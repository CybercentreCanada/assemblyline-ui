/*! For license information please see main.a225b845.chunk.js.LICENSE.txt */
(this["webpackJsonpassemblyline-ui-frontend"]=this["webpackJsonpassemblyline-ui-frontend"]||[]).push([[0],{273:function(e,t,a){var n,r;!function(i,l){"use strict";void 0===(r="function"===typeof(n={encode:function(e){var t,a=new ArrayBuffer(256),n=new DataView(a),r=0;function i(e){for(var i=a.byteLength,l=r+e;i<l;)i<<=1;if(i!==a.byteLength){var s=n;a=new ArrayBuffer(i),n=new DataView(a);for(var c=r+3>>2,o=0;o<c;++o)n.setUint32(o<<2,s.getUint32(o<<2))}return t=e,n}function l(){r+=t}function s(e){l(i(1).setUint8(r,e))}function c(e){for(var t=i(e.length),a=0;a<e.length;++a)t.setUint8(r+a,e[a]);l()}function o(e,t){t<24?s(e<<5|t):t<256?(s(e<<5|24),s(t)):t<65536?(s(e<<5|25),function(e){l(i(2).setUint16(r,e))}(t)):t<4294967296?(s(e<<5|26),function(e){l(i(4).setUint32(r,e))}(t)):(s(e<<5|27),function(e){var t=e%4294967296,a=(e-t)/4294967296,n=i(8);n.setUint32(r,a),n.setUint32(r+4,t),l()}(t))}if(function e(t){var a;if(!1===t)return s(244);if(!0===t)return s(245);if(null===t)return s(246);if(void 0===t)return s(247);switch(typeof t){case"number":if(Math.floor(t)===t){if(t>=0&&t<=9007199254740992)return o(0,t);if(-9007199254740992<=t&&t<0)return o(1,-(t+1))}return s(251),function(e){l(i(8).setFloat64(r,e))}(t);case"string":var n=[];for(a=0;a<t.length;++a){var u=t.charCodeAt(a);u<128?n.push(u):u<2048?(n.push(192|u>>6),n.push(128|63&u)):u<55296?(n.push(224|u>>12),n.push(128|u>>6&63),n.push(128|63&u)):(u=(1023&u)<<10,u|=1023&t.charCodeAt(++a),u+=65536,n.push(240|u>>18),n.push(128|u>>12&63),n.push(128|u>>6&63),n.push(128|63&u))}return o(3,n.length),c(n);default:var m;if(Array.isArray(t))for(o(4,m=t.length),a=0;a<m;++a)e(t[a]);else if(t instanceof Uint8Array)o(2,t.length),c(t);else{var d=Object.keys(t);for(o(5,m=d.length),a=0;a<m;++a){var p=d[a];e(p),e(t[p])}}}}(e),"slice"in a)return a.slice(0,r);for(var u=new ArrayBuffer(r),m=new DataView(u),d=0;d<r;++d)m.setUint8(d,n.getUint8(d));return u},decode:function(e,t,a){var n=new DataView(e),r=0;function i(e,t){return r+=e,t}function l(t){return i(t,new Uint8Array(e,r,t))}function s(){return i(1,n.getUint8(r))}function c(){return i(2,n.getUint16(r))}function o(){return i(4,n.getUint32(r))}function u(){return 255===n.getUint8(r)&&(r+=1,!0)}function m(e){if(e<24)return e;if(24===e)return s();if(25===e)return c();if(26===e)return o();if(27===e)return 4294967296*o()+o();if(31===e)return-1;throw"Invalid length encoding"}function d(e){var t=s();if(255===t)return-1;var a=m(31&t);if(a<0||t>>5!==e)throw"Invalid indefinite length element";return a}function p(e,t){for(var a=0;a<t;++a){var n=s();128&n&&(n<224?(n=(31&n)<<6|63&s(),t-=1):n<240?(n=(15&n)<<12|(63&s())<<6|63&s(),t-=2):(n=(15&n)<<18|(63&s())<<12|(63&s())<<6|63&s(),t-=3)),n<65536?e.push(n):(n-=65536,e.push(55296|n>>10),e.push(56320|1023&n))}}"function"!==typeof t&&(t=function(e){return e}),"function"!==typeof a&&(a=function(){});var g=function e(){var o,g,f=s(),h=f>>5,b=31&f;if(7===h)switch(b){case 25:return function(){var e=new ArrayBuffer(4),t=new DataView(e),a=c(),n=32768&a,r=31744&a,i=1023&a;if(31744===r)r=261120;else if(0!==r)r+=114688;else if(0!==i)return(n?-1:1)*i*5.960464477539063e-8;return t.setUint32(0,n<<16|r<<13|i<<13),t.getFloat32(0)}();case 26:return i(4,n.getFloat32(r));case 27:return i(8,n.getFloat64(r))}if((g=m(b))<0&&(h<2||h>6))throw"Invalid length";switch(h){case 0:return g;case 1:return-1-g;case 2:if(g<0){for(var v=[],E=0;(g=d(h))>=0;)E+=g,v.push(l(g));var y=new Uint8Array(E),O=0;for(o=0;o<v.length;++o)y.set(v[o],O),O+=v[o].length;return y}return l(g);case 3:var _=[];if(g<0)for(;(g=d(h))>=0;)p(_,g);else p(_,g);return String.fromCharCode.apply(null,_);case 4:var x;if(g<0)for(x=[];!u();)x.push(e());else for(x=new Array(g),o=0;o<g;++o)x[o]=e();return x;case 5:var w={};for(o=0;o<g||g<0&&!u();++o){w[e()]=e()}return w;case 6:return t(e(),g);case 7:switch(g){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;default:return a(g)}}}();if(r!==e.byteLength)throw"Remaining bytes";return g}})?n.call(t,a,t,e):n)||(e.exports=r)}()},321:function(e){e.exports=JSON.parse('{"disabled":"Your account has been disabled...","not_allowed":"You are not allowed to view this page...","title":"403: Forbidden"}')},322:function(e){e.exports=JSON.parse('{"description":"The page you are looking for cannot be found...","dl.alt":"Dead Link","dl.description":"Looks like this \'Link\' is dead...","title":"404: Not found"}')},323:function(e){e.exports=JSON.parse('{"canceled":"Show cancelled tasks","debug_info":"Debug Information:","exception":"Show unhandled exceptions","fail.FAIL_NONRECOVERABLE":"Non-recoverable failure","fail.FAIL_RECOVERABLE":"Recoverable Failure","file_info":"Related file:","filter":"Filter errors ...","filtered":"error matching filter","filtereds":"errors matching filter","header.time":"Created","header.service":"Service","header.message":"Error Message","header.type":"Type","maxed":"Show maximum depth, files and retries","message":"Error message:","no_results_desc":"The query that you ran did not return any results.","no_errors_title":"No errors found!","searching":"Searching...","title":"Error Viewer","total":"error","totals":"errors","type.SERVICE BUSY":"SERVICE BUSY","type.SERVICE DOWN":"SERVICE DOWN","type.MAX DEPTH REACHED":"MAX DEPTH REACHED","type.EXCEPTION":"EXCEPTION","type.MAX FILES REACHED":"MAX FILES REACHED","type.TASK PRE-EMPTED":"TASK PREEMPTED","type.MAX RETRY REACHED":"MAX RETRY REACHED","type.UNKNOWN":"UNKNOWN"}')},324:function(e){e.exports=JSON.parse('{"add":"Add a service","add.acceptText":"Add","add.cancelText":"Cancel","add.paste":"Paste your service manifest here","add.success":"The service was successfully added to the system.","add.title":"Add a service","container":"Container configuration","container.card.command":"Executed command","container.card.cpu":"CPU cores allocated","container.card.creds":"Using private credentials for this registry","container.card.env":"Environment variables","container.card.internet":"Internet access","container.card.no":"no","container.card.ram":"Max amount of memory allocated","container.card.volumes":"Persistent volumes","container.card.yes":"yes","container.channel":"Service update channel","container.channel.beta":"Beta","container.channel.dev":"Development","container.channel.rc":"Release Candidate","container.channel.stable":"Stable","container.image":"Container image","container.dependencies":"Container dependencies","container.dependencies.add":"Add dependency","container.dependencies.none":"This service has no dependencies","container.dependencies.remove":"Remove dependency","container.dialog.acceptText":"Save","container.dialog.allow_internet":"Allow outside access","container.dialog.allow_internet.yes":"Yes - Allowed to access resources outside of the Assemblyline cluster","container.dialog.allow_internet.no":"No - Confined to the container","container.dialog.cancelText":"Cancel","container.dialog.command":"Command executed in the container","container.dialog.cpu":"Allowed CPU cores","container.dialog.environment":"Environment variables","container.dialog.environment.name":"Variable name","container.dialog.environment.value":"Variable\'s value","container.dialog.image":"Container image name","container.dialog.name":"Dependency name","container.dialog.ram":"Allowed memory range","container.dialog.registry_password":"Container registry password","container.dialog.registry_username":"Container registry username","container.dialog.title.dependency":"Modifying dependency","container.dialog.title.container":"Modifying container","container.dialog.volumes":"Persistent Volumes","container.dialog.volumes.name":"Volume name","container.dialog.volumes.mount_path":"Mount path","container.dialog.volumes.capacity":"Capacity","container.dialog.volumes.storage_class":"Storage class","count":"services loaded in the system","delete.acceptText":"Remove","delete.cancelText":"Cancel","delete.success":"The service has successfully been remove from the system.","delete.text":"Are you sure you want to remove this service from the system? This cannot be undone but you can always re-add it afterwards.","delete.title":"Remove Service","disabled":"Disabled","enabled":"Enabled","general.accept":"Accepted file types","general.caching":"Result caching","general.caching.disabled":"Disabled","general.caching.enabled":"Enabled","general.category":"Service category","general.classification":"Default result\'s classification","general.description":"Description","general.licence":"Max number of instances","general.location":"Service location","general.location.external":"External - Outside of Assemblyline infrastructure","general.location.internal":"Internal - Inside of Assemblyline infrastructure","general.name":"Service name","general.reject":"Rejected file types","general.stage":"Execution stage","general.timeout":"Execution timeout","general.version":"Version","params.comma":"comma","params.config":"Service Variables","params.config.current":"Current service variables","params.config.new":"Add a new service variable","params.config.none":"There are no service variables right now","params.false":"False","params.true":"True","params.user":"User Specified Parameters","params.user.add":"Add user parameter","params.user.current":"Current parameters","params.user.new":"Add a new parameter","params.user.none":"There are no user specified parameter right now","params.user.remove":"Remove user parameter","remove":"Remove service","save":"Save changes","save.success":"Changes to the service were successfully saved to the system.","tab.docker":"Container","tab.general":"General","tab.params":"Parameters","tab.updater":"Updates","title":"Service Management","title.detail":"Service Details","updater":"Update\'s configuration","updater.dialog.acceptText":"Save","updater.dialog.ca":"Certificate Authority","updater.dialog.cancelText":"Cancel","updater.dialog.classification":"Default signature classification","updater.dialog.headers":"Headers","updater.dialog.headers.name":"Header name","updater.dialog.headers.value":"Header value","updater.dialog.ignore_ssl":"Ignore SSL Certificates Errors","updater.dialog.name":"Source name (required)","updater.dialog.password":"Password","updater.dialog.pattern":"Regex Pattern","updater.dialog.private_key":"Private Key","updater.dialog.proxy":"Proxy server","updater.dialog.proxy.placeholder":"scheme://user:pass@proxy:port","updater.dialog.title":"Source modification","updater.dialog.username":"Username","updater.dialog.uri":"URI (required)","updater.method":"Update\'s method","updater.method.run":"Execute a container","updater.method.build":"Rebuild a container","updater.interval":"Update interval (seconds)","updater.run.options":"Executed update container","updater.signatures":"Generates Signatures","updater.signatures.yes":"Yes","updater.signatures.no":"No","updater.sources":"Update sources","updater.sources.add":"Add a source","updater.sources.none":"There are no update sources specified right now","updater.sources.remove":"Remove source","updater.wait":"Wait for a valid update before starting service","updater.wait.yes":"Yes","updater.wait.no":"No"}')},325:function(e){e.exports=JSON.parse('{"E":"Extended","R":"Read","W":"Write","admin":"A","admin_label":"Administrator","caption":"available paths","header.function":"Function","header.methods":"Methods","header.permissions":"Permissions","header.protected":"Protected","header.url":"URL","signature_importer":"I","signature_importer_label":"Signature Importer","signature_manager":"M","signature_manager_label":"Signature Manager","title":"Site Map","user":"U","user_label":"User"}')},326:function(e){e.exports=JSON.parse('{"add_user":"Add a user","admins":"Show administrators","disabled":"Show disabled accounts","filter":"Filter users ...","filtered":"user matching filter","filtereds":"users matching filter","header.active":"Active","header.admin":"Admin","header.classification":"Classification","header.fullname":"Fullname","header.groups":"Groups","header.uid":"Username","newuser.api_quota":"API Quota","newuser.email":"Email","newuser.groups":"Groups","newuser.name":"Full Name","newuser.new_pass":"Password","newuser.roles":"Roles","newuser.save":"Add user","newuser.submission_quota":"Submission Quota","newuser.success":"New user was successfully added.","newuser.title":"Adding User","newuser.uname":"Username","no_results_desc":"The query that you ran did not return any results.","no_users_title":"No users found!","role.admin":"Administrator","role.normal_user":"Normal user","role.signature_importer":"Signature Importer","role.signature_manager":"Signature Manager","searching":"Searching...","subtitle":"total users(s)","title":"Users","total":"user","totals":"users"}')},327:function(e){e.exports=JSON.parse('{"actions.cancel":"Cancel","actions.ok":"Ok","actions.takeownershipdiag.content.grouped":"Do you want to take ownership of all alerts with the following properties?","actions.takeownershipdiag.content.single":"Do you want to take ownership of this single alert?","actions.takeownershipdiag.header":"Take Ownership","alert_id":"Alert ID","alerted_date":"Alerted","alerts":"Alerts","attack":"Att&ck","attack_category":"Categories","attack_pattern":"Patterns","attributions":"Attributions","avhits":"Antivirus detection","behaviors":"Behaviors","btn.ownership":"Take Ownership","btn.sha256":"Search SHA256","btn.submission":"Submission","btn.workflow":"Workflow Action","category":"Categories","data_filtered_msg":"Alert data filtered because user does not have the privileges to see all the results","dates":"Dates","detail.title":"Alert Detail","domain":"Domains","domain_dynamic":"Dynamic","domain_static":"Static","extended":"Extended Scan","favorites":"Favorites","file_info":"File Info","file_type":"Type","filters":"Filters","filters.apply":"Apply current filter selection","filters.clear":"Clear all filters","focus":"Show all alerts from group","groupBy":"Grouped By","groupBy.md5":"MD5","groupBy.name":"File name","groupBy.none":"No grouping","groupBy.priority":"Priority","groupBy.sha256":"SHA256","groupBy.status":"Status","group_count":"Group Count","heuristic":"Heuristics","hint_owned_by":"Another user own an alert in from this group","hint_owner":"There are owners for previous alerts in the group","ip":"IPs","ip_dynamic":"Dynamic","ip_static":"Static","label":"Labels","labels":"Labels","metadata":"Metadata","no_alerts_desc":"The following query in combination with the current selected filters do not match any alerts.","no_alerts_title":"No alerts found","others":"Other filters","owned_by":"Alert owned by:","ownership":"Owner","patterns":"Patterns","priority":"Priority","priority_CRITICAL":"CRITICAL","priority_HIGH":"HIGH","priority_LOW":"LOW","priority_MEDIUM":"MEDIUM","priority_unset":"NONE","query":"Query","received_date":"Received","result":"alert","results":"alerts","score":"System\'s verdict","status":"Status","status_ASSESS":"ASSESS","status_MALICIOUS":"MALICIOUS","status_NON-MALICIOUS":"NON-MALICIOUS","status_TRIAGE":"TRIAGE","submission":"Go to related submission","take_ownership":"Take ownership","take_ownership.success":"You are now the owner of this alert!","tc":"Time Constraint","tc.1month":"1 Month","tc.1week":"1 Week","tc.24h":"24 hours","tc.4d":"4 Days","tc.none":"No time constraint (can be slow)","tooltip.actions":"Alert Actions","type":"Type","user_verdict":"Users\' verdict","verdict.failed":"The system was unable to set the verdict.","verdict.malicious":"Malicious","verdict.malicious.action":"Set alert verdict to malicious","verdict.malicious.set":"You\'ve already set verdict to malicious","verdict.malicious.success":"Alert verdict successfully set to malicious.","verdict.non_malicious":"Non-Malicious","verdict.non_malicious.action":"Set alert verdict to non-malicious","verdict.non_malicious.set":"You\'ve already set verdict to non-malicious","verdict.non_malicious.success":"Alert verdict successfully set to non-malicious.","verdict.success.malicious":"Successfully applied malicious verdict to the alert.","verdict.success.non_malicious":"Successfully applied non-malicious verdict to the alert.","verdict.user.malicious":"users think this alert is malicious","verdict.user.non_malicious":"users think this alert is non-malicious","workflow.apply":"Apply workflow actions","workflow.impact.high":"The workflow action will be applied to all alerts matching the following filters:","workflow.impact.low":"The workflow action will only affect the currently selected alert which matches the following filters:","workflow.title":"Perform a workflow action","workflow_action":"Perform a workflow action","workflows":"Workflow actions","yara":"Yara rules triggered"}')},328:function(e){e.exports=JSON.parse('{"access":"is requesting access to your account.","button.back":"Go back","button.allow":"Allow","button.cancel":"Cancel","scope":"This will allow the application to:","invalid":"Invalid parameters were provided for the app registration. We will not be able to proceed.","scope.r":"Read any data from Assemblyline on your behalf","scope.rw":"Read and write any data from and to Assemblyline on your behalf","scope.w":"Write any data to Assemblyline on your behalf","warning":"Make sure you trust this application before allowing it access to your account. You can revoke this access at any time from your user profile."}')},329:function(e){e.exports=JSON.parse('{"alerter":"Alerter Metrics","alerter.error":"Alerter is generating errors","archived":"Archived:","archived.alert":"Archived alerts","archived.error":"Archived errors","archived.file":"Archived files","archived.result":"Archived results","archived.submission":"Archived submission","busyness":"Busyness:","caching":"Caching:","caching.hits":"Ingestion cache hits","caching.miss":"Ingestion cache miss","cores":"cores","cpu":"CPU","dispatcher":"Dispatch Metrics","dispatcher.error.busy":"Dispatcher processes are getting too busy","dispatcher.error.inflight":"Number of submissions being processed is getting too high","dispatcher.error.queue.files":"File processing queue is getting too full","dispatcher.error.queue.start":"Submission start message queue is getting too full","dispatcher.error.queue.command":"Command processing queue is getting too full","dispatcher.error.queue.result":"Result aggregation queue is getting too full","dispatcher.error.queue.ingest":"Dispatcher message queue is getting too full","expired":"Expired:","expired.alert":"Expired alerts","expired.error":"Expired errors","expired.file":"Expired files","expired.result":"Expired results","expired.submission":"Expired submission","expiry":"Expiry Metrics","gb":"GB","ingest":"Ingest:","ingest.critical":"Submissions of critical priority","ingest.error.busy":"Ingester processes are getting too busy","ingest.error.bytes":"Submissions are being ingested but none are completing","ingest.error.chance.critical":"Critical queue is too full and being sampled","ingest.error.chance.high":"High queue is too full and being sampled","ingest.error.chance.low":"Low queue is too full and being sampled","ingest.error.chance.medium":"Medium queue is too full and being sampled","ingest.error.queue":"Ingestion queue is getting too full","ingest.high":"Submissions of high priority","ingest.low":"Submissions of low priority","ingest.medium":"Submissions of medium priority","ingest.queue":"Submissions queued for ingesting","ingester":"Ingestion Metrics","no_services":"There are no service online","processing":"Processing:","processing.inflight":"Submissions being scanned right now","queued":"Queued:","queues":"Queues:","queues.alert":"Alerts","queues.error":"Errors","queues.file":"Files","queues.ingest":"Ingest","queues.result":"Results","queues.command":"Commands","queues.start":"Submissions starting","queues.submission":"Submissions","ram":"Memory","resources":"System Resources","service.busy":"Number of busy service instance","service.error.fail_nonrecoverable":"There are non-recoverable failures for this service","service.error.none":"There are no instances of this service","service.error.queue":"The queue for this service is getting very high","service.failed":"Failed files in the last minute","service.retried":"Retried files in the last minute","service.processed":"Processed files in the last minute","service.queue":"Number of files in service queue","services":"Online services:","submissions":"Submissions:","submissions.outstanding":"Outstanding submissions","throughput":"Throughput: (for the last minute)","throughput.busy":"Busyness percentage","throughput.bytes":"Bytes processed / Bytes ingested","throughput.created":"Created","throughput.duplicates":"Duplicate submissions","throughput.error":"Errors","throughput.files_completed":"Scanned files","throughput.received":"Received","throughput.skipped":"Skipped submissions","throughput.submissions_completed":"Scanned submissions","throughput.updated":"Updated","throughput.whitelisted":"Whitelisted submissions","timeout":"Were are not receiving any heartbeat for this component","title":"Dashboard"}')},330:function(e){e.exports=JSON.parse('{"added.global":"Successfully added favorite to the global list.","added.personal":"Successfully added favorite to your personal list.","addfavorites":"Manage favorites","cancel":"Cancel","confirmdiag.content":"Are you sure you want to delete the following favorite?","confirmdiag.header":"Delete a favorite","form.field.required":"The Query and Name value are required.","globalfavorites":"Public Favorites","name":"Name (required)","ok":"Yes, Delete it!","private":"Private","public":"Public","query":"Query (required)","save":"Add to favorites","yourfavorites":"Your Favorites"}')},331:function(e){e.exports=JSON.parse('{"attack_matrix":"Att&ck Matrix","childrens":"Possible Childrens","download":"Download File","emptys":"Empty Results","entropy":"Entropy","errors":"Errors","extracted":"Extracted files","file_viewer":"File Viewer","frequency":"File Frequency","generated_tags":"Generated Tags","heuristics":"Heuristics","identification":"File Identification","magic":"Magic","metadata":"Submissions Summary","mime":"Mimetype","nothing_to_report":"The service had nothing to report for this file.","parents":"Possible Parents","process_signatures":"Signature hits","related":"Related Submissions","resubmit.success":"File successfully resubmitted for dynamic analysis. You will be redirected...","resubmit_dynamic":"Resubmit for Dynamic Analysis","results":"Service Results","seen.count":"Count","seen.first":"First Seen","seen.last":"Last Seen","size":"Size","supplementary":"Supplementary files","title":"File Details","type":"Type","verdict.info":"Informational","verdict.malicious":"Malicious","verdict.suspicious":"Suspicious","view_file":"View file"}')},332:function(e){e.exports=JSON.parse('{"detail":"File analysis details","download":"Download file","related":"Related submissions","title":"File viewer"}')},333:function(e){e.exports=JSON.parse('{"complete":"Fully documented","description":"Description","function":"Internal Function","methods":"Allowed methods","path":"API Path","priv.E":"Extended","priv.R":"Read","priv.W":"Write","protected":"Requires login","require_type":"Required user types","required_priv":"Required priviledges","title":"API Documentation","user_type.admin":"Administrator","user_type.signature_importer":"Signature Importer","user_type.signature_manager":"Signature Manager","user_type.user":"User","version":"Assemblyline API version ","version_end":""}')},334:function(e){e.exports=JSON.parse('{"assumptions":"Lets assume the following:","desc_1":"When you submit a file to Assemblyline, you are required to provide it\'s classification. This classification is for the submission itself and will be applied to all the children files in the submission as well as the results associated to the submission.","desc_2":"If you realize that you\'ve submitted a file with the wrong classification, you can always use the delete button in the submission detail page to get rid of it.","desc_title":"Submission based classification","ex_title":"Example:","result_a_1":"<bold>File1</bold> is classified ","result_a_2":"<bold>ServiceX</bold> results for <bold>File1</bold> are ","result_a_3":"<bold>File2</bold> is classified ","result_a_4":"<bold>ServiceY</bold> results for <bold>File2</bold> are classified ","result_a_res_1_p1":"<bold>ServiceX</bold> results for <bold>File1</bold> are going to be classified ","result_a_res_1_p2":" because the file is classified higher then the service results. In the eyes of an ","result_a_res_1_p3":" user, they will not exist.","result_a_res_2_p1":"<bold>ServiceY</bold> results for <bold>File2</bold> will remain classified ","result_a_res_2_p2":" since the classification of the results is higher than the classification of the file itself.","result_desc":"The various Assemblyline services will output their results at different classification levels depending on the technique/tool used to provide the result. To prevent the search engine from displaying results of classified files to unclassified users, the system will apply the maximum classification between the file classification and the service result classification to the results.","result_title":"Service results have classification too!","title":"Classification Help","submission_a_1":"<bold>Submission1</bold> is classified ","submission_a_2":"<bold>Submission2</bold> is classified ","submission_a_3":"<bold>File1</bold> is in both submissions.","submission_a_res_1_p1":"<bold>File1</bold>\'s classification will be ","submission_a_res_1_p2":" which is the lowest classification between the two files. <bold>Submission1</bold> and <bold>Submission2</bold> will remain to their original classification.","submission_a_res_2_p1":"<bold><italic>If one of the submission is deleted</italic></bold>, let\'s says <bold>Submission2</bold>. The system will re-calculate the classification of all the files related to the deleted submission. <bold>File1</bold>\'s classification will now be ","submission_a_res_2_p2":". <bold>Submission1</bold> will remain to its original classification.","submission_desc":"If two submission contain the same file but those submissions have different classifications, the system will assign to lowest classification of the two submissions to the file.","submission_title":"One file, multiple submissions","validation_groups":"Groups Releaseability","validation_groups_desc":"To view a piece of information protected with a group releaseability, the user <bold>must have at least one</bold> of the groups that the submission/file/result the user is trying to view has.","validation_groups_none":"There are no groups configured in this system.","validation_groups_note":"** <bold>NOTE</bold>: not providing a group makes it available to all groups.","validation_groups_supported":"Currently Supported Groups:","validation_level":"Classification Level","validation_level_desc":"Classification level is validated by using <bold>greater than or equal</bold>. The user\'s classification has to be greater than or equal to submission/file/result it is trying to view/search.","validation_level_supported":"Currently Supported classification levels:","validation_required":"Required tokens","validation_required_desc":"To view a piece of information protected with required tokens, the user <bold>must have all</bold> the tokens that the submission/file/result the user is trying to view has.","validation_required_none":"There are no required field configured in this system.","validation_required_supported":"Currently Supported Required Tokens:","validation_subgroups":"Sub-Groups Releaseability","validation_subgroups_desc":"To view a piece of information protected with a sub-groups releaseability, the user <bold>must have at least one</bold> of the sub-groups that the submission/file/result the user is trying to view has.","validation_subgroups_none":"There are no sub-groups configured in this system.","validation_subgroups_note":"** <bold>NOTE</bold>: not providing a subgroup  makes it available to all subgroup.","validation_subgroups_supported":"Currently Supported Sub-Groups:","validation_title":"How is the classification validated?"}')},335:function(e){e.exports=JSON.parse('{"config":"Configuration variables","config.desc":"Every assemblyline instance has a unique configuration. Some configuration parameters are particularly useful to understand how the system works:","file_types":"File Types","file_types.desc":"Assemblyline assigns all files a type by analysing the file\'s structure and uses that type to route the file to the appropriate service.","file_types.non_specific":"Other files types are identified but not routed to specific services:","file_types.non_specific_service":"The following services process all file types:","file_types.specific":"Some file types will be routed to specific services:","priorities":"Priorities","priorities.desc":"Every submission in Assemblyline is assigned a priority. Submissions are processed in descending order of priority with higher priority submissions processed first. If two submissions have the same priority they are performed in the order they were received. The priority field is a number which allows for very fine-grained control over priorities.","priorities.desc_list":"For convenience, we\'ve define a number of  priorities, these are listed below:","priorities.max":"maximum","tags":"Tags","tags.desc":"Assemblyline pulls potentially interesting identifiers and assign them a type. Assemblyline calls these tags.","tags.desc_list":"Below are the different tag types that you can find throughout the system:","title":"Current Configuration"}')},336:function(e){e.exports=JSON.parse('{"title":"Search help"}')},337:function(e){e.exports=JSON.parse('{"accepts":"Accepts","category":"Category","count":"services loaded in the system","disabled":"Disabled","rejects":"Rejects","stage":"Stage","title":"Service Listing"}')},338:function(e){e.exports=JSON.parse('{"auto_notify":"System administrators have been notified. You will receive an email once your account is active.","contact_admin":"Contact your system administrators so they can activate your account.","title":"Waiting for approval..."}')},339:function(e){e.exports=JSON.parse('{"button":"Sign in","button_oauth":"Sign in with","other":"Or sign in as a different user...","otp":"One Time Password","password":"Password","reset.button":"Reset password","reset.desc":"Forgot password?","reset.done":"An email was sent to your address with instructions on how to reset your password.","reset.email":"Enter your email address","reset.link":"Reset it!","reset_now.button":"Reset","reset_now.done":"Password resetted!","reset_now.password":"New password","reset_now.password_confirm":"Confirm new password","reset_now.redirect":"You will be redirected to the login screen in a few seconds...","securitytoken":"Please touch the flashing security token","securitytoken.error":"Security token was invalid or operation was cancelled. Try with One Time Password instead...","securitytoken.unavailable":"Cannot use security token on this server. Use One Time Password instead...","signup":"Do not have an account?","signup.button":"Create my account","signup.completed":"New account registration is now complete, you can now login with your account","signup.done":"An email was sent to your address with the final instrucstions to create a new account.","signup.email":"Email address","signup.link":"Sign up!","signup.password":"Password","signup.password_confirm":"Password confirmation","signup.username":"Username","username":"Username"}')},340:function(e){e.exports=JSON.parse('{"title":"Logging out current user ... "}')},341:function(e){e.exports=JSON.parse('{"filter":"Filter heuristics...","filtered":"heuristic matching filter","filtereds":"heuristics matching filter","searching":"Searching...","title":"Heuristics","total":"heuristic","totals":"heuristics"}')},342:function(e){e.exports=JSON.parse('{"attack_id":"Associated Att&ck IDs","chart.title":"Number of hits in the last 30 days","contribution":"Score contribution","desc":"Description","filetype":"Associated file type","hit.count":"Hit Count:","hit.first":"First Hit:","hit.last":"Last Hit:","hit.none":"Never","hits":"Usage","last10":"Last 10 hits","max_score":"Maximum allowed score","name":"Name","no_attack_id":"None","no_max":"No maximum score enforced","no_sigs":"No signature score overrides","score":"Score","score.avg":"Average","score.max":"Maximum","score.min":"Minimum","signature_score_map":"Scores of the different signatures","statistics":"Statistics","title":"Heuristic Details","usage":"Show heuristic usage"}')},343:function(e){e.exports=JSON.parse('{"disabled":"Show disabled signatures","download_desc":"Download current set of signatures","filter":"Filter signatures...","filtered":"signature matching filter","filtereds":"signatures matching filter","noisy":"Show noisy signatures","searching":"Searching...","title":"Signatures","total":"signature","totals":"signatures"}')},344:function(e){e.exports=JSON.parse('{"change.close":"Cancel","change.save":"Save changes","change.success":"The state of the signature was successfully changed","change.title":"Changing the status of a signature","change.warning":"Before changing the signature state take note of the following:","change.warning.1":"After a signature has been either DEPLOYED, marked NOISY or DISABLED, it cannot go back in TESTING or STAGING status.","change.warning.2":"Only one revision of a signature can run at the same time in the system.","change.warning.action":"Choose the new signature state:","chart.title":"Number of hits in the last 30 days","contribution":"Score contribution","delete.acceptText":"Yes, delete it!","delete.cancelText":"Cancel","delete.success":"Signature was successfully deleted.","delete.text":"Are you sure you want to delete the current signature? There will be no way to recover it once it\'s done.","delete.title":"Delete Signature","hit.count":"Hit Count:","hit.first":"First Hit:","hit.last":"Last Hit:","hit.none":"Never","hits":"Usage","last10":"Last 10 hits","remove":"Remove signature","score.avg":"Average","score.max":"Maximum","score.min":"Minimum","statistics":"Statistics","status.DEPLOYED":"Deployed","status.DISABLED":"Disabled","status.NOISY":"Noisy","title":"Signature Details","usage":"Show signature usage"}')},345:function(e){e.exports=JSON.parse('{"add.save":"Add signature source","add.success":"The signature source was successfully added.","add_source":"Add a signature source for this service","adding_source":"Add a signature source","ca":"Certificate Authority","ca_used":"A Certificate Authority will be used to connect to the source","caption":"Services allowed to generate signatures","change.save":"Save changes","change.success":"The signature source was successfully modified.","classification":"Classification","delete":"Delete the current signature source","delete.acceptText":"Yes, delete it!","delete.cancelText":"Cancel","delete.success":"The signature source was successfully deleted.","delete.text":"Are you sure you want to delete the current signature source? There will be no way to recover it once it\'s done.","delete.title":"Delete signature source","editing_source":"Edit a signature source","headers":"Headers","headers.name":"Name","headers.value":"Value","ignore_ssl":"Ignore SSL Errors","ignore_ssl_used":"SSL Errors will be ignored when connecting to this source","name":"Source Name (Required)","no_sources":"There are currently no signature source for this service.","password":"Password","pattern":"Regex pattern","private_key":"Private key","private_key_used":"A private key will be used to connect to the source","proxy":"Proxy server","proxy.placeholder":"scheme://user:pass@proxy:port","proxy_used":"A proxy server will be used to connect to the source","title":"Signature sources","uri":"URI (Required)","username":"Username"}')},346:function(e){e.exports=JSON.parse('{"filter":"Filter workflows...","filtered":"workflow matching filter","filtereds":"workflows matching filter","noisy":"Show noisy workflows","searching":"Searching...","title":"Workflows","total":"workflow","totals":"workflows","never_used":"Workflows that were never used","old":"Workflows not used in the past 3 months"}')},347:function(e){e.exports=JSON.parse('{"add.button":"Add workflow","add.success":"Successfully added the new workflow.","add.title":"Adding a workflow","created_by":"Created by ","delete.acceptText":"Yes, remove it!","delete.cancelText":"Cancel","delete.success":"Workflow was successfully deleted.","delete.text":"Do you really want to remove the current workflow?","delete.title":"Remove workflow?","edited_by":"Edited by ","labels":"Labels","name":"Name (Required)","on":"on","priority":"Priority","priority.CRITICAL":"CRITICAL","priority.HIGH":"HIGH","priority.LOW":"LOW","priority.MEDIUM":"MEDIUM","priority.null":"","query":"Query (Required)","save":"Save Changes","save.success":"Workflow was successfully saved.","status":"Status","status.ASSESS":"ASSESS","status.MALICIOUS":"MALICIOUS","status.NON-MALICIOUS":"NON-MALICIOUS","status.null":"","title":"Workflow Details"}')},348:function(e){e.exports=JSON.parse('{"title":"Opting out of new user interface... Sorry to see you go! "}')},349:function(e){e.exports=JSON.parse('{"alert":"Alert","available":"available","file":"File","focus_search":"Focus on selected tab","header.accepts":"File types","header.attack_id":"Att&ck IDs","header.category":"Category","header.classification":"Classification","header.count":"Count","header.created":"Created Time","header.description":"Description","header.enabled":"Enabled","header.filetype":"File Type","header.hit_count":"Times seen","header.id":"ID","header.last_hit":"Last Seen","header.lasttimeseen":"Last Time Seen","header.name":"Name","header.numfiles":"Files","header.priority":"Priority","header.reporting_ts":"Alert Time","header.rev":"Revision","header.score":"Score","header.service":"Service","header.sha256":"SHA256","header.size":"Size","header.source":"Source","header.stage":"Stage","header.starttime":"Start Time","header.status":"Status","header.type":"Type","header.user":"User","header.verdict":"Verdict","header.version":"Version","matching_result":"matching result","matching_results":"matching results","never":"Never","no_alerts_title":"No alerts found!","no_files_title":"No files found!","no_heuristics_title":"No heuristic found!","no_results_desc":"The query that you ran did not return any results.","no_results_title":"No results found!","no_signatures_title":"No signatures found!","no_submissions_title":"No submissions found!","no_workflows_title":"No workflows found!","result":"Result","search_alert":"Search alert index...","search_all":"Search all indexes...","search_file":"Search file index...","search_result":"Search result index...","search_signature":"Search signature index...","search_submission":"Search submission index...","signature":"Signature","submission":"Submission","title_alert":"Search Alerts","title_all":"Search","title_file":"Search Files","title_result":"Search Results","title_signature":"Search Signatures","title_submission":"Search Submissions","update":"Update","updating":"Updating...","use_archive.turn_off":"Turn off achive search","use_archive.turn_on":"Turn on archive search"}')},350:function(e){e.exports=JSON.parse('{"interface":"Interface Options","interface.encoding":"File encoding","interface.encoding_cart":"CaRT file neutering format","interface.encoding_desc":"Encoding used for all downloaded files.","interface.encoding_raw":"No encoding","interface.score":"Auto-expand verdict","interface.score_-1000000":"Auto-expand all sections","interface.score_0":"Non-Malicious","interface.score_100":"Suspicious","interface.score_100000000":"Never auto-expand service sections","interface.score_2000":"Malicious","interface.score_500":"Highly Suspicious","interface.score_desc":"Minimum verdict required before a service result section gets auto-expanded.","interface.view":"Submission view","interface.view_desc":"Default view shown when opening completed submissions.","interface.view_details":"Detail view","interface.view_report":"Report view","save":"Save settings","service":"Service Selection","submissions":"Submission Options","submissions.classification":"Classification","submissions.classification_desc":"Default classification used for new submissions.","submissions.deep_scan":"Deep analysis","submissions.deep_scan_desc":"Perform deeper analysis of the file by turning on more checks. Slower and not recommended for bulk analysis.","submissions.dynamic_recursion":"Dynamic recursion prevention","submissions.dynamic_recursion_desc":"Ensures that children of dynamic analysis services are not sent back to dynamic services for analysis.","submissions.filtering":"Filtering","submissions.filtering_desc":"Allow filtering services to skip files if they believe the files are safe.","submissions.profile":"Submission profiling","submissions.profile_desc":"Add extra debugging steps to your scans so they can be traced better in the logs.","submissions.result_caching":"Result caching","submissions.result_caching_desc":"Cache service results so files don\'t have to be re-scanned if the service did not change.","submissions.ttl":"Days to live","submissions.ttl_days":"day(s)","submissions.ttl_desc":"Number of days your submissions will stay in the system.","submissions.ttl_forever":"Forever","success_save":"Settings successfully saved!"}')},351:function(e){e.exports=JSON.parse('{"avg":"Avg Score","classification":"Classification","count":"Count","heur_id":"ID","max":"Max Score","min":"Min Score","name":"Name","title":"Heuristics Statistics"}')},352:function(e){e.exports=JSON.parse('{"avg":"Avg Score","classification":"Classification","count":"Count","max":"Max Score","min":"Min Score","name":"Name","source":"Source","title":"Signatures Statistics","type":"Type"}')},353:function(e){e.exports=JSON.parse('{"attack_matrix":"Att&ck Matrix","attribution":"Attributions","behavior":"Behaviors","delete":"Delete current submission","delete.acceptText":"Yes, delete it!","delete.cancelText":"Cancel","delete.success":"Submission successfully deleted. You will be redirected to the submission list...","delete.text":"You are about to delete the current submission with all it\'s associated results. This operation cannot be undone.","delete.title":"Delete Submission ?","dispatcher.not_responding":"Dispatcher does not seem to be working correctly, it is not sending any messages.","download":"Download submission\'s bundle","errors":"Errors","errors.aggregated":"The following services generated {errorType} errors","errors.listed":" generated an error for file: ","errors.type.busy":"SERVICE BUSY","errors.type.down":"SERVICE DOWN","errors.type.depth":"MAX DEPTH REACHED","errors.type.exception":"EXCEPTION","errors.type.files":"MAX FILES REACHED","errors.type.preempted":"TASK PREEMPTED","errors.type.retry":"MAX RETRY REACHED","errors.type.unknown":"UNKNOWN","heuristics":"Heuristics","information":"Submission Information","ioc":"Indicators of Compromise","live_mode":"Submission is still processing, receiving results live...","max_score":"Verdict","metadata":"Metadata","outstanding.error":"We could not determine which services are busy working on your submission. There might be issues with the system...","outstanding.files":"Files remaining","outstanding.services":"Services","outstanding.title":"You are waiting on the following services finish processing:","params.deep_scan":"Deep Scan","params.description":"Description","params.groups":"Groups","params.ignore_cache":"Ignore Cache","params.ignore_dynamic_recursion_prevention":"Ignore Dynamic Recursion Prevention","params.ignore_filtering":"Ignore Filtering","params.services.selected":"Selected services","params.submitter":"Submitted By","report_view":"Show report view","resubmit":"Resubmit current submission","submit.success":"Submission successfully resubmited. You will be redirected to it...","times.completed":"Completed Time","times.submitted":"Start Time","title":"Submission Details","tree":"Files","verdict.info":"Informational","verdict.is.malicious":"You believe this file is Malicious","verdict.is.non_malicious":"You believe this file is Non-Malicious","verdict.malicious":"Malicious","verdict.set.malicious":"Vote for Malicious verdict","verdict.set.non_malicious":"Vote for Non-Malicious verdict","verdict.suspicious":"Suspicious"}')},354:function(e){e.exports=JSON.parse('{"actor":"Used by","attack":"Att&ck Matrix","detail_view":"Show detailed view","error.notfound":"The submission was not found","error.too_early":"It is too early to generate the report, the submission is not completed. Redirecting you to the detail view...","family":"Family","file.description":"Description","file.magic":"Magic","file.md5":"MD5","file.mime":"MIME","file.name":"Name","file.sha1":"SHA1","file.sha256":"SHA256","file.size":"Size","file.ssdeep":"SSDEEP","file.type":"Type","file.verdict":"Verdict","general":"General Information","heuristics":"Heuristics","implant":"Implant","important_files":"Important extracted files","malicious":"Malicious","metadata":"Metadata","non_malicious":"Non-Malicious","print":"Print Report","submission.date":"Analysis Date","submission.services":"Selected Services","submission.services.errors":"Service Errors","submission.user":"Submitted By","tag.attributions":"Attributions","tag.behaviors":"Behaviors","tag.indicators_of_compromise":"Indicators of Compromise","tag.table.files":"Related Files","tag.table.type":"Type","tag.table.value":"Value","title":"Submission Report","user.verdict":"User\'s Verdicts"}')},355:function(e){e.exports=JSON.parse('{"completed_submissions":"Show completed submissions","detail":"Detail","filter":"Filter submissions...","filtered":"submission matching filter","filtereds":"submissions matching filter","malicious_submissions":"Show malicious submissions","my_submission":"Show my submissions","report":"Report","searching":"Searching...","title":"Submissions","total":"submission","totals":"submissions"}')},356:function(e){e.exports=JSON.parse('{"classification":"The following classification will be applied to your submission:","file":"File","file.button":"Upload and Scan","file.cancel":"Cancel","file.dragzone":"Select a file to scan","file.dragzone.byte":"bytes","file.drophere":"Drop your file here!","options":"Options","options.service":"Service Selection","options.service_spec":"Services Specific Parameters","options.submission":"Submission Parameters","options.submission.deep_scan":"Perform deep analysis","options.submission.desc":"Description","options.submission.ignore_cache":"Ignore result cache","options.submission.ignore_dynamic_recursion_prevention":"Ignore dynamic recursion prevention","options.submission.ignore_filtering":"Ignore filtering services","options.submission.priority":"Priority","options.submission.priority.high":"High: 1500","options.submission.priority.low":"Low: 500","options.submission.priority.medium":"Medium: 1000","options.submission.profile":"Profile current scan","options.submission.ttl":"Days to live (0: Forever)","submit.file.failure":"The file your are trying to start did not upload properly, try again...","submit.file.upload_fail":"The file fail to upload, try again...","submit.progress":"% uploaded...","submit.success":"Successfully submitted, redirecting you to submission ID:","submit.url.failure":"Submitted URL is either invalid or unreachable...","terms1":"By pressing ","terms2":", you consent to our ","terms3":"Terms of Service","url":"URL","url.button":"Scan","url.input":"URL to Scan","validate.acceptText":"Continue","validate.cancelText":"Deselect external services","validate.text":"You are about to submit your file to a service outside Assemblyline\'s infrastructure. What do you want to do?","validate.title":"External Services Selected"}')},357:function(e){e.exports=JSON.parse('{"agreed":"You\'ve already agreed to the terms of service...","button":"Accept terms","logout":"Logout","title":"Terms of Service"}')},358:function(e){e.exports=JSON.parse('{"adminmenu":"Administration","adminmenu.errors":"Error Viewer","adminmenu.services":"Services","adminmenu.sitemap":"Site Map","adminmenu.users":"Users","api.invalid":"Invalid data returned by API server","api.unreachable":"API server unreachable. Try again later...","app.language":"Language","banner.alt":"Assemblyline Banner","breadcrumb.404":"Not Found","breadcrumb.alert.detail":"Details","breadcrumb.file.detail":"Details","breadcrumb.file.viewer":"File Viewer","breadcrumb.heuristic.detail":"Details","breadcrumb.signature.detail":"Details","breadcrumb.submission.detail":"Details","breadcrumb.submission.detail.file":"File","breadcrumb.submission.report":"Report","breadcrumb.workflow.detail":"Details","breadcrumb.tos":"Terms of Service","classification.done":"Done","clear_filter":"Clear search filter","divider":"OR","drawer.alerts":"Alerts","drawer.collapse":"Collapse Menu","drawer.dashboard":"Dashboard","drawer.expand":"Expand Menu","drawer.help":"Help","drawer.help.api":"API Documentation","drawer.help.classification":"Classification Help","drawer.help.configuration":"Current Configuration","drawer.help.search":"Search Help","drawer.help.services":"Service Listing","drawer.manage":"Manage","drawer.manage.heuristics":"Heuristics","drawer.manage.signatures":"Signatures","drawer.manage.source":"Signature Sources","drawer.manage.workflow":"Workflows","drawer.search":"Search","drawer.search.alert":"Alert Index","drawer.search.all":"All Indexes","drawer.search.file":"File Index","drawer.search.result":"Result Index","drawer.search.signature":"Signature Index","drawer.search.submission":"Submission Index","drawer.signatures":"Signatures","drawer.stats":"Statistics","drawer.stats.heuristics":"Heuristics","drawer.stats.signatures":"Signatures","drawer.submissions":"Submissions","drawer.submit":"Submit","extended_scan.completed":"Extended Scan completed successfully","extended_scan.incomplete":"Extended Scan completed with errors that where not present in original scan","extended_scan.skipped":"Extended Scan was skipped for this alert","extended_scan.submitted":"Waiting on extended scan to be completed...","filter":"Filter...","forbidden":"Forbidden","locked":"Locked","logo.alt":"Assemblyline Logo","notfound":"Not Found","pager.first":"First page","pager.last":"Last page","pager.next":"Next page","pager.back":"Previous page","pager.rows":"Items per page:","pager.more":"more than","pager.of":"of","personalization":"Personalization","personalization.autohideappbar":"Auto Hide Topbar","personalization.dark":"Dark Mode","personalization.minimizebreadcrumbs":"Minimize Breadcrumbs","personalization.quicksearch":"Show Quick Search","personalization.reset_text":"Reset to site defaults","personalization.showbreadcrumbs":"Show Breadcrumbs","personalization.sticky":"Sticky Topbar","quicksearch.aria":"search","quicksearch.placeholder":"Search ...","signature.status.DEPLOYED":"DEPLOYED","signature.status.DISABLED":"DISABLED","signature.status.NOISY":"NOISY","submission.state.completed":"Completed","submission.state.error":"Completed with errors","submission.state.submitted":"Scanning...","tooltip.breadcrumbs.max":"Expand Breadcrumbs","tooltip.breadcrumbs.min":"Collapse Breadcrumbs","under_construction":"This page is still under development","usermenu":"User Menu","usermenu.account":"Manage Account","usermenu.logout":"Logout","usermenu.optout":"Opt out of new UI","usermenu.settings":"Settings","verdict.highly_suspicious":"Highly Suspicious","verdict.highly_suspicious.short":"H","verdict.info":"Informative","verdict.info.short":"I","verdict.malicious":"Malicious","verdict.malicious.short":"M","verdict.non_malicious":"Non-Malicious","verdict.non_malicious.short":"N","verdict.safe":"Safe","verdict.safe.short":"S","verdict.suspicious":"Suspicious","verdict.suspicious.short":"S"}')},359:function(e){e.exports=JSON.parse('{"2fa_already_enabled":"2-factor authentication is already enabled on your account","2fa_disable":"Disable","2fa_disable_desc":"By disabling 2-factor authentication on your account your account will be less secure. You will no longer be asked for one-time password to log in and all security tokens will be remove from your account.","2fa_disable_title":"Disable 2-factor authentication","2fa_disabled":"2-factor authentication has been deactivated on your account","2fa_enabled":"2-factor authentication has been enabled on your account","2fa_manual":"Manually add the secret key in your application","2fa_off":"Turn off 2-factor authentication","2fa_on":"Turn on 2-factor authentication","2fa_scan":"Scan the QRCode below with your application","2fa_setup_title":"2-factor Authentication Setup","2fa_temp_otp":"Enter a temporary OTP Token","admin":"Administrator","api_quota":"API quota","api_quota_edit_title":"Maximum number of concurrent API call that can run inside the API server. It is the equivalent to the number of threads a script runnning under your acocunt can have connected to the API server at the same time.","apikeys":"Manage API Keys","apikeys.add":"Add","apikeys.desc":"Ramdomly generated password used in scripts to gain limited data access for either reading, writing or both.","apikeys.list":"Configured API Keys","apikeys.new_notice_text":"This will be the only time where you\'ll actually see the key. Make sure you copy/paste that key in the script where you want to use it now because once you close this window you can no longer see the key. If you forget the key you\'ll have to delete it and re-create another.","apikeys.new_notice_title":"* Important *","apikeys.new_title":"Your new API Key","apikeys.none":"There are no API Keys for this user yet.","apikeys.r_token":"Read","apikeys.remove":"Remove","apikeys.remove_text":"Do you want remove this API Key? You will not be able to use this key to login anymore, make sure that none of your scripts are using this key before removing it.","apikeys.remove_title":"Remove API Key","apikeys.removed":"API Key was successfully removed","apikeys.rw_token":"Read / Write","apikeys.temp_token":"API Key name","apikeys.title":"API Keys","apikeys.w_token":"Write","apps":"Manage Authorized Applications","apps.desc":"These applications are able to impersonate your account and issue query to Assemblyline on your behalf.","apps.none":"No applications currently have access to your account.","apps.remove":"Revoke","apps.remove_text":"Do you want to revoke this application access to your account ? This cannot be undone but the application can ask for access again later.","apps.remove_title":"Revoke Application Access","apps.removed":"The application access to your account was revoked.","apps.title":"Authorized Applications","cancel":"Cancel","change_password":"Change password","confirm_password":"Confirm Password","delete.acceptText":"Yes, remove it!","delete.cancelText":"Cancel","delete.success":"User sucessfully removed.","delete.text":"Are you sure you want to remove the current user? There will be no way to recover it once it\'s done.","delete.title":"Remove user","disabled":"Account Disabled","done":"Done","email":"Email Address","enabled":"Account Enabled","groups":"Groups","groups_edit_title":"Groups are not for access control, they are used to group submissions of users of the same group together. When you submit a file, all groups you are member of are assigned to the submission.","name":"Full Name","name_edit_title":"Type your full name","new_password":"New Password","normal_user":"Normal user","options":"Options","profile":"Profile","remove":"Remove","roles":"Roles","save":"Save changes","security":"Security","signature_importer":"Signature Importer","signature_manager":"Signature Manager","submission_quota":"Submission quota","submission_quota_edit_title":"Maximum number of submissions processing under you account. Only submissions executed via the submit API and the UI count towards the quota, submissions started using ingest API do not.","success_save":"Changes to your account were successfully saved.","token":"Manage security tokens","token.add":"Add","token.added":"Security token was successfully added to your account","token.desc":"Only security tokens compatible with the FIDO u2F protocol are compatible with this system.","token.list":"Configured security tokens","token.none":"There are no security token configured for this account","token.remove":"Remove","token.remove_text":"Do you want remove this security token? You will not be able to login to the system with this token if you remove it.","token.remove_title":"Remove security token","token.removed":"Security token was successfully removed","token.temp_token":"New security token","token.title":"Security tokens","uname":"Username","validate":"Validate"}')},360:function(e){e.exports=JSON.parse('{"disabled":"Votre compte utilisateur \xe0 \xe9t\xe9 d\xe9sactiv\xe9 ...","not_allowed":"Vous n\'\xeates pas autoris\xe9 \xe0 afficher cette page ...","title":"403: Interdit"}')},361:function(e){e.exports=JSON.parse('{"description":"La page que vous recherchez est introuvable ...","dl.alt":"Link mort","dl.description":"On dirait que ce \'Link\' est mort...","title":"404: Introuvable"}')},362:function(e){e.exports=JSON.parse('{"canceled":"Afficher les t\xe2ches annul\xe9es","debug_info":"Informations de d\xe9bogage:","exception":"Afficher les exceptions non g\xe9r\xe9es","fail.FAIL_NONRECOVERABLE":"\xc9chec non r\xe9cup\xe9rable","fail.FAIL_RECOVERABLE":"\xc9chec r\xe9cup\xe9rable","file_info":"Fichier connexe:","filter":"Filtrer les erreurs...","filtered":"erreur qui correspond au filtre","filtereds":"erreurs qui correspondent au filtre","header.time":"Cr\xe9\xe9","header.service":"Service","header.message":"Message d\'erreur","header.type":"Type","maxed":"Afficher la profondeur, les fichiers et les tentatives maximales","message":"Message d\'erreur:","no_results_desc":"La requ\xeate que vous avez ex\xe9cut\xe9e n\'a renvoy\xe9 aucun r\xe9sultat.","no_errors_title":"Aucune erreur trouv\xe9e!","searching":"Recherche en cours...","title":"Visualisateur d\'erreurs","total":"erreur","totals":"erreurs","type.SERVICE BUSY":"SERVICE OCCUP\xc9","type.SERVICE DOWN":"SERVICE EN PANNE","type.MAX DEPTH REACHED":"PROFONDEUR MAXIMALE ATTEINTE","type.EXCEPTION":"EXCEPTION","type.MAX FILES REACHED":"MAXIMUM DE FICHIERS ATTEINT","type.TASK PRE-EMPTED":"T\xc2CHE PR\xc9EMPT\xc9E","type.MAX RETRY REACHED":"MAXIMUM D\'ESSAIS ATTEINT","type.UNKNOWN":"INCONNUE"}')},363:function(e){e.exports=JSON.parse('{"add":"Ajouter un service","add.acceptText":"Ajouter","add.cancelText":"Annuler","add.paste":"Collez votre manifeste de service ici","add.success":"Le service a \xe9t\xe9 ajout\xe9 avec succ\xe8s au syst\xe8me.","add.title":"Ajouter un service","container":"Configuration du conteneur","container.card.command":"Commande ex\xe9cut\xe9e","container.card.cpu":"C\u0153urs de processeur allou\xe9s","container.card.creds":"Utilisation d\'identification priv\xe9es pour ce registre","container.card.env":"Variables d\'environnement","container.card.internet":"Acc\xe8s Internet","container.card.no":"non","container.card.ram":"Quantit\xe9 maximale de m\xe9moire allou\xe9e","container.card.volumes":"Volumes persistants","container.card.yes":"oui","container.channel":"Canal de mise \xe0 jour du service","container.channel.beta":"B\xeata","container.channel.dev":"D\xe9veloppement","container.channel.rc":"Version candidate","container.channel.stable":"Stable","container.image":"Image du conteneur","container.dependencies":"D\xe9pendances du conteneur","container.dependencies.add":"Ajouter une d\xe9pendance","container.dependencies.none":"Ce service n\'a pas de d\xe9pendances","container.dependencies.remove":"Supprimer la d\xe9pendance","container.dialog.acceptText":"Sauvegarder","container.dialog.allow_internet":"Autoriser l\'acc\xe8s ext\xe9rieur","container.dialog.allow_internet.yes":"Oui - Autoris\xe9 \xe0 acc\xe9der aux ressources en dehors du cluster Assemblyline","container.dialog.allow_internet.no":"Non - Confin\xe9 au conteneur","container.dialog.cancelText":"Annuler","container.dialog.command":"Commande ex\xe9cut\xe9e dans le conteneur","container.dialog.cpu":"C\u0153urs de processeur autoris\xe9s","container.dialog.environment":"Variables d\'environnement","container.dialog.environment.name":"Nom de variable","container.dialog.environment.value":"Valeur de la variable","container.dialog.image":"Nom de l\'image du conteneur","container.dialog.name":"Nom de la d\xe9pendance","container.dialog.ram":"Plage de m\xe9moire autoris\xe9e","container.dialog.registry_password":"Mot de passe du registre du conteneur","container.dialog.registry_username":"Nom d\'utilisateur du registre de conteneurs","container.dialog.title.dependency":"Modifier la d\xe9pendance","container.dialog.title.container":"Modifier le conteneur","container.dialog.volumes":"Volumes persistants","container.dialog.volumes.name":"Nom du volume","container.dialog.volumes.mount_path":"R\xe9pertoire de montage","container.dialog.volumes.capacity":"Capacit\xe9","container.dialog.volumes.storage_class":"Classe de stockage","count":"services charg\xe9s dans le syst\xe8me","delete.acceptText":"Supprim\xe9","delete.cancelText":"Annuler","delete.success":"Le service a \xe9t\xe9 supprim\xe9 du syst\xe8me avec succ\xe8s.","delete.text":"Voulez-vous vraiment supprimer ce service du syst\xe8me? Cela ne peut pas \xeatre annul\xe9, mais vous pouvez toujours le r\xe9-ajouter par la suite.","delete.title":"Supprimer le service","disabled":"D\xe9sactiv\xe9","enabled":"Activ\xe9","general.accept":"Types de fichiers accept\xe9s","general.caching":"Mise en cache des r\xe9sultats","general.caching.disabled":"D\xe9sactiv\xe9e","general.caching.enabled":"Activ\xe9","general.category":"Cat\xe9gorie de service","general.classification":"Classification par d\xe9faut des r\xe9sultats ","general.description":"Description","general.licence":"Nombre maximum d\'instances","general.location":"Emplacement du service","general.location.external":"Externe - En dehors de l\'infrastructure d\'Assemblyline","general.location.internal":"Interne - \xc0 l\'int\xe9rieur de l\'infrastructure d\'Assemblyline","general.name":"Nom du service","general.reject":"Types de fichier rejet\xe9","general.stage":"\xc9tape d\'ex\xe9cution","general.timeout":"D\xe9lai maximum d\'ex\xe9cution","general.version":"Version","params.comma":"virgule","params.config":"Variables de service","params.config.current":"Variables de service actuelles","params.config.new":"Ajouter une nouvelle variable de service","params.config.none":"Il n\'y a pas de variables de service pour le moment","params.false":"Faux","params.true":"Vrai","params.user":"Param\xe8tres sp\xe9cifi\xe9s par l\'utilisateur","params.user.add":"Ajouter le param\xe8tre utilisateur","params.user.current":"Param\xe8tres actuels","params.user.new":"Ajouter un nouveau param\xe8tre","params.user.none":"Il n\'y a aucun param\xe8tre sp\xe9cifi\xe9 par l\'utilisateur pour le moment","params.user.remove":"Supprimer le param\xe8tre utilisateur","remove":"Supprimer le service","save":"Sauvegarder les modifications","save.success":"Les modifications apport\xe9es au service ont \xe9t\xe9 correctement enregistr\xe9es dans le syst\xe8me.","tab.docker":"Conteneur","tab.general":"G\xe9n\xe9ral","tab.params":"Param\xe8tres","tab.updater":"Mise \xe0 jour","title":"Gestion des services","title.detail":"D\xe9tail du service","updater":"Configuration de la mise \xe0 jour","updater.dialog.acceptText":"Sauvegarder","updater.dialog.ca":"Autorit\xe9 de certification","updater.dialog.cancelText":"Annuler","updater.dialog.classification":"Classification de signature par d\xe9faut","updater.dialog.headers":"En-t\xeates","updater.dialog.headers.name":"Nom de l\'en-t\xeate","updater.dialog.headers.value":"Valeur d\'en-t\xeate","updater.dialog.ignore_ssl":"Ignorer les erreurs de certificats SSL","updater.dialog.name":"Nom de la source (obligatoire)","updater.dialog.password":"Mot de passe","updater.dialog.pattern":"Mod\xe8le Regex","updater.dialog.private_key":"Cl\xe9 priv\xe9e","updater.dialog.proxy":"Serveur proxy","updater.dialog.proxy.placeholder":"sch\xe9ma://utilisateur:pass@proxy:port","updater.dialog.title":"Modification de la source","updater.dialog.username":"Nom d\'utilisateur","updater.dialog.uri":"URI (obligatoire)","updater.method":"M\xe9thode de mise \xe0 jour","updater.method.run":"Ex\xe9cuter un conteneur","updater.method.build":"Reconstruire un conteneur","updater.interval":"Intervalle de mise \xe0 jour (secondes)","updater.run.options":"Conteneur de mise \xe0 jour ex\xe9cut\xe9","updater.signatures":"G\xe9n\xe8re des signatures","updater.signatures.yes":"Oui","updater.signatures.no":"Non","updater.sources":"Sources des mises \xe0 jour","updater.sources.add":"Ajouter une source","updater.sources.none":"Aucune source de mise \xe0 jour n\'est sp\xe9cifi\xe9e pour le moment","updater.sources.remove":"Supprimer la source","updater.wait":"Attendre une mise \xe0 jour valide avant de d\xe9marrer le service","updater.wait.yes":"Oui","updater.wait.no":"Non"}')},364:function(e){e.exports=JSON.parse('{"E":"\xc9largie","R":"Lecture","W":"\xc9criture","admin":"A","admin_label":"Administrateur","caption":"chemins disponibles","header.function":"Fonction","header.methods":"M\xe9thodes","header.permissions":"Autorisations","header.protected":"Prot\xe9g\xe9","header.url":"URL","signature_importer":"I","signature_importer_label":"Importateur de signatures","signature_manager":"M","signature_manager_label":"Gestionnaire de signatures","title":"Plan du site","user":"U","user_label":"Utilisateur"}')},365:function(e){e.exports=JSON.parse('{"add_user":"Ajouter un utilisateur","admins":"Afficher les administrateurs","disabled":"Afficher les comptes d\xe9sactiv\xe9s","filter":"Filtrer les utilisateurs ...","filtered":"utilisateur correspondant au filtre","filtereds":"utilisateurs correspondants au filtre","header.active":"Actif","header.admin":"Admin","header.classification":"Classification","header.fullname":"Nom Complet","header.groups":"Groupes","header.uid":"Nom d\'utilisateur","newuser.api_quota":"Quota d\'API","newuser.email":"Email","newuser.groups":"Groupes","newuser.name":"Nom complet","newuser.new_pass":"Mot de passe","newuser.roles":"R\xf4les","newuser.save":"Ajouter","newuser.submission_quota":"Quota de soumission","newuser.success":"Le nouvel utilisateur a \xe9t\xe9 ajout\xe9 avec succ\xe8s.","newuser.title":"Ajout d\'un utilisateur","newuser.uname":"Nom d\'utilisateur","no_results_desc":"La requ\xeate que vous avez ex\xe9cut\xe9e n\'a renvoy\xe9 aucun r\xe9sultat.","no_users_title":"Aucun utilisateur trouv\xe9!","role.admin":"Administrateur","role.normal_user":"Utilisateur normal","role.signature_importer":"Importateur de signatures","role.signature_manager":"Gestionnaire de signatures","searching":"Recherche en cours...","subtitle":"nombre total d\'utilisateur(s)","title":"Utilisateurs","total":"utilisateur","totals":"utilisateurs"}')},366:function(e){e.exports=JSON.parse('{"actions.cancel":"Annuler","actions.ok":"Ok","actions.takeownershipdiag.content":"Voulez-vous devenir propri\xe9taire de {0} alerte(s) li\xe9e \xe0 ce {1}","actions.takeownershipdiag.content.grouped":"Voulez-vous devenir propri\xe9taire de tout les alertes avec les propri\xe9t\xe9s suivantes?","actions.takeownershipdiag.content.single":"Voulez-vous devenir propri\xe9taire de cette alerte?","actions.takeownershipdiag.header":"Prendre possession","alert_id":"ID de l\'alerte","alerted_date":"Alert\xe9","alerts":"Alertes","attack":"Att&ck","attack_category":"Cat\xe9gories","attack_pattern":"Mod\xe8les","attributions":"Attribution","avhits":"D\xe9tection antivirus","behaviors":"Comportements","btn.ownership":"Prendre possession","btn.sha256":"Recherche SHA256","btn.submission":"Soumission","btn.workflow":"Flux de travail","category":"Cat\xe9gories","data_filtered_msg":"Donn\xe9es d\'alerte filtr\xe9es car l\'utilisateur n\'a pas les privil\xe8ges pour voir tous les r\xe9sultats","dates":"Dates","detail.title":"D\xe9tail d\'une alerte","domain":"Domaines","domain_dynamic":"Dynamique","domain_static":"Statique","extended":"Analyse \xc9tendue","favorites":"Favoris","file_info":"Info du fichier","file_type":"Type","filters":"Filtre","filters.apply":"Appliquer la s\xe9lection de filtre actuelle","filters.clear":"Effacer tous les filtres","focus":"Voir tous les alertes du groupe","groupBy":"Group\xe9 par","groupBy.md5":"MD5","groupBy.name":"Nom de fichier","groupBy.none":"Aucun regroupement","groupBy.priority":"Priorit\xe9","groupBy.sha256":"SHA256","groupBy.status":"Statut","group_count":"Nombre d\'alertes","heuristic":"Heuristiques","hint_owned_by":"Un autre utilisateur poss\xe8de une alerte dans ce groupe","hint_owner":"Il y a des propri\xe9taires pour les alertes pr\xe9c\xe9dentes dans le groupe","ip":"IPs","ip_dynamic":"Dynamique","ip_static":"Statique","label":"\xc9tiquettes","labels":"\xc9tiquettes","metadata":"M\xe9tadonn\xe9es","no_alerts_desc":"La requ\xeate actuelle en combinaison avec les filtres s\xe9lectionn\xe9s ne correspond \xe0 aucune alerte.","no_alerts_title":"Aucune alerte trouv\xe9e","others":"Autres filtres","owned_by":"Alerte appartenant \xe0:","ownership":"Propri\xe9taire","patterns":"Mod\xe8les","priority":"Priorit\xe9","priority_CRITICAL":"CRITIQUE","priority_HIGH":"HAUTE","priority_LOW":"BASSE","priority_MEDIUM":"MOYENNE","priority_unset":"AUCUNE","query":"Requ\xeate","received_date":"Recu","result":"alerte","results":"alertes","score":"Verdict du syst\xe8me","status":"Statut","status_ASSESS":"\xc9VALUER","status_MALICIOUS":"MALVEILLANT","status_NON-MALICIOUS":"NON-MALVEILLANT","status_TRIAGE":"TRIER","submission":"Aller \xe0 la soumission associ\xe9e","take_ownership":"Prendre possession","take_ownership.success":"Vous etes maintenant le propri\xe9taire de l\'alerte!","tc":"Contrainte de temps","tc.1month":"1 Mois","tc.1week":"1 Semaine","tc.24h":"24 heures","tc.4d":"4 Jours","tc.none":"Aucune contrainte de temps (peut \xeatre lent)","tooltip.actions":"Action d\'alerte","type":"Type","user_verdict":"Verdict des utilisateurs","verdict.failed":"Le syst\xe8me n\'a pas \xe9t\xe9 en mesure de rendre le verdict.","verdict.malicious":"Malveillant","verdict.malicious.action":"D\xe9finir le verdict d\'alerte \xe0 malveillant","verdict.malicious.set":"Vous avez d\xe9j\xe0 rendu le verdict malveillant","verdict.malicious.success":"Le verdict d\'alerte a bien \xe9t\xe9 d\xe9fini \xe0 malveillant.","verdict.non_malicious":"Non-malveillant","verdict.non_malicious.action":"D\xe9finir le verdict d\'alerte \xe0 non-malveillant","verdict.non_malicious.set":"Vous avez d\xe9j\xe0 rendu le verdict non-malveillant","verdict.non_malicious.success":"Le verdict d\'alerte a bien \xe9t\xe9 d\xe9fini \xe0 non-malveillant.","verdict.success.malicious":"Le verdict malveillant a \xe9t\xe9 appliqu\xe9 avec succ\xe8s \xe0 l\'alerte.","verdict.success.non_malicious":"Le verdict non malveillant a \xe9t\xe9 appliqu\xe9 avec succ\xe8s \xe0 l\'alerte.","verdict.user.malicious":"utilisateurs pensent que cette alerte est malveillante","verdict.user.non_malicious":"utilisateurs pensent que cette alerte est non-malveillante","workflow.apply":"Appliquer les actions du flu de travail","workflow.impact.high":"L\'action de flu de travail sera appliqu\xe9e \xe0 toutes les alertes correspondant aux filtres suivants:","workflow.impact.low":"L\'action de flu de travail affectera uniquement l\'alerte actuellement s\xe9lectionn\xe9e qui correspond aux filtres suivants:","workflow.title":"Effectuer une action de flu de travail","workflow_action":"Effectuer une action de flu de travail","workflows":"Actions de flu de travail","yara":"R\xe8gles Yara d\xe9clench\xe9es"}')},367:function(e){e.exports=JSON.parse('{"access":"demande l\'acc\xe8s \xe0 votre compte.","button.back":"Retourner","button.allow":"Permettre","button.cancel":"Annuler","scope":"Cela permettra \xe0 l\'application de:","invalid":"Des param\xe8tres non valides ont \xe9t\xe9 fournis pour l\'enregistrement de l\'application. Nous ne pourrons pas continuer.","scope.r":"Lire toutes les donn\xe9es de Assemblyline en votre nom","scope.rw":"Lire et \xe9crire toutes les donn\xe9es depuis et vers Assemblyline en votre nom","scope.w":"Ecrire des donn\xe9es \xe0 Assemblyline en votre nom","warning":"Assurez-vous de faire confiance \xe0 cette application avant de continuer. Vous pouvez r\xe9voquer \xe0 tout moment l\'acc\xe8s \xe0 cette application \xe0 partir de votre profil utilisateur."}')},368:function(e){e.exports=JSON.parse('{"alerter":"M\xe9triques d\'alertes","alerter.error":"Le g\xe9n\xe9rateur d\'alertes produit des erreurs","archived":"Archiv\xe9:","archived.alert":"Alertes archiv\xe9es","archived.error":"Erreurs archiv\xe9es","archived.file":"Fichiers archiv\xe9s","archived.result":"R\xe9sultats archiv\xe9s","archived.submission":"Soumission archiv\xe9e","busyness":"Occupation:","caching":"Mise en cache:","caching.hits":"Succ\xe8s de la cache d\'ingestion","caching.miss":"Rat\xe9es de la cache d\'ingestion","cores":"c\u0153ur","cpu":"Processeur","dispatcher":"M\xe9triques d\'exp\xe9dition","dispatcher.error.busy":"Les processus du r\xe9partiteur deviennent trop occup\xe9s","dispatcher.error.inflight":"Le nombre de soumissions en cours de traitement devient trop \xe9lev\xe9","dispatcher.error.queue.files":"La file d\'attente des fichiers en cours d\'analyse est trop pleine","dispatcher.error.queue.start":"La file d\'attente des messages de d\xe9but de soumission est trop pleine","dispatcher.error.queue.command":"La file d\'attente de traitement des commandes est trop pleine","dispatcher.error.queue.result":"La file d\'attente d\'agr\xe9gation des r\xe9sultats est trop pleine","dispatcher.error.queue.ingest":"La file d\'attente des messages du r\xe9partiteur est trop pleine","expired":"Expir\xe9:","expired.alert":"Alertes expir\xe9es","expired.error":"Erreurs expir\xe9es","expired.file":"Fichiers expir\xe9s","expired.result":"R\xe9sultats expir\xe9s","expired.submission":"Soumission expir\xe9e","expiry":"M\xe9triques d\'expiration","gb":"GiO","ingest":"Ingestion:","ingest.critical":"Soumissions de priorit\xe9 critique","ingest.error.busy":"Les processus d\'ingestion deviennent trop occup\xe9s","ingest.error.bytes":"Les soumissions sont en cours d\'ingestion, mais aucune ne se termine","ingest.error.chance.critical":"La file d\'attente critique est trop pleine et en cours d\'\xe9chantillonnage","ingest.error.chance.high":"La file d\'attente haute est trop pleine et en cours d\'\xe9chantillonnage","ingest.error.chance.low":"La file d\'attente basse est trop pleine et en cours d\'\xe9chantillonnage","ingest.error.chance.medium":"La file d\'attente moyenne est trop pleine et en cours d\'\xe9chantillonnage","ingest.error.queue":"La file d\'attente d\'ingestion est trop pleine","ingest.high":"Soumissions de haute priorit\xe9","ingest.low":"Soumissions de faible priorit\xe9","ingest.medium":"Soumissions de priorit\xe9 moyenne","ingest.queue":"Soumissions en file d\'attente pour ingestion","ingester":"M\xe9triques d\'ingestion","no_services":"Il n\'y a pas de service en ligne","processing":"En traitement:","processing.inflight":"Soumissions en cours d\'analyse","queued":"En file d\'attente:","queues":"Files d\'attente:","queues.alert":"Alertes","queues.error":"Erreurs","queues.file":"Fichiers","queues.ingest":"Ingestion","queues.result":"R\xe9sultats","queues.command":"Commandes","queues.start":"D\xe9but de soumissions","queues.submission":"Soumissions","ram":"M\xe9moire","resources":"Ressources syst\xe8me","service.busy":"Nombre d\'instances de service occup\xe9es","service.error.fail_nonrecoverable":"Il y a des \xe9checs non r\xe9cup\xe9rables pour ce service","service.error.none":"Il n\'y a aucune instance de ce service","service.error.queue":"La file d\'attente pour ce service devient tr\xe8s \xe9lev\xe9e","service.failed":"Fichiers \xe9chou\xe9s au cours de la derni\xe8re minute","service.retried":"Fichiers r\xe9essay\xe9s au cours de la derni\xe8re minute","service.processed":"Fichiers trait\xe9s dans la derni\xe8re minute","service.queue":"Nombre de fichiers dans la file d\'attente de service","services":"Services en ligne:","submissions":"Soumissions:","submissions.outstanding":"Soumissions manquantes","throughput":"D\xe9bit: (pour la derni\xe8re minute)","throughput.busy":"Pourcentage d\'occupation","throughput.bytes":"Octets trait\xe9s / Octets ing\xe9r\xe9s","throughput.created":"Cr\xe9\xe9","throughput.duplicates":"Soumissions en double","throughput.error":"Erreurs","throughput.files_completed":"Fichiers analys\xe9s","throughput.received":"Re\xe7us","throughput.skipped":"Soumissions ignor\xe9es","throughput.submissions_completed":"Soumissions analys\xe9s","throughput.updated":"Mise \xe0 jour","throughput.whitelisted":"Soumissions sur liste blanche","timeout":"Nous ne recevons aucun messages pour cette composante","title":"Tableau de bord"}')},369:function(e){e.exports=JSON.parse('{"addfavorites":"G\xe9rer les favoris","cancel":"Annuler","confirmdiag.content":"Voulez-vous vraiment supprimer le favori suivant?","confirmdiag.header":"Supprimer un favori","form.field.required":"Les valeurs Requ\xeate et Nom sont obligatoires.","globalfavorites":"Favoris publics","name":"Nom (requis)","ok":"Oui, Supprimez le!","private":"Priv\xe9","public":"Public","query":"Requete (requise)","save":"Ajouter aux favoris","yourfavorites":"Favoris personels"}')},370:function(e){e.exports=JSON.parse('{"attack_matrix":"Matrice d\'Att&ck","childrens":"Enfants possibles","download":"T\xe9l\xe9charger un fichier","emptys":"R\xe9sultats vides","entropy":"Entropie","errors":"Erreurs","extracted":"Fichiers extraits","file_viewer":"Visionneuse de fichiers","frequency":"Fr\xe9quence des fichiers","generated_tags":"Tags g\xe9n\xe9r\xe9s","heuristics":"Heuristiques","identification":"Identification du fichier","magic":"Magic","metadata":"R\xe9sum\xe9 des soumissions","mime":"MIME","nothing_to_report":"Le service n\'avait rien \xe0 signaler pour ce fichier.","parents":"Parents possibles","process_signatures":"Signature d\xe9clench\xe9e","related":"Soumissions connexes","resubmit.success":"Le fichier a \xe9t\xe9 soumis \xe0 nouveau pour une analyse dynamique. Vous serez redirig\xe9 ...","resubmit_dynamic":"Soumettre \xe0 nouveau pour l\'analyse dynamique","results":"R\xe9sultats du service","seen.count":"Nombre de fois","seen.first":"Vu la premi\xe8re fois","seen.last":"Vu la derni\xe8re fois","size":"Taille","supplementary":"Fichiers suppl\xe9mentaires","title":"D\xe9tails du fichier","type":"Type","verdict.info":"Informatif","verdict.malicious":"Malveillant","verdict.suspicious":"Suspect","view_file":"Visionner le fichier"}')},371:function(e){e.exports=JSON.parse('{"detail":"D\xe9tails de l\'analyse du fichier","download":"T\xe9l\xe9charger le fichier","related":"Soumissions connexes","title":"Visualisateur de Fichiers"}')},372:function(e){e.exports=JSON.parse('{"complete":"Enti\xe8rement document\xe9","description":"Description","function":"Fonction interne","methods":"M\xe9thodes autoris\xe9es","path":"Chemin d\'API","priv.E":"\xc9tendu","priv.R":"Lecture","priv.W":"\xc9criture","protected":"N\xe9cessite une authentification","require_type":"Types d\'utilisateurs requis","required_priv":"Privil\xe8ges requis","title":"Documentation de l\'API","user_type.admin":"Administrateur","user_type.signature_importer":"Importateur de signature","user_type.signature_manager":"Gestionaire de signature","user_type.user":"Utilisateur","version":"Version ","version_end":" de l\'API Assemblyline"}')},373:function(e){e.exports=JSON.parse('{"assumptions":"Supposons ce qui suit:","desc_1":"Lorsque vous soumettez un fichier \xe0 Assemblyline, vous devez fournir sa classification. Cette classification concerne la soumission elle-m\xeame et sera appliqu\xe9e \xe0 tous les fichiers enfants de la soumission ainsi qu\'aux r\xe9sultats associ\xe9s \xe0 la soumission.","desc_2":"Si vous r\xe9alisez que vous avez soumis un fichier avec la mauvaise classification, vous pouvez toujours utiliser le bouton Supprimer dans la page de d\xe9tails de la soumission pour vous en d\xe9barrasser.","desc_title":"Classification bas\xe9e sur la soumission","ex_title":"Exemple:","result_a_1":"<bold>Fichier1</bold> est class\xe9 ","result_a_2":"Les r\xe9sultats du <bold>ServiceX</bold> pour le <bold>Fichier1</bold> sont ","result_a_3":"<bold>Fichier2</bold> est class\xe9 ","result_a_4":"Les r\xe9sultats du <bold>ServiceY</bold> pour le <bold>Fichier2</bold> sont ","result_a_res_1_p1":"Les r\xe9sultats du <bold>ServiceX</bold> pour le <bold>Fichier1</bold> vont \xeatre class\xe9s ","result_a_res_1_p2":" parce que le fichier est class\xe9 plus haut que les r\xe9sultats du service. Aux yeux d\'un utilisateur ","result_a_res_1_p3":" , ils n\'existeront pas.","result_a_res_2_p1":"Les r\xe9sultats du <bold>ServiceY</bold> pour le <bold>Fichier2</bold> resteront class\xe9s ","result_a_res_2_p2":" car la classification des r\xe9sultats est sup\xe9rieure \xe0 la classification du fichier lui-m\xeame.","result_desc":"Les diff\xe9rents services Assemblyline produiront leurs r\xe9sultats \xe0 diff\xe9rents niveaux de classification en fonction de la technique / de l\'outil utilis\xe9 pour fournir le r\xe9sultat. Pour emp\xeacher le moteur de recherche d\'afficher les r\xe9sultats des fichiers classifi\xe9s aux utilisateurs non class\xe9s, le syst\xe8me appliquera la classification maximale entre la classification des fichiers et la classification des r\xe9sultats du service aux r\xe9sultats du fichier.","result_title":"Les r\xe9sultats des services ont \xe9galement une classification!","title":"Aide \xe0 la Classification","submission_a_1":"<bold>Soumission1</bold> est class\xe9e ","submission_a_2":"<bold>Soumission2</bold> est class\xe9e ","submission_a_3":"<bold>Fichier1</bold> est dans les deux soumissions.","submission_a_res_1_p1":"La classification de <bold>Fichier1</bold> sera ","submission_a_res_1_p2":" qui est la classification la plus basse entre les deux fichiers. <bold>Soumission1</bold> et <bold>Soumission2</bold> conserveront leur classification d\'origine.","submission_a_res_2_p1":"<bold><italic>Si l\'une des soumissions est supprim\xe9e</italic></bold>, disons <bold>Soumission2</bold>, le syst\xe8me recalculera la classification de tous les fichiers li\xe9s \xe0 la soumission supprim\xe9e. La classification de <bold>File1</bold> sera d\xe9sormais ","submission_a_res_2_p2":". <bold>Soumission1</bold> conservera sa classification d\'origine.","submission_desc":"Si deux soumissions contiennent le m\xeame fichier mais que ces soumissions ont des classifications diff\xe9rentes, le syst\xe8me attribuera la classification la plus basse des deux soumissions au dossier.","submission_title":"Un fichier, plusieurs soumissions","validation_groups":"Diffusion des groupes","validation_groups_desc":"Pour afficher une information prot\xe9g\xe9e par une diffusion de groupe, l\'utilisateur <bold>doit avoir au moins un</bold> des groupes que poss\xe8de la soumission / le fichier / le r\xe9sultat que l\'utilisateur tente de visualiser.","validation_groups_none":"Aucun groupe n\'est configur\xe9 dans ce syst\xe8me.","validation_groups_note":"** <bold>REMARQUE</bold>: ne pas fournir de groupe le rend disponible \xe0 tous les groupes.","validation_groups_supported":"Groupes actuellement pris en charge:","validation_level":"Niveau de classification","validation_level_desc":"Le niveau de classification est valid\xe9 en utilisant la function <bold>sup\xe9rieur ou \xe9gal</bold>. La classification de l\'utilisateur doit \xeatre sup\xe9rieure ou \xe9gale \xe0 la soumission / fichier / r\xe9sultat qu\'il tente d\'afficher / de rechercher.","validation_level_supported":"Niveaux de classification actuellement pris en charge:","validation_required":"Jetons requis","validation_required_desc":"Pour afficher une information prot\xe9g\xe9e avec les jetons requis, l\'utilisateur <bold>doit avoir tous</bold> les jetons que poss\xe8de la soumission / le fichier / le r\xe9sultat que l\'utilisateur tente de visualiser.","validation_required_none":"Aucun jeton requis n\'est configur\xe9 dans ce syst\xe8me.","validation_required_supported":"Jetons requis actuellement pris en charge:","validation_subgroups":"Diffusion des sous-groupes","validation_subgroups_desc":"Pour afficher une information prot\xe9g\xe9e par une diffusion de sous-groupes, l\'utilisateur <bold>doit avoir au moins un</bold> des sous-groupes que poss\xe8de la soumission / le fichier / le r\xe9sultat que l\'utilisateur tente de visualiser.","validation_subgroups_none":"Aucun sous-groupe n\'est configur\xe9 dans ce syst\xe8me.","validation_subgroups_note":"** <bold>REMARQUE</bold>: ne pas fournir de sous-groupe le rend disponible \xe0 tous les sous-groupes.","validation_subgroups_supported":"Sous-groupes actuellement pris en charge:","validation_title":"Comment la classification est-elle valid\xe9e?"}')},374:function(e){e.exports=JSON.parse('{"config":"Variables de configuration","config.desc":"Chaque instance d\'assemblyline a une configuration unique. Certains param\xe8tres de configuration sont particuli\xe8rement utiles pour comprendre le fonctionnement du syst\xe8me:","file_types":"Types de fichier","file_types.desc":"Assemblyline attribue un type \xe0 tous les fichiers en analysant la structure du fichier et utilise ce type pour acheminer le fichier vers le service appropri\xe9.","file_types.non_specific":"D\'autres types de fichiers sont identifi\xe9s mais ne sont pas achemin\xe9s vers des services sp\xe9cifiques:","file_types.non_specific_service":"Les services suivants traitent tous les types de fichiers:","file_types.specific":"Certains types de fichiers seront achemin\xe9s vers des services sp\xe9cifiques:","priorities":"Priorit\xe9s","priorities.desc":"Chaque soumission dans Assemblyline se voit attribuer une priorit\xe9. Les soumissions sont trait\xe9es par ordre d\xe9croissant de priorit\xe9, les soumissions de priorit\xe9 plus \xe9lev\xe9e \xe9tant trait\xe9es en premier. Si deux soumissions ont la m\xeame priorit\xe9, elles sont ex\xe9cut\xe9es dans l\'ordre o\xf9 elles ont \xe9t\xe9 re\xe7ues. Le champ de priorit\xe9 est un nombre qui permet un contr\xf4le tr\xe8s fin sur les priorit\xe9s.","priorities.desc_list":"Pour plus de commodit\xe9, nous avons d\xe9fini un certain nombre de priorit\xe9s, celles-ci sont \xe9num\xe9r\xe9es ci-dessous:","priorities.max":"maximum","tags":"Balises","tags.desc":"Assemblyline extrait des identifiants potentiellement int\xe9ressants et leur attribue un type. Assemblyline appelle ceux-ci des balises.","tags.desc_list":"Voici les diff\xe9rents types de balises que vous pouvez trouver dans tout le syst\xe8me:","title":"Configuration courante"}')},375:function(e){e.exports=JSON.parse('{"title":"Aide \xe0 la Recherche"}')},376:function(e){e.exports=JSON.parse('{"accepts":"Accepte","category":"Cat\xe9gorie","count":"services charg\xe9s dans le syst\xe8me","disabled":"D\xe9sactiv\xe9","rejects":"Rejette","stage":"Stage","title":"Liste des Services"}')},377:function(e){e.exports=JSON.parse('{"auto_notify":"Les administrateurs syst\xe8me ont \xe9t\xe9 inform\xe9s. Vous recevrez un e-mail une fois que votre compte sera actif.","contact_admin":"Contactez les administrateurs du syst\xe8me pour qu\'il puissent activer votre compte.","title":"En attente d\'approbation..."}')},378:function(e){e.exports=JSON.parse('{"button":"Se connecter","button_oauth":"Se connecter avec","other":"Ou connectez-vous avec un utilisateur diff\xe9rent...","otp":"Mot de passe \xe0 usage unique","password":"Mot de passe","reset.button":"R\xe9initialiser le mot de passe","reset.desc":"Oublier votre mot de passe?","reset.done":"Un courriel a \xe9t\xe9 envoy\xe9 \xe0 votre adresse avec des instructions sur la r\xe9initialisation de votre mot de passe.","reset.email":"Entrez votre adresse courriel","reset.link":"R\xe9initialisez le!","reset_now.button":"R\xe9initialiser","reset_now.done":"Mot de passe r\xe9initialis\xe9!","reset_now.password":"Nouveau mot de passe","reset_now.password_confirm":"Confirmer le nouveau mot de passe","reset_now.redirect":"Vous serez redirig\xe9 vers l\'\xe9cran de connexion dans quelques secondes ...","securitytoken":"Veuillez toucher le jeton de s\xe9curit\xe9 clignotant","securitytoken.error":"Le jeton de s\xe9curit\xe9 n\'est pas valide ou l\'op\xe9ration a \xe9t\xe9 annul\xe9e. Essayez plut\xf4t avec un mot de passe unique...","securitytoken.unavailable":"Impossible d\'utiliser le jeton de s\xe9curit\xe9 sur ce serveur. Utilisez plut\xf4t un mot de passe unique...","signup":"Vous n\'avez pas de compte?","signup.button":"Cr\xe9\xe9 mon compte","signup.completed":"L\'enregistrement d\'un nouveau compte est maintenant termin\xe9, vous pouvez maintenant vous connecter avec votre compte","signup.done":"Un courriel a \xe9t\xe9 envoy\xe9 \xe0 votre adresse avec les instructions finales pour cr\xe9er un nouveau compte.","signup.email":"Addresse courriel","signup.link":"Abonnez-vous!","signup.password":"Mot de passe","signup.password_confirm":"Confirmation du mot de passe","signup.username":"Nom d\'utilisateur","username":"Nom d\'utilisateur"}')},379:function(e){e.exports=JSON.parse('{"title":"D\xe9connexion de l\'utilisateur actuel ... "}')},380:function(e){e.exports=JSON.parse('{"filter":"Filtrer les heuristiques ...","filtered":"heuristique correspondant au filtre","filtereds":"heuristiques correspondant au filtre","searching":"Recherche en cours...","title":"Heuristiques","total":"heuristique","totals":"heuristiques"}')},381:function(e){e.exports=JSON.parse('{"attack_id":"IDs Att&ck associ\xe9s","chart.title":"Nombre de fois utilis\xe9 dans les derniers 30 jours","contribution":"Contribution au score","desc":"Description","filetype":"Type de fichier associ\xe9","hit.count":"Nombre:","hit.first":"Premi\xe8re fois:","hit.last":"Derni\xe8re fois:","hit.none":"Jamais","hits":"Utilisation","last10":"Derni\xe8re 10 utilisations","max_score":"Score maximum autoris\xe9","name":"Nom","no_attack_id":"Aucun","no_max":"Aucun score maximum impos\xe9","no_sigs":"Aucun remplacement de score de signature","score":"Score","score.avg":"Moyen","score.max":"Maximum","score.min":"Minimum","section_stat_contrib":"Statistiques sur les contributions aux sections","signature_score_map":"Score des diff\xe9rentes signatures","statistics":"Statistiques","title":"D\xe9tails de l\'heuristique","usage":"Afficher l\'utilisation de l\'heuristique"}')},382:function(e){e.exports=JSON.parse('{"disabled":"Afficher les signatures d\xe9sactiv\xe9es","download_desc":"T\xe9l\xe9charger la liste de signatures actuelle","filter":"Filtrer les signatures ...","filtered":"signature correspondant au filtre","filtereds":"signatures correspondant au filtre","noisy":"Afficher les signatures bruyantes","searching":"Recherche en cours...","title":"Signatures","total":"signature","totals":"signatures"}')},383:function(e){e.exports=JSON.parse('{"change.close":"Annuler","change.save":"Enregistrer les modifications","change.success":"L\'\xe9tat de la signature a \xe9t\xe9 modifi\xe9 avec succ\xe8s","change.title":"Changer le statut d\'une signature","change.warning":"Avant de modifier l\'\xe9tat de la signature, tenez compte des points suivants:","change.warning.1":"Une fois qu\'une signature a \xe9t\xe9 D\xc9PLOY\xc9E, marqu\xe9e BRUYANTE ou D\xc9SACTIV\xc9E, elle ne peut pas revenir \xe0 l\'\xe9tat d\'ESSAI ou de MIS EN SC\xc8NE.","change.warning.2":"Une seule r\xe9vision d\'une signature peut \xeatre ex\xe9cut\xe9e en m\xeame temps dans le syst\xe8me.","change.warning.action":"Choisissez le nouvel \xe9tat de signature:","chart.title":"Nombre de fois utilis\xe9 dans les derniers 30 jours","contribution":"Contribution au score","delete.acceptText":"Oui, supprimer la!","delete.cancelText":"Annuler","delete.success":"La signature a \xe9t\xe9 supprimer avec succ\xe8s.","delete.text":"Voulez-vous vraiment supprimer la signature actuelle? Il n\'y aura aucun moyen de le r\xe9cup\xe9rer une fois que c\'est fait.","delete.title":"Supprimer la signature","hit.count":"Nombre:","hit.first":"Premi\xe8re fois:","hit.last":"Derni\xe8re fois:","hit.none":"Jamais","hits":"Utilisation","last10":"Derni\xe8re 10 utilisations","remove":"Supprimer la signature","score.avg":"Moyen","score.max":"Maximum","score.min":"Minimum","statistics":"Statistiques","status.DEPLOYED":"D\xe9ploy\xe9e","status.DISABLED":"D\xe9sactiv\xe9e","status.NOISY":"Bruyante","title":"D\xe9tails de la signature","usage":"Afficher l\'utilisation de la signature"}')},384:function(e){e.exports=JSON.parse('{"add.save":"Ajouter la source de signature","add.success":"La source de signature a \xe9t\xe9 ajout\xe9e avec succ\xe8s.","add_source":"Ajouter une source de signature pour ce service","adding_source":"Ajouter une source de signature","ca":"Autorit\xe9 de certificat (CA)","ca_used":"Une autorit\xe9 de certificat (CA) sera utilis\xe9e pour se connecter \xe0 la source","caption":"Services autoris\xe9s \xe0 g\xe9n\xe9rer des signatures","change.save":"Sauvegarder les modifications","change.success":"La source de signature a \xe9t\xe9 modifi\xe9e avec succ\xe8s.","classification":"Classification","delete":"Supprimer la source de signature actuelle","delete.acceptText":"Oui, supprimez-la!","delete.cancelText":"Annuler","delete.success":"La source de signature a \xe9t\xe9 supprim\xe9e avec succ\xe8s.","delete.text":"Voulez-vous vraiment supprimer la source de signature actuelle? Il n\'y aura aucun moyen de la r\xe9cup\xe9rer une fois que c\'est fait.","delete.title":"Supprimer la source de signature","editing_source":"Modifier une source de signature","headers":"En-t\xeates","headers.name":"Nom","headers.value":"Valeur","ignore_ssl":"Ignorer les erreurs SSL","ignore_ssl_used":"Les erreurs SSL seront ignor\xe9es lors de la connexion \xe0 cette source","name":"Nom de la source (obligatoire)","no_sources":"Il n\'y a actuellement aucune source de signature pour ce service.","password":"Mot de passe","pattern":"Mod\xe8le Regex","private_key":"Cl\xe9 priv\xe9e","private_key_used":"Une cl\xe9 priv\xe9e sera utilis\xe9e pour se connecter \xe0 la source","proxy":"Serveur Proxy","proxy.placeholder":"scheme://utilisateur:mot_de_passe@serveur:port","proxy_used":"Un serveur proxy sera utilis\xe9 pour se connecter \xe0 la source","title":"Sources de signature","uri":"URI (obligatoire)","username":"Nom d\'utilisateur"}')},385:function(e){e.exports=JSON.parse('{"filter":"Filtrer les flux de travail ...","filtered":"flu de travail correspondant au filtre","filtereds":"flux de travail correspondant au filtre","searching":"Recherche en cours...","title":"Flux de travail","total":"flu de travail","totals":"flux de travail","never_used":"Flux de travail qui n\'ont jamais \xe9t\xe9 utilis\xe9s","old":"Flux de travail non utilis\xe9s au cours des 3 derniers mois"}')},386:function(e){e.exports=JSON.parse('{"add.button":"Ajouter","add.success":"Le flu de travail a \xe9t\xe9 ajouter avec succ\xe8s.","add.title":"Ajouter un flu de travail","created_by":"Cr\xe9\xe9 par ","delete.acceptText":"Yes, remove it!","delete.cancelText":"Annuler","delete.success":"Le flu de travail a \xe9t\xe9 supprimer avec succ\xe8s.","delete.text":"Voulez-vous vraiment supprimer le flux de travail actuel?","delete.title":"Supprimer le flu de travail?","edited_by":"\xc9dit\xe9 par ","labels":"\xc9tiquettes","name":"Nom (Requis)","on":"le","priority":"Priorit\xe9","priority.CRITICAL":"CRITIQUE","priority.HIGH":"HAUTE","priority.LOW":"BASSE","priority.MEDIUM":"MOYENNE","priority.null":"","query":"Requ\xeate (Requis)","save":"Sauvegarder les modifications","save.success":"Le flux de travail a \xe9t\xe9 enregistr\xe9 avec succ\xe8s.","status":"Statut","status.ASSESS":"\xc9VALUER","status.MALICIOUS":"MALICIEUX","status.NON-MALICIOUS":"NON-MALICIEUX","status.null":"","title":"D\xe9tails du flu de travail"}')},387:function(e){e.exports=JSON.parse('{"title":"D\xe9sactivation du nouvel interface utilisateur... D\xe9sol\xe9 de vous voir partir!"}')},388:function(e){e.exports=JSON.parse('{"alert":"Alerte","available":"disponible","file":"Ficher","focus_search":"Focus sur l\'onglet s\xe9lectionn\xe9","header.accepts":"Type de fichier","header.attack_id":"IDs Att&ck","header.category":"Cat\xe9gorie","header.classification":"Classification","header.count":"Nombre","header.created":"Temps de cr\xe9ation","header.description":"Description","header.enabled":"Activ\xe9","header.filetype":"Type de fichers","header.hit_count":"Fois vue","header.id":"ID","header.last_hit":"Derni\xe8re fois","header.lasttimeseen":"Derni\xe8re fois vu","header.name":"Nom","header.numfiles":"Fichiers","header.priority":"Priorit\xe9","header.reporting_ts":"Temps d\'alerte","header.rev":"R\xe9vision","header.score":"Score","header.service":"Service","header.sha256":"SHA256","header.size":"Taille","header.source":"Source","header.stage":"Stage","header.starttime":"Heure de d\xe9but","header.status":"Status","header.type":"Type","header.user":"Utilisateur","header.verdict":"Verdict","header.version":"Version","matching_result":"r\xe9sultat correspondant","matching_results":"r\xe9sultats correspondants","never":"Jamais","no_alerts_title":"Aucune alerte trouv\xe9e!","no_files_title":"Aucun fichier trouv\xe9!","no_heuristics_title":"Aucun heuristique trouv\xe9!","no_results_desc":"La requ\xeate que vous avez ex\xe9cut\xe9e n\'a renvoy\xe9 aucun r\xe9sultat.","no_results_title":"Aucun r\xe9sultat trouv\xe9!","no_signatures_title":"Aucune signature trouv\xe9e!","no_submissions_title":"Aucune soumission trouv\xe9e!","no_workflows_title":"Aucune flu de travail trouv\xe9e!","result":"R\xe9sultat","search_alert":"Rechercher dans l\'index des alertes ...","search_all":"Rechercher tous les index ...","search_file":"Rechercher dans l\'index des fichiers ...","search_result":"Rechercher dans l\'index des r\xe9sultats ...","search_signature":"Rechercher dans l\'index des signatures ...","search_submission":"Rechercher dans l\'index des soumissions ...","signature":"Signature","submission":"Soumission","title_alert":"Recherche d\'Alertes","title_all":"Recherche","title_file":"Recherche de Fichier","title_result":"Recherche de R\xe9sultats","title_signature":"Recherche de Signatures","title_submission":"Recherche de Soumissions","update":"Mettre \xe0 jour","updating":"Mise \xe0 jour...","use_archive.turn_off":"D\xe9sactiver la recherche dans les archives","use_archive.turn_on":"Activer la recherche dans les archives"}')},389:function(e){e.exports=JSON.parse('{"interface":"Options d\'interface","interface.encoding":"Encodage de fichier","interface.encoding_cart":"Format de st\xe9rilisation des fichiers CaRT","interface.encoding_desc":"Encodage utilis\xe9 pour tous les fichiers t\xe9l\xe9charg\xe9s.","interface.encoding_raw":"Aucun encodage","interface.score":"Verdict d\'expansion automatique","interface.score_-1000000":"Afficher automatiquement toutes les sections","interface.score_0":"Non malveillant","interface.score_100":"Suspect","interface.score_100000000":"Ne jamais afficher automatiquement les sections de service","interface.score_2000":"Malveillant","interface.score_500":"Tr\xe8s suspect","interface.score_desc":"Verdict minimum requis avant qu\'une section de r\xe9sultat de service soit automatiquement affich\xe9e.","interface.view":"Vue de soumission","interface.view_desc":"Vue par d\xe9faut affich\xe9e lors de l\'ouverture des soumissions.","interface.view_details":"Vue de d\xe9tail","interface.view_report":"Vue de rapport","save":"Enregistrer les param\xe8tres","service":"S\xe9lection de service","submissions":"Options de soumission","submissions.classification":"Classification","submissions.classification_desc":"Classification par d\xe9faut utilis\xe9e pour les nouvelles soumissions.","submissions.deep_scan":"Analyse approfondie","submissions.deep_scan_desc":"Effectuez une analyse plus approfondie du fichier en activant davantage de v\xe9rifications. Plus lent et non recommand\xe9 pour l\'analyse en vrac.","submissions.dynamic_recursion":"Pr\xe9vention de la r\xe9cursivit\xe9 dynamique","submissions.dynamic_recursion_desc":"Garantit que les enfants des services d\'analyse dynamique ne sont pas renvoy\xe9s ceux-ci pour l\'analyse.","submissions.filtering":"Filtration","submissions.filtering_desc":"Autorisez les services de filtrage \xe0 ignorer les fichiers s\'ils pensent que les fichiers sont s\xfbrs.","submissions.profile":"Profilage de soumission","submissions.profile_desc":"Ajoutez des \xe9tapes de d\xe9bogage suppl\xe9mentaires \xe0 vos analyses afin qu\'elles puissent \xeatre mieux suivies dans les journaux.","submissions.result_caching":"Mise en cache des r\xe9sultats","submissions.result_caching_desc":"Mise en cache des r\xe9sultats du service permettent aux fichiers de ne pas \xeatre analys\xe9s \xe0 nouveau si le service n\'a pas chang\xe9.","submissions.ttl":"Jours \xe0 vivre","submissions.ttl_days":"jour(s)","submissions.ttl_desc":"Nombre de jours pendant lesquels vos soumissions resteront dans le syst\xe8me.","submissions.ttl_forever":"Pour toujours","success_save":"Param\xe8tres enregistr\xe9s avec succ\xe8s!"}')},390:function(e){e.exports=JSON.parse('{"avg":"Score Moy","classification":"Classification","count":"Nombre","heur_id":"ID","max":"Score Max","min":"Score Min","name":"Nom","title":"Statistiques d\'heuristiques"}')},391:function(e){e.exports=JSON.parse('{"avg":"Score Moy","classification":"Classification","count":"Nombre","max":"Score Max","min":"Score Min","name":"Nom","source":"Source","title":"Statistiques des signatures","type":"Type"}')},392:function(e){e.exports=JSON.parse('{"attack_matrix":"Matrice d\'Att&ck","attribution":"Attributions","behavior":"Comportements","delete":"Supprimer la soumission actuelle","delete.acceptText":"Oui, supprimez-la!","delete.cancelText":"Annuler","delete.success":"La soumission a bien \xe9t\xe9 supprim\xe9e. Vous serez redirig\xe9 vers la liste de soumissions ...","delete.text":"Vous \xeates sur le point de supprimer la soumission actuelle avec tous ses r\xe9sultats associ\xe9s. Cette op\xe9ration ne peut pas \xeatre annul\xe9e.","delete.title":"Supprimer la soumission?","dispatcher.not_responding":"Dispatcher ne semble pas fonctionner correctement, il n\'envoie aucun message.","download":"T\xe9l\xe9charger le bundle de soumission","errors":"Erreurs","errors.aggregated":"Les services suivants on g\xe9n\xe9r\xe9 des erreurs de {errorType}","errors.listed":" a g\xe9n\xe9r\xe9 une erreur pour le fichier suivant: ","errors.type.busy":"SERVICE OCCUP\xc9","errors.type.down":"SERVICE EN PANNE","errors.type.depth":"PROFONDEUR MAXIMALE ATTEINTE","errors.type.exception":"EXCEPTION","errors.type.files":"MAXIMUM DE FICHIERS ATTEINT","errors.type.preempted":"T\xc2CHE PR\xc9EMPT\xc9E","errors.type.retry":"MAXIMUM D\'ESSAIS ATTEINT","errors.type.unknown":"INCONNUE","heuristics":"Heuristiques","information":"Informations de soumission","ioc":"Indicateurs de compromis","live_mode":"La soumission est toujours en cours de traitement, r\xe9ception des r\xe9sultats en direct ...","max_score":"Verdict","metadata":"M\xe9tadonn\xe9es","outstanding.error":"Nous n\'avons pas pu d\xe9terminer quels services sont occup\xe9s \xe0 travailler sur votre soumission. Il peut y avoir des probl\xe8mes avec le syst\xe8me ...","outstanding.files":"Fichiers restants","outstanding.services":"Services","outstanding.title":"Vous attendez la fin du traitement des services suivants:","params.deep_scan":"Analyse approfondie","params.description":"Description","params.groups":"Groupes","params.ignore_cache":"Ignorer la cache","params.ignore_dynamic_recursion_prevention":"Ignorer la pr\xe9vention de r\xe9cursivit\xe9 dynamique","params.ignore_filtering":"Ignorer le filtrage","params.services.selected":"Services s\xe9lectionn\xe9s","params.submitter":"Soumis par","report_view":"Afficher la vue du rapport","resubmit":"Soumettre \xe0 nouveau la soumission actuelle","submit.success":"Soumission soumis \xe0 nouveau avec succ\xe8s. Vous y serez redirig\xe9 ...","times.completed":"Temps termin\xe9","times.submitted":"Temps de d\xe9but","title":"D\xe9tails de la soumission","tree":"Fichiers","verdict.info":"Informatif","verdict.is.malicious":"Vous pensez que ce fichier est malveillant","verdict.is.non_malicious":"Vous pensez que ce fichier n\'est pas malveillant","verdict.malicious":"Malveillant","verdict.set.malicious":"Votez pour un verdict malveillant","verdict.set.non_malicious":"Votez pour un verdict non malveillant","verdict.suspicious":"Suspect"}')},393:function(e){e.exports=JSON.parse('{"actor":"Utilis\xe9 par","attack":"Matrice d\'Att&ck","detail_view":"Afficher la vue d\xe9taill\xe9e","error.notfound":"La soumission n\'a pas \xe9t\xe9 trouv\xe9e","error.too_early":"Il est trop t\xf4t pour g\xe9n\xe9rer le rapport car la soumission n\'est pas termin\xe9e. Vous serez rediriger vers la vue d\xe9taill\xe9e ...","family":"Famille","file.description":"Description","file.magic":"Magic","file.md5":"MD5","file.mime":"MIME","file.name":"Nom","file.sha1":"SHA1","file.sha256":"SHA256","file.size":"Taille","file.ssdeep":"SSDEEP","file.type":"Type","file.verdict":"Verdict","general":"Informations G\xe9n\xe9rales","heuristics":"Heuristiques","implant":"Implant","important_files":"Fichiers Extraits Importants","malicious":"Malveillant","metadata":"Metadata","non_malicious":"Non-Malveillant","print":"Imprimer le rapport","submission.date":"Date d\'analyse","submission.services":"Services S\xe9lectionn\xe9s","submission.services.errors":"Erreurs de Service","submission.user":"Soumis par","tag.attributions":"Attributions","tag.behaviors":"Comportements","tag.indicators_of_compromise":"Indicateurs de Danger","tag.table.files":"Fichiers Associ\xe9s","tag.table.type":"Type","tag.table.value":"Valeur","title":"Rapport de Soumission","user.verdict":"Verdict des Utilisateurs"}')},394:function(e){e.exports=JSON.parse('{"completed_submissions":"Afficher les soumissions termin\xe9es","detail":"D\xe9tail","filter":"Filtrer les soumissions...","filtered":"soumission correspondant au filtre","filtereds":"soumissions correspondant au filtre","malicious_submissions":"Afficher les soumissions malveillantes","my_submission":"Voir mes soumissions","report":"Rapport","searching":"Recherche en cours...","title":"Soumissions","total":"soumission","totals":"soumissions"}')},395:function(e){e.exports=JSON.parse('{"classification":"La classification suivante sera appliqu\xe9e \xe0 votre soumission:","file":"Fichier","file.button":"T\xe9l\xe9verser et Analyser","file.cancel":"Annuler","file.dragzone":"S\xe9lectioner un fichier \xe0 analyser","file.dragzone.byte":"octets","file.drophere":"D\xe9posez votre fichier ici!","options":"Options","options.service":"S\xe9lection de service","options.service_spec":"Param\xe8tres sp\xe9cifiques au services","options.submission":"Param\xe8tres de soumission","options.submission.deep_scan":"Effectuer une analyse approfondie","options.submission.desc":"Description","options.submission.ignore_cache":"Ignorer le cache des r\xe9sultats","options.submission.ignore_dynamic_recursion_prevention":"Ignorer la pr\xe9vention de la r\xe9cursivit\xe9 dynamique","options.submission.ignore_filtering":"Ignorer les services de filtrage","options.submission.priority":"Priorit\xe9","options.submission.priority.high":"Haute: 1500","options.submission.priority.low":"Basse: 500","options.submission.priority.medium":"Moyenne: 1000","options.submission.profile":"Examiner l\'analyse actuelle","options.submission.ttl":"Jours \xe0 vivre (0: pour toujours)","submit.file.failure":"Le fichier que vous essayez de d\xe9marrer n\'a pas \xe9t\xe9 t\xe9l\xe9vers\xe9 correctement, r\xe9essayez ...","submit.file.upload_fail":"\xc9chec du t\xe9l\xe9versement du fichier, r\xe9essayez ...","submit.progress":"% t\xe9l\xe9vers\xe9 ...","submit.success":"Envoi r\xe9ussi, redirection vers l\'ID de soumission:","submit.url.failure":"L\'URL soumit est soit invalide, ou inaccessible ...","terms1":"En appuyant sur ","terms2":", vous acceptez nos ","terms3":"Conditions d\'utilisation","url":"URL","url.button":"Analyser","url.input":"URL \xe0 Analyser","validate.acceptText":"Continuer","validate.cancelText":"D\xe9s\xe9lectionner les services externes","validate.text":"Vous \xeates sur le point de soumettre votre fichier \xe0 un service \xe0 l\'ext\xe9rieur de l\'infrastructure d\'Assemblyline. Que voulez-vous faire?","validate.title":"Services externes s\xe9lectionn\xe9s"}')},396:function(e){e.exports=JSON.parse('{"agreed":"Vous avez d\xe9ja accept\xe9 les conditions d\'utilisation...","button":"Accepter les conditions","logout":"D\xe9connexion","title":"Conditions d\'utilisation"}')},397:function(e){e.exports=JSON.parse('{"adminmenu":"Administration","adminmenu.errors":"Visualisateur d\'erreurs","adminmenu.services":"Services","adminmenu.sitemap":"Plan du site","adminmenu.users":"Utilisateurs","api.invalid":"Donn\xe9es non valides renvoy\xe9es par le serveur API","api.unreachable":"Serveur API inaccessible. R\xe9essayez plus tard...","app.language":"Langue","banner.alt":"Bani\xe8re d\'Assemblyline","breadcrumb.404":"Non disponible","breadcrumb.alert.detail":"D\xe9tails","breadcrumb.file.detail":"D\xe9tails","breadcrumb.file.viewer":"Visualisateur de Fichiers","breadcrumb.heuristic.detail":"D\xe9tails","breadcrumb.signature.detail":"D\xe9tails","breadcrumb.submission.detail":"D\xe9tails","breadcrumb.submission.detail.file":"Fichiers","breadcrumb.submission.report":"Rapport","breadcrumb.workflow.detail":"D\xe9tails","breadcrumb.tos":"Conditions d\'utilisation","classification.done":"Termin\xe9","clear_filter":"Effacer le filtre de recherche","divider":"OU","drawer.alerts":"Alertes","drawer.collapse":"Fermer le Menu","drawer.dashboard":"Tableau de bord","drawer.expand":"Ouvrir le Menu","drawer.help":"Aide","drawer.help.api":"Documentation de l\'API","drawer.help.classification":"Aide \xe0 la Classification","drawer.help.configuration":"Configuration courante","drawer.help.search":"Aide \xe0 la Recherche","drawer.help.services":"Liste des Services","drawer.manage":"Gestion","drawer.manage.heuristics":"Heuristiques","drawer.manage.signatures":"Signatures","drawer.manage.source":"Sources de Signature","drawer.manage.workflow":"Flux de travail","drawer.search":"Recherche","drawer.search.alert":"Index d\'Alerte","drawer.search.all":"Tous les Index","drawer.search.file":"Index de Fichier","drawer.search.result":"Index de Resultat","drawer.search.signature":"Index de Signature","drawer.search.submission":"Index de Soumission","drawer.signatures":"Signatures","drawer.stats":"Statistiques","drawer.stats.heuristics":"Heuristiques","drawer.stats.signatures":"Signatures","drawer.submissions":"Soumissions","drawer.submit":"Soumettre","extended_scan.completed":"Analyse \xe9tendue termin\xe9e avec succ\xe8s","extended_scan.incomplete":"Analyse \xe9tendue termin\xe9e avec des erreurs qui n\'\xe9taient pas pr\xe9sentes dans l\'analyse d\'origine","extended_scan.skipped":"L\'analyse \xe9tendu a \xe9t\xe9 ignor\xe9 pour cette alerte","extended_scan.submitted":"En attente de la fin de l\'analyse \xe9tendu ...","filter":"Filtrer...","forbidden":"Interdit","locked":"V\xe9rouill\xe9","logo.alt":"Logo d\'Assemblyline","notfound":"Introuvable","pager.first":"Premi\xe8re page","pager.last":"Derni\xe8re page","pager.next":"Page suivante","pager.back":"Page pr\xe9c\xe9dente","pager.rows":"Items par page:","pager.more":"plus de","pager.of":"sur","personalization":"Personnalisation","personalization.autohideappbar":"Masquer la barre sup\xe9rieure","personalization.dark":"Mode Sombre","personalization.minimizebreadcrumbs":"Minimiser fils d\'ariane","personalization.quicksearch":"Afficher recherche rapide","personalization.reset_text":"R\xe9initialiser les param\xe8tres","personalization.showbreadcrumbs":"Afficher fils d\'ariane","personalization.sticky":"Barre sup\xe9rieure collante","quicksearch.aria":"recherche","quicksearch.placeholder":"Recherche ...","signature.status.DEPLOYED":"D\xc9PLOY\xc9E","signature.status.DISABLED":"D\xc9SACTIV\xc9E","signature.status.NOISY":"BRUYANTE","submission.state.completed":"Termin\xe9","submission.state.error":"Termin\xe9 avec des erreurs","submission.state.submitted":"Examine...","tooltip.breadcrumbs.max":"Maximiser fils d\'ariane","tooltip.breadcrumbs.min":"Minimiser fils d\'ariane","under_construction":"Cette page est encore en d\xe9veloppement","usermenu":"Menu de l\'utilisateur","usermenu.account":"G\xe9rer votre compte","usermenu.logout":"D\xe9connexion","usermenu.optout":"D\xe9sactiver la nouvelle interface","usermenu.settings":"Param\xe8tres","verdict.highly_suspicious":"Tr\xe8s Suspect","verdict.highly_suspicious.short":"T","verdict.info":"Informatif","verdict.info.short":"I","verdict.malicious":"Malveillant","verdict.malicious.short":"M","verdict.non_malicious":"Non-Malveillant","verdict.non_malicious.short":"N","verdict.safe":"Sans Danger","verdict.safe.short":"S","verdict.suspicious":"Suspect","verdict.suspicious.short":"S"}')},398:function(e){e.exports=JSON.parse('{"2fa_already_enabled":"L\'authentification \xe0 2 facteurs est d\xe9j\xe0 activ\xe9e sur votre compte","2fa_disable":"D\xe9sactiver","2fa_disable_desc":"En d\xe9sactivant l\'authentification \xe0 2 facteurs sur votre compte, votre compte sera moins s\xe9cure. Vous ne serez plus invit\xe9 \xe0 saisir un mot de passe \xe0 usage unique pour vous connecter et tous les jetons de s\xe9curit\xe9 seront supprim\xe9s de votre compte.","2fa_disable_title":"D\xe9sactiver l\'authentification \xe0 2 facteurs","2fa_disabled":"L\'authentification \xe0 2 facteurs a \xe9t\xe9 d\xe9sactiv\xe9e pour votre compte","2fa_enabled":"L\'authentification \xe0 2 facteurs a \xe9t\xe9 activ\xe9e pour votre compte","2fa_manual":"Ajoutez manuellement la cl\xe9 secr\xe8te dans votre application","2fa_off":"D\xe9sactivez l\'authentification \xe0 2 facteurs","2fa_on":"Activez l\'authentification \xe0 2 facteurs","2fa_scan":"Scannez le QR Code ci-dessous avec votre application","2fa_setup_title":"Configuration de l\'authentification \xe0 2 facteurs","2fa_temp_otp":"Entrez le jeton OTP temporaire","admin":"Administrateur","api_quota":"Quota d\'API","api_quota_edit_title":"Nombre maximum d\'appels d\'API simultan\xe9s qui peuvent s\'ex\xe9cuter \xe0 l\'int\xe9rieur du serveur d\'API. C\'est l\'\xe9quivalent du nombre de threads qu\'un script ex\xe9cut\xe9 sous votre compte peut avoir connect\xe9 au serveur API simultan\xe9ment.","apikeys":"G\xe9rer les cl\xe9s API","apikeys.add":"Ajouter","apikeys.desc":"Mot de passe g\xe9n\xe9r\xe9 al\xe9atoirement pour utiliser dans les scripts afin d\'obtenir un acc\xe8s limit\xe9 aux donn\xe9es pour la lecture, l\'\xe9criture ou m\xeame les deux.","apikeys.list":"Cl\xe9s API configur\xe9es","apikeys.new_notice_text":"Ce sera le seul moment o\xf9 vous verrez r\xe9ellement la cl\xe9. Assurez-vous de copier/coller cette cl\xe9 dans le script o\xf9 vous souhaitez l\'utiliser maintenant, car une fois que vous fermez cette fen\xeatre, vous ne pouvez plus voir la cl\xe9. Si vous oubliez la cl\xe9, vous devrez la supprimer et en recr\xe9er une autre.","apikeys.new_notice_title":"* Important *","apikeys.new_title":"Votre nouvelle cl\xe9 API","apikeys.none":"Il n\'y a pas encore de cl\xe9 API pour cet utilisateur.","apikeys.r_token":"Lecture","apikeys.remove":"Supprimer","apikeys.remove_text":"Voulez-vous supprimer cette cl\xe9 API? Vous ne pourrez plus utiliser cette cl\xe9 pour vous connecter, assurez-vous qu\'aucun de vos scripts n\'utilise cette cl\xe9 avant de la supprimer.","apikeys.remove_title":"Supprimer la cl\xe9 API","apikeys.removed":"La cl\xe9 API a \xe9t\xe9 supprim\xe9e avec succ\xe8s","apikeys.rw_token":"Lecture / \xc9criture","apikeys.temp_token":"Nom de cl\xe9 API","apikeys.title":"Cl\xe9s API","apikeys.w_token":"\xc9criture","apps":"G\xe9rer les Applications Autoris\xe9es","apps.desc":"Ces applications peuvent emprunter l\'identit\xe9 de votre compte et \xe9mettre une requ\xeate \xe0 Assemblyline en votre nom.","apps.none":"Aucune application n\'a actuellement acc\xe8s \xe0 votre compte.","apps.remove":"Supprimer","apps.remove_text":"Voulez-vous r\xe9voquer l\'acc\xe8s de cette application \xe0 votre compte? Cela ne peut pas \xeatre annul\xe9, mais l\'application peut demander \xe0 nouveau l\'acc\xe8s plus tard.","apps.remove_title":"Supprimer l\'acc\xe8s de l\'application","apps.removed":"L\'acc\xe8s de l\'application \xe0 votre compte a \xe9t\xe9 r\xe9voqu\xe9.","apps.title":"Application Autoris\xe9es","cancel":"Annuler","change_password":"Changer de mot de passe","confirm_password":"Confirmer le mot de passe","delete.acceptText":"Oui, supprimez-le!","delete.cancelText":"Annuler","delete.success":"L\'utilisateur a bien \xe9t\xe9 supprim\xe9.","delete.text":"Voulez-vous vraiment supprimer l\'utilisateur actuel? Il n\'y aura aucun moyen de le r\xe9cup\xe9rer une fois que c\'est fait.","delete.title":"Supprimer l\'utilisateur","disabled":"Compte d\xe9sactiv\xe9","done":"Termin\xe9","email":"Adresse courriel","enabled":"Compte actif","groups":"Groupes","groups_edit_title":"Les groupes ne sont pas destin\xe9s au contr\xf4le d\'acc\xe8s, ils sont utilis\xe9s pour regrouper les soumissions des utilisateurs du m\xeame groupe. Lorsque vous soumettez un fichier, tous les groupes dont vous \xeates membre sont affect\xe9s \xe0 la soumission.","name":"Nom complet","name_edit_title":"Tapez votre nom complet","new_password":"Nouveau mot de passe","normal_user":"Utilisateur","options":"Options","profile":"Profil","remove":"Supprimer","roles":"R\xf4les","save":"Enregistrer les changements","security":"S\xe9curit\xe9","signature_importer":"Importateur de signature","signature_manager":"Gestionaire de signature","submission_quota":"Quota de soumissions","submission_quota_edit_title":"Nombre maximum de soumission en traitement sous votre compte. Seule les soumissions ex\xe9cut\xe9e via l\'API de soumission et l\'interface utilisateur sont compt\xe9es, les soumissions a commenc\xe9 \xe0 l\'aide de l\'API d\'ingestion ne compte pas envers le quota.","success_save":"Les changements \xe0 votre compte on \xe9t\xe9 enregistr\xe9s avec succ\xe8s.","token":"G\xe9rer les jetons de s\xe9curit\xe9","token.add":"Ajouter","token.added":"Le jeton de s\xe9curit\xe9 a bien \xe9t\xe9 ajout\xe9 \xe0 votre compte","token.desc":"Seuls les jetons de s\xe9curit\xe9 compatibles avec le protocole FIDO u2F sont pris en charge.","token.list":"Jetons de s\xe9curit\xe9 configur\xe9s","token.none":"Aucun jeton de s\xe9curit\xe9 n\'est configur\xe9 pour ce compte","token.remove":"Supprimer","token.remove_text":"Voulez-vous supprimer ce jeton de s\xe9curit\xe9? Vous ne pourrez plus vous connecter au syst\xe8me \xe0 l\'aide de celui-ci si vous le supprimer.","token.remove_title":"Supprimer le jeton de s\xe9curit\xe9","token.removed":"Le jeton de s\xe9curit\xe9 a \xe9t\xe9 supprim\xe9 avec succ\xe8s","token.temp_token":"Nouveau jeton de s\xe9curit\xe9","token.title":"Jetons de s\xe9curit\xe9","uname":"Nom d\'utilisateur","validate":"Valider"}')},453:function(e,t,a){(function(e){var a;!function(n,r,i){function l(e){if(this.support="undefined"!==typeof File&&"undefined"!==typeof Blob&&"undefined"!==typeof FileList&&(!!Blob.prototype.slice||!!Blob.prototype.webkitSlice||!!Blob.prototype.mozSlice||!1),this.support){this.supportDirectory=/WebKit/.test(n.navigator.userAgent),this.files=[],this.defaults={chunkSize:1048576,forceChunkSize:!1,simultaneousUploads:3,singleFile:!1,fileParameterName:"file",progressCallbacksInterval:500,speedSmoothingFactor:.1,query:{},headers:{},withCredentials:!1,preprocess:null,method:"multipart",prioritizeFirstAndLastChunk:!1,target:"/",testChunks:!0,generateUniqueIdentifier:null,maxChunkRetries:0,chunkRetryInterval:null,permanentErrors:[404,415,500,501]},this.opts={},this.events={};var t=this;this.onDrop=function(e){e.stopPropagation(),e.preventDefault();var a=e.dataTransfer;a.items&&a.items[0]&&a.items[0].webkitGetAsEntry?t.webkitReadDataTransfer(e):t.addFiles(a.files,e)},this.preventEvent=function(e){e.preventDefault()},this.opts=l.extend({},this.defaults,e||{})}}function s(e,t){this.flowObj=e,this.file=t,this.name=t.fileName||t.name,this.size=t.size,this.relativePath=t.relativePath||t.webkitRelativePath||this.name,this.uniqueIdentifier=e.generateUniqueIdentifier(t),this.chunks=[],this.paused=!1,this.error=!1,this.averageSpeed=0,this.currentSpeed=0,this._lastProgressCallback=Date.now(),this._prevUploadedSize=0,this._prevProgress=0,this.bootstrap()}function c(e,t,a){this.flowObj=e,this.fileObj=t,this.fileObjSize=t.size,this.offset=a,this.tested=!1,this.retries=0,this.pendingRetry=!1,this.preprocessState=0,this.loaded=0,this.total=0;var n=this.flowObj.opts.chunkSize;this.startByte=this.offset*n,this.endByte=Math.min(this.fileObjSize,(this.offset+1)*n),this.xhr=null,this.fileObjSize-this.endByte<n&&!this.flowObj.opts.forceChunkSize&&(this.endByte=this.fileObjSize);var r=this;this.progressHandler=function(e){e.lengthComputable&&(r.loaded=e.loaded,r.total=e.total),r.fileObj.chunkEvent("progress")},this.testHandler=function(e){var t=r.status();"success"===t?(r.tested=!0,r.fileObj.chunkEvent(t,r.message()),r.flowObj.uploadNextChunk()):r.fileObj.paused||(r.tested=!0,r.send())},this.doneHandler=function(e){var t=r.status();if("success"===t||"error"===t)r.fileObj.chunkEvent(t,r.message()),r.flowObj.uploadNextChunk();else{r.fileObj.chunkEvent("retry",r.message()),r.pendingRetry=!0,r.abort(),r.retries++;var a=r.flowObj.opts.chunkRetryInterval;null!==a?setTimeout((function(){r.send()}),a):r.send()}}}function o(e,t){return u(arguments,(function(t){t!==e&&u(t,(function(t,a){e[a]=t}))})),e}function u(e,t,a){var n;if(e)if("undefined"!==typeof e.length){for(n=0;n<e.length;n++)if(!1===t.call(a,e[n],n))return}else for(n in e)if(e.hasOwnProperty(n)&&!1===t.call(a,e[n],n))return}l.prototype={on:function(e,t){e=e.toLowerCase(),this.events.hasOwnProperty(e)||(this.events[e]=[]),this.events[e].push(t)},off:function(e,t){void 0!==e?(e=e.toLowerCase(),void 0!==t?this.events.hasOwnProperty(e)&&function(e,t){var a=e.indexOf(t);a>-1&&e.splice(a,1)}(this.events[e],t):delete this.events[e]):this.events={}},fire:function(e,t){t=Array.prototype.slice.call(arguments),e=e.toLowerCase();var a=!1;return this.events.hasOwnProperty(e)&&u(this.events[e],(function(e){a=!1===e.apply(this,t.slice(1))||a})),"catchall"!==e&&(t.unshift("catchAll"),a=!1===this.fire.apply(this,t)||a),!a},webkitReadDataTransfer:function(e){var t=this,a=e.dataTransfer.items.length,n=[];function r(e){a+=e.length,u(e,(function(e){if(e.isFile){var t=e.fullPath;e.file((function(e){i(e,t)}),l)}else e.isDirectory&&e.createReader().readEntries(r,l)})),s()}function i(e,t){e.relativePath=t.substring(1),n.push(e),s()}function l(e){throw e}function s(){0===--a&&t.addFiles(n,e)}u(e.dataTransfer.items,(function(e){var t=e.webkitGetAsEntry();t?t.isFile?i(e.getAsFile(),t.fullPath):t.createReader().readEntries(r,l):s()}))},generateUniqueIdentifier:function(e){var t=this.opts.generateUniqueIdentifier;if("function"===typeof t)return t(e);var a=e.relativePath||e.webkitRelativePath||e.fileName||e.name;return"".concat(e.size,"-").concat(a.replace(/[^0-9a-zA-Z_-]/gim,""))},uploadNextChunk:function(e){var t=!1;if(this.opts.prioritizeFirstAndLastChunk&&(u(this.files,(function(e){return!e.paused&&e.chunks.length&&"pending"===e.chunks[0].status()&&0===e.chunks[0].preprocessState?(e.chunks[0].send(),t=!0,!1):!e.paused&&e.chunks.length>1&&"pending"===e.chunks[e.chunks.length-1].status()&&0===e.chunks[0].preprocessState?(e.chunks[e.chunks.length-1].send(),t=!0,!1):void 0})),t))return t;if(u(this.files,(function(e){if(e.paused||u(e.chunks,(function(e){if("pending"===e.status()&&0===e.preprocessState)return e.send(),t=!0,!1})),t)return!1})),t)return!0;var a=!1;return u(this.files,(function(e){if(!e.isComplete())return a=!0,!1})),a||e||this.fire("complete"),!1},assignBrowse:function(e,t,a){"undefined"===typeof e.length&&(e=[e]),u(e,(function(e){var n;"INPUT"===e.tagName&&"file"===e.type?n=e:((n=r.createElement("input")).setAttribute("type","file"),o(e.style,{position:"relative",overflow:"hidden",verticalAlign:"top"}),o(n.style,{position:"absolute",top:0,right:0,fontFamily:"Arial",fontSize:"140px",margin:0,padding:0,opacity:0,cursor:"pointer"}),e.appendChild(n)),this.opts.singleFile||a||n.setAttribute("multiple","multiple"),t&&n.setAttribute("webkitdirectory","webkitdirectory");var i=this;n.addEventListener("change",(function(e){i.addFiles(e.target.files,e),e.target.value=""}),!1)}),this)},assignDrop:function(e){"undefined"===typeof e.length&&(e=[e]),u(e,(function(e){e.addEventListener("dragover",this.preventEvent,!1),e.addEventListener("dragenter",this.preventEvent,!1),e.addEventListener("drop",this.onDrop,!1)}),this)},unAssignDrop:function(e){"undefined"===typeof e.length&&(e=[e]),u(e,(function(e){e.removeEventListener("dragover",this.preventEvent),e.removeEventListener("dragenter",this.preventEvent),e.removeEventListener("drop",this.onDrop)}),this)},isUploading:function(){var e=!1;return u(this.files,(function(t){if(t.isUploading())return e=!0,!1})),e},upload:function(){if(!this.isUploading()){this.fire("uploadStart");for(var e=!1,t=1;t<=this.opts.simultaneousUploads;t++)e=this.uploadNextChunk(!0)||e;e||this.fire("complete")}},resume:function(){u(this.files,(function(e){e.resume()}))},pause:function(){u(this.files,(function(e){e.pause()}))},cancel:function(){for(var e=this.files.length-1;e>=0;e--)this.files[e].cancel()},progress:function(){var e=0,t=0;return u(this.files,(function(a){e+=a.progress()*a.size,t+=a.size})),t>0?e/t:0},addFile:function(e,t){this.addFiles([e],t)},addFiles:function(e,t){var a=[];u(e,(function(e){if((e.size%4096!==0||"."!==e.name&&"."!==e.fileName)&&!this.getFromUniqueIdentifier(this.generateUniqueIdentifier(e))){var n=new s(this,e);this.fire("fileAdded",n,t)&&a.push(n)}}),this),this.fire("filesAdded",a,t)&&u(a,(function(e){(this.opts.singleFile&&0===this.files.length||!this.opts.singleFile)&&this.files.push(e)}),this),this.fire("filesSubmitted",a,t)},removeFile:function(e){for(var t=this.files.length-1;t>=0;t--)this.files[t]===e&&(this.files.splice(t,1),e.abort())},getFromUniqueIdentifier:function(e){var t=!1;return u(this.files,(function(a){a.uniqueIdentifier===e&&(t=a)})),t},getSize:function(){var e=0;return u(this.files,(function(t){e+=t.size})),e},sizeUploaded:function(){var e=0;return u(this.files,(function(t){e+=t.sizeUploaded()})),e},timeRemaining:function(){var e=0,t=0;return u(this.files,(function(a){a.paused||a.error||(e+=a.size-a.sizeUploaded(),t+=a.averageSpeed)})),e&&!t?Number.POSITIVE_INFINITY:e||t?Math.floor(e/t):0}},s.prototype={measureSpeed:function(){var e=Date.now()-this._lastProgressCallback;if(e){var t=this.flowObj.opts.speedSmoothingFactor,a=this.sizeUploaded();this.currentSpeed=Math.max((a-this._prevUploadedSize)/e*1e3,0),this.averageSpeed=t*this.currentSpeed+(1-t)*this.averageSpeed,this._prevUploadedSize=a}},chunkEvent:function(e,t){switch(e){case"progress":if(Date.now()-this._lastProgressCallback<this.flowObj.opts.progressCallbacksInterval)break;this.measureSpeed(),this.flowObj.fire("fileProgress",this),this.flowObj.fire("progress"),this._lastProgressCallback=Date.now();break;case"error":this.error=!0,this.abort(!0),this.flowObj.fire("fileError",this,t),this.flowObj.fire("error",t,this);break;case"success":if(this.error)return;this.measureSpeed(),this.flowObj.fire("fileProgress",this),this.flowObj.fire("progress"),this._lastProgressCallback=Date.now(),this.isComplete()&&(this.currentSpeed=0,this.averageSpeed=0,this.flowObj.fire("fileSuccess",this,t));break;case"retry":this.flowObj.fire("fileRetry",this)}},pause:function(){this.paused=!0,this.abort()},resume:function(){this.paused=!1,this.flowObj.upload()},abort:function(e){this.currentSpeed=0,this.averageSpeed=0;var t=this.chunks;e&&(this.chunks=[]),u(t,(function(e){"uploading"===e.status()&&(e.abort(),this.flowObj.uploadNextChunk())}),this)},cancel:function(){this.flowObj.removeFile(this)},retry:function(){this.bootstrap(),this.flowObj.upload()},bootstrap:function(){this.abort(!0),this.error=!1,this._prevProgress=0;for(var e=this.flowObj.opts.forceChunkSize?Math.ceil:Math.floor,t=Math.max(e(this.file.size/this.flowObj.opts.chunkSize),1),a=0;a<t;a++)this.chunks.push(new c(this.flowObj,this,a))},progress:function(){if(this.error)return 0;if(1===this.chunks.length)return this._prevProgress=Math.max(this._prevProgress,this.chunks[0].progress()),this._prevProgress;var e=0;u(this.chunks,(function(t){e+=t.progress()*(t.endByte-t.startByte)}));var t=e/this.size;return this._prevProgress=Math.max(this._prevProgress,t>.999?1:t),this._prevProgress},isUploading:function(){var e=!1;return u(this.chunks,(function(t){if("uploading"===t.status())return e=!0,!1})),e},isComplete:function(){var e=!1;return u(this.chunks,(function(t){var a=t.status();if("pending"===a||"uploading"===a||1===t.preprocessState)return e=!0,!1})),!e},sizeUploaded:function(){var e=0;return u(this.chunks,(function(t){e+=t.sizeUploaded()})),e},timeRemaining:function(){if(this.paused||this.error)return 0;var e=this.size-this.sizeUploaded();return e&&!this.averageSpeed?Number.POSITIVE_INFINITY:e||this.averageSpeed?Math.floor(e/this.averageSpeed):0},getType:function(){return this.file.type&&this.file.type.split("/")[1]},getExtension:function(){return this.name.substr(2+(~-this.name.lastIndexOf(".")>>>0)).toLowerCase()}},c.prototype={getParams:function(){return{flowChunkNumber:this.offset+1,flowChunkSize:this.flowObj.opts.chunkSize,flowCurrentChunkSize:this.endByte-this.startByte,flowTotalSize:this.fileObjSize,flowIdentifier:this.fileObj.uniqueIdentifier,flowFilename:this.fileObj.name,flowRelativePath:this.fileObj.relativePath,flowTotalChunks:this.fileObj.chunks.length}},getTarget:function(e){var t=this.flowObj.opts.target;return t.indexOf("?")<0?t+="?":t+="&",t+e.join("&")},test:function(){this.xhr=new XMLHttpRequest,this.xhr.addEventListener("load",this.testHandler,!1),this.xhr.addEventListener("error",this.testHandler,!1);var e=this.prepareXhrRequest("GET");this.xhr.send(e)},preprocessFinished:function(){this.preprocessState=2,this.send()},send:function(){var e=this.flowObj.opts.preprocess;if("function"===typeof e)switch(this.preprocessState){case 0:return e(this),void(this.preprocessState=1);case 1:return}if(!this.flowObj.opts.testChunks||this.tested){this.loaded=0,this.total=0,this.pendingRetry=!1;var t=this.fileObj.file.slice?"slice":this.fileObj.file.mozSlice?"mozSlice":this.fileObj.file.webkitSlice?"webkitSlice":"slice",a=this.fileObj.file[t](this.startByte,this.endByte);this.xhr=new XMLHttpRequest,this.xhr.upload.addEventListener("progress",this.progressHandler,!1),this.xhr.addEventListener("load",this.doneHandler,!1),this.xhr.addEventListener("error",this.doneHandler,!1);var n=this.prepareXhrRequest("POST",this.flowObj.opts.method,a);this.xhr.send(n)}else this.test()},abort:function(){var e=this.xhr;this.xhr=null,e&&e.abort()},status:function(){return this.pendingRetry?"uploading":this.xhr?this.xhr.readyState<4?"uploading":200===this.xhr.status?"success":this.flowObj.opts.permanentErrors.indexOf(this.xhr.status)>-1||this.retries>=this.flowObj.opts.maxChunkRetries?"error":(this.abort(),"pending"):"pending"},message:function(){return this.xhr?this.xhr.responseText:""},progress:function(){if(this.pendingRetry)return 0;var e=this.status();return"success"===e||"error"===e?1:"pending"===e?0:this.total>0?this.loaded/this.total:0},sizeUploaded:function(){var e=this.endByte-this.startByte;return"success"!==this.status()&&(e*=this.progress()),e},prepareXhrRequest:function(e,t,a){var n=this.flowObj.opts.query;"function"===typeof n&&(n=n(this.fileObj,this)),n=o(this.getParams(),n);var r=this.flowObj.opts.target,i=null;if("GET"===e||"octet"===t){var l=[];u(n,(function(e,t){l.push([encodeURIComponent(t),encodeURIComponent(e)].join("="))})),r=this.getTarget(l),i=a||null}else i=new FormData,u(n,(function(e,t){i.append(t,e)})),i.append(this.flowObj.opts.fileParameterName,a);return this.xhr.open(e,r),this.xhr.withCredentials=this.flowObj.opts.withCredentials,u(this.flowObj.opts.headers,(function(e,t){this.xhr.setRequestHeader(t,e)}),this),i}},l.extend=o,l.each=u,l.FlowFile=s,l.FlowChunk=c,l.version="2.1.0",e&&"object"===typeof e.exports?e.exports=l:(n.Flow=l,void 0===(a=function(){return l}.apply(t,[]))||(e.exports=a))}(window,document)}).call(this,a(166)(e))},476:function(e,t,a){e.exports=a(725)},544:function(e,t){},724:function(e,t,a){},725:function(e,t,a){"use strict";a.r(t);var n=a(4),r=a(17),i=a(732),l=a(733),s=a(772),c=a(454),o=a(0),u=a.n(o),m=function(e,t){return[Object(o.useMemo)((function(){var a=t.background,n=t.darkPrimary,r=t.darkSecondary,i=t.lightPrimary,l=t.lightSecondary,s={primary:{main:e?n:i},secondary:{main:e?r:l},type:e?"dark":"light"};return a&&(e&&a.dark?s.background=a.dark:!e&&a.light&&(s.background=a.light)),Object(c.a)({overrides:{MuiCssBaseline:{"@global":{body:{width:"100%",height:"100%"},"#root":{position:"absolute",top:0,left:0,right:0,bottom:0}}}},palette:s})}),[t,e])]},d=a(118),p=u.a.createContext(null),g=Object(i.a)((function(e){return{snackroot:Object(r.a)({},e.breakpoints.only("xs"),{wordBreak:"break-all"})}})),f=function(e){var t=e.defaultTheme,a=e.colors,r=e.defaultContext,i=e.children,c=Object(o.useState)(r),f=Object(n.a)(c,2),h=f[0],b=f[1],v=g(),E=Object(l.a)("(prefers-color-scheme: dark)"),y=Object(o.useState)(function(e,t){var a=localStorage.getItem("darkMode"),n=a?!!JSON.parse(a):null;return null!==n&&!0===n?"dark":null!==n&&!1===n?"light":t?"dark":e}(t,E)),O=Object(n.a)(y,2),_=O[0],x=O[1],w=m("dark"===_,a),j=Object(n.a)(w,1)[0];return u.a.createElement(p.Provider,{value:{context:h,theme:_,colors:a,isDarkTheme:"dark"===_,isLightTheme:"light"===_,toggleTheme:function(){var e="dark"===_?"light":"dark";localStorage.setItem("darkMode",JSON.stringify("dark"===e)),x(e)},setContext:b,getAppbarStyles:function(e){var t,n,r,i,l,s,c,o,u="top"===e,m="dark"===_,d="light"===_,p=u?j.palette.primary.dark:j.palette.background.default;u&&(m&&(null===(l=a.appbar)||void 0===l||null===(s=l.sticky)||void 0===s?void 0:s.dark)&&(p=a.appbar.sticky.dark.backgroundColor),d&&(null===(c=a.appbar)||void 0===c||null===(o=c.sticky)||void 0===o?void 0:o.light)&&(p=a.appbar.sticky.light.backgroundColor));var g=u?void 0!==(null===(t=a.appbar)||void 0===t||null===(n=t.sticky)||void 0===n?void 0:n.elevation)?null===(r=a.appbar)||void 0===r||null===(i=r.sticky)||void 0===i?void 0:i.elevation:2:0;return{color:j.palette.getContrastText(p),backgroundColor:p,elevation:g}}}},u.a.createElement(s.a,{theme:j},u.a.createElement(d.a,{classes:{root:v.snackroot}},i)))},h=a(3),b=a(28),v=a(29),E=a(788),y=u.a.createContext(null);function O(e){var t=e.children,a=Object(b.a)(e,["children"]);return u.a.createElement(y.Provider,{value:a},t)}O.defaultProps={validateProps:function(){return!0}};var _=O;function x(){var e=Object(o.useContext)(y);return e||{user:null,setUser:function(e){return null},isReady:function(){return!1}}}var w=a(778),j=a(779),k=a(738),S=a(734),C=a(774),T=a(775),A=a(731),N=a(780),I=a(735),R=a(827),z=a(773),D=a(120),B=a.n(D),q=a(94),L=a.n(q),F=a(5),P=a(457),M=a(776),W=a(93),U=a.n(W),H=a(54),V=a.n(H),G=a(726),Y=a(15),J=Object(i.a)((function(e){return Object(G.a)({nested:{paddingLeft:e.spacing(4)}})})),Q=Object(z.a)()((function(e){var t=J(),a=Pa(),n=a.drawerState,r=a.hideNestedIcons,i=a.toggleDrawer,l=e.text,s=e.icon,c=e.nested,o=e.route,m=e.userPropValidators,d=x().validateProps,p=u.a.createElement(S.a,{button:!0,component:o?Y.b:null,to:o,dense:!!c,className:c?t.nested:null,key:l,onClick:function(){Object(z.b)("sm",e.width)&&n&&setTimeout(i,150)}},(s&&!c||!r&&s&&c)&&u.a.createElement(C.a,null,s),u.a.createElement(T.a,{primary:l}));return d(m)?n||c?p:u.a.createElement(I.a,{title:l,"aria-label":l,placement:"right"},p):null})),K=function(e){var t=e.open,a=void 0===t||t,r=e.id,i=e.title,l=e.icon,s=e.items,c=Pa().drawerState,m=Object(o.useState)(),d=Object(n.a)(m,2),p=d[0],g=d[1],f=u.a.useState(!1),h=Object(n.a)(f,2),b=h[0],v=h[1],E=u.a.createElement(S.a,{button:!0,key:r,onClick:function(e){a?v(!b):function(e){g(e?e.currentTarget:void 0)}(e)}},u.a.createElement(C.a,null,l),u.a.createElement(T.a,{primary:i}),b?u.a.createElement(U.a,{color:"action"}):u.a.createElement(V.a,{color:"action"}));return u.a.createElement("div",null,c?E:u.a.createElement(I.a,{title:i,"aria-label":i,placement:"right"},E),u.a.createElement(P.a,{in:b&&a,timeout:"auto",unmountOnExit:!0},u.a.createElement(k.a,{component:"div",disablePadding:!0},s.map((function(e){return u.a.createElement(Q,Object.assign({key:e.id},e))})))),u.a.createElement(M.a,{open:!!p,onClose:function(){return g(void 0)},onClick:function(){return g(void 0)},anchorEl:p,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"}},u.a.createElement(k.a,{disablePadding:!0},s.map((function(e){return u.a.createElement(Q,Object.assign({key:e.id},e))})))))},X=a(777),Z=a(739),$=a(316),ee=a.n($),te=Object(i.a)((function(e){return{topBarTitle:{display:"flex",alignItems:"center",flex:"0 0 auto",fontSize:"1.5rem",letterSpacing:"-1px"},icon:{display:"flex",alignItems:"center",padding:"0",minWidth:e.spacing(7)},title:{color:"inherit",textDecoration:"none"}}}));function ae(e){var t=e.disabled,a=void 0!==t&&t,n=e.noTitle,r=void 0!==n&&n,i=Object(v.a)(),s=te(),c=Object(l.a)(i.breakpoints.only("xs")),o=Pa(),m=o.layoutProps,d=o.getLogo,p=o.toggleDrawer;return a?null:c?u.a.createElement("div",{className:s.topBarTitle,style:{paddingLeft:i.spacing(2)}},u.a.createElement("div",{className:s.icon},u.a.createElement(Z.a,{"aria-label":"open drawer",edge:"start",color:"inherit",onClick:p},u.a.createElement(ee.a,null))),!r&&u.a.createElement(Y.b,{to:"/",className:s.title,onClick:p},m.appName)):u.a.createElement(Y.b,{to:"/",className:s.title,style:{paddingLeft:i.spacing(2)}},u.a.createElement("div",{className:s.topBarTitle},u.a.createElement("div",{className:s.icon},d(i)),!r&&u.a.createElement("div",null,m.appName)))}var ne=Object(i.a)((function(e){var t;return{drawer:{width:240,flexShrink:0,whiteSpace:"nowrap","@media print":{display:"none !important"}},drawerOver:{overflowX:"hidden"},drawerOpen:{width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:(t={transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:0},Object(r.a)(t,e.breakpoints.up("sm"),{width:e.spacing(7)+1}),Object(r.a)(t,e.breakpoints.only("xs"),{border:"none"}),t),toolbar:Object(r.a)({},e.breakpoints.up("xs"),{padding:0}),title:{alignItems:"center",display:"inline-flex",flex:"0 0 auto",fontSize:"1.5rem",letterSpacing:"-1px",textDecoration:"none",color:e.palette.text.primary},toggler:{height:"100%",width:"100%","&:hover":{cursor:"pointer"}}}})),re=Object(z.a)()((function(e){var t,a,n=Object(X.a)().t,i=Object(v.a)(),s=ne(),c=Pa(),o=c.layoutProps,m=c.drawerState,d=c.currentLayout,p=c.toggleDrawer,g="top"===d,f=Object(l.a)(i.breakpoints.only("xs")),h=u.a.createElement("div",null,u.a.createElement(w.a,{className:s.toolbar},u.a.createElement(ae,null)),u.a.createElement(j.a,{style:{backgroundColor:g&&!f?"transparent":null}})),b=u.a.createElement(k.a,{disablePadding:!0},u.a.createElement(S.a,{button:!0,key:"chevron",onClick:p},u.a.createElement(C.a,null,m?u.a.createElement(B.a,null):u.a.createElement(L.a,null)),u.a.createElement(T.a,{primary:n("drawer.collapse")})));return u.a.createElement(A.a,{mouseEvent:"onMouseDown",touchEvent:"onTouchStart",onClickAway:function(){Object(z.b)("sm",e.width)&&m&&p()}},u.a.createElement(N.a,{variant:"permanent",className:Object(F.default)(s.drawer,(t={},Object(r.a)(t,s.drawerOpen,m),Object(r.a)(t,s.drawerClose,!m),t)),classes:{paper:Object(F.default)(s.drawerOver,(a={},Object(r.a)(a,s.drawerOpen,m),Object(r.a)(a,s.drawerClose,!m),a))}},m?h:u.a.createElement(I.a,{title:o.appName,"aria-label":o.appName,placement:"right"},h),u.a.createElement(k.a,{disablePadding:!0},o.leftnav.elements.map((function(e,t){var a="{navel-".concat(t,"}");return"item"===e.type?u.a.createElement(Q,Object.assign({key:a},e.element)):"group"===e.type?u.a.createElement(K,Object.assign({key:a,open:m},e.element)):"divider"===e.type?u.a.createElement(j.a,{key:a}):null}))),u.a.createElement(j.a,null),m?b:u.a.createElement(I.a,{title:n("drawer.expand"),"aria-label":n("drawer.expand"),placement:"right"},b),u.a.createElement(R.a,{className:Object(F.default)(s.toggler),onClick:p})))})),ie=a(787),le=a(456);function se(){var e=Object(o.useState)(-1),t=Object(n.a)(e,2),a=t[0],r=t[1],i=function(){var e=document.getElementById("appbar");if(e){var t=e.getBoundingClientRect();r(t.height)}};return Object(o.useLayoutEffect)((function(){return i(),window.addEventListener("resize",i),window.addEventListener("tui.event.appbar.ready",i),function(){window.removeEventListener("resize",i),window.removeEventListener("tui.event.appbar.ready",i)}}),[]),a}function ce(){return Object(o.useContext)(p)}var oe=a(10),ue=a(37),me=u.a.createContext(null);var de=function(e){var t=e.children,a=Object(b.a)(e,["children"]),r=Object(ue.g)(),i=x().isReady,l=Object(o.useState)([]),s=Object(n.a)(l,2),c=s[0],m=s[1],d=i();return Object(o.useEffect)((function(){m(Ut([Wt("/",a.routes)],Wt(r.location.pathname,a.routes)))}),[d]),Object(o.useEffect)((function(){return r.listen((function(e){var t=Wt(e.pathname,a.routes),n=Ut(c,t);m(n)}))})),u.a.createElement(me.Provider,{value:Object(h.a)({breadcrumbs:c},a)},t)},pe=a(130),ge=a(320),fe=a(321),he=a(322),be=a(323),ve=a(324),Ee=a(325),ye=a(326),Oe=a(327),_e=a(328),xe=a(329),we=a(330),je=a(331),ke=a(332),Se=a(333),Ce=a(334),Te=a(335),Ae=a(336),Ne=a(337),Ie=a(338),Re=a(339),ze=a(340),De=a(341),Be=a(342),qe=a(343),Le=a(344),Fe=a(345),Pe=a(346),Me=a(347),We=a(348),Ue=a(349),He=a(350),Ve=a(351),Ge=a(352),Ye=a(353),Je=a(354),Qe=a(355),Ke=a(356),Xe=a(357),Ze=a(358),$e=a(359),et=a(360),tt=a(361),at=a(362),nt=a(363),rt=a(364),it=a(365),lt=a(366),st=a(367),ct=a(368),ot=a(369),ut=a(370),mt=a(371),dt=a(372),pt=a(373),gt=a(374),ft=a(375),ht=a(376),bt=a(377),vt=a(378),Et=a(379),yt=a(380),Ot=a(381),_t=a(382),xt=a(383),wt=a(384),jt=a(385),kt=a(386),St=a(387),Ct=a(388),Tt=a(389),At=a(390),Nt=a(391),It=a(392),Rt=a(393),zt=a(394),Dt=a(395),Bt=a(396),qt=a(397),Lt=a(398),Ft=a(83),Pt={en:{adminErrorViewer:be,adminServices:ve,adminSiteMap:Ee,adminUsers:ye,authorize:_e,dashboard:xe,error403:fe,error404:he,fileDetail:je,fileViewer:ke,helpAPI:Se,helpClassification:Ce,helpConfiguration:Te,helpSearch:Ae,helpServices:Ne,locked:Ie,login:Re,logout:ze,manageHeuristics:De,manageHeuristicDetail:Be,manageSignatures:qe,manageSignatureDetail:Le,manageSignatureSources:Fe,manageWorkflowDetail:Me,manageWorkflows:Pe,optout:We,search:Ue,settings:He,statisticsHeuristics:Ve,statisticsSignatures:Ge,submissions:Qe,submissionDetail:Ye,submissionReport:Je,submit:Ke,translation:Ze,tos:Xe,user:$e,alerts:Oe,favorites:we},fr:{adminErrorViewer:at,adminServices:nt,adminSiteMap:rt,adminUsers:it,authorize:st,dashboard:ct,error403:et,error404:tt,fileDetail:ut,fileViewer:mt,helpAPI:dt,helpClassification:pt,helpConfiguration:gt,helpSearch:ft,helpServices:ht,locked:bt,login:vt,logout:Et,manageHeuristics:yt,manageHeuristicDetail:Ot,manageSignatures:_t,manageSignatureDetail:xt,manageSignatureSources:wt,manageWorkflowDetail:kt,manageWorkflows:jt,optout:St,search:Ct,settings:Tt,statisticsHeuristics:At,statisticsSignatures:Nt,submissions:zt,submissionDetail:It,submissionReport:Rt,submit:Dt,translation:qt,tos:Bt,user:Lt,alerts:lt,favorites:ot}};pe.a.use(ge.a).use(Ft.e).init({fallbackLng:"en",keySeparator:!1,interpolation:{escapeValue:!1},detection:{order:["localStorage","cookie"]},resources:Pt});var Mt=pe.a.t("breadcrumb.404"),Wt=function(e,t){var a=t.map((function(t){return{route:t,matcher:Object(ue.f)(e,{path:t.path})}})).filter((function(e){return e.matcher&&e.matcher.isExact}));return a&&a.length>1&&console.warn("Found more than one sitemap route match for: ".concat(e)),a&&a[0]?a[0]:{route:{path:e,title:Mt},matcher:null}},Ut=function(e,t){if(t){if(t.route.isRoot)return[t];e[e.length-1].route.isLeaf&&(e=e.slice(0,e.length-1));var a=e.findIndex((function(e){return e.route.path===t.route.path}));return[].concat(a>-1?Object(oe.a)(e.slice(0,a)):Object(oe.a)(e),[t])}return e},Ht=function(e){return e.route.title===Mt};function Vt(){var e=Object(o.useContext)(me),t=e.breadcrumbs,a=Object(b.a)(e,["breadcrumbs"]);return{breadcrumbs:t,props:a,resolveTitle:function(e){return function(e,t){var a=e.route.path?Wt(e.route.path,t).route.title:e.route.title;if(e.matcher&&e.matcher.params){var n=e.matcher.params;Object.keys(n).forEach((function(e){a=a.replace("{:".concat(e,"}"),n[e])}))}return a}(e,a.routes)},getSiteRoute:function(e){return Wt(e,a.routes)},last:function(){return t.length>0?t[t.length-1]:t[0]},first:function(){return t[0]},is404:Ht}}var Gt,Yt=a(824),Jt=a(399),Qt=a.n(Jt),Kt=a(52),Xt=Object(i.a)((function(e){return{icon:{"& svg":{marginRight:e.spacing(.5),width:20,height:20}}}})),Zt=function(e){var t=e.item.route.icon,a=Xt();return t?u.a.createElement("span",{className:a.icon},t):null},$t=a(782),ea=Object(i.a)({link:{display:"flex"},text:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}),ta=function(e){return u.a.createElement($t.a,Object.assign({},e,{component:Y.b}))},aa=function(e){var t=e.item,a=e.textOnly,n=void 0!==a&&a,r=ea(),i=t.route,l=t.matcher,s=Vt().resolveTitle,c=l?l.url:i.path;return u.a.createElement(ta,{style:i.icon?{paddingTop:"3px"}:null,key:"bcrumb-".concat(c),color:"inherit",to:c,className:r.link},!n&&u.a.createElement(Zt,{item:t}),u.a.createElement("span",{className:r.text},s(t)))},na=function(e){var t=e.item,a=e.textOnly,n=void 0!==a&&a,r=ea(),i=t.route,l=t.matcher,s=ea(),c=Vt().resolveTitle,o=l?l.url:i.path;return u.a.createElement(Kt.a,{style:i.icon?{paddingTop:"3px"}:null,key:"bcrumb-".concat(o),className:s.link},!n&&u.a.createElement(Zt,{item:t}),u.a.createElement(I.a,{title:o},u.a.createElement("span",{className:r.text},c(t))))},ra=function(e){var t=e.onClick,a=e.css,n=e.expanded,r=Object(X.a)().t;return u.a.createElement(I.a,{title:r(n?"tooltip.breadcrumbs.min":"tooltip.breadcrumbs.max")},u.a.createElement(Qt.a,{fontSize:"small",className:a,onClick:t}))},ia=function(e){var t=e.items,a=e.disableStyle,r=e.itemsBefore,i=void 0===r?1:r,l=e.itemsAfter,s=void 0===l?1:l,c=e.allLinks,m=void 0!==c&&c,d=e.textOnly,p=void 0!==d&&d,g=e.exceptLast,f=void 0!==g&&g,h=e.isStatic,b=void 0!==h&&h,v=Object(o.useState)(!1),E=Object(n.a)(v,2),y=E[0],O=E[1],_=la(),x=function(e,t,a,n,r){var i=e.concat().filter((function(e){return!e.route.exclude}));if(i.length<=t+a+1||r)return{before:null,after:i,hasEllipsis:!1};var l=i.slice(0,t),s=n?i.slice(t):i.slice(i.length-a);return{before:l,after:s,hasEllipsis:l.length+s.length+1<i.length||n}}(f?t.slice(0,t.length-1):t,i,s,y,b),w=x.before,j=x.after,k=x.hasEllipsis,S=j.length>0&&!m?j.pop():w?w.pop():null;return u.a.createElement(Yt.a,{"aria-label":"breadcrumb",className:a?"":_.breadcrumbs,maxItems:1e3},w&&w.map((function(e){return u.a.createElement(aa,{key:"bcrumb-".concat(e.route.path),item:e,textOnly:p})})),k&&u.a.createElement(ra,{expanded:y,onClick:function(){return O(!y)},css:_.moreicon}),j&&j.map((function(e){return u.a.createElement(aa,{key:"bcrumb-".concat(e.route.path),item:e,textOnly:p})})),S&&u.a.createElement(na,{item:S,textOnly:p}))},la=Object(i.a)((function(e){return{breadcrumbs:{color:"inherit",display:"flex",alignItems:"center",flexGrow:2},moreicon:{verticalAlign:"bottom",marginTop:"5px",display:"inline-flex","&:hover":{cursor:"pointer"}}}})),sa=function(e){var t=e.disableStyle,a=Object(v.a)(),n=Object(l.a)(a.breakpoints.up("md")),r=Pa().breadcrumbsState&&n,i=Vt(),s=i.breadcrumbs,c=i.props,o=c.lastOnly,m=c.exceptLast,d=c.allLinks,p=c.itemsBefore,g=void 0===p?1:p,f=c.itemsAfter,h=void 0===f?1:f,b=i.getSiteRoute,E=i.last,y=i.is404,O=E(),_=!!O.route.breadcrumbs,x=null;if(o||y(O))x=[O];else if(_){var w=O.route.breadcrumbs.map((function(e){return b(e)}));x=[].concat(Object(oe.a)(w),[O])}else x=m?s.length>1?s.slice(0,s.length-1):[]:s;return u.a.createElement(ia,{items:x,disableStyle:t,allLinks:d,isStatic:_,itemsBefore:r?g:0,itemsAfter:r?h:1})},ca=a(736),oa=a(460),ua=a(131),ma=a(783),da=a(828),pa=a(400),ga=a.n(pa),fa=Object(i.a)((function(e){return{popper:{zIndex:e.zIndex.drawer+2}}})),ha=Object(z.a)()((function(e){var t=Object(v.a)(),a=fa(),r=Pa().layoutProps,i=Object(o.useState)(null),l=Object(n.a)(i,2),s=l[0],c=l[1],m="dark"===t.palette.type,d=!!s,p=t.spacing(1);return 0===r.topnav.apps.length?null:u.a.createElement(A.a,{onClickAway:function(){return c(null)}},u.a.createElement(Z.a,{color:"inherit",onClick:function(e){c(s?null:e.currentTarget)}},u.a.createElement(ga.a,null),u.a.createElement(ca.a,{open:d,anchorEl:s,placement:"bottom-end",className:a.popper,transition:!0},(function(a){var n=a.TransitionProps;return u.a.createElement(oa.a,Object.assign({},n,{timeout:250}),u.a.createElement(ua.a,{style:{textAlign:"center",padding:t.spacing(1)},elevation:4},u.a.createElement("div",{style:{maxWidth:r.topnav.apps.length<=4||Object(z.b)("xs",e.width)?"240px":"360px",display:"flex",flexDirection:"row",flexWrap:"wrap"}},r.topnav.apps.map((function(e,a){return u.a.createElement("div",{key:"box-".concat(a),style:{width:"120px",padding:p,overflow:"hidden"}},u.a.createElement(ma.a,{component:$t.a,target:e.newWindow?"_blank":null,href:e.route,key:"button-".concat(a),style:{display:"inherit",textDecoration:"none",fontWeight:400}},u.a.createElement("div",{style:{display:"inline-flex"}},u.a.createElement(da.a,{key:"avatar-".concat(a),variant:"rounded",alt:e.name,src:m?"string"===typeof e.img_d?e.img_d:null:"string"===typeof e.img_l?e.img_l:null,style:null===e.img_d||"string"===typeof e.img_d?{width:t.spacing(8),height:t.spacing(8)}:{backgroundColor:"transparent",width:t.spacing(8),height:t.spacing(8)}},m?null!==e.img_d&&"string"!==typeof e.img_d?e.img_d:e.alt:null!==e.img_l&&"string"!==typeof e.img_l?e.img_l:e.alt)),u.a.createElement(Kt.a,{key:"text-".concat(a),variant:"caption"},e.name)))})))))}))))})),ba=a(19),va=a(210),Ea=a(99),ya=a.n(Ea),Oa=function(){var e=Object(X.a)().t,t=Pa(),a=t.layoutProps,l=t.breadcrumbsEnabled,s=function(e){return Object(i.a)((function(t){var a;return{search:(a={flexGrow:1,position:"relative",borderRadius:t.shape.borderRadius,backgroundColor:Object(ba.c)(t.palette.text.primary,.04),"&:hover":{backgroundColor:Object(ba.c)(t.palette.text.primary,.06)},marginRight:t.spacing(2),marginLeft:0,width:"100%"},Object(r.a)(a,t.breakpoints.up("sm"),{width:"auto"}),Object(r.a)(a,t.breakpoints.up("md"),{maxWidth:e?300:"inherit"}),a),searchIcon:{padding:t.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit",width:"100%"},inputInput:{padding:t.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(t.spacing(4),"px)"),transition:t.transitions.create("width"),width:"100%"}}}))()}(a.allowBreadcrumbs&&l),c=Object(o.useState)(""),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Object(ue.g)(),f=a.topnav.quickSearchURI?a.topnav.quickSearchURI:"/search/",h=a.topnav.quickSearchParam?a.topnav.quickSearchParam:"q";return u.a.createElement("div",{className:s.search},u.a.createElement("form",{autoComplete:"off",onSubmit:function(e){e.preventDefault(),g.push("".concat(f,"?").concat(h,"=").concat(encodeURIComponent(d))),p("")}},u.a.createElement("div",{className:s.searchIcon},u.a.createElement(ya.a,null)),u.a.createElement(va.a,{onChange:function(e){return p(e.target.value)},placeholder:e("quicksearch.placeholder"),classes:{root:s.inputRoot,input:s.inputInput},value:d,inputProps:{"aria-label":e("quicksearch.aria")}})))},_a=a(401),xa=a.n(_a),wa=a(784),ja=a(785),ka=a(786);!function(e){e.EN="en",e.FR="fr"}(Gt||(Gt={}));var Sa=function(e){return pe.a.language===e.valueOf()},Ca=Object(z.a)()((function(e){var t=e.width,a=Object(v.a)(),n=Object(X.a)().t,r=ce().toggleTheme,i=Pa(),l=i.currentLayout,s=i.showQuickSearch,c=i.autoHideAppbar,o=i.layoutProps,m=i.breadcrumbsEnabled,d=i.breadcrumbsState,p=i.toggleLayout,g=i.toggleQuickSearch,f=i.toggleAutoHideAppbar,h=i.toggleShowBreadcrumbs,b=i.toggleBreadcrumbsState,E=o.allowAutoHideTopbar||o.allowBreadcrumbs||o.allowQuickSearch||o.allowReset||o.allowThemeSelection||o.allowTopbarModeSelection;return u.a.createElement("div",null,o.allowTranslate&&u.a.createElement(k.a,{dense:!0,subheader:u.a.createElement(wa.a,{disableSticky:!0},n("app.language"))},u.a.createElement(S.a,{dense:!0,button:!0,onClick:function(){pe.a.changeLanguage(Sa(Gt.EN)?Gt.FR.valueOf():Gt.EN.valueOf())}},u.a.createElement(T.a,{style:{margin:0}},u.a.createElement("div",{style:{display:"flex",alignItems:"center",flexDirection:"row",width:"100%",textAlign:"center",cursor:"pointer"}},u.a.createElement(Kt.a,{component:"div",variant:"body2"},"English"),u.a.createElement("div",{style:{flexGrow:1}},u.a.createElement(ja.a,{checked:Sa(Gt.FR),name:"langSwitch"})),u.a.createElement(Kt.a,{component:"div",variant:"body2"},"Fran\xe7ais"))))),o.allowTranslate&&E&&u.a.createElement(j.a,null),E&&u.a.createElement(k.a,{dense:!0,subheader:u.a.createElement(wa.a,{disableSticky:!0},n("personalization"))},o.allowThemeSelection&&u.a.createElement(S.a,{button:!0,onClick:r},u.a.createElement(T.a,null,n("personalization.dark")),u.a.createElement(ka.a,null,u.a.createElement(ja.a,{edge:"end",onChange:r,checked:"dark"===a.palette.type}))),o.allowTopbarModeSelection&&u.a.createElement(S.a,{button:!0,onClick:p},u.a.createElement(T.a,null,n("personalization.sticky")),u.a.createElement(ka.a,{onClick:p},u.a.createElement(ja.a,{edge:"end",checked:"top"===l}))),o.allowQuickSearch&&!Object(z.b)("xs",t)&&u.a.createElement(S.a,{button:!0,onClick:g},u.a.createElement(T.a,null,n("personalization.quicksearch")),u.a.createElement(ka.a,null,u.a.createElement(ja.a,{edge:"end",checked:s,onClick:g}))),o.allowAutoHideTopbar&&u.a.createElement(S.a,{button:!0,disabled:"top"===l,onClick:f},u.a.createElement(T.a,null,n("personalization.autohideappbar")),u.a.createElement(ka.a,null,u.a.createElement(ja.a,{edge:"end",disabled:"top"===l,checked:c&&"top"!==l,onClick:f}))),o.allowBreadcrumbs&&!Object(z.b)("sm",t)&&u.a.createElement(u.a.Fragment,null,u.a.createElement(S.a,{button:!0,onClick:h},u.a.createElement(T.a,null,n("personalization.showbreadcrumbs")),u.a.createElement(ka.a,null,u.a.createElement(ja.a,{edge:"end",checked:m,onClick:h}))),o.allowBreadcrumbsMinimize&&u.a.createElement(S.a,{button:!0,onClick:b,disabled:!m},u.a.createElement(T.a,null,n("personalization.minimizebreadcrumbs")),u.a.createElement(ka.a,null,u.a.createElement(ja.a,{edge:"end",disabled:!m,checked:m&&!d,onClick:b}))))),(o.allowTranslate||E)&&o.allowReset&&u.a.createElement(j.a,null),o.allowReset&&u.a.createElement(k.a,{dense:!0},u.a.createElement(S.a,{dense:!0,button:!0,onClick:function(){localStorage.clear(),window.location.reload()}},u.a.createElement(T.a,null,n("personalization.reset_text")))))})),Ta=function(){var e=Object(v.a)(),t=Object(i.a)((function(e){return{popper:{zIndex:e.zIndex.drawer+2,minWidth:"280px"}}}))(),a=Object(o.useState)(null),r=Object(n.a)(a,2),l=r[0],s=r[1],c=Pa().layoutProps,m=!!l;return c.allowAutoHideTopbar||c.allowBreadcrumbs||c.allowQuickSearch||c.allowReset||c.allowThemeSelection||c.allowTopbarModeSelection||c.allowTranslate||c.allowReset?u.a.createElement(A.a,{onClickAway:function(){return s(null)}},u.a.createElement(Z.a,{color:"inherit","aria-label":"open drawer",onClick:function(e){s(l?null:e.currentTarget)},edge:"start"},u.a.createElement(xa.a,null),u.a.createElement(ca.a,{open:m,anchorEl:l,className:t.popper,placement:"bottom-end",transition:!0},(function(t){var a=t.TransitionProps;return u.a.createElement(oa.a,Object.assign({},a,{timeout:250}),u.a.createElement(ua.a,{style:{padding:e.spacing(1)},elevation:4},u.a.createElement(Ca,null)))})))):null},Aa=a(490),Na=function(e){return Object(o.useMemo)((function(){return null!==e?"https://s.gravatar.com/avatar/".concat(Aa(e),"?d=404"):null}),[e])},Ia=Object(i.a)((function(e){return{popper:{zIndex:e.zIndex.appBar+200,minWidth:"280px"},avatarButton:{padding:0,marginLeft:e.spacing(1),marginRight:e.spacing(1)},iconButton:Object(r.a)({width:e.spacing(5),height:e.spacing(5)},e.breakpoints.down("xs"),{width:e.spacing(4),height:e.spacing(4)})}})),Ra=function(){var e=Ia(),t=Object(v.a)(),a=x().user,r=Pa().layoutProps,i=Na(r.allowGravatar?a.email:null),l=Object(o.useState)(null),s=Object(n.a)(l,2),c=s[0],m=s[1],d=t.spacing(2),p=t.spacing(3),g=r.allowAutoHideTopbar||r.allowBreadcrumbs||r.allowQuickSearch||r.allowReset||r.allowThemeSelection||r.allowTopbarModeSelection,f=!!c,h=function(e,t,a){return void 0!==t&&null!==t&&0!==t.length?u.a.createElement("div",null,u.a.createElement(j.a,null),u.a.createElement(k.a,{dense:!0,subheader:u.a.createElement(wa.a,{disableSticky:!0},a)},t.map((function(t,a){return u.a.createElement(S.a,{button:!0,component:Y.b,to:t.route,key:"".concat(e,"-").concat(a)},t.icon&&u.a.createElement(C.a,null,t.icon),u.a.createElement(T.a,null,t.name))})))):null};return u.a.createElement(A.a,{onClickAway:function(){return m(null)}},u.a.createElement(Z.a,{edge:"end",className:e.avatarButton,onClick:function(e){m(c?null:e.currentTarget)}},u.a.createElement(da.a,{className:e.iconButton,alt:a.name,src:a.avatar?a.avatar:i},a.name.split(" ",2).map((function(e){return e[0].toUpperCase()})).join("")),u.a.createElement(ca.a,{open:f,anchorEl:c,className:e.popper,placement:"bottom-end",transition:!0},(function(e){var n=e.TransitionProps;return u.a.createElement(oa.a,Object.assign({},n,{timeout:250}),u.a.createElement(ua.a,{style:{padding:t.spacing(1)},elevation:4},u.a.createElement(k.a,{disablePadding:!0},u.a.createElement(S.a,{disableGutters:!0,dense:!0},u.a.createElement("div",{style:{display:"flex",paddingTop:d,paddingBottom:d,paddingLeft:p,paddingRight:p,alignItems:"center"}},u.a.createElement(da.a,{style:{width:t.spacing(8),height:t.spacing(8)},alt:a.name,src:a.avatar?a.avatar:i},a.name.split(" ",2).map((function(e){return e[0].toUpperCase()})).join("")),u.a.createElement("div",{style:{paddingLeft:d}},u.a.createElement(Kt.a,{variant:"body1",noWrap:!0},u.a.createElement("b",null,a.name)),u.a.createElement(Kt.a,{variant:"caption",noWrap:!0},a.email))))),h("usermenu",r.topnav.userMenu,r.topnav.userMenuTitle),a.is_admin&&h("adminmenu",r.topnav.adminMenu,r.topnav.adminMenuTitle),"profile"===r.topnav.themeSelectionUnder&&(g||r.allowTranslate||r.allowReset)?u.a.createElement("div",null,u.a.createElement(j.a,null),u.a.createElement(Ca,null)):null))}))))},za=Object(i.a)((function(e){return{appBarTopLayout:{zIndex:e.zIndex.drawer+1},appBar:Object(r.a)({"@media print":{display:"none !important"}},e.breakpoints.only("xs"),{zIndex:e.zIndex.drawer-1}),toolbar:Object(r.a)({},e.breakpoints.only("xs"),{}),menuButton:Object(r.a)({display:"none"},e.breakpoints.down("xs"),{display:"inline-block"}),topBarLeft:{display:"flex",flexDirection:"row",alignItems:"center"},leftSpacer:{marginLeft:e.spacing(3)}}}));function Da(e){var t=e.children,a=e.show;return u.a.createElement(le.a,{appear:!1,direction:"down",in:a,mountOnEnter:!0,unmountOnExit:!0},t)}var Ba=Object(z.a)()((function(e){var t=e.width,a=Pa(),n=a.currentLayout,r=a.layoutProps,i=a.showQuickSearch,s=a.autoHideAppbar,c=a.breadcrumbsEnabled,m=a.appbarState,d=Object(v.a)(),p=ce().getAppbarStyles,g=za(n),f="top"===n,h=Object(l.a)(d.breakpoints.only("xs")),E=Object(l.a)(d.breakpoints.down("sm")),y=p(n),O=y.elevation,_=Object(b.a)(y,["elevation"]),x=r.topnav,j=x.left,k=x.leftAfterBreadcrumbs;Object(o.useLayoutEffect)((function(){window.dispatchEvent(new CustomEvent("tui.event.appbar.ready"))}),[]);var S=!f&&s;return u.a.createElement(Da,{show:m},u.a.createElement(ie.a,{elevation:O,position:S&&!f?"relative":"sticky",id:"appbar",className:"".concat(g.appBar," ").concat(f&&g.appBarTopLayout),style:_},u.a.createElement(w.a,{disableGutters:!0,className:g.toolbar,style:{paddingLeft:h||f?null:d.spacing(2),paddingRight:d.spacing(1)}},u.a.createElement("div",{className:g.topBarLeft},u.a.createElement(ae,{disabled:!f&&!h,noTitle:h}),u.a.createElement("div",{className:f?g.leftSpacer:null}),j,c&&!E&&u.a.createElement(sa,null),k),(h||j||k||c&&!E||!i&&!c||!i&&c&&E)&&u.a.createElement("div",{style:{flexGrow:1}}),i&&Object(z.c)("sm",t)&&u.a.createElement(Oa,null),"icon"===r.topnav.themeSelectionUnder&&u.a.createElement(Ta,null),r.topnav.right,u.a.createElement(ha,null),u.a.createElement(Ra,null))))})),qa=Object(i.a)((function(e){return{appVertical:{height:"100%",display:"flex",flexDirection:"row",position:"relative"},appVerticalLeft:Object(r.a)({height:"100%"},e.breakpoints.down("sm"),{position:"absolute",top:0,left:0,bottom:0}),appVerticalRight:{"@media print":{overflow:"unset !important"},display:"flex",flexDirection:"column",position:"relative",flex:1,height:"100%"},appVerticalRightContent:{height:"auto",display:"flex",flexDirection:"column",flexGrow:1},appHorizontal:{"@media print":{overflow:"unset !important"},height:"100%",display:"flex",flexDirection:"column"}}})),La=u.a.createContext(null);var Fa=function(e){var t,a=e.children,r=Object(b.a)(e,["children"]),i=x().isReady,s=localStorage.getItem("navLayout");t=s&&"top"===s?"top":s&&"side"===s?"side":r.defaultLayout;var c=localStorage.getItem("drawerOpen"),m=c?!!JSON.parse(c):r.defaultDrawerOpen,d=localStorage.getItem("showQuickSearch"),p=d?!!JSON.parse(d):r.defaultShowQuickSearch,g=localStorage.getItem("autoHideAppbar"),f=g?!!JSON.parse(g):r.defaultAutoHideAppbar,y=localStorage.getItem("breadcrumbsEnabled"),O=y?!!JSON.parse(y):r.defaultShowBreadcrumbs,_=localStorage.getItem("breadcrumbsState"),w=_?!!JSON.parse(_):r.defaultBreadcrumbsOpen,j=Object(o.useState)(!1),k=Object(n.a)(j,2),S=k[0],C=k[1],T=Object(o.useState)(!0),A=Object(n.a)(T,2),N=A[0],I=A[1],R=Object(o.useState)(m),z=Object(n.a)(R,2),D=z[0],B=z[1],q=Object(o.useState)(!0),L=Object(n.a)(q,2),F=L[0],P=L[1],M=Object(o.useState)(O),W=Object(n.a)(M,2),U=W[0],H=W[1],V=Object(o.useState)(w),G=Object(n.a)(V,2),Y=G[0],J=G[1],Q=Object(o.useState)(p),K=Object(n.a)(Q,2),X=K[0],Z=K[1],$=Object(o.useState)(f),ee=Object(n.a)($,2),te=ee[0],ae=ee[1],ne=Object(o.useState)(t),ie=Object(n.a)(ne,2),le=ie[0],se=ie[1],ce=Object(v.a)(),oe=Object(l.a)(ce.breakpoints.only("sm")),ue=Object(l.a)("print"),me=qa();return u.a.createElement(La.Provider,{value:{autoHideAppbar:te,appbarState:F,currentLayout:le,drawerState:D,breadcrumbsEnabled:U,breadcrumbsState:Y,hideNestedIcons:!!r.leftnav.hideNestedIcons,layoutProps:Object(h.a)({allowAutoHideTopbar:!0,allowBreadcrumbs:!0,allowBreadcrumbsMinimize:!0,allowQuickSearch:!0,allowReset:!0,allowTopbarModeSelection:!0,allowThemeSelection:!0,allowTranslate:!0},r),showQuickSearch:X,getBanner:function(e){return"dark"===e.palette.type?r.bannerDark:r.bannerLight},getLogo:function(e){return"dark"===e.palette.type?r.appIconDark:r.appIconLight},hideMenus:function(){return I(!1)},toggleLayout:function(){var e="top"===le?"side":"top";localStorage.setItem("navLayout",e),se(e)},toggleDrawer:function(){localStorage.setItem("drawerOpen",JSON.stringify(!D)),B(!D)},toggleQuickSearch:function(){localStorage.setItem("showQuickSearch",JSON.stringify(!X)),Z(!X)},toggleAutoHideAppbar:function(){localStorage.setItem("autoHideAppbar",JSON.stringify(!te)),ae(!te)},toggleShowBreadcrumbs:function(){localStorage.setItem("breadcrumbsEnabled",JSON.stringify(!U)),H(!U)},toggleBreadcrumbsState:function(){localStorage.setItem("breadcrumbsState",JSON.stringify(!Y)),J(!Y)},isReady:function(){return S},setReady:function(e){return C(e)},setAppbarState:P}},u.a.createElement(u.a.Fragment,null,u.a.createElement(E.a,null),"side"===le?u.a.createElement("div",{className:me.appVertical},u.a.createElement("div",{className:me.appVerticalLeft},i()&&S&&N&&u.a.createElement(re,null)),u.a.createElement("div",{id:"app-scrollct",className:me.appVerticalRight,style:{overflow:"auto",paddingLeft:N&&oe&&!ue?ce.spacing(7):0}},i()&&S&&N&&u.a.createElement(Ba,null),a)):u.a.createElement("div",{id:"app-scrollct",className:me.appHorizontal,style:{overflow:"auto"}},i()&&S&&N&&u.a.createElement(Ba,null),u.a.createElement("div",{className:me.appVertical},u.a.createElement("div",{className:me.appVerticalLeft},i()&&S&&N&&u.a.createElement(re,null)),u.a.createElement("div",{className:me.appVerticalRight,style:{paddingLeft:N&&oe&&!ue?ce.spacing(7):0}},a)))))};function Pa(){return Object(o.useContext)(La)}function Ma(){return Object(o.useContext)(y)}var Wa=a(144),Ua=a.n(Wa),Ha=a(128),Va=a.n(Ha),Ga=a(61),Ya=a.n(Ga),Ja=a(193),Qa=a.n(Ja),Ka=a(189),Xa=a.n(Ka),Za=a(402),$a=a.n(Za),en=a(191),tn=a.n(en),an=a(188),nn=a.n(an),rn=a(64),ln=a.n(rn),sn=a(403),cn=a.n(sn),on=a(122),un=a.n(on),mn=a(192),dn=a.n(mn),pn=a(194),gn=a.n(pn),fn=a(197),hn=a.n(fn),bn=a(187),vn=a.n(bn),En=a(143),yn=a.n(En),On=a(195),_n=a.n(On),xn=a(196),wn=a.n(xn),jn=a(190),kn=a.n(jn),Sn=a(198),Cn=a.n(Sn),Tn=a(95),An=function(){var e=Object(X.a)().t,t=Object(v.a)(),a=Object(l.a)(t.breakpoints.only("xs")),n=[{type:"item",element:{id:"submit",text:e("drawer.submit"),icon:u.a.createElement(yn.a,null),route:"/submit",nested:!1}},{type:"item",element:{id:"submissions",text:e("drawer.submissions"),icon:u.a.createElement(Ya.a,null),route:"/submissions",nested:!1}},{type:"item",element:{id:"alerts",text:e("drawer.alerts"),icon:u.a.createElement(vn.a,null),route:"/alerts",nested:!1}},{type:"group",element:{id:"search",title:e("drawer.search"),icon:u.a.createElement(ya.a,null),items:[{id:"search.all",text:e("drawer.search.all"),route:"/search",nested:!0},{id:"search.alert",text:e("drawer.search.alert"),route:"/search/alert",nested:!0},{id:"search.file",text:e("drawer.search.file"),route:"/search/file",nested:!0},{id:"search.result",text:e("drawer.search.result"),route:"/search/result",nested:!0},{id:"search.signature",text:e("drawer.search.signature"),route:"/search/signature",nested:!0},{id:"search.submission",text:e("drawer.search.submission"),route:"/search/submission",nested:!0}]}},{type:"divider",element:null},{type:"item",element:{id:"dashboard",text:e("drawer.dashboard"),icon:u.a.createElement(nn.a,null),route:"/dashboard",nested:!1}},{type:"group",element:{id:"manage",title:e("drawer.manage"),icon:u.a.createElement(Xa.a,null),items:[{id:"manage.heuristics",text:e("drawer.manage.heuristics"),icon:u.a.createElement(kn.a,null),route:"/manage/heuristics",nested:!0},{id:"manage.signatures",text:e("drawer.manage.signatures"),icon:u.a.createElement(un.a,null),route:"/manage/signatures",nested:!0},{id:"manage.source",text:e("drawer.manage.source"),userPropValidators:[{prop:"user.is_admin",value:!0},{prop:"user.roles",value:"signature_manager"}],icon:u.a.createElement(tn.a,null),route:"/manage/sources",nested:!0},{id:"manage.workflow",text:e("drawer.manage.workflow"),icon:u.a.createElement(Tn.a,null),route:"/manage/workflows",nested:!0}]}},{type:"divider",element:null},{type:"group",element:{id:"help",title:e("drawer.help"),icon:u.a.createElement(dn.a,null),items:[{id:"help.api",text:e("drawer.help.api"),icon:u.a.createElement(Qa.a,null),route:"/help/api",nested:!0},{id:"help.classification",text:e("drawer.help.classification"),userPropValidators:[{prop:"c12nDef.enforce",value:!0}],icon:u.a.createElement(gn.a,null),route:"/help/classification",nested:!0},{id:"help.configuration",text:e("drawer.help.configuration"),icon:u.a.createElement(_n.a,null),route:"/help/configuration",nested:!0},{id:"help.search",text:e("drawer.help.search"),icon:u.a.createElement(ya.a,null),route:"/help/search",nested:!0},{id:"help.services",text:e("drawer.help.services"),icon:u.a.createElement(Va.a,null),route:"/help/services",nested:!0}]}}],r=[{name:e("usermenu.account"),route:"/account",icon:u.a.createElement(Ua.a,null)},{name:e("usermenu.settings"),route:"/settings",icon:u.a.createElement(wn.a,null)},{name:e("usermenu.optout"),route:"/optout",icon:u.a.createElement($a.a,null)},{name:e("usermenu.logout"),route:"/logout",icon:u.a.createElement(cn.a,null)}],i=[{name:e("adminmenu.errors"),route:"/admin/errors",icon:u.a.createElement(ln.a,null)},{name:e("adminmenu.services"),route:"/admin/services",icon:u.a.createElement(Va.a,null)},{name:e("adminmenu.sitemap"),route:"/admin/sitemap",icon:u.a.createElement(hn.a,null)},{name:e("adminmenu.users"),route:"/admin/users",icon:u.a.createElement(Cn.a,null)}],s=u.a.createElement("img",{alt:e("logo.alt"),src:"".concat("","/images/al_dark.svg"),width:"40",height:"32",style:{marginLeft:"-5px"}}),c=u.a.createElement("img",{alt:e("logo.alt"),src:"".concat("","/images/al.svg"),width:"40",height:"32",style:{marginLeft:"-5px"}}),o=u.a.createElement("img",{style:{display:"inline-block",width:"100%",margin:"".concat(a?2:3,"rem 0")},src:"".concat("","/images/banner_dark.svg"),alt:e("banner.alt")});return{appName:"Assemblyline",allowBreadcrumbsMinimize:!1,allowReset:!1,appIconDark:s,appIconLight:c,bannerLight:u.a.createElement("img",{style:{display:"inline-block",width:"100%",margin:"".concat(a?2:3,"rem 0")},src:"".concat("","/images/banner.svg"),alt:e("banner.alt")}),bannerDark:o,defaultLayout:"side",defaultDrawerOpen:!1,defaultShowQuickSearch:!0,defaultAutoHideAppbar:!0,defaultShowBreadcrumbs:!0,defaultBreadcrumbsOpen:!0,leftnav:{elements:n,hideNestedIcons:!0},topnav:{adminMenu:i,adminMenuTitle:e("adminmenu"),apps:[],quickSearchURI:"/search",quickSearchParam:"query",themeSelectionUnder:"icon",userMenu:r,userMenuTitle:e("usermenu")}}},Nn=a(405),In=a.n(Nn),Rn=a(68),zn=a.n(Rn),Dn=a(407),Bn=a.n(Dn),qn=a(200),Ln=a.n(qn),Fn=a(199),Pn=a.n(Fn),Mn=a(404),Wn=a.n(Mn),Un=a(145),Hn=a.n(Un),Vn=a(212),Gn=a.n(Vn),Yn=a(123),Jn=a.n(Yn),Qn=a(406),Kn=a.n(Qn),Xn=a(408),Zn=a.n(Xn);function $n(){var e=Object(d.b)(),t=e.enqueueSnackbar,a=e.closeSnackbar,n={preventDuplicate:!0,anchorOrigin:{vertical:"bottom",horizontal:"center"},onClick:function(e){a()}};return{showErrorMessage:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;t(e,Object(h.a)({variant:"error",autoHideDuration:a},n))},showWarningMessage:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;t(e,Object(h.a)({variant:"warning",autoHideDuration:a},n))},showSuccessMessage:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;t(e,Object(h.a)({variant:"success",autoHideDuration:a},n))},showInfoMessage:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;t(e,Object(h.a)({variant:"info",autoHideDuration:a},n))},closeSnackbar:a}}function er(){var e=Object(o.useState)(null),t=Object(n.a)(e,2),a=t[0],r=t[1],i=Object(o.useState)(null),l=Object(n.a)(i,2),s=l[0],c=l[1],u=Object(o.useState)(null),m=Object(n.a)(u,2),d=m[0],p=m[1],g=Object(o.useState)(null),f=Object(n.a)(g,2),h=f[0],v=f[1],E=Object(o.useState)(null),y=Object(n.a)(E,2),O=y[0],_=y[1],x=Object(o.useState)(null),w=Object(n.a)(x,2),j=w[0],k=w[1];var S=function(e){var t=j[e.prop];return Array.isArray(t)?-1!==t.indexOf(e.value):t===e.value};return{c12nDef:s,configuration:d,indexes:h,settings:O,user:a,setUser:function(e){var t=e.configuration,a=e.c12nDef,n=e.indexes,i=e.settings,l=Object(b.a)(e,["configuration","c12nDef","indexes","settings"]);c(a),p(t),v(n),r(l),_(i),k(function e(t){var a={};for(var n in t)if({}.hasOwnProperty.call(t,n))if("object"==typeof t[n]){var r=e(t[n]);for(var i in r)({}).hasOwnProperty.call(r,i)&&(a["".concat(n,".").concat(i)]=r[i])}else a[n]=t[n];return a}({user:l,c12nDef:a,configuration:t,indexes:n,settings:i}))},setConfiguration:p,isReady:function(){return!(null===a||!a.agrees_with_tos&&d.ui.tos||!a.is_active)},validateProps:function(e){return void 0===e||e.some(S)}}}var tr=a(789);var ar=function(){var e=Object(v.a)(),t=Pa().getBanner;return u.a.createElement("div",{style:{textAlign:"center",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},t(e),u.a.createElement(tr.a,{variant:"indeterminate"}))},nr=a(409),rr=a.n(nr),ir=function(e){var t,a,n=e.children,s=e.margin,c=void 0===s?null:s,o=e.maxWidth,m=void 0===o?"1200px":o,d=e.mb,p=void 0===d?2:d,g=e.ml,f=void 0===g?2:g,h=e.mr,b=void 0===h?2:h,E=e.mt,y=void 0===E?2:E,O=e.width,_=(t=void 0===O?"95%":O,a=m,Object(i.a)((function(e){return{page:Object(r.a)({textAlign:"center",margin:"0 auto auto auto",width:t,maxWidth:a},e.breakpoints.down("xs"),{maxWidth:"100%"})}}))()),x=Object(v.a)(),w=Object(l.a)(x.breakpoints.up("md"))?1:2;return u.a.createElement("div",{className:_.page},u.a.createElement("div",{style:{marginBottom:x.spacing(c/w||p/w),marginLeft:x.spacing(c/w||f/w),marginRight:x.spacing(c/w||b/w),marginTop:x.spacing(c/w||y/w)}},n))},lr=function(e){var t=e.disabled,a=void 0!==t&&t,n=Object(X.a)(["error403"]).t,r=Object(v.a)();return u.a.createElement(ir,{width:"65%",margin:4},u.a.createElement("div",{style:{paddingTop:r.spacing(10),fontSize:200}},u.a.createElement(zn.a,{style:{color:"dark"===r.palette.type?r.palette.error.light:r.palette.error.dark},fontSize:"inherit"})),u.a.createElement("div",{style:{paddingBottom:r.spacing(2)}},u.a.createElement(Kt.a,{variant:"h3"},n("title"))),a?u.a.createElement("div",null,u.a.createElement(Kt.a,{variant:"h6"},n("disabled"))):u.a.createElement("div",null,u.a.createElement(Kt.a,{variant:"h6"},n("not_allowed"))))},sr=function(){var e=Object(X.a)(["locked"]).t,t=Ma().configuration,a=Object(v.a)();return u.a.createElement(u.a.Fragment,null,t.ui.tos?u.a.createElement(ir,{width:"65%",margin:4},u.a.createElement("div",{style:{paddingTop:a.spacing(10),fontSize:200}},u.a.createElement(rr.a,{color:"secondary",fontSize:"inherit"})),u.a.createElement("div",{style:{paddingBottom:a.spacing(2)}},u.a.createElement(Kt.a,{variant:"h3"},e("title"))),t.ui.tos_lockout_notify?u.a.createElement("div",null,u.a.createElement(Kt.a,{variant:"h6"},e("auto_notify"))):u.a.createElement("div",null,u.a.createElement(Kt.a,{variant:"h6"},e("contact_admin")))):u.a.createElement(lr,{disabled:!0}))},cr=a(790),or=Object(i.a)((function(e){var t;return{card:(t={display:"flex",flexDirection:"column",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",maxWidth:"22rem",backgroundColor:e.palette.background.paper,borderRadius:"4px"},Object(r.a)(t,e.breakpoints.down("xs"),{backgroundColor:e.palette.background.default,width:"100%",maxWidth:"22rem",padding:"0rem 1rem 3rem"}),Object(r.a)(t,e.breakpoints.up("sm"),{width:"22rem",padding:"0 2rem 3rem"}),t)}}));var ur=function(e){var t=e.children,a=Object(v.a)(),n=Object(l.a)(a.breakpoints.only("xs")),r=or();return u.a.createElement(cr.a,{elevation:n?0:4,className:r.card},t)};function mr(){var e=null;if(void 0!==document.cookie)try{e=document.cookie.split("; ").find((function(e){return e.startsWith("XSRF-TOKEN")})).split("=")[1]}catch(t){}return e}function dr(){var e=Object(X.a)().t,t=$n().showErrorMessage;return function(a){var n=a.url,r=a.contentType,i=void 0===r?"application/json":r,l=a.method,s=void 0===l?"GET":l,c=a.body,o=void 0===c?null:c,u=a.reloadOnUnauthorize,m=void 0===u||u,d=a.onSuccess,p=a.onFailure,g=a.onEnter,f=a.onExit,h=a.onFinalize,b={method:s,credentials:"same-origin",headers:{"Content-Type":i,"X-XSRF-TOKEN":mr()},body:null!==o?"application/json"===i?JSON.stringify(o):o:null};g&&g(),fetch(n,b).then((function(e){return 401===e.status&&m&&window.location.reload(!1),e.json()})).catch((function(t){return console.error(t),{api_error_message:e("api.unreachable"),api_response:"",api_server_version:"4.0.0",api_status_code:400}})).then((function(a){if(f&&f(),void 0!==a&&a.hasOwnProperty("api_status_code")){if(401===a.api_status_code&&m)return;200!==a.api_status_code?p?p(a):t(a.api_error_message):d&&d(a)}else t(e("api.invalid"));h&&h(a)}))}}var pr=a(791),gr=Object(i.a)((function(){return Object(G.a)({buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})}));function fr(e){var t=e.avatar,a=e.username,n=e.email,r=e.oAuthToken,i=e.buttonLoading,l=e.onSubmit,s=e.reset,c=Object(X.a)(["login"]).t,o=gr(),m=Object(v.a)();return u.a.createElement("form",{onSubmit:l},u.a.createElement("div",{style:{display:"flex",flexDirection:"column",textAlign:"center",justifyContent:"center"}},r?u.a.createElement(da.a,{style:{alignSelf:"center",width:m.spacing(18),height:m.spacing(18)},src:t}):u.a.createElement(pr.a,{variant:"circle",style:{alignSelf:"center"},width:144,height:144}),u.a.createElement(Kt.a,{color:"textPrimary"},r?a:u.a.createElement(pr.a,null)),u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},r?n:u.a.createElement(pr.a,null)),r?u.a.createElement(ma.a,{type:"submit",style:{marginTop:"1.5rem",marginBottom:"1.5rem"},variant:"contained",color:"primary",disabled:i},c("button"),i&&u.a.createElement(tr.a,{size:24,className:o.buttonProgress})):u.a.createElement(pr.a,{variant:"rect",style:{height:"36px",marginTop:"1.5rem",marginBottom:"1.5rem"}}),r?u.a.createElement($t.a,{variant:"body2",href:"#",onClick:s},c("other")):u.a.createElement(pr.a,null)))}var hr=a(792),br=Object(i.a)((function(){return Object(G.a)({buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})}));function vr(e){var t=e.onSubmit,a=e.buttonLoading,n=e.setOneTimePass,r=Object(X.a)(["login"]).t,i=br();return u.a.createElement("form",{onSubmit:t},u.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},u.a.createElement(hr.a,{inputProps:{maxLength:6},autoFocus:!0,variant:"outlined",size:"small",label:r("otp"),onChange:function(e){return n(e.target.value)}}),u.a.createElement(ma.a,{type:"submit",style:{marginTop:"1.5rem"},variant:"contained",color:"primary",disabled:a},r("button"),a&&u.a.createElement(tr.a,{size:24,className:i.buttonProgress}))))}var Er=Object(i.a)((function(){return Object(G.a)({buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})}));function yr(e){var t=e.buttonLoading,a=e.setButtonLoading,r=Object(ue.h)(),i=Object(ue.g)(),l=Object(X.a)(["login"]).t,s=Er(),c=dr(),m=new URLSearchParams(r.search),d=Object(o.useState)(""),p=Object(n.a)(d,2),g=p[0],f=p[1],h=Object(o.useState)(""),b=Object(n.a)(h,2),v=b[0],E=b[1],y=Object(o.useState)(""),O=Object(n.a)(y,2),_=O[0],x=O[1],w=Object(o.useState)(!1),j=Object(n.a)(w,2),k=j[0],S=j[1];return Object(o.useEffect)((function(){f(m.get("reset_id")),m.get("reset_id")&&i.push("/")}),[]),u.a.createElement("form",{onSubmit:function(e){c({url:"/api/v4/auth/reset_pwd/",method:"POST",body:{reset_id:g,password:v,password_confirm:_},onEnter:function(){return a(!0)},onExit:function(){return a(!1)},onSuccess:function(){S(!0),setTimeout((function(){return window.location.reload(!1)}),7e3)}}),e.preventDefault()}},u.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},k?u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{align:"center",variant:"h6",gutterBottom:!0},l("reset_now.done")),u.a.createElement(Kt.a,{align:"center",variant:"caption"},l("reset_now.redirect"))):u.a.createElement(u.a.Fragment,null,u.a.createElement(hr.a,{autoFocus:!0,type:"password",variant:"outlined",size:"small",label:l("reset_now.password"),onChange:function(e){return E(e.target.value)}}),u.a.createElement(hr.a,{style:{marginTop:".5rem"},type:"password",variant:"outlined",size:"small",label:l("reset_now.password_confirm"),onChange:function(e){return x(e.target.value)}}),u.a.createElement(ma.a,{type:"submit",style:{marginTop:"1.5rem"},variant:"contained",color:"primary",disabled:t},l("reset_now.button"),t&&u.a.createElement(tr.a,{size:24,className:s.buttonProgress})))))}function Or(e){var t=e.buttonLoading,a=e.setButtonLoading,r=Object(X.a)(["login"]).t,i=Er(),l=dr(),s=Object(o.useState)(""),c=Object(n.a)(s,2),m=c[0],d=c[1],p=Object(o.useState)(!1),g=Object(n.a)(p,2),f=g[0],h=g[1];return u.a.createElement("form",{onSubmit:function(e){l({url:"/api/v4/auth/get_reset_link/",method:"POST",body:{email:m},onEnter:function(){return a(!0)},onExit:function(){return a(!1)},onSuccess:function(){return h(!0)}}),e.preventDefault()}},u.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},f?u.a.createElement(Kt.a,{align:"center"},r("reset.done")):u.a.createElement(u.a.Fragment,null,u.a.createElement(hr.a,{autoFocus:!0,type:"email",variant:"outlined",size:"small",label:r("reset.email"),onChange:function(e){return d(e.target.value)}}),u.a.createElement(ma.a,{type:"submit",style:{marginTop:"1.5rem"},variant:"contained",color:"primary",disabled:t},r("reset.button"),t&&u.a.createElement(tr.a,{size:24,className:i.buttonProgress})))))}var _r=a(410),xr=a.n(_r);function wr(e){for(var t=new Uint8Array(e.length),a=0;a<t.length;a++)t[a]=e[a];return t}var jr=a(273);function kr(e){var t=e.username,a=e.setShownControls,n=e.setWebAuthNResponse,r=Object(X.a)(["login"]).t,i=dr(),l=$n().showErrorMessage;return Object(o.useEffect)((function(){i({url:"/api/v4/webauthn/authenticate/begin/".concat(t,"/"),onSuccess:function(e){var t=wr(e.api_response),i=jr.decode(t.buffer),s=navigator.credentials;void 0!==s?s.get(i).then((function(e){var t=e.response,a=jr.encode({credentialId:new Uint8Array(e.rawId),authenticatorData:new Uint8Array(t.authenticatorData),clientDataJSON:new Uint8Array(t.clientDataJSON),signature:new Uint8Array(t.signature)});n(Array.from(new Uint8Array(a)))})).catch((function(e){console.log("".concat(e.name,": ").concat(e.message)),a("otp"),l(r("securitytoken.error"))})):(a("otp"),l(r("securitytoken.unavailable")))}})}),[]),u.a.createElement("div",{style:{display:"flex",flexDirection:"column",textAlign:"center"}},u.a.createElement("div",null,u.a.createElement(xr.a,{style:{fontSize:"108pt"},color:"action"})),u.a.createElement(Kt.a,{variant:"h6",color:"textSecondary"},r("securitytoken")))}var Sr=Object(i.a)((function(){return Object(G.a)({buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})}));function Cr(e){var t=e.buttonLoading,a=e.setButtonLoading,r=Object(X.a)(["login"]).t,i=Sr(),l=dr(),s=Object(o.useState)(""),c=Object(n.a)(s,2),m=c[0],d=c[1],p=Object(o.useState)(""),g=Object(n.a)(p,2),f=g[0],h=g[1],b=Object(o.useState)(""),v=Object(n.a)(b,2),E=v[0],y=v[1],O=Object(o.useState)(""),_=Object(n.a)(O,2),x=_[0],w=_[1],j=Object(o.useState)(!1),k=Object(n.a)(j,2),S=k[0],C=k[1];return u.a.createElement("form",{onSubmit:function(e){l({url:"/api/v4/auth/signup/",method:"POST",body:{user:m,password:E,password_confirm:x,email:f},onEnter:function(){return a(!0)},onExit:function(){return a(!1)},onSuccess:function(){return C(!0)}}),e.preventDefault()}},u.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},S?u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{align:"center"},r("signup.done"))):u.a.createElement(u.a.Fragment,null,u.a.createElement(hr.a,{autoFocus:!0,inputProps:{autoCorrect:"off",autoCapitalize:"off"},variant:"outlined",size:"small",label:r("signup.username"),onChange:function(e){return d(e.target.value)}}),u.a.createElement(hr.a,{style:{marginTop:".5rem"},type:"password",variant:"outlined",size:"small",label:r("signup.password"),onChange:function(e){return y(e.target.value)}}),u.a.createElement(hr.a,{style:{marginTop:".5rem"},type:"password",variant:"outlined",size:"small",label:r("signup.password_confirm"),onChange:function(e){return w(e.target.value)}}),u.a.createElement(hr.a,{inputProps:{autoCorrect:"off",autoCapitalize:"off"},style:{marginTop:".5rem"},variant:"outlined",size:"small",label:r("signup.email"),onChange:function(e){return h(e.target.value)}}),u.a.createElement(ma.a,{type:"submit",style:{marginTop:"1.5rem"},variant:"contained",color:"primary",disabled:t},r("signup.button"),t&&u.a.createElement(tr.a,{size:24,className:i.buttonProgress})))))}var Tr=Object(i.a)((function(){return Object(G.a)({buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})}));function Ar(e){var t=e.onSubmit,a=e.buttonLoading,n=e.setPassword,r=e.setUsername,i=Object(X.a)(["login"]).t,l=Tr();return u.a.createElement("form",{onSubmit:t},u.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},u.a.createElement(hr.a,{autoFocus:!0,inputProps:{autoCorrect:"off",autoCapitalize:"off"},variant:"outlined",size:"small",label:i("username"),onChange:function(e){return r(e.target.value)}}),u.a.createElement(hr.a,{style:{marginTop:".5rem"},variant:"outlined",size:"small",type:"password",label:i("password"),onChange:function(e){return n(e.target.value)}}),u.a.createElement(ma.a,{type:"submit",style:{marginTop:"1.5rem"},variant:"contained",color:"primary",disabled:a},i("button"),a&&u.a.createElement(tr.a,{size:24,className:l.buttonProgress}))))}var Nr=function(e){var t=e.forcePaper,a=void 0!==t&&t,n=Object(X.a)().t,l=Object(i.a)((function(e){return{divider:{display:"inline-block",textAlign:"center",width:"100%",margin:"30px 0",position:"relative",borderTop:"1px solid ".concat(e.palette.divider)},inner:Object(r.a)({backgroundColor:e.palette.background.paper,left:"50%",marginLeft:"-30px",position:"absolute",top:"-10px",width:"60px"},e.breakpoints.down("xs"),{backgroundColor:a?e.palette.background.paper:e.palette.background.default})}}))();return u.a.createElement("div",null,u.a.createElement("div",{className:l.divider},u.a.createElement("div",{className:l.inner},n("divider"))))},Ir=Object(i.a)((function(e){return Object(G.a)({buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})}));function Rr(e){var t=e.allowUserPass,a=e.allowSignup,r=e.allowPWReset,i=e.oAuthProviders,l=Object(ue.h)(),s=Object(ue.g)(),c=new URLSearchParams(l.search),m=Object(X.a)(["login"]).t,d=Object(v.a)(),p=Ir(),g=dr(),f=Pa().getBanner,h=Object(o.useState)(c.get("provider")?"oauth":c.get("reset_id")?"reset_now":"login"),b=Object(n.a)(h,2),E=b[0],y=b[1],O=$n(),_=O.showErrorMessage,x=O.showSuccessMessage,w=Object(o.useState)(""),j=Object(n.a)(w,2),k=j[0],S=j[1],C=Object(o.useState)(""),T=Object(n.a)(C,2),A=T[0],N=T[1],I=Object(o.useState)(""),z=Object(n.a)(I,2),D=z[0],B=z[1],q=Object(o.useState)(""),L=Object(n.a)(q,2),F=L[0],P=L[1],M=Object(o.useState)(""),W=Object(n.a)(M,2),U=W[0],H=W[1],V=Object(o.useState)(""),G=Object(n.a)(V,2),Y=G[0],J=G[1],Q=Object(o.useState)(null),K=Object(n.a)(Q,2),Z=K[0],$=K[1],ee=Object(o.useState)(!1),te=Object(n.a)(ee,2),ae=te[0],ne=te[1],re=a?1:2;function ie(e){se(e.target[0]),e.preventDefault()}function le(e){("oauth"===E&&U||"oauth"!==E)&&($(null),y("login"),S(""),N(""),B(""),P(""),H(""),J("")),e&&e.preventDefault()}function se(e){ae||g({url:"/api/v4/auth/login/",method:"POST",body:{user:k,password:D,otp:Y,webauthn_auth_resp:Z,oauth_token:U},reloadOnUnauthorize:!1,onEnter:function(){return ne(!0)},onExit:function(){return ne(!1)},onFailure:function(t){"Wrong OTP token"===t.api_error_message&&"otp"!==E?y("otp"):"Wrong Security Token"===t.api_error_message&&"sectoken"===E?(y("otp"),_(m("securitytoken.error"))):"Wrong Security Token"===t.api_error_message&&"sectoken"!==E?y("sectoken"):"oauth"===E?(_(t.api_error_message),le(null)):(_(t.api_error_message),null!==e&&e.hasOwnProperty("select")&&(e.select(),e.focus()))},onSuccess:function(){window.location.reload(!1)}})}return Object(o.useEffect)((function(){null!==Z?se(null):"oauth"===E?g({url:"/api/v4/auth/oauth/".concat(l.search),reloadOnUnauthorize:!1,onSuccess:function(e){P(e.api_response.avatar),S(e.api_response.username),N(e.api_response.email_adr||""),H(e.api_response.oauth_token)},onFailure:function(e){_(e.api_error_message),y("login")},onFinalize:function(){c.get("provider")&&s.push(localStorage.getItem("nextLocation")||"/")}}):c.get("registration_key")&&g({url:"/api/v4/auth/signup_validate/",method:"POST",body:{registration_key:c.get("registration_key")},onSuccess:function(){return x(m("signup.completed"),1e4)},onFinalize:function(){return s.push("/")}})}),[Z,E]),u.a.createElement(ur,null,u.a.createElement(R.a,{style:{cursor:"pointer"},onClick:le},f(d)),{login:u.a.createElement(u.a.Fragment,null,t?u.a.createElement(Ar,{onSubmit:ie,buttonLoading:ae,setPassword:B,setUsername:S}):null,a?u.a.createElement(Kt.a,{align:"center",variant:"caption",style:{marginTop:d.spacing(2)}},m("signup"),"\xa0\xa0",u.a.createElement($t.a,{href:"#",onClick:function(e){y("signup"),e.preventDefault()}},m("signup.link"))):null,r?u.a.createElement(Kt.a,{align:"center",variant:"caption",style:{marginTop:d.spacing(re)}},m("reset.desc"),"\xa0\xa0",u.a.createElement($t.a,{href:"#",onClick:function(e){y("reset"),e.preventDefault()}},m("reset.link"))):null,void 0!==i&&0!==i.length?u.a.createElement(u.a.Fragment,null,t?u.a.createElement(Nr,null):null,u.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},i.map((function(e,t){return u.a.createElement(ma.a,{key:t,style:0!==t?{marginTop:"1.5rem"}:null,variant:"contained",color:"primary",disabled:ae,onClick:function(){var e=new Date;e.setTime(e.getTime()+3e5),document.cookie="ui4_path=".concat("","; expires=").concat(e.toUTCString(),"; path=/"),localStorage.setItem("nextLocation","".concat(l.pathname).concat(l.search).concat(l.hash))},href:"/api/v4/auth/login/?oauth_provider=".concat(e)},"".concat(m("button_oauth")," ").concat(e.replace(/_/g," ")),ae&&u.a.createElement(tr.a,{size:24,className:p.buttonProgress}))})))):null),signup:u.a.createElement(Cr,{setButtonLoading:ne,buttonLoading:ae}),reset:u.a.createElement(Or,{setButtonLoading:ne,buttonLoading:ae}),reset_now:u.a.createElement(yr,{setButtonLoading:ne,buttonLoading:ae}),oauth:u.a.createElement(fr,{reset:le,oAuthToken:U,avatar:F,username:k,email:A,onSubmit:ie,buttonLoading:ae}),otp:u.a.createElement(vr,{onSubmit:ie,buttonLoading:ae,setOneTimePass:J}),sectoken:u.a.createElement(kr,{setShownControls:y,setWebAuthNResponse:$,username:k})}[E])}var zr=function(){var e=Object(X.a)(["error404"]).t,t=Object(v.a)();return u.a.createElement(ir,{width:"65%",margin:4},u.a.createElement("div",{style:{paddingTop:t.spacing(10),paddingBottom:t.spacing(6)}},u.a.createElement("img",{alt:e("dl.alt"),src:"".concat("","/images/dead_link.png"),style:{maxHeight:"300px",maxWidth:"90%"}})),u.a.createElement("div",null,u.a.createElement(Kt.a,{variant:"h6"},e("dl.description"))))},Dr=a(8),Br=a(800),qr=a(801),Lr=a(802),Fr=a(803),Pr=a(804),Mr=a(805),Wr=a(806),Ur=a(211),Hr=a(50),Vr=a.n(Hr),Gr=a(106),Yr=a.n(Gr),Jr=a(311),Qr=a(743),Kr=a(794),Xr=a(795),Zr=a(796),$r=a(797),ei=a(798),ti=a(799);function ai(e){var t=e.user,a=e.toggleAPIKey,r=Object(X.a)(["user"]).t,i=Object(o.useState)(null),s=Object(n.a)(i,2),c=s[0],m=s[1],d=Object(o.useState)(null),p=Object(n.a)(d,2),g=p[0],f=p[1],h=Object(o.useState)(""),b=Object(n.a)(h,2),E=b[0],y=b[1],O=Object(o.useState)("READ"),_=Object(n.a)(O,2),x=_[0],w=_[1],j=dr(),k=Object(v.a)(),S=Object(l.a)(k.breakpoints.down("sm")),C=$n().showSuccessMessage,T=RegExp("^[a-zA-Z][a-zA-Z0-9_]*$"),A=k.spacing(1),N=k.spacing(2),I=k.spacing(4);function R(){f(null),y(""),w("READ")}return u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4",gutterBottom:!0},r("apikeys.title")),u.a.createElement(Kt.a,{variant:"caption",gutterBottom:!0},r("apikeys.desc")),u.a.createElement("div",{style:{paddingTop:I,paddingBottom:I}},u.a.createElement(Kt.a,{variant:"subtitle1",gutterBottom:!0},r("apikeys.list")),0!==t.apikeys.length?t.apikeys.map((function(e,t){return u.a.createElement(Jr.a,{key:t,label:e,onDelete:function(){m(e)},style:{marginRight:A,marginBottom:A}})})):u.a.createElement(Kt.a,{variant:"subtitle2",color:"secondary"},r("apikeys.none"))),u.a.createElement("div",{style:{paddingTop:I}},u.a.createElement(hr.a,{style:{width:"100%"},size:"small",margin:"normal",variant:"outlined",label:r("apikeys.temp_token"),onChange:function(e){T.test(e.target.value)||""===e.target.value?y(e.target.value):e.preventDefault()},value:E})),u.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%"}},u.a.createElement("div",{style:{alignSelf:"center",flexGrow:2}},u.a.createElement(Qr.a,{id:"priv",value:x,onChange:function(e){w(e.target.value)},variant:"outlined",margin:"dense"},u.a.createElement(Kr.a,{value:"READ"},r("apikeys.r_token")),u.a.createElement(Kr.a,{value:"READ_WRITE"},r("apikeys.rw_token")),u.a.createElement(Kr.a,{value:"WRITE"},r("apikeys.w_token")))),u.a.createElement("div",{style:{alignSelf:"flex-end",paddingLeft:A}},u.a.createElement(ma.a,{disabled:""===E,onClick:function(){j({url:"/api/v4/auth/apikey/".concat(E,"/").concat(x,"/"),onSuccess:function(e){f(e.api_response.apikey),a(E)}})},color:"primary",variant:"contained"},r("apikeys.add")))),u.a.createElement(Xr.a,{fullScreen:S,open:null!==g,onClose:function(){return R()},"aria-labelledby":"new-dialog-title","aria-describedby":"new-dialog-description"},u.a.createElement(Zr.a,{id:"new-dialog-title"},r("apikeys.new_title")),u.a.createElement($r.a,null,u.a.createElement(ei.a,{id:"new-dialog-description",component:"div"},u.a.createElement("div",{style:{paddingTop:N,paddingBottom:I}},u.a.createElement(cr.a,{variant:"outlined",style:{backgroundColor:k.palette.background.default}},u.a.createElement("div",{style:{padding:N}},u.a.createElement(Kt.a,{style:{fontFamily:"monospace",wordBreak:"break-word"}},g))))),u.a.createElement(ei.a,{id:"new-dialog-notice-title",component:"div"},u.a.createElement(Kt.a,{variant:"subtitle2",color:"textPrimary"},r("apikeys.new_notice_title"))),u.a.createElement(ei.a,{id:"new-dialog-notice-texte",component:"div"},u.a.createElement(Kt.a,{variant:"body2"},r("apikeys.new_notice_text")))),u.a.createElement(ti.a,null,u.a.createElement(ma.a,{onClick:function(){return R()},color:"primary",autoFocus:!0},r("done")))),u.a.createElement(Xr.a,{fullScreen:S,open:null!==c,onClose:function(){return m(null)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},u.a.createElement(Zr.a,{id:"alert-dialog-title"},r("apikeys.remove_title"),": ",c),u.a.createElement($r.a,null,u.a.createElement(ei.a,{id:"alert-dialog-description"},r("apikeys.remove_text"))),u.a.createElement(ti.a,null,u.a.createElement(ma.a,{onClick:function(){return m(null)},color:"primary",autoFocus:!0},r("cancel")),u.a.createElement(ma.a,{onClick:function(){j({url:"/api/v4/auth/apikey/".concat(c,"/"),method:"DELETE",onSuccess:function(){a(c),m(null),C(r("apikeys.removed"))}})},color:"primary"},r("apikeys.remove")))))}function ni(e){var t=e.setDrawerOpen,a=e.set2FAEnabled,n=dr(),r=Object(X.a)(["user"]).t,i=Object(v.a)();return u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4",gutterBottom:!0},r("2fa_disable_title")),u.a.createElement(Kt.a,null,r("2fa_disable_desc")),u.a.createElement("div",{style:{textAlign:"end",paddingTop:i.spacing(6)}},u.a.createElement(ma.a,{style:{marginRight:"8px"},variant:"contained",onClick:function(){return t(!1)}},r("cancel")),u.a.createElement(ma.a,{variant:"contained",color:"primary",onClick:function(){n({url:"/api/v4/auth/disable_otp/",onSuccess:function(e){t(!1),a(!1)}})}},r("2fa_disable"))))}function ri(e){var t=e.setDrawerOpen,a=e.set2FAEnabled,r=dr(),i=Object(o.useState)(null),l=Object(n.a)(i,2),s=l[0],c=l[1],m=Object(o.useState)(""),d=Object(n.a)(m,2),p=d[0],g=d[1],f=Object(X.a)(["user"]).t,h=RegExp("^[0-9]{1,6}$"),b=Object(v.a)(),E=b.spacing(4),y=b.spacing(6);return Object(o.useEffect)((function(){r({url:"/api/v4/auth/setup_otp/",onSuccess:function(e){c(e.api_response)},onFailure:function(){a(!0),setTimeout((function(){t(!1)}),1e3)}})}),[]),u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4",gutterBottom:!0},f("2fa_setup_title")),u.a.createElement("div",{style:{textAlign:"center"}},u.a.createElement(Kt.a,null,f("2fa_scan")),u.a.createElement("div",{style:{paddingTop:E,paddingBottom:E,display:"flex",flexDirection:"row",justifyContent:"center"}},s?u.a.createElement("div",{style:{backgroundColor:"white"},dangerouslySetInnerHTML:{__html:s.qrcode}}):u.a.createElement(pr.a,{variant:"rect",style:{width:"195px",height:"195px"}})),u.a.createElement(Nr,{forcePaper:!0}),u.a.createElement(Kt.a,{gutterBottom:!0},f("2fa_manual")),u.a.createElement("div",{style:{paddingTop:E,paddingBottom:E}},u.a.createElement(Kt.a,{variant:"caption"},s?s.secret_key:u.a.createElement(pr.a,null))),u.a.createElement(hr.a,{disabled:null===s,style:{width:"100%"},margin:"normal",variant:"outlined",label:f("2fa_temp_otp"),onChange:function(e){h.test(e.target.value)||""===e.target.value?g(e.target.value):e.preventDefault()},value:p}),u.a.createElement("div",{style:{paddingTop:y,textAlign:"end"}},u.a.createElement(ma.a,{style:{marginRight:"8px"},variant:"contained",onClick:function(){return t(!1)}},f("cancel")),u.a.createElement(ma.a,{disabled:null===s||""===p,variant:"contained",color:"primary",onClick:function(){r({url:"/api/v4/auth/validate_otp/".concat(p,"/"),onSuccess:function(){t(!1),a(!0)}})}},f("validate")))))}var ii=a(273);function li(e){var t=e.user,a=e.toggleToken,r=Object(X.a)(["user"]).t,i=Object(o.useState)(null),l=Object(n.a)(i,2),s=l[0],c=l[1],m=Object(o.useState)(""),d=Object(n.a)(m,2),p=d[0],g=d[1],f=$n(),h=f.showSuccessMessage,b=f.showErrorMessage,E=dr(),y=RegExp("^[a-zA-Z][a-zA-Z0-9_ ]*$"),O=Object(v.a)(),_=O.spacing(1),x=O.spacing(4);return u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4",gutterBottom:!0},r("token.title")),u.a.createElement(Kt.a,{variant:"caption",gutterBottom:!0},r("token.desc")),u.a.createElement("div",{style:{paddingTop:x,paddingBottom:x}},u.a.createElement(Kt.a,{variant:"subtitle1",gutterBottom:!0},r("token.list")),0!==t.security_tokens.length?t.security_tokens.map((function(e,t){return u.a.createElement(Jr.a,{key:t,label:e,onDelete:function(){c(e)},style:{marginRight:_,marginBottom:_}})})):u.a.createElement(Kt.a,{variant:"subtitle2",color:"secondary"},r("token.none"))),u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(hr.a,{style:{width:"100%"},size:"small",margin:"normal",variant:"outlined",label:r("token.temp_token"),onChange:function(e){y.test(e.target.value)||""===e.target.value?g(e.target.value):e.preventDefault()},value:p})),u.a.createElement("div",{style:{alignSelf:"flex-end"}},u.a.createElement(ma.a,{disabled:""===p,onClick:function(){E({url:"/api/v4/webauthn/register/begin/",method:"POST",onSuccess:function(e){var t=wr(e.api_response),n=ii.decode(t.buffer),i=navigator.credentials;void 0!==i&&i.create(n).then((function(e){var t=e.response,n=ii.encode({attestationObject:new Uint8Array(t.attestationObject),clientDataJSON:new Uint8Array(t.clientDataJSON)});E({url:"/api/v4/webauthn/register/complete/".concat(p,"/"),method:"POST",body:Array.from(new Uint8Array(n)),onSuccess:function(){a(p),g(""),h(r("token.added"))}})})).catch((function(e){g(""),b("".concat(e.name,": ").concat(e.message))}))}})},color:"primary",variant:"contained"},r("token.add"))),u.a.createElement(Xr.a,{open:null!==s,onClose:function(){return c(null)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},u.a.createElement(Zr.a,{id:"alert-dialog-title"},r("token.remove_title"),": ",s),u.a.createElement($r.a,null,u.a.createElement(ei.a,{id:"alert-dialog-description"},r("token.remove_text"))),u.a.createElement(ti.a,null,u.a.createElement(ma.a,{onClick:function(){return c(null)},color:"primary",autoFocus:!0},r("cancel")),u.a.createElement(ma.a,{onClick:function(){E({url:"/api/v4/webauthn/remove/".concat(s,"/"),onSuccess:function(){a(s),c(null),h(r("token.removed"))}})},color:"primary"},r("token.remove")))))}var si=a(149),ci=a.n(si),oi={"label-default":"default","label-primary":"primary","label-secondary":"secondary","label-info":"info","label-success":"success","label-warning":"warning","label-error":"error",default:"default",primary:"primary",secondary:"secondary",info:"info",success:"success",warning:"warning",error:"error"},ui=Object(i.a)((function(e){return{auto_height:{height:"auto"},wrap:{whiteSpace:"pre-wrap",wordBreak:"break-word",paddingTop:"2px",paddingBottom:"2px"},square:{borderRadius:"0px",margin:"2px 4px 2px 0"},rounded:{borderRadius:"3px",margin:"2px 4px 2px 0"},fullWidth:{width:"100%"},tiny:{height:"20px",fontSize:"0.725rem"},label_tiny:{paddingLeft:"6px",paddingRight:"6px"},mono:{fontFamily:"monospace",fontSize:"1.15rem"},tiny_mono:{fontFamily:"monospace",fontSize:"1rem"},default:{backgroundColor:"dark"===e.palette.type?"#616161":"#999",color:e.palette.common.white,"[role=button]&:hover, [role=button]&:focus":{backgroundColor:Object(ba.a)("dark"===e.palette.type?"#616161":"#999",.15)}},primary:{"[role=button]&:hover, [role=button]&:focus":{backgroundColor:Object(ba.a)(e.palette.primary.main,.15)}},secondary:{color:e.palette.common.white,"[role=button]&:hover, [role=button]&:focus":{backgroundColor:Object(ba.a)(e.palette.secondary.main,.15)}},success:{backgroundColor:e.palette.success.main,color:e.palette.common.white,"[role=button]&:hover, [role=button]&:focus":{backgroundColor:Object(ba.a)(e.palette.success.main,.15)}},info:{backgroundColor:"dark"===e.palette.type?"#28abd2":"#00baf1",color:e.palette.common.white,"[role=button]&:hover, [role=button]&:focus":{backgroundColor:Object(ba.a)("dark"===e.palette.type?"#28abd2":"#00baf1",.15)}},warning:{backgroundColor:"dark"===e.palette.type?"#ed8b00":"#ff9d12",color:e.palette.common.white,"[role=button]&:hover, [role=button]&:focus":{backgroundColor:Object(ba.a)("dark"===e.palette.type?"#ed8b00":"#ff9d12",.15)}},error:{backgroundColor:e.palette.error.dark,color:e.palette.common.white,"[role=button]&:hover, [role=button]&:focus":{backgroundColor:Object(ba.a)(e.palette.error.dark,.15)}},success_outlined:{borderColor:"dark"!==e.palette.type?e.palette.success.dark:e.palette.success.light,color:"dark"!==e.palette.type?e.palette.success.dark:e.palette.success.light},info_outlined:{borderColor:"dark"!==e.palette.type?e.palette.info.dark:e.palette.info.light,color:"dark"!==e.palette.type?e.palette.info.dark:e.palette.info.light},warning_outlined:{borderColor:"dark"!==e.palette.type?e.palette.warning.dark:e.palette.warning.light,color:"dark"!==e.palette.type?e.palette.warning.dark:e.palette.warning.light},error_outlined:{borderColor:"dark"!==e.palette.type?e.palette.error.dark:e.palette.error.light,color:"dark"!==e.palette.type?e.palette.error.dark:e.palette.error.light},icon:{color:e.palette.common.white}}})),mi=u.a.memo((function(e){var t=e.className,a=void 0===t?null:t,n=e.type,r=void 0===n?"round":n,i=e.size,l=void 0===i?"medium":i,s=e.color,c=void 0===s?"default":s,o=e.variant,m=void 0===o?"default":o,d=e.mono,p=void 0!==d&&d,g=e.wrap,f=void 0!==g&&g,h=e.tooltip,v=void 0===h?null:h,E=e.fullWidth,y=void 0!==E&&E,O=(e.children,Object(b.a)(e,["className","type","size","color","variant","mono","wrap","tooltip","fullWidth","children"])),_=ui(),x={square:_.square,rounded:_.rounded,round:null},w={tiny:_.label_tiny,small:null,medium:null},j={tiny:_.tiny,small:null,medium:null},k={success:_.success,warning:_.warning,error:_.error,info:_.info,success_outlined:_.success_outlined,warning_outlined:_.warning_outlined,error_outlined:_.error_outlined,info_outlined:_.info_outlined,default:_.default,primary:_.primary,secondary:_.secondary},S=Object(F.default)(p?"tiny"===l?_.tiny_mono:_.mono:null,f?_.auto_height:null,y?_.fullWidth:null,x[r],j[l],"outlined"===m?k["".concat(c,"_outlined")]:k[c],a),C=Object(F.default)(w[l],f?_.wrap:null),T=u.a.createElement(Jr.a,Object.assign({classes:{label:C,icon:"outlined"!==m?_.icon:null},className:S,size:{small:"small",medium:"medium"}[l],color:{primary:"primary",secondary:"secondary"}[c],variant:m},O));return v?u.a.createElement(I.a,{title:v},T):T})),di=a(25),pi={lvlIdx:0,lvl:"",req:[],groups:[],subgroups:[]},gi={groups:[],levels:[]};function fi(e,t,a,n){var r=null;return null!=t&&(r=t.levels_map[e.toString()]),void 0!==r&&null!=r||(r=""),"long"!==a||n?r:t.levels_map_stl[r]}function hi(e,t){var a=null,n=e.indexOf("//"),r=e;return-1!==n&&(r=e.slice(0,n)),void 0!==t.levels_map[r]?a=t.levels_map[r]:void 0!==t.levels_map_lts[r]?a=t.levels_map[t.levels_map_lts[r]]:void 0!==t.levels_aliases[r]&&(a=t.levels_map[t.levels_aliases[r]]),a}function bi(e,t,a,n){var r,i=[],l=e.split("/"),s=Object(di.a)(l);try{for(s.s();!(r=s.n()).done;){var c=r.value;if(c in t.access_req_map_lts)i.push(t.access_req_map_lts[c]);else if(c in t.access_req_map_stl)i.push(c);else if(c in t.access_req_aliases){var o,u=Object(di.a)(t.access_req_aliases[c]);try{for(u.s();!(o=u.n()).done;){var m=o.value;i.push(m)}}catch(h){u.e(h)}finally{u.f()}}}}catch(h){s.e(h)}finally{s.f()}if("long"===a&&!n){var d,p=[],g=Object(di.a)(i);try{for(g.s();!(d=g.n()).done;){var f=d.value;p.push(t.access_req_map_stl[f])}}catch(h){g.e(h)}finally{g.f()}return p.sort()}return i.sort()}function vi(e,t,a,n){var r,i=[],l=[],s=e.split("//"),c=[],o=Object(di.a)(s);try{for(o.s();!(r=o.n()).done;){var u,m=r.value,d=(m=m.replace("REL TO ","")).split(","),p=Object(di.a)(d);try{for(p.s();!(u=p.n()).done;){var g=u.value;c=c.concat(g.trim().split("/"))}}catch(I){p.e(I)}finally{p.f()}}}catch(I){o.e(I)}finally{o.f()}var f,h=Object(di.a)(c);try{for(h.s();!(f=h.n()).done;){var b=f.value;if(b in t.groups_map_lts)i.push(t.groups_map_lts[b]);else if(b in t.groups_map_stl)i.push(b);else if(b in t.groups_aliases){var v,E=Object(di.a)(t.groups_aliases[b]);try{for(E.s();!(v=E.n()).done;){var y=v.value;i.push(y)}}catch(I){E.e(I)}finally{E.f()}}else if(b in t.subgroups_map_lts)l.push(t.subgroups_map_lts[b]);else if(b in t.subgroups_map_stl)l.push(b);else if(b in t.subgroups_aliases){var O,_=Object(di.a)(t.subgroups_aliases[b]);try{for(_.s();!(O=_.n()).done;){var x=O.value;l.push(x)}}catch(I){_.e(I)}finally{_.f()}}}}catch(I){h.e(I)}finally{h.f()}if("long"===a&&!n){var w,j=[],k=Object(di.a)(i);try{for(k.s();!(w=k.n()).done;){var S=w.value;j.push(t.groups_map_stl[S])}}catch(I){k.e(I)}finally{k.f()}var C,T=[],A=Object(di.a)(l);try{for(A.s();!(C=A.n()).done;){var N=C.value;T.push(t.subgroups_map_stl[N])}}catch(I){A.e(I)}finally{A.f()}return{groups:j.sort(),subgroups:T.sort()}}return{groups:i.sort(),subgroups:l.sort()}}function Ei(e,t,a,n){var r=vi(e,t,a,n),i=hi(e,t);return{lvlIdx:i,lvl:fi(i,t,a,n),req:bi(e,t,a,n),groups:r.groups,subgroups:r.subgroups}}function yi(e,t,a,n){var r,i=e.lvl,l=e.req,s=e.subgroups,c=e.groups,o=i,u=[],m=Object(di.a)(l);try{for(m.s();!(r=m.n()).done;){var d=r.value;void 0!==t.params_map[d]&&void 0!==t.params_map[d].is_required_group&&t.params_map[d].is_required_group&&u.push(d)}}catch(E){m.e(E)}finally{m.f()}for(var p=0,g=u;p<g.length;p++){var f=g[p];l.splice(l.indexOf(f),1)}if(l.length>0&&(o+="//".concat(l.join("/"))),u.length>0&&(o+="//".concat(u.join("/"))),c.length>0)if(u.length>0?o+="/":o+="//",1===c.length){var h=c[0];void 0!==t.params_map[h]&&void 0!==t.params_map[h].solitary_display_name?o+=t.params_map[h].solitary_display_name:o+="REL TO ".concat(h)}else{if("short"===a||n)for(var b in t.groups_aliases)if({}.hasOwnProperty.call(t.groups_aliases,b)){var v=t.groups_aliases[b];v.length>1&&JSON.stringify(v.sort())===JSON.stringify(c)&&(c=[b])}o+="REL TO ".concat(c.join(", "))}return s.length>0&&(c.length>0||u.length>0?o+="/":o+="//",o+=s.join("/")),o}function Oi(e){var t=[];for(var a in e.levels_map)isNaN(parseInt(a))||t.push(e.levels_map[a]);return t}var _i={disabled:gi,parts:pi};function xi(e,t,a,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i={},l={},s={},c=["req","groups","subgroups"],o=Object(h.a)({},e),u={levels:[],groups:[]};for(var m in t.params_map)if({}.hasOwnProperty.call(t.params_map,m)){var d=t.params_map[m];"require_lvl"in d&&(i[m]=d.require_lvl),"limited_to_group"in d&&(l[m]=d.limited_to_group),"require_group"in d&&(s[m]=d.require_group)}for(var p in c)if({}.hasOwnProperty.call(c,p)){var g,f=o[c[p]],b=Object(di.a)(f);try{for(b.s();!(g=b.n()).done;){var v=g.value,E=!1;if(v){if(v in i){o.lvlIdx<i[v]&&(o.lvlIdx=i[v],o.lvl=fi(i[v],t,a,n));var y,O=Oi(t),_=Object(di.a)(O);try{for(_.s();!(y=_.n()).done;){var x=y.value;t.levels_map[x]<i[v]&&u.levels.push(x)}}catch(N){_.e(N)}finally{_.f()}}if(v in s&&!o.groups.includes(s[v])){o.groups.push(s[v]);var w,j=Object(di.a)(t.groups_auto_select);try{for(j.s();!(w=j.n()).done;){var k=w.value;o.groups.includes(k)||o.groups.push(k)}}catch(N){j.e(N)}finally{j.f()}}if(v in l)for(var S in t.groups_map_stl)S!==l[v]&&(u.groups.push(S),o.groups.includes(S)&&o.groups.splice(o.groups.indexOf(S),1));r||"groups"!==c[p]||(E=!0)}if(E){var C,T=Object(di.a)(t.groups_auto_select);try{for(T.s();!(C=T.n()).done;){var A=C.value;o.groups.includes(A)||o.groups.push(A)}}catch(N){T.e(N)}finally{T.f()}}}}catch(N){b.e(N)}finally{b.f()}}return o.req=o.req.sort(),o.groups=o.groups.sort(),o.subgroups=o.subgroups.sort(),{disabled:u,parts:o}}var wi=Object(i.a)((function(e){return{classification:{fontWeight:500},inlineSkel:{display:"inline-block",width:"8rem",verticalAlign:"bottom"},default:{fontWeight:500,color:"dark"===e.palette.type?"#AAA":"#888"},primary:{fontWeight:500,color:e.palette.primary.main},secondary:{fontWeight:500,color:e.palette.secondary.main},success:{fontWeight:500,color:"dark"!==e.palette.type?e.palette.success.dark:e.palette.success.light},info:{fontWeight:500,color:"dark"!==e.palette.type?e.palette.info.dark:e.palette.info.light},warning:{fontWeight:500,color:"dark"!==e.palette.type?e.palette.warning.dark:e.palette.warning.light},error:{fontWeight:500,color:"dark"!==e.palette.type?e.palette.error.dark:e.palette.error.light}}}));function ji(e){var t=e.c12n,a=e.format,r=e.inline,i=e.setClassification,s=e.size,c=e.type,m=e.isUser,d=e.fullWidth,p=wi(),g=Object(X.a)().t,f=Object(v.a)(),b=Ma(),E=b.user,y=b.c12nDef,O=Object(l.a)(f.breakpoints.down("xs")),_=Object(l.a)(f.breakpoints.down("sm")),x=Object(o.useState)(!1),w=Object(n.a)(x,2),j=w[0],C=w[1],A=Object(o.useState)(pi),N=Object(n.a)(A,2),I=N[0],R=N[1],z=Object(o.useState)(_i),D=Object(n.a)(z,2),B=D[0],q=D[1],L=f.spacing(2);Object(o.useEffect)((function(){if(y&&y.enforce&&t){var e=Ei(t,y,a,_);"picker"===c?(R(Ei(E.classification,y,a,_)),q(xi(e,y,a,_,m))):q({disabled:gi,parts:e})}}),[t,E,_]);var F=function(){var e=y.levels_styles_map[B.parts.lvl];return e&&oi[e.color||e.label.replace("label-","")]||"default"},P={medium:f.spacing(4),small:f.spacing(3.5),tiny:f.spacing(3)},M=function(){var e=yi(B.parts,y,a,_),n=yi(Ei(t,y,a,_),y,a,_);i&&e!==n&&i(e),C(!1)};return y&&y.enforce&&(t?u.a.createElement(u.a.Fragment,null,"text"===c?u.a.createElement("span",{className:p[F()]},yi(B.parts,y,a,_)):u.a.createElement("div",{style:{display:r?"inline-block":null}},u.a.createElement(mi,{type:"rounded",variant:"outlined"===c?"outlined":"default",size:s,color:F(),className:p.classification,label:yi(B.parts,y,a,_),onClick:"picker"===c?function(){return C(!0)}:null,fullWidth:d})),"picker"===c?u.a.createElement(Xr.a,{fullScreen:O,fullWidth:!0,maxWidth:_?"xs":"md",open:j,onClose:M},u.a.createElement(Zr.a,null,u.a.createElement(mi,{type:"rounded",variant:"outlined",size:s,color:F(),className:p.classification,label:yi(B.parts,y,a,_),fullWidth:d})),u.a.createElement($r.a,null,u.a.createElement(ci.a,{container:!0,spacing:2},u.a.createElement(ci.a,{item:!0,xs:12,md:!0},u.a.createElement(cr.a,{variant:"outlined"},u.a.createElement(k.a,{disablePadding:!0,style:{borderRadius:"6px"}},y.original_definition.levels.map((function(e,t){return(m||e.lvl<=I.lvlIdx)&&u.a.createElement(S.a,{key:t,button:!0,disabled:B.disabled.levels.includes(e.name)||B.disabled.levels.includes(e.short_name),selected:B.parts.lvlIdx===e.lvl,onClick:function(){return t=e.lvl,void q(xi(Object(h.a)(Object(h.a)({},B.parts),{},{lvlIdx:t,lvl:fi(t,y,a,_)}),y,a,_,m));var t}},u.a.createElement(T.a,{style:{textAlign:"center"},primary:e.name}))}))))),(m||0!==I.req.length)&&u.a.createElement(ci.a,{item:!0,xs:12,md:!0},u.a.createElement(cr.a,{variant:"outlined"},u.a.createElement(k.a,{disablePadding:!0},y.original_definition.required.map((function(e,t){return(m||[e.name,e.short_name].some((function(e){return I.req.includes(e)})))&&u.a.createElement(S.a,{key:t,button:!0,selected:B.parts.req.includes(e.name)||B.parts.req.includes(e.short_name),onClick:function(){return function(e){var t=B.parts.req;-1===t.indexOf(e.name)&&-1===t.indexOf(e.short_name)?t.push("long"!==a||_?e.short_name:e.name):-1!==t.indexOf(e.name)?t.splice(t.indexOf(e.name),1):t.splice(t.indexOf(e.short_name),1),q(xi(Object(h.a)(Object(h.a)({},B.parts),{},{req:t}),y,a,_,m))}(e)}},u.a.createElement(T.a,{style:{textAlign:"center"},primary:e.name}))}))))),(m||0!==I.groups.length||0!==I.subgroups.length)&&u.a.createElement(ci.a,{item:!0,xs:12,md:!0},(m||0!==I.groups.length)&&u.a.createElement("div",{style:{paddingBottom:L}},u.a.createElement(cr.a,{variant:"outlined"},u.a.createElement(k.a,{disablePadding:!0},y.original_definition.groups.map((function(e,t){return(m||[e.name,e.short_name].some((function(e){return I.groups.includes(e)})))&&u.a.createElement(S.a,{key:t,button:!0,disabled:B.disabled.groups.includes(e.name)||B.disabled.groups.includes(e.short_name),selected:B.parts.groups.includes(e.name)||B.parts.groups.includes(e.short_name),onClick:function(){return function(e){var t=B.parts.groups;-1===t.indexOf(e.name)&&-1===t.indexOf(e.short_name)?t.push("long"!==a||_?e.short_name:e.name):-1!==t.indexOf(e.name)?t.splice(t.indexOf(e.name),1):t.splice(t.indexOf(e.short_name),1),q(xi(Object(h.a)(Object(h.a)({},B.parts),{},{groups:t}),y,a,_,m))}(e)}},u.a.createElement(T.a,{style:{textAlign:"center"},primary:e.name}))}))))),(m||0!==I.subgroups.length)&&u.a.createElement(cr.a,{variant:"outlined"},u.a.createElement(k.a,{disablePadding:!0},y.original_definition.subgroups.map((function(e,t){return(m||[e.name,e.short_name].some((function(e){return I.subgroups.includes(e)})))&&u.a.createElement(S.a,{key:t,button:!0,selected:B.parts.subgroups.includes(e.name)||B.parts.subgroups.includes(e.short_name),onClick:function(){return function(e){var t=B.parts.subgroups;-1===t.indexOf(e.name)&&-1===t.indexOf(e.short_name)?t.push("long"!==a||_?e.short_name:e.name):-1!==t.indexOf(e.name)?t.splice(t.indexOf(e.name),1):t.splice(t.indexOf(e.short_name),1),q(xi(Object(h.a)(Object(h.a)({},B.parts),{},{subgroups:t}),y,a,_,m))}(e)}},u.a.createElement(T.a,{style:{textAlign:"center"},primary:e.name}))}))))))),u.a.createElement(ti.a,null,u.a.createElement(ma.a,{onClick:M,color:"primary",autoFocus:!0},g("classification.done")))):null):u.a.createElement(pr.a,{variant:"text"===c?"text":"rect",className:r?p.inlineSkel:null,height:"text"!==c?P[s]:null,style:{borderRadius:f.spacing(.5)}}))}ji.defaultProps={setClassification:null,size:"medium",type:"pill",format:"short",inline:!1,isUser:!1,fullWidth:!0};var ki=u.a.memo(ji),Si=function(e){var t=e.open,a=e.handleClose,n=e.handleAccept,r=e.title,i=e.cancelText,l=e.acceptText,s=e.text,c=void 0===s?null:s;return u.a.createElement(Xr.a,{open:t,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},u.a.createElement(Zr.a,{id:"alert-dialog-title"},r),c&&u.a.createElement($r.a,null,u.a.createElement(ei.a,{id:"alert-dialog-description"},c)),u.a.createElement(ti.a,null,u.a.createElement(ma.a,{onClick:a,color:"secondary"},i),u.a.createElement(ma.a,{onClick:n,color:"primary",autoFocus:!0},l)))},Ci=a(201),Ti=a.n(Ci);function Ai(e){var t=e.user,a=e.toggleApp,r=Object(X.a)(["user"]).t,i=Object(o.useState)(null),s=Object(n.a)(i,2),c=s[0],m=s[1],d=dr(),p=Object(v.a)(),g=Object(l.a)(p.breakpoints.down("sm")),f=$n(),h=f.showSuccessMessage,b=f.showErrorMessage,E=p.spacing(1),y=p.spacing(4);return u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4",gutterBottom:!0},r("apps.title")),u.a.createElement(Kt.a,{variant:"caption",gutterBottom:!0},r("apps.desc")),u.a.createElement("div",{style:{paddingTop:y,paddingBottom:y}},t.apps&&0!==Object.keys(t.apps).length?Object.keys(t.apps).map((function(e){return u.a.createElement(I.a,{key:e,title:t.apps[e].netloc},u.a.createElement(Jr.a,{label:"".concat(t.apps[e].server," [").concat(t.apps[e].scope.toUpperCase(),"]"),onDelete:function(){m(e)},style:{marginRight:E,marginBottom:E}}))})):u.a.createElement(Kt.a,{variant:"subtitle2",color:"secondary"},r("apps.none"))),u.a.createElement(Xr.a,{fullScreen:g,open:null!==c,onClose:function(){return m(null)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},u.a.createElement(Zr.a,{id:"alert-dialog-title"},"".concat(r("apps.remove_title"),": ").concat(c&&t.apps[c]&&"".concat(t.apps[c].server," [").concat(t.apps[c].scope.toUpperCase(),"]"))),u.a.createElement($r.a,null,u.a.createElement(ei.a,{id:"alert-dialog-description"},r("apps.remove_text"))),u.a.createElement(ti.a,null,u.a.createElement(ma.a,{onClick:function(){return m(null)},color:"primary",autoFocus:!0},r("cancel")),u.a.createElement(ma.a,{onClick:function(){d({url:"/api/v4/auth/obo_token/".concat(c,"/"),method:"DELETE",onSuccess:function(){a(c),m(null),h(r("apps.removed"))},onFailure:function(e){m(null),b(e.api_error_message)}})},color:"primary"},r("apps.remove")))))}var Ni=Object(Dr.a)((function(e){return{root:{color:e.palette.getContrastText(Ur.a[500]),backgroundColor:Ur.a[500],"&:hover":{backgroundColor:Ur.a[700]},minWidth:e.spacing(16)}}}))(ma.a);function Ii(e){var t=e.width,a=e.username,s=Object(ue.i)().id,c=Object(ue.h)(),m=Object(o.useRef)(null),d=Object(X.a)(["user"]).t,p=Object(v.a)(),g=Object(ue.g)(),f=Object(o.useState)(null),b=Object(n.a)(f,2),E=b[0],y=b[1],O=Object(o.useState)(!1),_=Object(n.a)(O,2),x=_[0],w=_[1],j=Object(o.useState)(!1),k=Object(n.a)(j,2),S=k[0],C=k[1],T=Object(o.useState)(null),A=Object(n.a)(T,2),I=A[0],R=A[1],D=Object(o.useState)(!1),B=Object(n.a)(D,2),q=B[0],L=B[1],F=Object(o.useState)(!1),P=Object(n.a)(F,2),M=P[0],W=P[1],U=Ma(),H=U.user,V=U.configuration,G=Object(l.a)(p.breakpoints.down("sm")),Y=$n(),J=Y.showErrorMessage,Q=Y.showSuccessMessage,K=Y.showWarningMessage,$=p.spacing(1),ee=p.spacing(4),te=p.spacing(6),ae=dr(),ne=Object(i.a)((function(e){return{drawer:Object(r.a)({width:"500px"},p.breakpoints.down("xs"),{width:"100vw"}),row:{height:"62px"},group:{marginTop:"1rem"},skelItem:{display:"inline-block"},skelButton:{display:"inline-block",width:"9rem",height:"4rem"},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}))();function re(e){e&&I["2fa_enabled"]?J(d("2fa_already_enabled")):e?Q(d("2fa_enabled")):K(d("2fa_disabled")),R(Object(h.a)(Object(h.a)({},I),{},{"2fa_enabled":e}))}function ie(e){I&&(y(e),w(!0))}function le(e){var t=I.type;-1===t.indexOf(e)?t.push(e):t.splice(t.indexOf(e),1),L(!0),R(Object(h.a)(Object(h.a)({},I),{},{type:t}))}return Object(o.useEffect)((function(){!H.is_admin&&c.pathname.includes("/admin/")||ae({url:"/api/v4/user/".concat(a||s,"/?load_avatar"),onSuccess:function(e){R(e.api_response)}})}),[]),!H.is_admin&&c.pathname.includes("/admin/")?u.a.createElement(ue.a,{to:"/forbidden"}):u.a.createElement(ir,{margin:4,width:"100%"},u.a.createElement(u.a.Fragment,{key:"right"},u.a.createElement(N.a,{anchor:"right",open:x,onClose:function(){return w(!1)}},u.a.createElement("div",{style:{alignSelf:"flex-end"}},u.a.createElement(Z.a,{onClick:function(){return w(!1)}},u.a.createElement(Yr.a,null))),u.a.createElement("div",{style:{paddingTop:ee,paddingBottom:te,paddingLeft:ee,paddingRight:ee,display:"flex",flexDirection:"column"},className:ne.drawer},E&&I?{api_quota:u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4"},d("api_quota")),u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},d("api_quota_edit_title")),u.a.createElement(hr.a,{autoFocus:!0,type:"number",margin:"normal",variant:"outlined",onChange:function(e){return t=e.target.value,L(!0),void R(Object(h.a)(Object(h.a)({},I),{},{api_quota:t}));var t},value:I.api_quota})),change_password:u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4",gutterBottom:!0},d("change_password")),u.a.createElement(hr.a,{autoFocus:!0,type:"password",margin:"normal",variant:"outlined",label:d("new_password"),onChange:function(e){return t=e.target.value,L(!0),void R(Object(h.a)(Object(h.a)({},I),{},{new_pass:t}));var t}}),u.a.createElement(hr.a,{type:"password",margin:"normal",variant:"outlined",label:d("confirm_password"),onChange:function(e){return t=e.target.value,L(!0),void R(Object(h.a)(Object(h.a)({},I),{},{new_pass_confirm:t}));var t}})),groups:u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4"},d("groups")),u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},d("groups_edit_title")),u.a.createElement(Ti.a,{margin:"normal",defaultValue:I.groups,onChange:function(e){return t=e,L(!0),void R(Object(h.a)(Object(h.a)({},I),{},{groups:t}));var t},variant:"outlined"})),name:u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4"},d("name")),u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},d("name_edit_title")),u.a.createElement(hr.a,{autoFocus:!0,margin:"normal",variant:"outlined",onChange:function(e){return t=e.target.value,L(!0),void R(Object(h.a)(Object(h.a)({},I),{},{name:t}));var t},value:I.name})),submission_quota:u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4"},d("submission_quota")),u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},d("submission_quota_edit_title")),u.a.createElement(hr.a,{autoFocus:!0,type:"number",margin:"normal",variant:"outlined",onChange:function(e){return t=e.target.value,L(!0),void R(Object(h.a)(Object(h.a)({},I),{},{submission_quota:t}));var t},value:I.submission_quota})),otp:u.a.createElement(ri,{setDrawerOpen:w,set2FAEnabled:re}),disable_otp:u.a.createElement(ni,{setDrawerOpen:w,set2FAEnabled:re}),token:u.a.createElement(li,{user:I,toggleToken:function(e){var t=I.security_tokens;-1===t.indexOf(e)?t.push(e):t.splice(t.indexOf(e),1),R(Object(h.a)(Object(h.a)({},I),{},{security_tokens:t}))}}),api_key:u.a.createElement(ai,{user:I,toggleAPIKey:function(e){var t=I.apikeys;-1===t.indexOf(e)?t.push(e):t.splice(t.indexOf(e),1),R(Object(h.a)(Object(h.a)({},I),{},{apikeys:t}))}}),apps:u.a.createElement(Ai,{user:I,toggleApp:function(e){var t=I.apps;delete t[e],R(Object(h.a)(Object(h.a)({},I),{},{apps:t}))}})}[E]:null))),u.a.createElement(Si,{open:S,handleClose:function(){return C(!1)},handleAccept:function(){ae({url:"/api/v4/user/".concat(a||s,"/"),method:"DELETE",onSuccess:function(){Q(d("delete.success")),g.push("/admin/users")},onEnter:function(){return W(!0)},onExit:function(){return W(!1)}})},title:d("delete.title"),cancelText:d("delete.cancelText"),acceptText:d("delete.acceptText"),text:d("delete.text")}),u.a.createElement(Br.a,{container:!0,spacing:2,justify:"center"},u.a.createElement(Br.a,{item:!0,xs:12,sm:12,md:3},u.a.createElement(Br.a,{container:!0,className:ne.group},s&&u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{style:{paddingBottom:ee}},I?u.a.createElement(Ni,{fullWidth:G,disabled:M,variant:"contained",onClick:function(){C(!0)}},d("remove"),M&&u.a.createElement(tr.a,{size:24,className:ne.buttonProgress})):u.a.createElement(pr.a,{className:ne.skelButton,style:{minWidth:p.spacing(16),width:G?"100%":null}}))),u.a.createElement(Br.a,{item:!0,xs:12},I?u.a.createElement(u.a.Fragment,null,u.a.createElement("input",{ref:m,accept:"image/*",id:"contained-button-file",type:"file",style:{display:"none"},onChange:function(e){var t=new FileReader,a=e.target.files[0];a&&(t.onload=function(e){L(!0),R(Object(h.a)(Object(h.a)({},I),{},{avatar:e.target.result.toString()}))},t.readAsDataURL(a))}}),u.a.createElement("label",{htmlFor:"contained-button-file"},u.a.createElement(Z.a,{onClick:function(e){m.current.click()}},u.a.createElement(da.a,{style:{width:G?p.spacing(24):p.spacing(16),height:G?p.spacing(24):p.spacing(16)},alt:I.name,src:I.avatar},I.name.split(" ",2).map((function(e){return e?e[0].toUpperCase():""})).join(""))))):u.a.createElement(pr.a,{className:ne.skelItem,variant:"circle",width:G?p.spacing(24):p.spacing(16),height:G?p.spacing(24):p.spacing(16)}),u.a.createElement(Kt.a,{gutterBottom:!0},I?I.uname:u.a.createElement(pr.a,null))),u.a.createElement(Br.a,{item:!0,style:{marginTop:"2rem"},xs:12},u.a.createElement("div",{style:{paddingBottom:s?0:ee}},I?u.a.createElement(mi,{fullWidth:G,color:I.is_active?"primary":"default",onClick:H.username!==I.uname?function(){L(!0),R(Object(h.a)(Object(h.a)({},I),{},{is_active:!I.is_active}))}:null,label:I.is_active?d("enabled"):d("disabled"),type:"rounded",style:{minWidth:p.spacing(16)}}):u.a.createElement(pr.a,{className:ne.skelButton,style:{minWidth:p.spacing(16),width:G?"100%":null}}))))),u.a.createElement(Br.a,{item:!0,sm:12,md:9,style:{width:"100%"}},u.a.createElement(ki,{type:H.is_admin?"picker":"pill",size:"medium",format:"long",c12n:I&&I.classification,setClassification:function(e){L(!0),R(Object(h.a)(Object(h.a)({},I),{},{classification:e}))},isUser:!0}),u.a.createElement(qr.a,{className:ne.group,component:ua.a},u.a.createElement(Lr.a,{"aria-label":d("profile")},u.a.createElement(Fr.a,null,u.a.createElement(Pr.a,null,u.a.createElement(Mr.a,{colSpan:Object(z.b)("xs",t)?2:3},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},d("profile"))))),u.a.createElement(Wr.a,null,u.a.createElement(Pr.a,{className:ne.row},Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,{style:{whiteSpace:"nowrap"}},d("uname")),u.a.createElement(Mr.a,{width:"100%"},Object(z.b)("xs",t)?u.a.createElement(Kt.a,{variant:"caption"},d("uname")):null,I?u.a.createElement("div",null,I.uname):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"})),u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return ie("name")}},Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,{style:{whiteSpace:"nowrap"}},d("name")),u.a.createElement(Mr.a,{width:"100%"},Object(z.b)("xs",t)?u.a.createElement(Kt.a,{variant:"caption"},d("name")):null,I?u.a.createElement("div",null,I.name):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(Vr.a,null))),u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return ie("groups")}},Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,{style:{whiteSpace:"nowrap"}},d("groups")),u.a.createElement(Mr.a,{width:"100%"},Object(z.b)("xs",t)?u.a.createElement(Kt.a,{variant:"caption"},d("groups")):null,I?u.a.createElement("div",null,I.groups.join(" | ")):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(Vr.a,null))),u.a.createElement(Pr.a,{className:ne.row},Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,{style:{whiteSpace:"nowrap"}},d("email")),u.a.createElement(Mr.a,{width:"100%"},Object(z.b)("xs",t)?u.a.createElement(Kt.a,{variant:"caption"},d("email")):null,I?u.a.createElement("div",null,I.email):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"}))))),u.a.createElement(qr.a,{className:ne.group,component:ua.a},u.a.createElement(Lr.a,{"aria-label":d("options")},u.a.createElement(Fr.a,null,u.a.createElement(Pr.a,null,u.a.createElement(Mr.a,{colSpan:3},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},d("options"))))),u.a.createElement(Wr.a,null,u.a.createElement(Pr.a,null,Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,{style:{whiteSpace:"nowrap"}},d("roles")),u.a.createElement(Mr.a,{width:"100%"},Object(z.b)("xs",t)?u.a.createElement(Kt.a,{variant:"caption"},d("roles")):null,I?u.a.createElement("div",null,u.a.createElement(mi,{type:"rounded",size:"small",color:I.type.includes("user")?"primary":"default",onClick:H.username!==I.uname&&H.is_admin?function(){return le("user")}:null,label:d("normal_user")}),u.a.createElement(mi,{type:"rounded",size:"small",color:I.type.includes("admin")?"primary":"default",onClick:H.username!==I.uname&&H.is_admin?function(){return le("admin")}:null,label:d("admin")}),u.a.createElement(mi,{type:"rounded",size:"small",color:I.type.includes("signature_manager")?"primary":"default",onClick:H.is_admin?function(){return le("signature_manager")}:null,label:d("signature_manager")}),u.a.createElement(mi,{type:"rounded",size:"small",color:I.type.includes("signature_importer")?"primary":"default",onClick:H.is_admin?function(){return le("signature_importer")}:null,label:d("signature_importer")})):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"})),u.a.createElement(Pr.a,{hover:H.is_admin,style:{cursor:H.is_admin?"pointer":"default"},onClick:H.is_admin?function(e){return ie("api_quota")}:null},Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,{style:{whiteSpace:"nowrap"}},d("api_quota")),u.a.createElement(Mr.a,{width:"100%"},Object(z.b)("xs",t)?u.a.createElement(Kt.a,{variant:"caption"},d("api_quota")):null,I?u.a.createElement("div",null,I.api_quota):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"},H.is_admin?u.a.createElement(Vr.a,null):null)),u.a.createElement(Pr.a,{hover:H.is_admin,style:{cursor:H.is_admin?"pointer":"default"},onClick:H.is_admin?function(e){return ie("submission_quota")}:null},Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,{style:{whiteSpace:"nowrap"}},d("submission_quota")),u.a.createElement(Mr.a,{width:"100%"},Object(z.b)("xs",t)?u.a.createElement(Kt.a,{variant:"caption"},d("submission_quota")):null,I?u.a.createElement("div",null,I.submission_quota):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"},H.is_admin?u.a.createElement(Vr.a,null):null))))),u.a.createElement(qr.a,{className:ne.group,component:ua.a},u.a.createElement(Lr.a,{"aria-label":d("security")},u.a.createElement(Fr.a,null,u.a.createElement(Pr.a,null,u.a.createElement(Mr.a,{colSpan:2},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},d("security"))))),u.a.createElement(Wr.a,null,u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return ie("change_password")}},u.a.createElement(Mr.a,{width:"100%"},I?d("change_password"):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(Vr.a,null))),I&&H.username===I.uname&&V.auth.allow_2fa&&u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return ie(I&&I["2fa_enabled"]?"disable_otp":"otp")}},u.a.createElement(Mr.a,{width:"100%"},I?I["2fa_enabled"]?d("2fa_off"):d("2fa_on"):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(Vr.a,null))),I&&H.username===I.uname&&I["2fa_enabled"]&&V.auth.allow_security_tokens&&u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return ie("token")}},u.a.createElement(Mr.a,{width:"100%"},d("token")),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(Vr.a,null))),I&&H.username===I.uname&&V.auth.allow_apikeys&&u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return ie("api_key")}},u.a.createElement(Mr.a,{width:"100%"},d("apikeys")),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(Vr.a,null))),I&&H.username===I.uname&&u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return ie("apps")}},u.a.createElement(Mr.a,{width:"100%"},d("apps")),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(Vr.a,null)))))),I&&q?u.a.createElement("div",{style:{paddingTop:$,paddingBottom:$,position:"fixed",bottom:0,left:0,width:"100%",zIndex:p.zIndex.drawer-1,backgroundColor:p.palette.background.default,boxShadow:p.shadows[4]}},u.a.createElement(ma.a,{variant:"contained",color:"primary",disabled:M||!q,onClick:function(){ae({url:"/api/v4/user/".concat(a||s,"/"),method:"POST",body:I,onSuccess:function(){L(!1),Q(d("success_save"))},onEnter:function(){return W(!0)},onExit:function(){return W(!1)}})}},d("save"),M&&u.a.createElement(tr.a,{size:24,className:ne.buttonProgress}))):null)))}Ii.defaultProps={username:null};var Ri=Object(z.a)()(Ii);function zi(){var e=x().user;return u.a.createElement(Ri,{username:e.username})}var Di=a(411),Bi=a.n(Di);function qi(e){var t=e.items,a=Object(v.a)(),n=a.palette.action.active,r=a.spacing(10);return u.a.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-around"}},t.map((function(e,t){return u.a.createElement(ma.a,{key:t,component:Y.b,to:e.route},u.a.createElement("div",{style:{height:"300px",width:"300px",padding:r,textAlign:"center",color:n}},e.icon?u.a.cloneElement(e.icon,{style:{fontSize:"8rem"}},null):u.a.createElement(Bi.a,{style:{fontSize:"8rem"}}),u.a.createElement("span",{style:{fontSize:"medium"}},e.name||e.text)))})))}function Li(){var e=An();return x().user.is_admin?u.a.createElement(ir,{margin:4,width:"100%"},u.a.createElement(qi,{items:e.topnav.adminMenu})):u.a.createElement(ue.a,{to:"/forbidden"})}var Fi=a(86),Pi=a.n(Fi),Mi=a(85),Wi=a.n(Mi),Ui=a(110),Hi=a.n(Ui);function Vi(){var e=Object(d.b)(),t=e.enqueueSnackbar,a=e.closeSnackbar,n={preventDuplicate:!0,autoHideDuration:5e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},onClick:function(e){a()}};return{copy:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"root",r=document.createElement("textarea"),i=document.getElementById(a)||document.body;r.value=e,i.appendChild(r),r.focus(),r.select();var l=document.execCommand("copy");i.removeChild(r),t(e,l?Object(h.a)({variant:"success"},n):Object(h.a)({variant:"error"},n))}}}var Gi=Object(i.a)((function(e){return{page:{width:"100%"}}})),Yi=function(e){var t=e.children,a=e.margin,n=void 0===a?null:a,r=e.mb,i=void 0===r?2:r,s=e.ml,c=void 0===s?2:s,o=e.mr,m=void 0===o?2:o,d=e.mt,p=void 0===d?2:d,g=Gi(),f=Object(v.a)(),h=Object(l.a)(f.breakpoints.up("md"))?1:2;return u.a.createElement("div",{className:g.page},u.a.createElement("div",{style:{marginBottom:f.spacing(n/h||i/h),marginLeft:f.spacing(n/h||c/h),marginRight:f.spacing(n/h||m/h),marginTop:f.spacing(n/h||p/h)}},t))},Ji=function(e){var t=e.children,a=e.left,n=e.right,r=e.actions,i=e.isSticky,l=void 0!==i&&i,s=e.top,c=e.backgroundColor,o=void 0===c?null:c,m=e.elevation,d=void 0===m?0:m,p=Object(v.a)(),g=Pa(),f=g.currentLayout,h=g.autoHideAppbar,b=se(),E="top"!==f&&h;return u.a.createElement(ie.a,{id:"header1",position:l?"sticky":"relative",style:{top:void 0!==s?s:l?E?0:b:null,backgroundColor:o||p.palette.background.default,zIndex:l?null:p.zIndex.appBar-100},elevation:d,color:"inherit"},t,(a||n||r)&&u.a.createElement(w.a,{style:{minHeight:0},disableGutters:!0},u.a.createElement("div",{style:{flexGrow:1}},a),u.a.createElement("div",null,r&&r.map((function(e,t){var a=null;return a=e.title?u.a.createElement(ma.a,Object.assign({key:e.tooltip?null:e.key?e.key:"ph-action-".concat(t),startIcon:e.icon,color:e.color,onClick:e.action},e.btnProp,{style:{marginRight:p.spacing(1)}}),e.title):u.a.createElement(Z.a,Object.assign({key:e.tooltip?null:e.key?e.key:"ph-action-".concat(t),color:e.color,onClick:e.action},e.btnProp,{style:{marginRight:p.spacing(1)}}),e.icon),e.tooltip?u.a.createElement(I.a,{key:e.key?e.key:"ph-action-".concat(t),title:e.tooltip},a):a}))),u.a.createElement("div",null,n)))},Qi=a(124),Ki=a.n(Qi),Xi=Object(i.a)((function(e){var t;return{appMain:{"@media print":{overflow:"unset !important"},height:"100%",display:"flex",flexDirection:"row",position:"relative",overflowX:"hidden"},appContent:{"@media print":{overflow:"unset !important"},display:"flex",flexDirection:"column",position:"relative",flex:1,height:"100%",overflowX:"hidden"},appRightDrawer:{"@media print":{display:"none"},transition:"width 225ms cubic-bezier(0, 0, 0.2, 1) 0ms"},paper:(t={},Object(r.a)(t,e.breakpoints.only("xl"),{width:"45vw"}),Object(r.a)(t,e.breakpoints.only("lg"),{width:"85%"}),Object(r.a)(t,e.breakpoints.only("md"),{width:"85%"}),Object(r.a)(t,e.breakpoints.down("sm"),{width:"100%"}),t)}})),Zi=u.a.createContext(null);var $i=function(e){var t=e.children,a=Object(o.useState)(null),r=Object(n.a)(a,2),i=r[0],s=r[1],c=Object(v.a)(),m=Xi(),d=Object(l.a)(c.breakpoints.only("md")),p=Object(l.a)(c.breakpoints.only("lg")),g=Object(l.a)(c.breakpoints.only("xl")),f=g?"45vw":p||d?"85%":"100%",h=function(){s(null)};return u.a.createElement(Zi.Provider,{value:{closeGlobalDrawer:h,setGlobalDrawer:s,globalDrawer:i}},u.a.createElement("div",{className:m.appMain},Object(o.useMemo)((function(){return u.a.createElement("div",{className:m.appContent},t)}),[t]),u.a.createElement(N.a,{open:null!==i,className:m.appRightDrawer,style:{width:i?f:0,zIndex:c.zIndex.drawer+100},classes:{paper:m.paper},anchor:"right",variant:g?"persistent":"temporary",onClose:h},Object(o.useMemo)((function(){return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{id:"drawerTop",style:{backgroundColor:c.palette.background.paper,padding:c.spacing(1),position:"sticky",top:0,zIndex:1}},u.a.createElement(Z.a,{onClick:h},u.a.createElement(Ki.a,null))),u.a.createElement("div",{style:{paddingLeft:c.spacing(2),paddingRight:c.spacing(2)}},i))}),[i,c]))))};function el(){return Object(o.useContext)(Zi)}var tl=a(807),al=a(413),nl=a.n(al),rl=a(412);function il(e,t,a,n){var r=Object(rl.a)().name;e.focus(),"firefox"===r?function(e,t,a,n){var r=e.value,i=r.substring(0,t),l=r.substring(a),s="".concat(i).concat(n).concat(l);e.value=s}(e,t,a,n):function(e,t,a,n){e.setSelectionRange(t,a),document.execCommand("insertText",!1,n)}(e,t,a,n)}function ll(e,t){return e===t}function sl(e){return ll(e,"ArrowUp")}function cl(e){return ll(e,"ArrowDown")}function ol(e){return ll(e,"ArrowLeft")}function ul(e){return ll(e,"ArrowRight")}function ml(e){return ll(e,"Escape")}function dl(e){return ll(e,"Enter")}var pl=["OR","AND","NOT","TO","now","d","M","y","h","m"],gl=Object(i.a)((function(e){return{searchTextFieldOptionsCt:{textAlign:"left",position:"relative",height:0,outline:"none",borderRadius:"0 0 4px 4px"},searchTextFieldOptionsInner:{display:"inline-block",position:"absolute",overflow:"auto",zIndex:1,top:e.spacing(1),minWidth:"100%",maxHeight:250,backgroundColor:e.palette.background.default,boxShadow:e.shadows[4],borderRadius:"0 0 4px 4px"},searchTextFieldItem:{padding:e.spacing(1),"&:hover":{cursor:"pointer",backgroundColor:e.palette.action.hover},'&[data-searchtextfieldoption-selected="true"]':{backgroundColor:e.palette.action.selected}}}})),fl=function(e){var t=e.text,a=e.position,n=e.selected,r=void 0!==n&&n,i=e.onSelection,l=gl();return u.a.createElement(R.a,{className:l.searchTextFieldItem,"data-searchtextfieldoption-position":a,"data-searchtextfieldoption-selected":r,onClick:function(){return i()}},t)},hl=function(e){var t=e.value,a=e.options,r=e.placeholder,i=void 0===r?null:r,s=e.disabled,c=void 0!==s&&s,m=e.onSearch,d=e.onChange,p=e.onSelection,g=e.onClear,f=Object(v.a)(),h=gl(),b=Object(o.useState)(-1),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Object(o.useState)({start:0,end:0,items:a}),x=Object(n.a)(_,2),w=x[0],j=x[1],k=Object(X.a)().t,S=Object(o.useState)(!1),C=Object(n.a)(S,2),T=C[0],A=C[1],N=Object(o.useRef)(),I=Object(o.useRef)(),R=Object(l.a)(f.breakpoints.up("md"));Object(o.useEffect)((function(){return j({start:0,end:0,items:a})}),[a]);var z=function(){return N.current.querySelector("input")},D=function(){A(!0)},B=function(){A(!1),O(-1),z().focus()},q=function(e,t,a){if(a){var n=z();il(n,e,t+1,"".concat(a).concat(-1===pl.indexOf(a)?":":"")),B(),d(n.value),p&&p(a)}},L=function(e){var t=I.current.querySelector('[data-searchtextfieldoption-position="'.concat(e,'"'));t&&t.scrollIntoView({block:"nearest"})},F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=P(e,t),r=n.value,i=n.cursor,l=n.startIndex,s=n.endIndex,c=r.length>0?a.filter((function(e){return e.toLowerCase().includes(r.toLowerCase())})):a;j({start:l>-1?l:i,end:s>-1?s:i,items:c}),0===c.length&&A(!1)},P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=z().selectionStart+t,n=e.substr(0,a),r=e.substr(a),i=-1,l=-1,s=n.split(" "),c=s[s.length-1],o=r.split(" "),u=o[0];return""!==c&&(i=a-c.length),l=""!==u?a+u.length-1:i>-1?a-1:-1,-1===i&&l>-1&&(i=a),{value:c,cursor:a,startIndex:i,endIndex:l}};return u.a.createElement("div",{ref:N},u.a.createElement(hr.a,{placeholder:i||k("filter"),value:t,color:"secondary",InputProps:{disableUnderline:!0},disabled:c,onChange:function(e){var t=e.currentTarget.value;d(t),F(t)},onKeyDown:function(e){var a=e.key;if(dl(a))T&&-1!==y?q(w.start,w.end,w.items[y]):(m(t),T&&B());else if(ml(a))T?B():g();else if(sl(a)){if(e.preventDefault(),T){var n=y-1>-1?y-1:w.items.length-1;O(n),L(n)}}else if(cl(a))if(e.preventDefault(),T){var r=y+1<w.items.length?y+1:0;O(r),L(r)}else D();else ol(a)?F(t,-1):ul(a)?F(t,1):T||D()},onBlur:function(){},autoFocus:!0,fullWidth:!0}),T&&R?u.a.createElement("div",{ref:I,className:h.searchTextFieldOptionsCt},u.a.createElement("div",{className:h.searchTextFieldOptionsInner},w.items.map((function(e,t){return u.a.createElement(fl,{key:"SearchTextField-item-".concat(t),text:e,position:t,onSelection:function(){return q(w.start,w.end,e)},selected:t===y})})))):null)},bl=Object(i.a)((function(e){return{root:{"& button":{marginRight:e.spacing(1)}},searchbar:{borderRadius:"4px",paddingLeft:e.spacing(2),backgroundColor:Object(ba.c)(e.palette.text.primary,.04),"&:hover":{backgroundColor:Object(ba.c)(e.palette.text.primary,.06)},"& input":{color:e.palette.text.secondary}},searchresult:{color:e.palette.primary.light,paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)}}})),vl=function(e){var t=e.initValue,a=e.children,r=e.placeholder,i=e.searching,s=void 0!==i&&i,c=e.suggestions,m=void 0===c?[]:c,d=e.buttons,p=void 0===d?[]:d,g=e.extras,f=e.onValueChange,h=e.onSearch,b=e.onClear,E=Object(X.a)().t,y=Object(v.a)(),O=bl(),_=Object(o.useRef)(),x=Object(o.useState)(t),w=Object(n.a)(x,2),k=w[0],S=w[1],C=Object(l.a)(y.breakpoints.up("md")),T=function(){return _.current.querySelector("input")},A=function(){S(""),b(T())};return Object(o.useEffect)((function(){S(t)}),[t]),u.a.createElement("div",{ref:_,className:O.root},u.a.createElement(R.a,{display:"flex",flexDirection:"row",className:O.searchbar,alignItems:"center",style:{paddingRight:g?null:y.spacing(.5)}},u.a.createElement(R.a,{flex:1,display:"relative"},u.a.createElement(hl,{value:k,placeholder:r,options:m,disabled:s,onChange:function(e){S(e),f(e)},onSearch:function(){h(k,T())},onClear:A})),u.a.createElement(Z.a,{onClick:A,edge:"end",size:C?null:"small",style:{marginRight:y.spacing(C?1:.5)}},u.a.createElement(I.a,{title:E("clear_filter")},u.a.createElement(nl.a,{fontSize:C?"default":"small"}))),0!==p.length&&u.a.createElement(j.a,{orientation:"vertical",flexItem:!0,style:{marginLeft:y.spacing(C?0:.5),marginRight:y.spacing(C?1:.5)}}),p.map((function(e,t){return e.tooltip?u.a.createElement(I.a,{key:"searchbar-button-".concat(t),title:e.tooltip},u.a.createElement(Z.a,Object.assign({},e.props,{edge:"end",size:C?null:"small",style:{marginRight:y.spacing(C?1:.5)}}),e.icon)):u.a.createElement(Z.a,Object.assign({key:"searchbar-button-".concat(t)},e.props,{edge:"end",size:C?null:"small",style:{marginRight:y.spacing(C?1:.5)}}),e.icon)})),g),s&&u.a.createElement(tl.a,{style:{position:"absolute",height:y.spacing(C?.5:.25),marginTop:y.spacing(C?-.5:-.25),width:"100%",borderRadius:"0 0 4px 4px"}}),u.a.createElement("div",{className:O.searchresult},a))},El=a(97),yl=a(98),Ol=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rows=25&offset=0";Object(El.a)(this,e),this.params=null,this.defaultParams=null,this.params=new URLSearchParams(t),this.defaultParams=new URLSearchParams(a)}return Object(yl.a)(e,[{key:"getDefaultString",value:function(){return this.defaultParams.toString()}},{key:"getDeltaString",value:function(){var e=this,t=new URLSearchParams;return this.params.forEach((function(a,n){e.defaultParams.get(n)!==a&&t.append(n,a)})),t.toString()}},{key:"getParams",value:function(){var e=this,t={};return this.defaultParams.forEach((function(a,n){n in t||e.params.has(n)?"fq"===n&&t[n].push(a):t[n]="fq"!==n?a:[a]})),this.params.forEach((function(e,a){a in t?"fq"===a&&t[a].push(e):t[a]="fq"!==a?e:[e]})),t}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.params.get(e)||t}},{key:"set",value:function(e,t){this.params.set(e,t)}},{key:"getAll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.params.getAll(e)||t}},{key:"delete",value:function(e){this.params.delete(e)}},{key:"has",value:function(e){return this.params.has(e)}},{key:"toString",value:function(){var e=new URLSearchParams(this.params.toString());return e.delete("group_by"),e.toString()}}]),e}(),_l=a(819),xl=u.a.memo((function(e){var t=e.total,a=e.pageSize,n=e.index,r=e.method,i=void 0===r?"POST":r,l=e.query,s=e.setResults,c=e.scrollToTop,o=void 0===c||c,m=e.size,d=void 0===m?"small":m,p=e.setSearching,g=void 0===p?null:p,f=e.url,h=void 0===f?null:f,v=(e.children,Object(b.a)(e,["total","pageSize","index","method","query","setResults","scrollToTop","size","setSearching","url","children"])),E=dr(),y=Math.ceil(t/a);return y>1?u.a.createElement(_l.a,Object.assign({},v,{count:y,onChange:function(e,t){g&&g(!0);var r=new Ol(l.toString(),l.getDefaultString());r.set("rows",a),r.set("offset",(t-1)*a),E({method:i,url:"".concat(h||"/api/v4/search/".concat(n,"/")).concat("GET"===i?"?".concat(r.toString()):""),body:"POST"===i?r.getParams():null,onSuccess:function(e){s(e.api_response),o&&window.scrollTo(0,0)},onFinalize:function(){g&&g(!1)}})},shape:"rounded",size:d})):null})),wl=a(808),jl=a(829),kl=(a(27),Object(Dr.a)((function(e){return Object(G.a)({root:{paddingRight:"8px",paddingLeft:"8px"},head:{backgroundColor:"dark"===e.palette.type?"#404040":"#EEE",whiteSpace:"nowrap"}})}))(Mr.a)),Sl=function(e){var t=e.children,a=Object(b.a)(e,["children"]);return u.a.createElement(kl,Object.assign({},a,{component:"div"}),t)};Sl.defaultProps={children:null};var Cl=function(e){var t=e.children,a=e.sortField,n=e.allowSort,r=void 0===n||n,i=Object(b.a)(e,["children","sortField","allowSort"]),l=Object(ue.h)(),s=new URLSearchParams(l.search),c=s.get("sort"),o=Object(ue.g)(),m=c&&-1!==c.indexOf(a),d=m&&-1!==c.indexOf("asc")?"asc":"desc";return u.a.createElement(kl,Object.assign({},i,{component:"div"}),r?u.a.createElement(jl.a,{active:m,direction:d,onClick:function(){c&&-1!==c.indexOf(a)&&-1===c.indexOf("asc")?s.set("sort","".concat(a," asc")):s.set("sort","".concat(a," desc")),o.push("".concat(l.pathname,"?").concat(s.toString()))}},t):t)},Tl=function(e){var t=e.children,a=e.to,n=Object(b.a)(e,["children","to"]);return u.a.createElement(Pr.a,Object.assign({component:Y.b},n,{to:a,style:{cursor:"pointer",textDecoration:"none"}}),t)},Al=function(e){var t=e.children,a=Object(b.a)(e,["children"]);return u.a.createElement(Pr.a,Object.assign({},a,{component:"div"}),t)},Nl=function(e){var t=e.children,a=Object(b.a)(e,["children"]);return u.a.createElement(Fr.a,Object.assign({},a,{component:"div"}),t)},Il=function(e){var t=e.children,a=Object(b.a)(e,["children"]);return u.a.createElement(Wr.a,Object.assign({},a,{component:"div"}),t)},Rl=function(e){var t=e.children,a=e.size,n=void 0===a?"small":a,r=Object(b.a)(e,["children","size"]);return u.a.createElement(Lr.a,Object.assign({size:n},r,{component:"div"}),t)},zl=a(23),Dl=a.n(zl),Bl=a(820),ql=Object(Dr.a)((function(e){return Object(G.a)({root:{marginbottom:e.spacing(2),marginTop:e.spacing(4),color:e.palette.text.secondary,backgroundColor:Object(ba.c)(e.palette.text.primary,.04)},icon:{color:"".concat(e.palette.text.secondary," !important")},message:{width:"100%",textAlign:"left"}})}))(Bl.a),Ll=function(e){var t=e.children,a=Object(b.a)(e,["children"]);return u.a.createElement(ql,Object.assign({},a,{severity:"info"}),t)},Fl=u.a.memo((function(e){var t=e.errorResults,a=e.onClick,n=Object(X.a)(["adminErrorViewer"]),r=n.t,i=n.i18n,l=Object(v.a)(),s={"MAX DEPTH REACHED":u.a.createElement(Wi.a,{style:{color:l.palette.action.active}}),"MAX RETRY REACHED":u.a.createElement(Wi.a,{style:{color:l.palette.action.active}}),EXCEPTION:u.a.createElement(Hi.a,{style:{color:l.palette.action.active}}),"TASK PRE-EMPTED":u.a.createElement(Pi.a,{style:{color:l.palette.action.active}}),"SERVICE DOWN":u.a.createElement(Pi.a,{style:{color:l.palette.action.active}}),"SERVICE BUSY":u.a.createElement(Pi.a,{style:{color:l.palette.action.active}}),"MAX FILES REACHED":u.a.createElement(Wi.a,{style:{color:l.palette.action.active}}),UNKNOWN:u.a.createElement(Hi.a,{style:{color:l.palette.action.active}})};return t?0!==t.total?u.a.createElement(qr.a,{component:ua.a},u.a.createElement(Rl,{size:"small"},u.a.createElement(Nl,null,u.a.createElement(Al,{style:{whiteSpace:"nowrap"}},u.a.createElement(Cl,{sortField:"created"},r("header.time")),u.a.createElement(Cl,{sortField:"response.service_name"},r("header.service")),u.a.createElement(Sl,null,r("header.message")),u.a.createElement(Cl,{sortField:"type"},r("header.type")))),u.a.createElement(Il,null,t.items.map((function(e){return u.a.createElement(Al,{key:e.id,hover:!0,onClick:function(){return a(e)},style:{cursor:"pointer"}},u.a.createElement(Sl,{style:{whiteSpace:"nowrap"}},u.a.createElement(I.a,{title:e.created},u.a.createElement(Dl.a,{fromNow:!0,locale:i.language},e.created))),u.a.createElement(Sl,{style:{whiteSpace:"nowrap"}},e.response.service_name),u.a.createElement(Sl,null,e.response.message),u.a.createElement(Sl,{style:{whiteSpace:"nowrap"}},u.a.createElement(I.a,{title:r("type.".concat(e.type))},u.a.createElement("span",null,s[e.type]))))}))))):u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(Ll,null,u.a.createElement(wl.a,null,r("no_errors_title")),r("no_results_desc"))):u.a.createElement(pr.a,{variant:"rect",style:{height:"6rem",borderRadius:"4px"}})})),Pl=a(129),Ml=Object(i.a)((function(e){return{searchresult:{fontStyle:"italic",paddingTop:e.spacing(.5),display:"flex",flexWrap:"wrap"},drawerPaper:Object(r.a)({width:"80%",maxWidth:"800px"},e.breakpoints.down("sm"),{width:"100%"}),clipboardIcon:{marginLeft:e.spacing(1),"&:hover":{cursor:"pointer",transform:"scale(1.1)"}}}}));function Wl(e){var t=e.error,a=Object(X.a)(["adminErrorViewer"]),n=a.t,r=a.i18n,i=Ml(),l=Object(v.a)(),s=Vi().copy,c={"MAX DEPTH REACHED":u.a.createElement(Wi.a,{style:{color:l.palette.action.active}}),"MAX RETRY REACHED":u.a.createElement(Wi.a,{style:{color:l.palette.action.active}}),EXCEPTION:u.a.createElement(Hi.a,{style:{color:l.palette.action.active}}),"TASK PRE-EMPTED":u.a.createElement(Pi.a,{style:{color:l.palette.action.active}}),"SERVICE DOWN":u.a.createElement(Pi.a,{style:{color:l.palette.action.active}}),"SERVICE BUSY":u.a.createElement(Pi.a,{style:{color:l.palette.action.active}}),"MAX FILES REACHED":u.a.createElement(Wi.a,{style:{color:l.palette.action.active}}),UNKNOWN:u.a.createElement(Hi.a,{style:{color:l.palette.action.active}})};return u.a.createElement("div",{style:{paddingLeft:l.spacing(2),paddingRight:l.spacing(2)}},u.a.createElement(Br.a,{container:!0,spacing:1,style:{paddingBottom:l.spacing(1)}},u.a.createElement(Br.a,{item:!0,xs:6,sm:8},u.a.createElement(Kt.a,{variant:"h5"},t.response.service_name),u.a.createElement(Kt.a,{variant:"caption"},"".concat(t.response.service_version).concat(t.response.service_tool_version&&" (".concat(t.response.service_tool_version,")")))),u.a.createElement(Br.a,{item:!0,xs:6,sm:4},u.a.createElement("div",{style:{display:"inline-block",textAlign:"start"}},u.a.createElement(Kt.a,{component:"div",variant:"body1"},u.a.createElement(Dl.a,{fromNow:!0,locale:r.language},t.created)),u.a.createElement(Kt.a,{component:"div",variant:"caption"},u.a.createElement(Dl.a,{format:"YYYY-MM-DD HH:mm:ss"},t.created))))),u.a.createElement(Br.a,{container:!0,spacing:1,style:{paddingBottom:l.spacing(1)}},u.a.createElement(Br.a,{item:!0,xs:6,sm:8},u.a.createElement("span",{style:{verticalAlign:"middle"}},c[t.type],"\xa0"),u.a.createElement("span",{style:{verticalAlign:"middle"}},n("type.".concat(t.type)))),u.a.createElement(Br.a,{item:!0,xs:6,sm:4,style:{alignSelf:"center"}},u.a.createElement("span",{style:{verticalAlign:"middle"}},n("fail.".concat(t.response.status))))),u.a.createElement("div",{style:{marginBottom:l.spacing(1)}},u.a.createElement("label",null,n("message")),u.a.createElement(cr.a,{variant:"outlined"},u.a.createElement("pre",{style:{paddingLeft:l.spacing(1),paddingRight:l.spacing(1),whiteSpace:"pre-wrap",minHeight:"10rem"}},t.response.message))),t.response.service_debug_info&&u.a.createElement("div",{style:{marginBottom:l.spacing(1)}},u.a.createElement("label",null,n("debug_info")),u.a.createElement(cr.a,{variant:"outlined"},u.a.createElement("pre",{style:{paddingLeft:l.spacing(1),paddingRight:l.spacing(1),whiteSpace:"pre-wrap"}},t.response.service_debug_info))),u.a.createElement("div",{style:{marginBottom:l.spacing(1)}},u.a.createElement("label",null,n("file_info")),u.a.createElement("div",{style:{wordBreak:"break-all"}},t.sha256,u.a.createElement(Pl.a,{className:i.clipboardIcon,onClick:function(){return s(t.sha256,"drawerTop")}}))))}function Ul(){var e=Object(X.a)(["adminErrorViewer"]).t,t=Object(o.useState)(25),a=Object(n.a)(t,1)[0],r=Object(o.useState)(!1),i=Object(n.a)(r,2),s=i[0],c=i[1],m=Object(o.useState)(null),d=Object(n.a)(m,2),p=d[0],g=d[1],f=Ml(),h=Object(ue.g)(),b=Object(o.useState)(null),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Object(v.a)(),w=dr(),j=x().user,k=Object(o.useState)(pl),S=Object(n.a)(k,2),C=S[0],T=S[1],A=Object(ue.h)(),N=Object(l.a)(_.breakpoints.up("md")),I=Object(o.useRef)(""),R=el().setGlobalDrawer;Object(o.useEffect)((function(){O(new Ol(A.search,"rows=".concat(a,"&offset=0")))}),[A.search,a]),Object(o.useEffect)((function(){y&&j.is_admin&&(y.set("rows",a),y.set("offset",0),c(!0),w({url:"/api/v4/error/list/?".concat(y.toString()),onSuccess:function(e){g(e.api_response)},onFinalize:function(){c(!1)}}))}),[y]),Object(o.useEffect)((function(){w({url:"/api/v4/search/fields/error/",onSuccess:function(e){T([].concat(Object(oe.a)(Object.keys(e.api_response).filter((function(t){return e.api_response[t].indexed}))),Object(oe.a)(pl)))}})}),[]);var z=Object(o.useCallback)((function(){h.push(A.pathname)}),[A.pathname]),D=Object(o.useCallback)((function(){""!==I.current?(y.set("query",I.current),h.push("".concat(A.pathname,"?").concat(y.toString()))):z()}),[y,A.pathname,z]),B=Object(o.useCallback)((function(e){R(u.a.createElement(Wl,{error:e}))}),[]);return j.is_admin?u.a.createElement(Yi,{margin:4},u.a.createElement("div",{style:{paddingBottom:_.spacing(2)}},u.a.createElement(Kt.a,{variant:"h4"},e("title"))),u.a.createElement(Ji,{isSticky:!0},u.a.createElement("div",{style:{paddingTop:_.spacing(1)}},u.a.createElement(vl,{initValue:y?y.get("query",""):"",placeholder:e("filter"),searching:s,suggestions:C,onValueChange:function(e){I.current=e},onClear:z,onSearch:D,buttons:[{icon:u.a.createElement(Hi.a,{fontSize:N?"default":"small"}),tooltip:e("exception"),props:{onClick:function(){y.set("query","type:EXCEPTION OR type:UNKNOWN"),h.push("".concat(A.pathname,"?").concat(y.getDeltaString()))}}},{icon:u.a.createElement(Pi.a,{fontSize:N?"default":"small"}),tooltip:e("canceled"),props:{onClick:function(){y.set("query","type:SERVICE* OR type:TASK*"),h.push("".concat(A.pathname,"?").concat(y.getDeltaString()))}}},{icon:u.a.createElement(Wi.a,{fontSize:N?"default":"small"}),tooltip:e("maxed"),props:{onClick:function(){y.set("query","type:MAX*"),h.push("".concat(A.pathname,"?").concat(y.getDeltaString()))}}}]},null!==p&&u.a.createElement("div",{className:f.searchresult},0!==p.total&&u.a.createElement(Kt.a,{variant:"subtitle1",color:"secondary",style:{flexGrow:1}},s?u.a.createElement("span",null,e("searching")):u.a.createElement("span",null,p.total,"\xa0",y.get("query")?e("filtered".concat(1===p.total?"":"s")):e("total".concat(1===p.total?"":"s")))),u.a.createElement(xl,{method:"GET",url:"/api/v4/error/list/",total:p.total,setResults:g,pageSize:a,index:"user",query:y,setSearching:c}))))),u.a.createElement("div",{style:{paddingTop:_.spacing(2),paddingLeft:_.spacing(.5),paddingRight:_.spacing(.5)}},u.a.createElement(Fl,{errorResults:p,onClick:B}))):u.a.createElement(ue.a,{to:"/forbidden"})}var Hl=a(80),Vl=a.n(Hl),Gl=a(811),Yl=a(32),Jl=a.n(Yl),Ql=a(133),Kl=a(810),Xl=a(812);var Zl=function(e){return u.a.createElement("div",null)},$l=a(248),es=a(830),ts=a(809),as=a(821),ns={name:"",value:""},rs=function(e){var t=e.envVar,a=e.onAdd,r=e.onUpdate,i=e.onDelete,l=Object(X.a)(["adminServices"]).t,s=Object(o.useState)(ns),c=Object(n.a)(s,2),m=c[0],d=c[1],p=Object(v.a)();return t?u.a.createElement(Br.a,{container:!0,spacing:1,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:10,sm:3,style:{wordBreak:"break-word"}},"".concat(t.name," :")),u.a.createElement(Br.a,{item:!0,xs:10,sm:8},u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",value:t.value,onChange:function(e){r(Object(h.a)(Object(h.a)({},t),{},{value:e.target.value}))},style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:2,sm:1},u.a.createElement(I.a,{title:l("params.user.remove")},u.a.createElement(Z.a,{style:{color:"dark"===p.palette.type?p.palette.error.light:p.palette.error.dark},onClick:function(){return i(t)}},u.a.createElement(Jl.a,null))))):u.a.createElement(Br.a,{container:!0,spacing:1,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:10,sm:3},u.a.createElement(hr.a,{fullWidth:!0,placeholder:l("container.dialog.environment.name"),size:"small",margin:"dense",variant:"outlined",onChange:function(e){d(Object(h.a)(Object(h.a)({},m),{},{name:e.target.value}))},value:m.name,style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:10,sm:8},u.a.createElement(hr.a,{fullWidth:!0,placeholder:l("container.dialog.environment.value"),size:"small",margin:"dense",variant:"outlined",value:m.value,onChange:function(e){d(Object(h.a)(Object(h.a)({},m),{},{value:e.target.value}))},style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:2,sm:1,style:{height:p.spacing(8)}},""!==m.name&&""!==m.value&&u.a.createElement(I.a,{title:l("params.user.add")},u.a.createElement(Z.a,{style:{color:"dark"===p.palette.type?p.palette.success.light:p.palette.success.dark},onClick:function(){a(m),d(ns)}},u.a.createElement(Vl.a,null)))))};rs.defaultProps={envVar:null,onAdd:function(e){return console.log("ADD",e)},onUpdate:function(e){return console.log("UPDATE",e)},onDelete:function(e){return console.log("DELETE",e)}};var is=u.a.memo(rs),ls={capacity:"",mount_path:"",storage_class:""},ss=function(e){var t=e.name,a=e.vol,i=e.onAdd,l=e.onDelete,s=Object(X.a)(["adminServices"]).t,c=Object(o.useState)(ls),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Object(o.useState)(""),f=Object(n.a)(g,2),b=f[0],E=f[1],y=Object(v.a)(),O=function(e,t){p(Object(h.a)(Object(h.a)({},d),{},Object(r.a)({},e,t)))};return t&&a?u.a.createElement(Br.a,{container:!0,spacing:1,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:10,sm:3,style:{wordBreak:"break-word"}},"".concat(t," :")),u.a.createElement(Br.a,{item:!0,xs:10,sm:8},"".concat(a.mount_path," (").concat(a.capacity,")")),u.a.createElement(Br.a,{item:!0,xs:2,sm:1},u.a.createElement(I.a,{title:s("params.user.remove")},u.a.createElement(Z.a,{style:{color:"dark"===y.palette.type?y.palette.error.light:y.palette.error.dark},onClick:function(){return l(t)}},u.a.createElement(Jl.a,null))))):u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:10,sm:3},u.a.createElement(hr.a,{fullWidth:!0,placeholder:s("container.dialog.volumes.name"),size:"small",margin:"dense",variant:"outlined",onChange:function(e){E(e.target.value)},value:b,style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:10,sm:8},u.a.createElement(hr.a,{fullWidth:!0,placeholder:s("container.dialog.volumes.mount_path"),size:"small",margin:"dense",variant:"outlined",value:d.mount_path,onChange:function(e){return O("mount_path",e.target.value)},style:{margin:0}}),u.a.createElement(hr.a,{fullWidth:!0,placeholder:s("container.dialog.volumes.capacity"),size:"small",margin:"dense",variant:"outlined",value:d.capacity,onChange:function(e){return O("capacity",e.target.value)},style:{margin:0}}),u.a.createElement(hr.a,{fullWidth:!0,placeholder:s("container.dialog.volumes.storage_class"),size:"small",margin:"dense",variant:"outlined",value:d.storage_class,onChange:function(e){return O("storage_class",e.target.value)},style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:2,sm:1,style:{height:y.spacing(8)}},""!==b&&""!==d.capacity&&""!==d.mount_path&&""!==d.storage_class&&u.a.createElement(I.a,{title:s("params.user.add")},u.a.createElement(Z.a,{style:{color:"dark"===y.palette.type?y.palette.success.light:y.palette.success.dark},onClick:function(){i(b,d),p(ls),E("")}},u.a.createElement(Vl.a,null)))))};ss.defaultProps={name:null,vol:null,onAdd:function(e,t){return console.log("ADD",e,t)},onDelete:function(e){return console.log("DELETE",e)}};var cs=u.a.memo(ss),os={allow_internet_access:!1,command:null,cpu_cores:1,environment:[],image:"",ports:[],ram_mb:512,ram_mb_min:128,registry_password:"",registry_username:""},us=function(e){var t=e.open,a=e.setOpen,i=e.container,l=e.name,s=e.volumes,c=e.onSave,m=Object(X.a)(["adminServices"]).t,d=Object(o.useState)(!1),p=Object(n.a)(d,2),g=p[0],f=p[1],b=Object(o.useState)(i||os),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Object(o.useState)(l),x=Object(n.a)(_,2),w=x[0],j=x[1],k=Object(o.useState)(s),S=Object(n.a)(k,2),C=S[0],T=S[1],A=Object(v.a)(),N=function(){a(!1),f(!1),O(i||os),j(l),T(s)},I=function(e,t){f(!0),O(Object(h.a)(Object(h.a)({},y),{},Object(r.a)({},e,t)))},R=function(e){var t=Object(oe.a)(y.environment),a=-1;t.forEach((function(t,n){t.name===e.name&&(a=n)})),-1===a?t.push(e):t[a]=e,f(!0),O(Object(h.a)(Object(h.a)({},y),{},{environment:t}))},z=function(e){var t=Object(oe.a)(y.environment),a=-1;t.forEach((function(t,n){t.name===e.name&&(a=n)})),-1!==a&&(t.splice(a,1),f(!0),O(Object(h.a)(Object(h.a)({},y),{},{environment:t})))},D=function(e){var t=Object(h.a)({},C);delete t[e],f(!0),T(t)};return u.a.createElement("div",{style:{paddingTop:A.spacing(1)}},u.a.createElement(Xr.a,{open:t,onClose:N,"aria-labelledby":"form-dialog-title",fullWidth:!0,maxWidth:"md"},u.a.createElement(Zr.a,{id:"form-dialog-title"},m("container.dialog.title.".concat(null===l?"container":"dependency"))),u.a.createElement($r.a,null,u.a.createElement(Br.a,{container:!0,spacing:2},null!==l&&u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},m("container.dialog.name")),u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){return j(e.target.value)},value:w})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},m("container.dialog.image")),u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){return I("image",e.target.value)},value:y.image})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"subtitle2"},m("container.dialog.cpu")),u.a.createElement(hr.a,{fullWidth:!0,type:"number",size:"small",margin:"dense",variant:"outlined",onChange:function(e){return I("cpu_cores",e.target.value)},value:y.cpu_cores})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"subtitle2"},m("container.dialog.ram")),u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(hr.a,{fullWidth:!0,type:"number",size:"small",margin:"dense",variant:"outlined",onChange:function(e){return I("ram_mb_min",e.target.value)},value:y.ram_mb_min})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(hr.a,{fullWidth:!0,type:"number",size:"small",margin:"dense",variant:"outlined",onChange:function(e){return I("ram_mb",e.target.value)},value:y.ram_mb})))),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"subtitle2"},m("container.dialog.registry_username")),u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){return I("registry_username",e.target.value)},value:y.registry_username})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"subtitle2"},m("container.dialog.registry_password")),u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){return I("registry_password",e.target.value)},value:y.registry_password})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},m("container.dialog.command")),u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){f(!0),O(Object(h.a)(Object(h.a)({},y),{},{command:e.target.value.split(" ")}))},value:y.command?y.command.join(" "):""})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},m("container.dialog.allow_internet")),u.a.createElement(es.a,{value:y.allow_internet_access,onChange:function(){f(!0),O(Object(h.a)(Object(h.a)({},y),{},{allow_internet_access:!y.allow_internet_access}))}},u.a.createElement(ts.a,{value:!0,control:u.a.createElement(as.a,null),label:m("container.dialog.allow_internet.yes")}),u.a.createElement(ts.a,{value:!1,control:u.a.createElement(as.a,null),label:m("container.dialog.allow_internet.no")}))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},m("container.dialog.environment")),y.environment.map((function(e,t){return u.a.createElement(is,{key:t,envVar:e,onUpdate:R,onDelete:z})}))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(is,{onAdd:R})),null!==l&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},m("container.dialog.volumes")),Object.keys(C).map((function(e){return u.a.createElement(cs,{key:e,name:e,vol:C[e],onDelete:D})}))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(cs,{onAdd:function(e,t){f(!0),T(Object(h.a)(Object(h.a)({},C),{},Object(r.a)({},e,t)))}}))))),u.a.createElement(ti.a,null,u.a.createElement(ma.a,{onClick:N,color:"secondary"},m("container.dialog.cancelText")),u.a.createElement(ma.a,{onClick:function(){f(!1),a(!1),c(y,w,C)},color:"primary",disabled:!g||""===y.image},m("container.dialog.acceptText")))))};us.defaultProps={container:null,name:null,volumes:null};var ms=u.a.memo(us),ds=Object(i.a)((function(e){return{card:{border:"1px solid ".concat(e.palette.divider),borderRadius:"4px",padding:"8px",margin:"0.25rem 0",overflow:"auto",wordBreak:"break-word","&:hover":{backgroundColor:"dark"===e.palette.type?"#ffffff10":"#00000005",cursor:"pointer"}},card_title:{fontSize:"large",fontFamily:"monospace"},label:{fontWeight:500},mono:{fontSize:"larger",fontFamily:"monospace"}}})),ps=function(e){var t=e.container,a=e.name,r=e.volumes,i=e.onChange,l=Object(X.a)(["adminServices"]).t,s=Object(o.useState)(!1),c=Object(n.a)(s,2),m=c[0],d=c[1],p=Object(v.a)(),g=ds(),f="dark"===p.palette.type?p.palette.success.light:p.palette.success.dark,h="dark"===p.palette.type?p.palette.error.light:p.palette.error.dark;return u.a.createElement("div",{style:{paddingTop:p.spacing(1)}},u.a.createElement(ms,{open:m,setOpen:d,name:a,container:t,volumes:r,onSave:function(e,t,a){i(e,t,a)}}),u.a.createElement(cr.a,{className:g.card,onClick:function(){return d(!0)}},u.a.createElement(Br.a,{container:!0},a&&u.a.createElement(Br.a,{item:!0,xs:12,className:g.card_title,style:{fontWeight:700}},a),u.a.createElement(Br.a,{item:!0,xs:12,className:g.card_title},t.image),t.registry_password&&t.registry_username&&u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("i",null,l("container.card.creds"))),u.a.createElement(Br.a,{item:!0,xs:12,style:{paddingTop:p.spacing(1),paddingBottom:p.spacing(1)}},u.a.createElement(I.a,{title:l("container.card.cpu")},u.a.createElement("div",{style:{display:"inline-block",paddingRight:p.spacing(4)}},u.a.createElement($l.a,{size:24,style:{verticalAlign:"middle"}}),u.a.createElement("span",{style:{paddingLeft:p.spacing(1),verticalAlign:"middle"}},t.cpu_cores))),u.a.createElement(I.a,{title:l("container.card.ram")},u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement($l.b,{size:24,style:{verticalAlign:"middle"}}),u.a.createElement("span",{style:{paddingLeft:p.spacing(1),verticalAlign:"middle"}},t.ram_mb)))),t.command&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:5,sm:4,md:2,className:g.label},"".concat(l("container.card.command"),":")),u.a.createElement(Br.a,{item:!0,xs:7,sm:8,md:10,className:g.mono},t.command.join(" "))),u.a.createElement(Br.a,{item:!0,xs:5,sm:4,md:2,className:g.label},"".concat(l("container.card.internet"),":")),u.a.createElement(Br.a,{item:!0,xs:7,sm:8,md:10,className:g.mono,style:{color:t.allow_internet_access?f:h}},t.allow_internet_access?l("container.card.yes"):l("container.card.no")),t.environment&&0!==t.environment.length&&u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:g.label},"".concat(l("container.card.env"),":"),"\xa0"),t.environment.map((function(e,t){return u.a.createElement("div",{key:t,className:g.mono,style:{paddingLeft:"2rem"}},"".concat(e.name," = ").concat(e.value))}))),r&&0!==Object.keys(r).length&&u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:g.label},"".concat(l("container.card.volumes"),":"),"\xa0"),Object.keys(r).map((function(e,t){return u.a.createElement("div",{key:t,className:g.mono,style:{paddingLeft:"2rem"}},"".concat(e," = ").concat(r[e].mount_path," (").concat(r[e].capacity,")"))}))))))};ps.defaultProps={name:null,volumes:null};var gs=u.a.memo(ps),fs=function(e){var t=e.service,a=e.setService,r=e.setModified,i=Object(X.a)(["adminServices"]).t,l=Object(o.useState)(!1),s=Object(n.a)(l,2),c=s[0],m=s[1],d=Object(v.a)(),p=function(e,n,i){var l=Object(h.a)({},t.dependencies);l[n]={container:e,volumes:i},r(!0),a(Object(h.a)(Object(h.a)({},t),{},{dependencies:l}))};return u.a.createElement(Br.a,{container:!0,spacing:2},u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"h6"},i("container"))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},i("container.channel")),t?u.a.createElement(Qr.a,{id:"channel",fullWidth:!0,value:t.update_channel,onChange:function(e){r(!0),a(Object(h.a)(Object(h.a)({},t),{},{update_channel:e.target.value}))},variant:"outlined",margin:"dense",style:{marginTop:d.spacing(1),marginBottom:d.spacing(.5)}},u.a.createElement(Kr.a,{value:"stable"},i("container.channel.stable")),u.a.createElement(Kr.a,{value:"dev"},i("container.channel.dev"))):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},i("container.image")),t?u.a.createElement(gs,{container:t.docker_config,onChange:function(e){r(!0),a(Object(h.a)(Object(h.a)({},t),{},{docker_config:e}))}}):u.a.createElement(pr.a,{style:{height:"8rem"}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},i("container.dependencies")),t?0!==Object.keys(t.dependencies).length?Object.keys(t.dependencies).map((function(e){return u.a.createElement("div",{key:e,style:{display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{paddingRight:d.spacing(1),flexGrow:1}},u.a.createElement(gs,{name:e,container:t.dependencies[e].container,volumes:t.dependencies[e].volumes,onChange:p})),u.a.createElement("div",null,u.a.createElement(I.a,{title:i("container.dependencies.remove")},u.a.createElement(Z.a,{style:{color:"dark"===d.palette.type?d.palette.error.light:d.palette.error.dark},onClick:function(){return function(e){var n=Object(h.a)({},t.dependencies);delete n[e],r(!0),a(Object(h.a)(Object(h.a)({},t),{},{dependencies:n}))}(e)}},u.a.createElement(Jl.a,null)))))})):u.a.createElement(Kt.a,{color:"textSecondary",variant:"caption",component:"div"},i("container.dependencies.none")):u.a.createElement(pr.a,{style:{height:"8rem"}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(ms,{open:c,setOpen:m,name:"",volumes:{},onSave:p}),u.a.createElement(ma.a,{variant:"contained",color:"primary",onClick:function(){return m(!0)}},i("container.dependencies.add"))))},hs=function(e){var t=e.service,a=e.constants,n=e.versions,r=e.setService,i=e.setModified,l=Object(X.a)(["adminServices"]).t,s=Object(v.a)(),c=Ma().c12nDef;return u.a.createElement("div",null,u.a.createElement(Br.a,{container:!0,spacing:2},u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.name")),t?u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",disabled:!0,value:t.name}):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.version")),t?u.a.createElement(Qr.a,{id:"version",fullWidth:!0,value:t.version,onChange:function(e){i(!0),r(Object(h.a)(Object(h.a)({},t),{},{version:e.target.value}))},variant:"outlined",margin:"dense",style:{marginTop:s.spacing(1),marginBottom:s.spacing(.5)}},n?n.map((function(e,t){return u.a.createElement(Kr.a,{key:t,value:e},e)})):u.a.createElement(Kr.a,{value:t.version},t.version)):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),c.enforce&&u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.classification")),u.a.createElement(ki,{type:"picker",c12n:t?t.default_result_classification:null,setClassification:function(e){i(!0),r(Object(h.a)(Object(h.a)({},t),{},{default_result_classification:e}))}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.description")),t?u.a.createElement(hr.a,{fullWidth:!0,size:"small",multiline:!0,rows:6,margin:"dense",variant:"outlined",onChange:function(e){i(!0),r(Object(h.a)(Object(h.a)({},t),{},{description:e.target.value}))},value:t.description}):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.stage")),t?u.a.createElement(Qr.a,{id:"stage",fullWidth:!0,value:t.stage,onChange:function(e){i(!0),r(Object(h.a)(Object(h.a)({},t),{},{stage:e.target.value}))},variant:"outlined",margin:"dense",style:{marginTop:s.spacing(1),marginBottom:s.spacing(.5)}},a?a.stages.map((function(e,t){return u.a.createElement(Kr.a,{key:t,value:e},e)})):u.a.createElement(Kr.a,{value:t.stage},t.stage)):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.category")),t?u.a.createElement(Qr.a,{id:"category",fullWidth:!0,value:t.category,onChange:function(e){i(!0),r(Object(h.a)(Object(h.a)({},t),{},{category:e.target.value}))},variant:"outlined",margin:"dense",style:{marginTop:s.spacing(1),marginBottom:s.spacing(.5)}},a?a.categories.map((function(e,t){return u.a.createElement(Kr.a,{key:t,value:e},e)})):u.a.createElement(Kr.a,{value:t.category},t.category)):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.accept")),t?u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){i(!0),r(Object(h.a)(Object(h.a)({},t),{},{accepts:e.target.value}))},value:t.accepts}):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.reject")),t?u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){i(!0),r(Object(h.a)(Object(h.a)({},t),{},{rejects:e.target.value}))},value:t.rejects}):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.timeout")),t?u.a.createElement(hr.a,{fullWidth:!0,type:"number",size:"small",margin:"dense",variant:"outlined",onChange:function(e){i(!0),r(Object(h.a)(Object(h.a)({},t),{},{timeout:e.target.value}))},value:t.timeout}):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.licence")),t?u.a.createElement(hr.a,{fullWidth:!0,type:"number",size:"small",margin:"dense",variant:"outlined",onChange:function(e){i(!0),r(Object(h.a)(Object(h.a)({},t),{},{licence_count:e.target.value}))},value:t.licence_count}):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.location")),t?u.a.createElement(es.a,{value:t.is_external,onChange:function(){i(!0),r(Object(h.a)(Object(h.a)({},t),{},{is_external:!t.is_external}))}},u.a.createElement(ts.a,{value:!0,control:u.a.createElement(as.a,null),label:l("general.location.external")}),u.a.createElement(ts.a,{value:!1,control:u.a.createElement(as.a,null),label:l("general.location.internal")})):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},l("general.caching")),t?u.a.createElement(es.a,{value:t.disable_cache,onChange:function(){i(!0),r(Object(h.a)(Object(h.a)({},t),{},{disable_cache:!t.disable_cache}))}},u.a.createElement(ts.a,{value:!1,control:u.a.createElement(as.a,null),label:l("general.caching.enabled")}),u.a.createElement(ts.a,{value:!0,control:u.a.createElement(as.a,null),label:l("general.caching.disabled")})):u.a.createElement(pr.a,{style:{height:"2.5rem"}}))))},bs=a(146),vs=a.n(bs),Es={name:"",type:"bool",value:"false"},ys=function(e){var t,a=e.config,r=e.onAdd,i=e.onUpdate,l=e.onDelete,s=Object(X.a)(["adminServices"]).t,c=Object(o.useState)(Es),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Object(v.a)(),f={base00:"transparent",base01:"#f1f1f1",base02:"dark"===g.palette.type?g.palette.text.hint:g.palette.divider,base03:"#444",base04:g.palette.grey["dark"===g.palette.type?700:400],base05:g.palette.grey[(g.palette.type,700)],base06:"#444",base07:g.palette.text.primary,base08:g.palette.text.secondary,base09:"dark"===g.palette.type?g.palette.warning.light:g.palette.warning.dark,base0A:"#333",base0B:"dark"===g.palette.type?g.palette.error.light:g.palette.error.dark,base0C:"dark"===g.palette.type?g.palette.secondary.light:g.palette.secondary.dark,base0D:"dark"===g.palette.type?g.palette.info.light:g.palette.info.dark,base0E:"dark"===g.palette.type?g.palette.info.light:g.palette.info.dark,base0F:"dark"===g.palette.type?g.palette.error.light:g.palette.error.dark},b=a?"number"===typeof(t=a).value?Object(h.a)(Object(h.a)({},t),{},{type:"int"}):"object"===typeof t.value?Array.isArray(t.value)?Object(h.a)(Object(h.a)({},t),{},{type:"list",value:t.value.toString()}):Object(h.a)(Object(h.a)({},t),{},{type:"json"}):"boolean"===typeof t.value?Object(h.a)(Object(h.a)({},t),{},{type:"bool"}):Object(h.a)(Object(h.a)({},t),{},{type:"str"}):null,E=function(e){var t=e.target.value;"bool"===b.type?i(Object(h.a)(Object(h.a)({},b),{},{value:"true"===t})):"list"===b.type?i(Object(h.a)(Object(h.a)({},b),{},{value:t.split(",")})):"str"===b.type?i(Object(h.a)(Object(h.a)({},b),{},{value:t})):"int"===b.type&&i(Object(h.a)(Object(h.a)({},b),{},{value:parseInt(t)||0}))},y=function(e){var t=e.updated_src;i(Object(h.a)(Object(h.a)({},b),{},{value:t}))},O=function(e){p(Object(h.a)(Object(h.a)({},d),{},{value:e.target.value}))},_=function(e){var t=e.updated_src;p(Object(h.a)(Object(h.a)({},d),{},{value:t}))};return a?u.a.createElement(Br.a,{container:!0,spacing:1,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:10,sm:3,style:{wordBreak:"break-word"}},"".concat(b.name," [").concat(b.type,"]:")),u.a.createElement(Br.a,{item:!0,xs:10,sm:8},"bool"===b.type?u.a.createElement(Qr.a,{id:"user_spec_params",fullWidth:!0,value:b.value,onChange:E,variant:"outlined",margin:"dense"},u.a.createElement(Kr.a,{value:"false"},s("params.false")),u.a.createElement(Kr.a,{value:"true"},s("params.true"))):"json"===b.type?u.a.createElement(vs.a,{name:!1,src:b.value,theme:f,enableClipboard:!1,groupArraysAfterLength:10,displayDataTypes:!1,displayObjectSize:!1,onAdd:y,onDelete:y,onEdit:y,style:{border:"1px solid ".concat(g.palette.divider),borderRadius:"4px",fontSize:"1rem",minHeight:g.spacing(5),padding:"4px"}}):u.a.createElement(hr.a,{fullWidth:!0,type:"int"===b.type?"number":"text",size:"small",margin:"dense",variant:"outlined",value:b.value,onChange:E,style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:2,sm:1},u.a.createElement(I.a,{title:s("params.user.remove")},u.a.createElement(Z.a,{style:{color:"dark"===g.palette.type?g.palette.error.light:g.palette.error.dark},onClick:function(){return l(b)}},u.a.createElement(Jl.a,null))))):u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:10,sm:3},u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){p(Object(h.a)(Object(h.a)({},d),{},{name:e.target.value}))},value:d.name,style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:10,sm:2},u.a.createElement(Qr.a,{id:"user_spec_params",fullWidth:!0,value:d.type,onChange:function(e){var t=e.target.value;p(Object(h.a)(Object(h.a)({},d),{},{type:t,value:"int"===t?"1":"bool"===t?"false":"json"===t?{}:""}))},variant:"outlined",margin:"dense"},u.a.createElement(Kr.a,{value:"bool"},"bool"),u.a.createElement(Kr.a,{value:"int"},"int"),u.a.createElement(Kr.a,{value:"json"},"json"),u.a.createElement(Kr.a,{value:"list"},"list (",s("params.comma"),")"),u.a.createElement(Kr.a,{value:"str"},"str"))),u.a.createElement(Br.a,{item:!0,xs:10,sm:6},"bool"===d.type?u.a.createElement(Qr.a,{id:"user_spec_params",fullWidth:!0,value:d.value,onChange:O,variant:"outlined",margin:"dense"},u.a.createElement(Kr.a,{value:"false"},s("params.false")),u.a.createElement(Kr.a,{value:"true"},s("params.true"))):"json"===d.type?u.a.createElement(vs.a,{name:!1,src:d.value,theme:f,enableClipboard:!1,groupArraysAfterLength:10,displayDataTypes:!1,displayObjectSize:!1,onAdd:_,onDelete:y,onEdit:_,style:{border:"1px solid ".concat(g.palette.divider),borderRadius:"4px",fontSize:"1rem",minHeight:g.spacing(5),padding:"4px"}}):u.a.createElement(hr.a,{fullWidth:!0,type:"int"===d.type?"number":"text",size:"small",margin:"dense",variant:"outlined",value:d.value,onChange:O,style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:2,sm:1,style:{height:g.spacing(8)}},""!==d.name&&u.a.createElement(I.a,{title:s("params.user.add")},u.a.createElement(Z.a,{style:{color:"dark"===g.palette.type?g.palette.success.light:g.palette.success.dark},onClick:function(){"bool"===d.type?r(Object(h.a)(Object(h.a)({},d),{},{value:"true"===d.value})):"list"===d.type?r(Object(h.a)(Object(h.a)({},d),{},{value:d.value.split(",")})):"str"===d.type?r(Object(h.a)(Object(h.a)({},d),{},{value:d.value})):"int"===d.type?r(Object(h.a)(Object(h.a)({},d),{},{value:parseInt(d.value)||0})):r(Object(h.a)(Object(h.a)({},d),{},{value:d.value})),p(Es)}},u.a.createElement(Vl.a,null)))))};ys.defaultProps={config:null,onAdd:function(e){return console.log("ADD",e)},onUpdate:function(e){return console.log("UPDATE",e)},onDelete:function(e){return console.log("DELETE",e)}};var Os=u.a.memo(ys),_s={name:"",type:"bool",default:"false",value:"false",list:[]},xs=function(e){var t=e.param,a=e.id,r=e.onAdd,i=e.onUpdate,l=e.onDelete,s=Object(X.a)(["adminServices"]).t,c=Object(o.useState)(_s),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Object(v.a)(),f=function(e){var n=e.target.value;"bool"===t.type?i(Object(h.a)(Object(h.a)({},t),{},{default:"true"===n,value:"true"===n}),a):"list"===t.type||"str"===t.type?i(Object(h.a)(Object(h.a)({},t),{},{default:n,value:n}),a):i(Object(h.a)(Object(h.a)({},t),{},{default:parseInt(n)||0,value:parseInt(n)||0}),a)},b=function(e){p(Object(h.a)(Object(h.a)({},d),{},{default:e.target.value,value:e.target.value}))};return t?u.a.createElement(Br.a,{container:!0,spacing:1,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:10,sm:3,style:{wordBreak:"break-word"}},"".concat(t.name," [").concat(t.type,"]:")),"list"===t.type&&u.a.createElement(Br.a,{item:!0,xs:10,sm:5},u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){var n=e.target.value.split(","),r=n[0];-1!==n.indexOf(t.default)&&(r=t.default),i(Object(h.a)(Object(h.a)({},t),{},{list:n,default:r,value:r}),a)},value:t.list,style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:10,sm:"list"===t.type?3:8},"bool"===t.type?u.a.createElement(Qr.a,{id:"user_spec_params",fullWidth:!0,value:t.default,onChange:f,variant:"outlined",margin:"dense"},u.a.createElement(Kr.a,{value:"false"},s("params.false")),u.a.createElement(Kr.a,{value:"true"},s("params.true"))):"list"===t.type?u.a.createElement(Qr.a,{id:"user_spec_params",fullWidth:!0,value:t.default,onChange:f,variant:"outlined",margin:"dense"},t.list.map((function(e,t){return u.a.createElement(Kr.a,{key:t,value:e},e)}))):u.a.createElement(hr.a,{fullWidth:!0,type:"int"===t.type?"number":"text",size:"small",margin:"dense",variant:"outlined",value:t.default,onChange:f,style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:2,sm:1},u.a.createElement(I.a,{title:s("params.user.remove")},u.a.createElement(Z.a,{style:{color:"dark"===g.palette.type?g.palette.error.light:g.palette.error.dark},onClick:function(){return l(a)}},u.a.createElement(Jl.a,null))))):u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:10,sm:3},u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){p(Object(h.a)(Object(h.a)({},d),{},{name:e.target.value}))},value:d.name,style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:10,sm:2},u.a.createElement(Qr.a,{id:"user_spec_params",fullWidth:!0,value:d.type,onChange:function(e){var t=e.target.value;p(Object(h.a)(Object(h.a)({},d),{},{type:t,list:[],default:"int"===t?"1":"bool"===t?"false":"",value:"int"===t?"1":"bool"===t?"false":""}))},variant:"outlined",margin:"dense"},u.a.createElement(Kr.a,{value:"bool"},"bool"),u.a.createElement(Kr.a,{value:"int"},"int"),u.a.createElement(Kr.a,{value:"list"},"list (",s("params.comma"),")"),u.a.createElement(Kr.a,{value:"str"},"str"))),"list"===d.type&&u.a.createElement(Br.a,{item:!0,xs:10,sm:4},u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",value:d.list,onChange:function(e){var t=e.target.value.split(","),a=t[0];-1!==t.indexOf(d.default)&&(a=d.default),p(Object(h.a)(Object(h.a)({},d),{},{list:t,default:a,value:a}))},style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:10,sm:"list"===d.type?2:6},"bool"===d.type?u.a.createElement(Qr.a,{id:"user_spec_params",fullWidth:!0,value:d.default,onChange:b,variant:"outlined",margin:"dense"},u.a.createElement(Kr.a,{value:"false"},s("params.false")),u.a.createElement(Kr.a,{value:"true"},s("params.true"))):"list"===d.type?u.a.createElement(Qr.a,{id:"user_spec_params",fullWidth:!0,value:d.default,onChange:b,variant:"outlined",margin:"dense"},d.list.map((function(e,t){return u.a.createElement(Kr.a,{key:t,value:e},e)}))):u.a.createElement(hr.a,{fullWidth:!0,type:"int"===d.type?"number":"text",size:"small",margin:"dense",variant:"outlined",value:d.default,onChange:b,style:{margin:0}})),u.a.createElement(Br.a,{item:!0,xs:2,sm:1,style:{height:g.spacing(8)}},""!==d.name&&u.a.createElement(I.a,{title:s("params.user.add")},u.a.createElement(Z.a,{style:{color:"dark"===g.palette.type?g.palette.success.light:g.palette.success.dark},onClick:function(){"bool"===d.type?r(Object(h.a)(Object(h.a)({},d),{},{default:"true"===d.default,value:"true"===d.default})):"list"===d.type||"str"===d.type?r(Object(h.a)(Object(h.a)({},d),{},{default:d.default,value:d.default})):r(Object(h.a)(Object(h.a)({},d),{},{default:parseInt(d.default)||0,value:parseInt(d.default)||0})),p(_s)}},u.a.createElement(Vl.a,null)))))};xs.defaultProps={param:null,id:null,onAdd:function(){return null},onUpdate:function(){return null},onDelete:function(){return null}};var ws=u.a.memo(xs),js=function(e){var t=e.service,a=e.setService,n=e.setModified,i=Object(X.a)(["adminServices"]).t,l=Object(v.a)(),s=Object(o.useCallback)((function(e){window.dispatchEvent(new CustomEvent("paramAdd",{detail:e}))}),[]),c=Object(o.useCallback)((function(e,t){window.dispatchEvent(new CustomEvent("paramUpdate",{detail:{param:e,id:t}}))}),[]),m=Object(o.useCallback)((function(e){window.dispatchEvent(new CustomEvent("paramDelete",{detail:e}))}),[]),d=Object(o.useCallback)((function(e){window.dispatchEvent(new CustomEvent("configAddUpdate",{detail:e}))}),[]),p=Object(o.useCallback)((function(e){window.dispatchEvent(new CustomEvent("configDelete",{detail:e}))}),[]);return Object(o.useEffect)((function(){function e(e){var r=e.detail,i=[].concat(Object(oe.a)(t.submission_params),[Object(h.a)({},r)]);n(!0),a(Object(h.a)(Object(h.a)({},t),{},{submission_params:i}))}function i(e){var r=e.detail,i=r.param,l=r.id,s=Object(oe.a)(t.submission_params);s[l]=Object(h.a)({},i),n(!0),a(Object(h.a)(Object(h.a)({},t),{},{submission_params:s}))}function l(e){var r=e.detail,i=Object(oe.a)(t.submission_params);i.splice(r,1),n(!0),a(Object(h.a)(Object(h.a)({},t),{},{submission_params:i}))}function s(e){var i=e.detail;n(!0),a(Object(h.a)(Object(h.a)({},t),{},{config:Object(h.a)(Object(h.a)({},t.config),{},Object(r.a)({},i.name,i.value))}))}function c(e){var r=e.detail,i=Object(h.a)({},t.config);delete i[r.name],n(!0),a(Object(h.a)(Object(h.a)({},t),{},{config:i}))}return window.addEventListener("paramAdd",e),window.addEventListener("paramUpdate",i),window.addEventListener("paramDelete",l),window.addEventListener("configAddUpdate",s),window.addEventListener("configDelete",c),function(){window.removeEventListener("paramAdd",e),window.removeEventListener("paramUpdate",i),window.removeEventListener("paramDelete",l),window.removeEventListener("configAddUpdate",s),window.removeEventListener("configDelete",c)}}),[t,n,a]),u.a.createElement("div",null,u.a.createElement(Br.a,{container:!0,spacing:1,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"h6"},i("params.user"))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},i("params.user.current"))),0!==t.submission_params.length?t.submission_params.map((function(e,t){return u.a.createElement(Br.a,{item:!0,key:t,xs:12},u.a.createElement(ws,{param:e,id:t,onUpdate:c,onDelete:m}))})):u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary"},i("params.user.none"))),u.a.createElement(Br.a,{item:!0,xs:12,style:{marginTop:l.spacing(2)}},u.a.createElement(Kt.a,{variant:"subtitle2"},i("params.user.new"))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(ws,{onAdd:s})),u.a.createElement(Br.a,{item:!0,xs:12,style:{marginTop:l.spacing(2)}},u.a.createElement(Kt.a,{variant:"h6"},i("params.config"))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},i("params.config.current"))),0!==Object.keys(t.config).length?Object.keys(t.config).map((function(e,a){return u.a.createElement(Br.a,{item:!0,key:a,xs:12},u.a.createElement(Os,{config:{name:e,value:t.config[e]},onUpdate:d,onDelete:p}))})):u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary"},i("params.config.none"))),u.a.createElement(Br.a,{item:!0,xs:12,style:{marginTop:l.spacing(2)}},u.a.createElement(Kt.a,{variant:"subtitle2"},i("params.config.new"))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Os,{onAdd:d}))))},ks=a(822),Ss=a(107),Cs=a.n(Ss),Ts=a(415),As=a.n(Ts),Ns=a(416),Is=a.n(Ns),Rs=a(205),zs=a.n(Rs),Ds=a(414),Bs=a.n(Ds),qs=Object(i.a)((function(e){return{buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},card:{border:"1px solid ".concat(e.palette.divider),borderRadius:"4px",padding:"8px",margin:"0.25rem 0",overflow:"auto",wordBreak:"break-word","&:hover":{backgroundColor:"dark"===e.palette.type?"#ffffff10":"#00000005",cursor:"pointer"}},checkbox:{marginLeft:0,width:"100%","&:hover":{background:e.palette.action.hover}},card_title:{fontSize:"large",fontFamily:"monospace"},drawerPaper:Object(r.a)({width:"80%",maxWidth:"800px"},e.breakpoints.down("sm"),{width:"100%"}),label:{fontWeight:500},mono:{fontSize:"larger",fontFamily:"monospace"},searchresult:{fontStyle:"italic",paddingTop:e.spacing(.5),display:"flex",flexWrap:"wrap"},title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),Ls={name:"",value:""},Fs={ca_cert:"",default_classification:"",headers:[],name:"",password:"",pattern:"",private_key:"",ssl_ignore_errors:!1,uri:"",username:""},Ps=u.a.memo((function(e){var t=e.service,a=e.base,r=e.close,i=e.reload,s=Object(X.a)(["manageSignatureSources"]).t,c=Object(v.a)(),m=Ma().c12nDef,d=Object(o.useState)(!1),p=Object(n.a)(d,2),g=p[0],f=p[1],b=Object(o.useState)(!1),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Object(o.useState)(!1),x=Object(n.a)(_,2),w=x[0],j=x[1],k=dr(),S=$n().showSuccessMessage,C=Object(o.useState)(Object(h.a)({},Ls)),T=Object(n.a)(C,2),A=T[0],N=T[1],R=Object(o.useState)(null),z=Object(n.a)(R,2),D=z[0],B=z[1],q=Object(l.a)(c.breakpoints.only("xl")),L=qs();Object(o.useEffect)((function(){B(a?Object(h.a)(Object(h.a)({},Fs),{},{default_classification:m.UNRESTRICTED},a):Object(h.a)(Object(h.a)({},Fs),{},{default_classification:m.UNRESTRICTED}))}),[a]);return D&&u.a.createElement("div",{style:{paddingTop:c.spacing(2)}},u.a.createElement(Si,{open:y,handleClose:function(){return O(!1)},handleAccept:function(){r(),k({url:"/api/v4/signature/sources/".concat(t,"/").concat(D.name,"/"),method:"DELETE",onSuccess:function(){S(s("delete.success")),i()}})},title:s("delete.title"),cancelText:s("delete.cancelText"),acceptText:s("delete.acceptText"),text:s("delete.text")}),u.a.createElement("div",{style:{paddingBottom:c.spacing(2)}},u.a.createElement(Br.a,{container:!0,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement(Kt.a,{variant:"h4"},t),u.a.createElement(Kt.a,{variant:"caption"},"".concat(s(a?"editing_source":"adding_source")).concat(a?" (".concat(a.name,")"):""))),a&&u.a.createElement(Br.a,{item:!0,xs:!0,style:{textAlign:"right",flexGrow:0}},u.a.createElement(I.a,{title:s("delete")},u.a.createElement(Z.a,{style:{color:"dark"===c.palette.type?c.palette.error.light:c.palette.error.dark},onClick:function(){return O(!0)}},u.a.createElement(Jl.a,null)))))),u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:L.label},s("uri")),u.a.createElement(hr.a,{size:"small",value:D.uri,fullWidth:!0,variant:"outlined",onChange:function(e){B(Object(h.a)(Object(h.a)({},D),{},{uri:e.target.value})),f(!0)}})),m.enforce&&u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:L.label},s("classification")),u.a.createElement(ki,{c12n:D.default_classification,type:"picker",setClassification:function(e){B(Object(h.a)(Object(h.a)({},D),{},{default_classification:e})),f(!0)}})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement("div",null,u.a.createElement("div",{className:L.label},s("name")),u.a.createElement(hr.a,{disabled:!!a,size:"small",value:D.name,fullWidth:!0,variant:"outlined",onChange:function(e){B(Object(h.a)(Object(h.a)({},D),{},{name:e.target.value})),f(!0)}})),u.a.createElement("div",{style:{paddingTop:c.spacing(1)}},u.a.createElement("div",{className:L.label},s("pattern")),u.a.createElement(hr.a,{size:"small",value:D.pattern,fullWidth:!0,variant:"outlined",onChange:function(e){B(Object(h.a)(Object(h.a)({},D),{},{pattern:e.target.value})),f(!0)}}))),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement("div",null,u.a.createElement("div",{className:L.label},s("username")),u.a.createElement(hr.a,{size:"small",value:D.username,fullWidth:!0,variant:"outlined",onChange:function(e){B(Object(h.a)(Object(h.a)({},D),{},{username:e.target.value})),f(!0)}})),u.a.createElement("div",{style:{paddingTop:c.spacing(1)}},u.a.createElement("div",{className:L.label},s("password")),u.a.createElement(hr.a,{size:"small",value:D.password,fullWidth:!0,variant:"outlined",onChange:function(e){B(Object(h.a)(Object(h.a)({},D),{},{password:e.target.value})),f(!0)}}))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:L.label},s("private_key")),u.a.createElement(hr.a,{size:"small",value:D.private_key,multiline:!0,rows:6,fullWidth:!0,variant:"outlined",InputProps:{style:{fontFamily:"monospace"}},onChange:function(e){B(Object(h.a)(Object(h.a)({},D),{},{private_key:e.target.value})),f(!0)}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:L.label},s("headers"))),D.headers.map((function(e,t){return u.a.createElement(Br.a,{key:t,item:!0,xs:12},u.a.createElement(Br.a,{container:!0,spacing:1,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:10,md:3},u.a.createElement("div",{className:L.label},e.name)),u.a.createElement(Br.a,{item:!0,xs:10,md:8},u.a.createElement(hr.a,{size:"small",value:e.value,fullWidth:!0,variant:"outlined"})),u.a.createElement(Br.a,{item:!0,xs:2,md:1,style:{textAlign:"end"}},u.a.createElement(Z.a,{style:{color:"dark"===c.palette.type?c.palette.error.light:c.palette.error.dark,margin:"-4px 0"},onClick:function(){!function(e){var t=Object(oe.a)(D.headers);t.splice(e,1),B(Object(h.a)(Object(h.a)({},D),{},{headers:t})),f(!0)}(t)}},u.a.createElement(Jl.a,null)))))})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:10,md:3},u.a.createElement(hr.a,{size:"small",value:A.name,fullWidth:!0,placeholder:s("headers.name"),variant:"outlined",onChange:function(e){N(Object(h.a)(Object(h.a)({},A),{},{name:e.target.value}))}})),u.a.createElement(Br.a,{item:!0,xs:10,md:8},u.a.createElement(hr.a,{size:"small",value:A.value,fullWidth:!0,placeholder:s("headers.value"),variant:"outlined",onChange:function(e){N(Object(h.a)(Object(h.a)({},A),{},{value:e.target.value}))}})),u.a.createElement(Br.a,{item:!0,xs:2,md:1,style:{textAlign:"end"}},u.a.createElement(Z.a,{style:{color:A.name&&A.value?"dark"===c.palette.type?c.palette.success.light:c.palette.success.dark:c.palette.action.disabled,margin:"-4px 0"},disabled:!A.name||!A.value,onClick:function(){!function(){var e=Object(oe.a)(D.headers);e.push(A),B(Object(h.a)(Object(h.a)({},D),{},{headers:e})),N(Object(h.a)({},Ls)),f(!0)}()}},u.a.createElement(Cs.a,null))))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:L.label},s("proxy")),u.a.createElement(hr.a,{size:"small",value:D.proxy,placeholder:s("proxy.placeholder"),fullWidth:!0,variant:"outlined",onChange:function(e){B(Object(h.a)(Object(h.a)({},D),{},{proxy:e.target.value})),f(!0)}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:L.label},s("ca")),u.a.createElement(hr.a,{size:"small",value:D.ca_cert,multiline:!0,rows:6,fullWidth:!0,variant:"outlined",InputProps:{style:{fontFamily:"monospace"}},onChange:function(e){B(Object(h.a)(Object(h.a)({},D),{},{ca_cert:e.target.value})),f(!0)}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(ts.a,{control:u.a.createElement(ks.a,{size:"small",checked:D.ssl_ignore_errors,name:"label",onChange:function(e){B(Object(h.a)(Object(h.a)({},D),{},{ssl_ignore_errors:e.target.checked})),f(!0)}}),label:u.a.createElement(Kt.a,{variant:"body2"},s("ignore_ssl")),className:L.checkbox}))),u.a.createElement("div",{style:{paddingTop:c.spacing(2),paddingBottom:c.spacing(2),textAlign:"right"}},u.a.createElement(ma.a,{variant:"contained",color:"primary",disabled:!D.name||!D.uri||!g||w,onClick:function(){k({method:a?"POST":"PUT",url:a?"/api/v4/signature/sources/".concat(t,"/").concat(D.name,"/"):"/api/v4/signature/sources/".concat(t,"/"),body:D,onSuccess:function(){S(s(a?"change.success":"add.success")),f(!1),a&&q||r(),i()},onEnter:function(){return j(!0)},onExit:function(){return j(!1)}})}},s(a?"change.save":"add.save"),w&&u.a.createElement(tr.a,{size:24,className:L.buttonProgress}))))})),Ms=function(e){var t=e.source,a=e.onClick,n=Object(X.a)(["manageSignatureSources"]).t,r=Object(v.a)(),i=Ma().c12nDef,l=qs();return u.a.createElement("div",{style:{paddingTop:r.spacing(1)}},u.a.createElement(cr.a,{className:l.card,onClick:a},u.a.createElement("div",{style:{paddingBottom:r.spacing(2)}},u.a.createElement("div",{style:{float:"right"}},t.private_key&&u.a.createElement(I.a,{title:n("private_key_used")},u.a.createElement(Bs.a,{color:"action",style:{marginLeft:r.spacing(.5)}})),t.ca_cert&&u.a.createElement(I.a,{title:n("ca_used")},u.a.createElement(As.a,{color:"action",style:{marginLeft:r.spacing(.5)}})),t.proxy&&u.a.createElement(I.a,{title:n("proxy_used")},u.a.createElement(Is.a,{color:"action",style:{marginLeft:r.spacing(.5)}})),t.ssl_ignore_errors&&u.a.createElement(I.a,{title:n("ignore_ssl_used")},u.a.createElement(zs.a,{color:"action",style:{marginLeft:r.spacing(.5)}}))),u.a.createElement("span",{className:l.card_title},t.name,"\xa0"),u.a.createElement("span",{className:l.mono},"(",t.uri,")")),u.a.createElement(Br.a,{container:!0},t.pattern&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:5,sm:4,md:2,className:l.label},"".concat(n("pattern"),":")),u.a.createElement(Br.a,{item:!0,xs:7,sm:8,md:10,className:l.mono},t.pattern)),t.username&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:5,sm:4,md:2,className:l.label},"".concat(n("username"),":")),u.a.createElement(Br.a,{item:!0,xs:7,sm:8,md:10,className:l.mono},t.username)),t.password&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:5,sm:4,md:2,className:l.label},"".concat(n("password"),":")),u.a.createElement(Br.a,{item:!0,xs:7,sm:8,md:10,className:l.mono},"******")),i.enforce&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:5,sm:4,md:2,className:l.label},"".concat(n("classification"),":")),u.a.createElement(Br.a,{item:!0,xs:7,sm:8,md:10},u.a.createElement(ki,{type:"text",c12n:t.default_classification||i.UNRESTRICTED})))),t.headers&&0!==t.headers.length&&u.a.createElement("div",null,u.a.createElement("div",{className:l.label},"".concat(n("headers"),":"),"\xa0"),t.headers.map((function(e,t){return u.a.createElement("div",{key:t,className:l.mono,style:{paddingLeft:"2rem"}},"".concat(e.name," = ").concat(e.value))})))))},Ws=function(e){var t=e.service,a=e.sources,r=e.reload,i=Object(X.a)(["manageSignatureSources"]).t,l=u.a.useState(!0),s=Object(n.a)(l,2),c=s[0],m=s[1],d=Object(v.a)(),p=el(),g=p.closeGlobalDrawer,f=p.setGlobalDrawer,h=qs(),b=Object(o.useCallback)((function(e,t){f(u.a.createElement(Ps,{service:e,base:t,close:g,reload:r}))}),[]);return Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingTop:d.spacing(2)}},u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:10,style:{alignSelf:"center"}},u.a.createElement(Kt.a,{variant:"h6",className:h.title,onClick:function(){m(!c)}},t)),u.a.createElement(Br.a,{item:!0,xs:2,style:{textAlign:"right"}},u.a.createElement(I.a,{title:i("add_source")},u.a.createElement(Z.a,{style:{color:"dark"===d.palette.type?d.palette.success.light:d.palette.success.dark,margin:"-4px 0"},onClick:function(){return b(t,null)}},u.a.createElement(Cs.a,null))))),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:c,timeout:"auto"},u.a.createElement("div",null,0!==a.length?a.map((function(e,a){return u.a.createElement(Ms,{key:a,source:e,onClick:function(){return b(t,e)}})})):u.a.createElement(Kt.a,{variant:"subtitle1",color:"textSecondary",style:{marginTop:d.spacing(1)}},i("no_sources")))))}),[h.title,c,b,t,a,i,d])};function Us(){var e=Object(X.a)(["manageSignatureSources"]).t,t=Object(v.a)(),a=Ma().user,r=Object(o.useState)(null),i=Object(n.a)(r,2),l=i[0],s=i[1],c=dr(),m=Object(o.useCallback)((function(){(a.is_admin||-1!==a.roles.indexOf("signature_manager"))&&c({url:"/api/v4/signature/sources/",onSuccess:function(e){s(e.api_response)}})}),[c,a.is_admin,a.roles]);return Object(o.useEffect)((function(){m()}),[]),a.is_admin||-1!==a.roles.indexOf("signature_manager")?u.a.createElement(Yi,{margin:4},u.a.createElement("div",{style:{textAlign:"left"}},u.a.createElement("div",{style:{paddingBottom:t.spacing(2)}},u.a.createElement(Kt.a,{variant:"h4"},e("title")),u.a.createElement(Kt.a,{variant:"caption"},l?"".concat(Object.keys(l).length," ").concat(e("caption")):u.a.createElement(pr.a,null))),l?Object.keys(l).map((function(e,t){return u.a.createElement(Ws,{key:t,service:e,sources:l[e],reload:m})})):Object(oe.a)(Array(2)).map((function(e,a){return u.a.createElement("div",{key:a,style:{marginTop:t.spacing(2)}},u.a.createElement(Kt.a,{variant:"h6",style:{marginTop:t.spacing(.5),marginBottom:t.spacing(.5)}},u.a.createElement(pr.a,null)),u.a.createElement(j.a,null),u.a.createElement(pr.a,{variant:"rect",height:"6rem",style:{marginTop:t.spacing(2),borderRadius:"4px"}}))})))):u.a.createElement(ue.a,{to:"/forbidden"})}var Hs=Object(i.a)((function(e){return{checkbox:{marginLeft:0,width:"100%","&:hover":{background:e.palette.action.hover}},label:{fontWeight:500}}})),Vs={name:"",value:""},Gs={ca_cert:"",default_classification:"",headers:[],name:"",password:"",pattern:"",private_key:"",proxy:"",ssl_ignore_errors:!1,uri:"",username:""},Ys=function(e){var t=e.open,a=e.setOpen,i=e.source,l=e.onSave,s=Object(X.a)(["adminServices"]).t,c=Object(o.useState)(!1),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Ma().c12nDef,f=Object(o.useState)(null),b=Object(n.a)(f,2),E=b[0],y=b[1],O=Object(o.useState)(Object(h.a)({},Vs)),_=Object(n.a)(O,2),x=_[0],w=_[1],j=Object(v.a)(),k=Hs(),S=function(){a(!1),p(!1),y(i||Gs)},C=function(e,t){p(!0),y(Object(h.a)(Object(h.a)({},E),{},Object(r.a)({},e,t)))};return Object(o.useEffect)((function(){y(i?Object(h.a)(Object(h.a)({},Gs),{},{default_classification:g.UNRESTRICTED},i):Object(h.a)(Object(h.a)({},Gs),{},{default_classification:g.UNRESTRICTED}))}),[i]),E&&u.a.createElement("div",{style:{paddingTop:j.spacing(1)}},u.a.createElement(Xr.a,{open:t,onClose:S,"aria-labelledby":"form-dialog-title",fullWidth:!0,maxWidth:"md"},u.a.createElement(Zr.a,{id:"form-dialog-title"},s("updater.dialog.title")),u.a.createElement($r.a,null,u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:k.label},s("updater.dialog.uri")),u.a.createElement(hr.a,{size:"small",value:E.uri,fullWidth:!0,variant:"outlined",onChange:function(e){return C("uri",e.target.value)}})),g.enforce&&u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:k.label},s("updater.dialog.classification")),u.a.createElement(ki,{c12n:E.default_classification,type:"picker",setClassification:function(e){return C("classification",e)}})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement("div",null,u.a.createElement("div",{className:k.label},s("updater.dialog.name")),u.a.createElement(hr.a,{disabled:!!i,size:"small",value:E.name,fullWidth:!0,variant:"outlined",onChange:function(e){return C("name",e.target.value)}})),u.a.createElement("div",{style:{paddingTop:j.spacing(1)}},u.a.createElement("div",{className:k.label},s("updater.dialog.pattern")),u.a.createElement(hr.a,{size:"small",value:E.pattern,fullWidth:!0,variant:"outlined",onChange:function(e){return C("pattern",e.target.value)}}))),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement("div",null,u.a.createElement("div",{className:k.label},s("updater.dialog.username")),u.a.createElement(hr.a,{size:"small",value:E.username,fullWidth:!0,variant:"outlined",onChange:function(e){return C("username",e.target.value)}})),u.a.createElement("div",{style:{paddingTop:j.spacing(1)}},u.a.createElement("div",{className:k.label},s("updater.dialog.password")),u.a.createElement(hr.a,{size:"small",value:E.password,fullWidth:!0,variant:"outlined",onChange:function(e){return C("password",e.target.value)}}))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:k.label},s("updater.dialog.private_key")),u.a.createElement(hr.a,{size:"small",value:E.private_key,multiline:!0,rows:6,fullWidth:!0,variant:"outlined",InputProps:{style:{fontFamily:"monospace"}},onChange:function(e){return C("private_key",e.target.value)}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:k.label},s("updater.dialog.headers"))),E.headers.map((function(e,t){return u.a.createElement(Br.a,{key:t,item:!0,xs:12},u.a.createElement(Br.a,{container:!0,spacing:1,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:10,md:3},u.a.createElement("div",{className:k.label},e.name)),u.a.createElement(Br.a,{item:!0,xs:10,md:8},u.a.createElement(hr.a,{size:"small",value:e.value,fullWidth:!0,variant:"outlined"})),u.a.createElement(Br.a,{item:!0,xs:2,md:1,style:{textAlign:"end"}},u.a.createElement(Z.a,{style:{color:"dark"===j.palette.type?j.palette.error.light:j.palette.error.dark,margin:"-4px 0"},onClick:function(){!function(e){var t=Object(oe.a)(E.headers);t.splice(e,1),y(Object(h.a)(Object(h.a)({},E),{},{headers:t})),p(!0)}(t)}},u.a.createElement(Jl.a,null)))))})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:10,md:3},u.a.createElement(hr.a,{size:"small",value:x.name,fullWidth:!0,placeholder:s("updater.dialog.headers.name"),variant:"outlined",onChange:function(e){w(Object(h.a)(Object(h.a)({},x),{},{name:e.target.value}))}})),u.a.createElement(Br.a,{item:!0,xs:10,md:8},u.a.createElement(hr.a,{size:"small",value:x.value,fullWidth:!0,placeholder:s("updater.dialog.headers.value"),variant:"outlined",onChange:function(e){w(Object(h.a)(Object(h.a)({},x),{},{value:e.target.value}))}})),u.a.createElement(Br.a,{item:!0,xs:2,md:1,style:{textAlign:"end"}},u.a.createElement(Z.a,{style:{color:x.name&&x.value?"dark"===j.palette.type?j.palette.success.light:j.palette.success.dark:j.palette.action.disabled,margin:"-4px 0"},disabled:!x.name||!x.value,onClick:function(){!function(){var e=Object(oe.a)(E.headers);e.push(x),y(Object(h.a)(Object(h.a)({},E),{},{headers:e})),w(Object(h.a)({},Vs)),p(!0)}()}},u.a.createElement(Cs.a,null))))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:k.label},s("updater.dialog.proxy")),u.a.createElement(hr.a,{size:"small",value:E.proxy,placeholder:s("updater.dialog.proxy.placeholder"),fullWidth:!0,variant:"outlined",onChange:function(e){return C("proxy",e.target.value)}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{className:k.label},s("updater.dialog.ca")),u.a.createElement(hr.a,{size:"small",value:E.ca_cert,multiline:!0,rows:6,fullWidth:!0,variant:"outlined",InputProps:{style:{fontFamily:"monospace"}},onChange:function(e){return C("ca_cert",e.target.value)}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(ts.a,{control:u.a.createElement(ks.a,{size:"small",checked:E.ssl_ignore_errors,name:"label",onChange:function(){p(!0),y(Object(h.a)(Object(h.a)({},E),{},{ssl_ignore_errors:!E.ssl_ignore_errors}))}}),label:u.a.createElement(Kt.a,{variant:"body2"},s("updater.dialog.ignore_ssl")),className:k.checkbox})))),u.a.createElement(ti.a,null,u.a.createElement(ma.a,{onClick:S,color:"secondary"},s("updater.dialog.cancelText")),u.a.createElement(ma.a,{onClick:function(){p(!1),a(!1),l(E)},color:"primary",disabled:!d||""===E.name||""===E.uri},s("updater.dialog.acceptText")))))};Ys.defaultProps={source:null};var Js=u.a.memo(Ys),Qs=function(e){var t=e.service,a=e.setService,r=e.setModified,i=Object(X.a)(["adminServices"]).t,l=Object(o.useState)(!1),s=Object(n.a)(l,2),c=s[0],m=s[1],d=Object(o.useState)(!1),p=Object(n.a)(d,2),g=p[0],f=p[1],b=Object(o.useState)(-1),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Object(v.a)(),x=function(e){var n=Object(oe.a)(t.update_config.sources);-1===y?n.push(e):n[y]=e,r(!0),a(Object(h.a)(Object(h.a)({},t),{},{update_config:Object(h.a)(Object(h.a)({},t.update_config),{},{sources:n})}))};return Object(o.useEffect)((function(){g||-1===y||O(-1)}),[g]),u.a.createElement(Br.a,{container:!0,spacing:2},u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"h6"},i("updater"))),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},i("updater.method")),t?u.a.createElement(Qr.a,{id:"channel",fullWidth:!0,value:t.update_config.method,onChange:function(e){r(!0),a(Object(h.a)(Object(h.a)({},t),{},{update_config:Object(h.a)(Object(h.a)({},t.update_config),{},{method:e.target.value})}))},variant:"outlined",margin:"dense",style:{marginTop:_.spacing(1),marginBottom:_.spacing(.5)}},u.a.createElement(Kr.a,{value:"run"},i("updater.method.run"))):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},i("updater.interval")),t?u.a.createElement(hr.a,{fullWidth:!0,type:"number",size:"small",margin:"dense",variant:"outlined",value:t.update_config.update_interval_seconds,onChange:function(e){r(!0),a(Object(h.a)(Object(h.a)({},t),{},{update_config:Object(h.a)(Object(h.a)({},t.update_config),{},{update_interval_seconds:e.target.value})}))}}):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},i("updater.run.options")),t?"run"===t.update_config.method&&u.a.createElement(gs,{container:t.update_config.run_options,onChange:function(e){r(!0),a(Object(h.a)(Object(h.a)({},t),{},{update_config:Object(h.a)(Object(h.a)({},t.update_config),{},{run_options:e})}))}}):u.a.createElement(pr.a,{style:{height:"8rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},i("updater.signatures")),u.a.createElement(es.a,{value:t.update_config.generates_signatures,onChange:function(){r(!0),a(Object(h.a)(Object(h.a)({},t),{},{update_config:Object(h.a)(Object(h.a)({},t.update_config),{},{generates_signatures:!t.update_config.generates_signatures})}))}},u.a.createElement(ts.a,{value:!0,control:u.a.createElement(as.a,null),label:i("updater.signatures.yes")}),u.a.createElement(ts.a,{value:!1,control:u.a.createElement(as.a,null),label:i("updater.signatures.no")}))),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},i("updater.wait")),u.a.createElement(es.a,{value:t.update_config.wait_for_update,onChange:function(){r(!0),a(Object(h.a)(Object(h.a)({},t),{},{update_config:Object(h.a)(Object(h.a)({},t.update_config),{},{wait_for_update:!t.update_config.wait_for_update})}))}},u.a.createElement(ts.a,{value:!0,control:u.a.createElement(as.a,null),label:i("updater.wait.yes")}),u.a.createElement(ts.a,{value:!1,control:u.a.createElement(as.a,null),label:i("updater.wait.no")}))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},i("updater.sources")),u.a.createElement(Js,{open:g,source:-1!==y?t.update_config.sources[y]:null,setOpen:f,onSave:x}),0!==t.update_config.sources.length?t.update_config.sources.map((function(e,n){return u.a.createElement("div",{key:n,style:{display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{paddingRight:_.spacing(1),flexGrow:1}},u.a.createElement(Ms,{key:n,source:e,onClick:function(){return e=n,f(!0),void O(e);var e}})),u.a.createElement("div",null,u.a.createElement(I.a,{title:i("updater.sources.remove")},u.a.createElement(Z.a,{style:{color:"dark"===_.palette.type?_.palette.error.light:_.palette.error.dark},onClick:function(){return function(e){var n=t.update_config.sources;n.splice(e,1),r(!0),a(Object(h.a)(Object(h.a)({},t),{},{update_config:Object(h.a)(Object(h.a)({},t.update_config),{},{sources:n})}))}(n)}},u.a.createElement(Jl.a,null)))))})):u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary"},i("updater.sources.none"))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Js,{open:c,setOpen:m,onSave:x}),u.a.createElement(ma.a,{variant:"contained",color:"primary",onClick:function(){return m(!0)}},i("updater.sources.add"))))},Ks=Object(i.a)((function(){return{buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}));function Xs(e){var t=e.name,a=e.onDeleted,r=Object(ue.i)().svc,i=Object(X.a)(["adminServices"]).t,l=Object(o.useState)(null),s=Object(n.a)(l,2),c=s[0],m=s[1],d=Object(o.useState)(null),p=Object(n.a)(d,2),g=p[0],f=p[1],b=Object(o.useState)(null),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Object(o.useState)("general"),x=Object(n.a)(_,2),w=x[0],j=x[1],k=Object(o.useState)(!1),S=Object(n.a)(k,2),C=S[0],T=S[1],A=Object(o.useState)(!1),N=Object(n.a)(A,2),R=N[0],z=N[1],D=Object(v.a)(),B=Object(o.useState)(!1),q=Object(n.a)(B,2),L=q[0],F=q[1],P=Ma().user,M=$n().showSuccessMessage,W=Object(ue.g)(),U=Ks(),H=dr();return Object(o.useEffect)((function(){P.is_admin&&(H({url:"/api/v4/service/".concat(t||r,"/"),onSuccess:function(e){m(e.api_response)}}),H({url:"/api/v4/service/constants/",onSuccess:function(e){f(e.api_response)}}),H({url:"/api/v4/service/versions/".concat(t||r,"/"),onSuccess:function(e){O(e.api_response)}}))}),[]),P.is_admin?u.a.createElement(ir,{margin:r?4:2,width:"100%"},u.a.createElement("div",{style:{textAlign:"left"}},u.a.createElement(Si,{open:L,handleClose:function(){return F(!1)},handleAccept:function(){F(!1),H({url:"/api/v4/service/".concat(t||r,"/"),method:"DELETE",onSuccess:function(){M(i("delete.success")),r&&setTimeout((function(){return W.push("/admin/services")}),1e3),a()}})},title:i("delete.title"),cancelText:i("delete.cancelText"),acceptText:i("delete.acceptText"),text:i("delete.text")}),u.a.createElement(Br.a,{container:!0,alignItems:"center",spacing:3,style:{paddingBottom:D.spacing(2)}},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement(Kt.a,{variant:"h4"},c?c.name:u.a.createElement(pr.a,{style:{width:"20rem"}})),u.a.createElement(Kt.a,{variant:"caption"},i("title.detail"))),u.a.createElement(Br.a,{item:!0,xs:!0,style:{textAlign:"right",flexGrow:0}},c?u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{display:"flex",marginBottom:D.spacing(1),justifyContent:"flex-end"}},u.a.createElement(I.a,{title:i("remove")},u.a.createElement(Z.a,{style:{color:"dark"===D.palette.type?D.palette.error.light:D.palette.error.dark},onClick:function(){F(!0)}},u.a.createElement(Jl.a,null))))):u.a.createElement(pr.a,{variant:"circle",height:"2.5rem",width:"2.5rem",style:{margin:D.spacing(.5)}}))),c?u.a.createElement(mi,{type:"rounded",color:c.enabled?"primary":"default",onClick:function(){T(!0),m(Object(h.a)(Object(h.a)({},c),{},{enabled:!c.enabled}))},label:c.enabled?i("enabled"):i("disabled"),fullWidth:!0,style:{marginBottom:D.spacing(2)}}):u.a.createElement(pr.a,{variant:"rect",height:"2.5rem",style:{marginBottom:D.spacing(1)}}),c?u.a.createElement(Ql.a,{value:w},u.a.createElement(ua.a,{square:!0,style:{backgroundColor:t?D.palette.background.default:D.palette.background.paper}},u.a.createElement(Kl.a,{onChange:function(e,t){j(t)},indicatorColor:"primary",textColor:"primary"},u.a.createElement(Gl.a,{label:i("tab.general"),value:"general"}),u.a.createElement(Gl.a,{label:i("tab.docker"),value:"docker"}),c.update_config?u.a.createElement(Gl.a,{label:i("tab.updater"),value:"updater"}):u.a.createElement(Zl,null),u.a.createElement(Gl.a,{label:i("tab.params"),value:"params"}))),u.a.createElement(Xl.a,{value:"general",style:{paddingLeft:0,paddingRight:0}},u.a.createElement(hs,{service:c,setService:m,setModified:T,constants:g,versions:y})),u.a.createElement(Xl.a,{value:"docker",style:{paddingLeft:0,paddingRight:0}},u.a.createElement(fs,{service:c,setService:m,setModified:T})),u.a.createElement(Xl.a,{value:"updater",style:{paddingLeft:0,paddingRight:0}},u.a.createElement(Qs,{service:c,setService:m,setModified:T})),u.a.createElement(Xl.a,{value:"params",style:{paddingLeft:0,paddingRight:0}},u.a.createElement(js,{service:c,setService:m,setModified:T}))):u.a.createElement(pr.a,{variant:"rect",height:"10rem"})),c&&C?u.a.createElement("div",{style:{paddingTop:D.spacing(1),paddingBottom:D.spacing(1),position:"fixed",bottom:0,left:0,width:"100%",zIndex:D.zIndex.drawer-1,backgroundColor:D.palette.background.default,boxShadow:D.shadows[4]}},u.a.createElement(ma.a,{variant:"contained",color:"primary",disabled:R||!C,onClick:function(){H({url:"/api/v4/service/".concat(t||r,"/"),method:"POST",body:c,onSuccess:function(){T(!1),M(i("save.success"))},onEnter:function(){return z(!0)},onExit:function(){return z(!1)}})}},i("save"),R&&u.a.createElement(tr.a,{size:24,className:U.buttonProgress}))):null):u.a.createElement(ue.a,{to:"/forbidden"})}Xs.defaultProps={name:null,onDeleted:function(){return null}};var Zs=Xs,$s=a(82),ec=a.n($s),tc=a(81),ac=a.n(tc),nc=u.a.memo((function(e){var t=e.serviceResults,a=e.updates,n=e.setService,r=e.onUpdate,i=Object(X.a)(["search"]).t;return t&&a?0!==t.length?u.a.createElement(qr.a,{component:ua.a},u.a.createElement(Rl,null,u.a.createElement(Nl,null,u.a.createElement(Al,null,u.a.createElement(Sl,null,i("header.name")),u.a.createElement(Sl,null,i("header.version")),u.a.createElement(Sl,null,i("header.category")),u.a.createElement(Sl,null,i("header.stage")),u.a.createElement(Sl,null,i("header.accepts")),u.a.createElement(Sl,null,i("header.enabled")),u.a.createElement(Sl,null))),u.a.createElement(Il,null,t.map((function(e){return u.a.createElement(Tl,{key:e.name,component:Y.b,to:"/admin/services/".concat(e.name),hover:!0,style:{textDecoration:"none"},onClick:function(t){n&&(t.preventDefault(),n(e.name))}},u.a.createElement(Sl,null,e.name),u.a.createElement(Sl,null,e.version),u.a.createElement(Sl,null,e.category),u.a.createElement(Sl,null,e.stage),u.a.createElement(Sl,{style:{wordBreak:"break-all"}},e.accepts),u.a.createElement(Sl,null,e.enabled?u.a.createElement(ac.a,{color:"primary"}):u.a.createElement(ec.a,{color:"error"})),u.a.createElement(Sl,{style:{whiteSpace:"nowrap"}},a[e.name]&&a[e.name].update_available&&!a[e.name].updating&&u.a.createElement(I.a,{title:"".concat(e.name," ").concat(a[e.name].latest_tag," ").concat(i("available"),"!")},u.a.createElement(ma.a,{size:"small",variant:"outlined",color:"primary",onClick:function(t){t.preventDefault(),t.stopPropagation(),r(e.name,a[e.name])}},i("update"))),a[e.name]&&a[e.name].updating&&i("updating")))}))))):u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(Ll,null,u.a.createElement(wl.a,null,i("no_results_title")),i("no_results_desc"))):u.a.createElement(pr.a,{variant:"rect",style:{height:"6rem",borderRadius:"4px"}})}));function rc(){var e=Object(X.a)(["adminServices"]).t,t=Object(o.useState)(null),a=Object(n.a)(t,2),r=a[0],i=a[1],l=Object(o.useState)(null),s=Object(n.a)(l,2),c=s[0],m=s[1],d=Object(o.useState)(!1),p=Object(n.a)(d,2),g=p[0],f=p[1],b=Object(o.useState)(""),E=Object(n.a)(b,2),y=E[0],O=E[1],_=$n().showSuccessMessage,w=Object(v.a)(),j=dr(),k=x().user,S=el().setGlobalDrawer;var C=function(){j({url:"/api/v4/service/all/",onSuccess:function(e){i(e.api_response)}}),j({url:"/api/v4/service/updates/",onSuccess:function(e){m(e.api_response)}})};Object(o.useEffect)((function(){k.is_admin&&C()}),[]);var T=Object(o.useCallback)((function(e,t){j({method:"PUT",url:"/api/v4/service/update/",body:{name:e,update_data:t},onSuccess:function(){var t=Object(h.a)({},c);t[e]=Object(h.a)(Object(h.a)({},t[e]),{},{updating:!0}),m(t)}})}),[c]),A=function(){S(null),setTimeout((function(){return C()}),1e3)},N=Object(o.useCallback)((function(e){S(u.a.createElement(Zs,{name:e,onDeleted:A}))}),[]);return k.is_admin?u.a.createElement(Yi,{margin:4},u.a.createElement(Xr.a,{open:g,onClose:function(){return f(!1)},"aria-labelledby":"form-dialog-title",fullWidth:!0,maxWidth:"md"},u.a.createElement(Zr.a,{id:"form-dialog-title"},e("add.title")),u.a.createElement($r.a,null,u.a.createElement(hr.a,{label:e("add.paste"),multiline:!0,rows:24,variant:"outlined",fullWidth:!0,InputProps:{style:{fontFamily:"monospace"}},onChange:function(e){O(e.target.value)}})),u.a.createElement(ti.a,null,u.a.createElement(ma.a,{onClick:function(){return f(!1)},color:"secondary"},e("add.cancelText")),u.a.createElement(ma.a,{onClick:function(){j({method:"PUT",contentType:"text/plain",url:"/api/v4/service/",body:y,onSuccess:function(t){_(e("add.success")),f(!1),setTimeout((function(){return C()}),1e3)}})},color:"primary",disabled:!y},e("add.acceptText")))),u.a.createElement(Br.a,{container:!0,alignItems:"center",spacing:3,style:{paddingBottom:w.spacing(2)}},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement(Kt.a,{variant:"h4"},e("title")),r?u.a.createElement(Kt.a,{variant:"caption"},"".concat(r.length," ").concat(e("count"))):u.a.createElement(pr.a,{width:"8rem"})),u.a.createElement(Br.a,{item:!0,xs:!0,style:{textAlign:"right",flexGrow:0}},u.a.createElement("div",{style:{display:"flex",marginBottom:w.spacing(1),justifyContent:"flex-end"}},u.a.createElement(I.a,{title:e("add")},u.a.createElement(Z.a,{style:{color:"dark"===w.palette.type?w.palette.success.light:w.palette.success.dark},onClick:function(){return f(!0)}},u.a.createElement(Vl.a,null)))))),u.a.createElement("div",{style:{paddingTop:w.spacing(2),paddingLeft:w.spacing(.5),paddingRight:w.spacing(.5)}},u.a.createElement(nc,{serviceResults:r,updates:c,setService:N,onUpdate:T}))):u.a.createElement(ue.a,{to:"/forbidden"})}var ic=a(417),lc=a.n(ic),sc=Object(Dr.a)((function(e){return Object(G.a)({root:{paddingRight:e.spacing(1),paddingLeft:e.spacing(1),wordBreak:"break-all"},head:{backgroundColor:"dark"===e.palette.type?"#404040":"#EEE",whiteSpace:"nowrap"}})}))(Mr.a);function cc(){var e=Object(X.a)(["adminSiteMap"]).t,t=Object(v.a)(),a=Object(o.useState)(null),r=Object(n.a)(a,2),i=r[0],l=r[1],s=dr(),c=x().user,m={R:"success",W:"warning",E:"error"},d={user:"default",signature_importer:"warning",signature_manager:"info",admin:"error"};return Object(o.useEffect)((function(){s({method:"GET",url:"/api/site_map/",onSuccess:function(e){l(e.api_response)}})}),[]),c.is_admin?u.a.createElement(Yi,{margin:4},u.a.createElement("div",{style:{marginBottom:t.spacing(2),textAlign:"left"}},u.a.createElement(Kt.a,{variant:"h4"},e("title")),i?u.a.createElement(Kt.a,{variant:"caption"},"".concat(i.length," ").concat(e("caption"))):u.a.createElement(pr.a,{width:"10rem"})),i?u.a.createElement(qr.a,{component:ua.a},u.a.createElement(Lr.a,{size:"small",stickyHeader:!0},u.a.createElement(Fr.a,null,u.a.createElement(Pr.a,null,u.a.createElement(sc,null,e("header.url")),u.a.createElement(sc,null,e("header.function")),u.a.createElement(sc,null,e("header.methods")),u.a.createElement(sc,null,e("header.protected")),u.a.createElement(sc,{colSpan:2},e("header.permissions")))),u.a.createElement(Wr.a,null,i.map((function(t,a){return u.a.createElement(Pr.a,{key:a,hover:!0},u.a.createElement(sc,null,t.url),u.a.createElement(sc,null,t.function),u.a.createElement(sc,null,t.methods&&t.methods.map((function(e,t){return u.a.createElement("div",{key:t},e)}))),u.a.createElement(sc,null,t.protected?u.a.createElement(lc.a,{color:"primary"}):u.a.createElement(zs.a,{color:"error"})),u.a.createElement(sc,null,t.req_priv&&t.req_priv.map((function(t,a){return u.a.createElement(mi,{key:a,mono:!0,type:"rounded",color:m[t],size:"tiny",label:t,tooltip:e("".concat(t))})}))),u.a.createElement(sc,null,t.required_type&&t.required_type.map((function(t,a){return u.a.createElement(mi,{key:a,mono:!0,type:"rounded",color:d[t],size:"tiny",label:e(t),tooltip:e("".concat(t,"_label"))})}))))}))))):u.a.createElement(pr.a,{variant:"rect",height:"10rem",style:{borderRadius:"4px"}})):u.a.createElement(ue.a,{to:"/forbidden"})}var oc=a(418),uc=a.n(oc),mc=a(419),dc=a.n(mc),pc=u.a.memo((function(e){var t=e.userResults,a=Object(X.a)(["adminUsers"]).t,n=Ma().c12nDef;return t?0!==t.total?u.a.createElement(qr.a,{component:ua.a},u.a.createElement(Rl,{size:"small"},u.a.createElement(Nl,null,u.a.createElement(Al,{style:{whiteSpace:"nowrap"}},u.a.createElement(Cl,{sortField:"uname"},a("header.uid")),u.a.createElement(Cl,{sortField:"name"},a("header.fullname")),u.a.createElement(Cl,{sortField:"groups"},a("header.groups")),n.enforce&&u.a.createElement(Cl,{sortField:"classification"},a("header.classification")),u.a.createElement(Cl,{sortField:"is_active"},a("header.active")),u.a.createElement(Cl,{sortField:"type"},a("header.admin")))),u.a.createElement(Il,null,t.items.map((function(e){return u.a.createElement(Tl,{key:e.id,to:"/admin/users/".concat(e.uname),hover:!0,style:{textDecoration:"none"}},u.a.createElement(Sl,{style:{whiteSpace:"nowrap"}},e.uname),u.a.createElement(Sl,null,e.name),u.a.createElement(Sl,null,e.groups.join(" | ")),n.enforce&&u.a.createElement(Sl,{style:{whiteSpace:"nowrap"}},u.a.createElement(ki,{type:"text",size:"tiny",c12n:e.classification,format:"short"})),u.a.createElement(Sl,null,e.is_active?u.a.createElement(ac.a,{color:"primary"}):u.a.createElement(ec.a,{color:"error"})),u.a.createElement(Sl,null,-1!==e.type.indexOf("admin")?u.a.createElement(ac.a,{color:"primary"}):u.a.createElement(ec.a,{color:"error"})))}))))):u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(Ll,null,u.a.createElement(wl.a,null,a("no_users_title")),a("no_results_desc"))):u.a.createElement(pr.a,{variant:"rect",style:{height:"6rem",borderRadius:"4px"}})})),gc={avatar:null,groups:["USERS"],is_active:!0,type:["user"],classification:null,email:"",name:"",new_pass:"",uname:"",api_quota:10,submission_quota:5},fc=Object(i.a)((function(e){return{searchresult:{fontStyle:"italic",paddingTop:e.spacing(.5),display:"flex",flexWrap:"wrap"},drawerPaper:Object(r.a)({width:"80%",maxWidth:"800px"},e.breakpoints.down("sm"),{width:"100%"}),buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}));function hc(){var e=Object(X.a)(["adminUsers"]).t,t=Object(o.useState)(25),a=Object(n.a)(t,1)[0],i=Object(o.useState)(!1),s=Object(n.a)(i,2),c=s[0],m=s[1],d=Object(o.useState)(!1),p=Object(n.a)(d,2),g=p[0],f=p[1],b=Object(o.useState)(!1),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Ma(),x=_.user,w=_.c12nDef,j=Object(o.useState)(null),k=Object(n.a)(j,2),S=k[0],C=k[1],T=Object(o.useState)(gc),A=Object(n.a)(T,2),z=A[0],D=A[1],B=Object(ue.h)(),q=Object(o.useState)(null),L=Object(n.a)(q,2),F=L[0],P=L[1],M=$n().showSuccessMessage,W=Object(ue.g)(),U=Object(v.a)(),H=dr(),V=fc(),G=Object(l.a)(U.breakpoints.up("md")),Y=Object(o.useState)(pl),J=Object(n.a)(Y,2),Q=J[0],K=J[1],$=Object(o.useRef)(""),ee=function(){f(!1)};Object(o.useEffect)((function(){P(new Ol(B.search,"rows=".concat(a,"&offset=0")))}),[B.search,a]),Object(o.useEffect)((function(){F&&x.is_admin&&(F.set("rows",a),F.set("offset",0),m(!0),H({url:"/api/v4/user/list/?".concat(F.toString()),onSuccess:function(e){C(e.api_response)},onFinalize:function(){m(!1)}}))}),[F]),Object(o.useEffect)((function(){ne(w.UNRESTRICTED),H({url:"/api/v4/search/fields/user/",onSuccess:function(e){K([].concat(Object(oe.a)(Object.keys(e.api_response).filter((function(t){return e.api_response[t].indexed}))),Object(oe.a)(pl)))}})}),[]);var te=function(){W.push(B.pathname)},ae=function(e,t){D(Object(h.a)(Object(h.a)({},z),{},Object(r.a)({},e,t)))};function ne(e){D(Object(h.a)(Object(h.a)({},z),{},{classification:e}))}function re(e){var t=z.type;-1===t.indexOf(e)?t.push(e):t.splice(t.indexOf(e),1),D(Object(h.a)(Object(h.a)({},z),{},{type:t}))}return x.is_admin?u.a.createElement(Yi,{margin:4},u.a.createElement(N.a,{anchor:"right",classes:{paper:V.drawerPaper},open:g,onClose:ee},u.a.createElement("div",{id:"drawerTop",style:{padding:U.spacing(1)}},u.a.createElement(Z.a,{onClick:ee},u.a.createElement(Ki.a,null))),u.a.createElement("div",{style:{paddingLeft:U.spacing(2),paddingRight:U.spacing(2)}},u.a.createElement(R.a,{mb:3},u.a.createElement(Kt.a,{variant:"h5"},e("newuser.title"))),w.enforce&&u.a.createElement(R.a,{mb:1},u.a.createElement(ki,{type:"picker",size:"medium",format:"long",c12n:z.classification,setClassification:ne,isUser:!0})),u.a.createElement(Br.a,{container:!0,spacing:2},u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption"},e("newuser.uname")),u.a.createElement(hr.a,{autoFocus:!0,fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){return ae("uname",e.target.value)},value:z.uname})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption"},e("newuser.name")),u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){return ae("name",e.target.value)},value:z.name})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"caption"},e("newuser.groups")),u.a.createElement(Ti.a,{style:{display:"block"},margin:"dense",defaultValue:z.groups,onChange:function(e){return ae("groups",e)},variant:"outlined"})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption"},e("newuser.new_pass")),u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){return ae("new_pass",e.target.value)},value:z.new_pass})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption"},e("newuser.email")),u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){return ae("email",e.target.value)},value:z.email})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"caption"},e("newuser.roles")),u.a.createElement("div",null,u.a.createElement(mi,{type:"rounded",size:"small",color:z.type.includes("user")?"primary":"default",onClick:function(){return re("user")},label:e("role.normal_user")}),u.a.createElement(mi,{type:"rounded",size:"small",color:z.type.includes("admin")?"primary":"default",onClick:function(){return re("admin")},label:e("role.admin")}),u.a.createElement(mi,{type:"rounded",size:"small",color:z.type.includes("signature_manager")?"primary":"default",onClick:function(){return re("signature_manager")},label:e("role.signature_manager")}),u.a.createElement(mi,{type:"rounded",size:"small",color:z.type.includes("signature_importer")?"primary":"default",onClick:function(){return re("signature_importer")},label:e("role.signature_importer")}))),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption"},e("newuser.api_quota")),u.a.createElement(hr.a,{fullWidth:!0,type:"number",margin:"dense",variant:"outlined",onChange:function(e){return ae("api_quota",e.target.value)},value:z.api_quota})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption"},e("newuser.submission_quota")),u.a.createElement(hr.a,{fullWidth:!0,type:"number",margin:"dense",variant:"outlined",onChange:function(e){return ae("submission_quota",e.target.value)},value:z.submission_quota}))),u.a.createElement(R.a,{my:2,textAlign:"right"},u.a.createElement(ma.a,{disabled:y||!z.uname,variant:"contained",color:"primary",onClick:function(){H({method:"PUT",url:"/api/v4/user/".concat(z.uname,"/"),body:z,onSuccess:function(t){M(e("newuser.success")),f(!1),P(new Ol(B.search,"rows=".concat(a,"&offset=0")))},onEnter:function(){return O(!0)},onExit:function(){return O(!1)}})}},e("newuser.save"),y&&u.a.createElement(tr.a,{size:24,className:V.buttonProgress}))))),u.a.createElement("div",{style:{paddingBottom:U.spacing(2)}},u.a.createElement(Br.a,{container:!0,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement(Kt.a,{variant:"h4"},e("title"))),u.a.createElement(Br.a,{item:!0,xs:!0,style:{textAlign:"right"}},u.a.createElement(I.a,{title:e("add_user")},u.a.createElement(Z.a,{style:{color:"dark"===U.palette.type?U.palette.success.light:U.palette.success.dark},onClick:function(){f(!0)}},u.a.createElement(uc.a,null)))))),u.a.createElement(Ji,{isSticky:!0},u.a.createElement("div",{style:{paddingTop:U.spacing(1)}},u.a.createElement(vl,{initValue:F?F.get("query",""):"",placeholder:e("filter"),searching:c,suggestions:Q,onValueChange:function(e){$.current=e},onClear:te,onSearch:function(){""!==$.current?(F.set("query",$.current),W.push("".concat(B.pathname,"?").concat(F.toString()))):te()},buttons:[{icon:u.a.createElement(dc.a,{fontSize:G?"default":"small"}),tooltip:e("admins"),props:{onClick:function(){F.set("query","type:admin"),W.push("".concat(B.pathname,"?").concat(F.getDeltaString()))}}},{icon:u.a.createElement(zn.a,{fontSize:G?"default":"small"}),tooltip:e("disabled"),props:{onClick:function(){F.set("query","is_active:false"),W.push("".concat(B.pathname,"?").concat(F.getDeltaString()))}}}]},null!==S&&u.a.createElement("div",{className:V.searchresult},0!==S.total&&u.a.createElement(Kt.a,{variant:"subtitle1",color:"secondary",style:{flexGrow:1}},c?u.a.createElement("span",null,e("searching")):u.a.createElement("span",null,S.total,"\xa0",F.get("query")?e("filtered".concat(1===S.total?"":"s")):e("total".concat(1===S.total?"":"s")))),u.a.createElement(xl,{method:"GET",url:"/api/v4/user/list/",total:S.total,setResults:C,pageSize:a,index:"user",query:F,setSearching:m}))))),u.a.createElement("div",{style:{paddingTop:U.spacing(2),paddingLeft:U.spacing(.5),paddingRight:U.spacing(.5)}},u.a.createElement(pc,{userResults:S}))):u.a.createElement(ue.a,{to:"/forbidden"})}var bc=a(69),vc=a.n(bc),Ec=a(70),yc=a.n(Ec),Oc=Object(i.a)((function(e){return{chiplist:{display:"flex",flexWrap:"wrap",listStyle:"none",padding:0,boxShadow:"inherit",margin:0},chip:{marginBottom:e.spacing(.5),marginRight:e.spacing(1)}}})),_c=function(){return u.a.createElement(pr.a,{variant:"rect",height:"24px",width:"4rem",style:{borderRadius:"16px",marginRight:"4px"}})},xc=function(){return u.a.createElement(pr.a,{variant:"rect",height:"24px",width:"4rem",style:{borderRadius:"16px",marginRight:"4px",display:"inline-block",verticalAlign:"middle"}})},wc=function(e){var t=e.items,a=Object(v.a)(),n=Oc();return u.a.createElement("ul",{className:n.chiplist},t?t.map((function(e,t){return u.a.createElement("li",{key:"chiplist-".concat(t)},u.a.createElement(mi,Object.assign({size:"small",className:n.chip,wrap:!0},e)))})):Object(oe.a)(Array(3)).map((function(e,t){return u.a.createElement(pr.a,{key:"chiplist-".concat(t),variant:"rect",height:a.spacing(3),width:"4rem",style:{verticalAlign:"middle",display:"inline-block",borderRadius:a.spacing(2),marginRight:a.spacing(.5)}})})))};function jc(e){if(0===e||null===e)return"0 B";var t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(Math.round(e/Math.pow(1024,t))," ").concat(["B","KB","MB","GB","TB"][t])}function kc(e){return e>=1e3?"malicious":e>=500?"highly_suspicious":e>=100?"suspicious":e<0?"safe":"info"}function Sc(e,t){var a,n=t.split("."),r=e;for(a=0;a<n.length;++a){if(void 0===r[n[a]])return;r=r[n[a]]}return r}var Cc=u.a.memo((function(e){var t=e.score,a=e.type,n=void 0===a?"rounded":a,r=e.variant,i=void 0===r?"default":r,l=e.size,s=void 0===l?"tiny":l,c=e.short,o=void 0!==c&&c,m=e.mono,d=void 0!==m&&m,p=e.fullWidth,g=void 0!==p&&p,f=e.wrap,h=void 0!==f&&f,b=Object(X.a)().t,E=Object(v.a)(),y={info:{shortText:b("verdict.info.short"),text:b("verdict.info"),color:"default",textColor:"dark"===E.palette.type?"#AAA":"#888"},safe:{shortText:b("verdict.safe.short"),text:b("verdict.safe"),color:"success",textColor:"dark"!==E.palette.type?E.palette.success.dark:E.palette.success.light},suspicious:{shortText:b("verdict.suspicious.short"),text:b("verdict.suspicious"),color:"warning",textColor:"dark"!==E.palette.type?E.palette.warning.dark:E.palette.warning.light},highly_suspicious:{shortText:b("verdict.highly_suspicious.short"),text:b("verdict.highly_suspicious"),color:"warning",textColor:"dark"!==E.palette.type?E.palette.warning.dark:E.palette.warning.light},malicious:{shortText:b("verdict.malicious.short"),text:b("verdict.malicious"),color:"error",textColor:"dark"!==E.palette.type?E.palette.error.dark:E.palette.error.light}}[kc(t)],O=y.text,_=y.color,x=y.shortText,w=y.textColor;return u.a.createElement(I.a,{title:"".concat(O," [Score: ").concat(t,"]")},u.a.createElement("span",null,"text"===n?u.a.createElement("span",{style:{fontWeight:500,color:w}},O):u.a.createElement(mi,{type:n,variant:i,size:s,label:o?x:O,color:_,mono:d,fullWidth:g,wrap:h})))})),Tc=a(250),Ac=a.n(Tc),Nc=a(249),Ic=a.n(Nc),Rc=a(251),zc=a.n(Rc),Dc=Object(i.a)({priority:{"& > svg":{verticalAlign:"bottom"}}}),Bc={CRITICAL:{color:"hsl(0, 100%, 40%)",chip_color:"error",arrow:u.a.createElement(Ic.a,{fontSize:"small",color:"inherit"})},HIGH:{color:"hsl(39, 100%, 40%)",chip_color:"warning",arrow:u.a.createElement(Ic.a,{fontSize:"small",color:"inherit"})},MEDIUM:{color:"hsl(39, 100%, 40%)",chip_color:"warning",arrow:u.a.createElement(Ac.a,{fontSize:"small",color:"inherit"})},LOW:{color:"hsl(120, 100%, 30%)",chip_color:"success",arrow:u.a.createElement(Ac.a,{fontSize:"small",color:"inherit"})},undefined:{color:"inherit",chip_color:"default",arrow:u.a.createElement(zc.a,{fontSize:"small",color:"inherit"})},null:{color:"inherit",chip_color:"default",arrow:u.a.createElement(zc.a,{fontSize:"small",color:"inherit"})}},qc=function(e){var t=e.name,a=e.withText,n=void 0!==a&&a,r=e.withChip,i=void 0!==r&&r,l=e.size,s=void 0===l?"small":l,c=Object(X.a)("alerts").t,o=Dc();return i?u.a.createElement(mi,{wrap:!0,size:s,variant:"outlined",color:Bc[t].chip_color,label:c(t?"priority_".concat(t):"priority_unset"),icon:Bc[t].arrow}):u.a.createElement(R.a,{style:{color:Bc[t].color},display:"inline-block",className:o.priority},Bc[t].arrow," ",n?u.a.createElement(Kt.a,null,c(t?"priority_".concat(t):"priority_unset")):"")},Lc={TRIAGE:"default",MALICIOUS:"error","NON-MALICIOUS":"success",ASSESS:"primary"},Fc=function(e){var t=e.name,a=e.size,n=void 0===a?"small":a,r=Object(X.a)("alerts").t;return u.a.createElement(mi,{size:n,variant:"outlined",color:Lc[t],label:r("status_".concat(t))})},Pc=Object(i.a)((function(e){return{section:{marginBottom:e.spacing(2),"& > hr":{marginBottom:e.spacing(1)}},sectionTitle:{fontWeight:"bold"},sectionContent:{},clipboardIcon:{"&:hover":{cursor:"pointer",transform:"scale(1.1)"}}}})),Mc=function(){return u.a.createElement(pr.a,{style:{display:"inline-block",width:"10rem"}})},Wc=function(e){var t=e.id,a=e.alert,r=Object(X.a)("alerts").t,i=Object(v.a)(),l=Pc(),s=dr(),c=Ma().c12nDef,m=Vi().copy,d=Object(o.useState)(null),p=Object(n.a)(d,2),g=p[0],f=p[1],b=Object(ue.i)().id;return Object(o.useEffect)((function(){var e=t||b;e&&s({url:"/api/v4/alert/".concat(e,"/"),onSuccess:function(e){f(e.api_response)}})}),[t,b]),Object(o.useEffect)((function(){a&&f(a)}),[a]),Object(o.useEffect)((function(){function e(e){var t=e.detail;t.id===g.id&&f(Object(h.a)(Object(h.a)({},g),t.changes))}return window.addEventListener("alertUpdate",e),function(){window.removeEventListener("alertUpdate",e)}}),[g]),u.a.createElement(ir,{margin:a?1:4,width:"100%"},c.enforce&&u.a.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:i.spacing(2)}},u.a.createElement("div",{style:{flex:1}},u.a.createElement(ki,{c12n:g?g.classification:null,type:"outlined"}))),!a&&u.a.createElement("div",{style:{paddingBottom:i.spacing(3),textAlign:"left"}},u.a.createElement(Br.a,{container:!0,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement(Kt.a,{variant:"h4"},r("detail.title"))),u.a.createElement(Br.a,{item:!0,xs:!0,style:{textAlign:"right",flexGrow:0}},g?u.a.createElement(I.a,{title:r("submission")},u.a.createElement(Z.a,{component:Y.b,style:{color:i.palette.action.active},to:'/submission/"'.concat(g.sid,'"')},u.a.createElement(Ya.a,null))):u.a.createElement(pr.a,{variant:"circle",height:"2.5rem",width:"2.5rem",style:{margin:i.spacing(.5)}})))),u.a.createElement("div",{style:{textAlign:"left"}},g&&g.filtered&&u.a.createElement("div",{style:{marginBottom:i.spacing(3)}},u.a.createElement(Bl.a,{severity:"warning"},r("data_filtered_msg"))),u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("alert_id")),u.a.createElement(j.a,null),g?g.alert_id:u.a.createElement(pr.a,null))),u.a.createElement(Br.a,{item:!0,xs:6,md:3},u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("score")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},g?u.a.createElement(Cc,{size:"tiny",score:g.al.score}):u.a.createElement(pr.a,null)))),u.a.createElement(Br.a,{item:!0,xs:6,md:3},u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("user_verdict")),u.a.createElement(j.a,null),g?u.a.createElement("div",{style:{display:"flex"}},u.a.createElement("div",{style:{flexGrow:1}},u.a.createElement("div",null,"".concat(g.verdict.malicious.length,"x ").concat(r("verdict.malicious"))),u.a.createElement("div",null,"".concat(g.verdict.non_malicious.length,"x ").concat(r("verdict.non_malicious")))),u.a.createElement("div",{style:{flexGrow:0,alignSelf:"center",paddingLeft:i.spacing(2),paddingRight:i.spacing(2)}},g.verdict.malicious.length>g.verdict.non_malicious.length&&u.a.createElement(vc.a,null),g.verdict.non_malicious.length>g.verdict.malicious.length&&u.a.createElement(yc.a,null))):u.a.createElement(u.a.Fragment,null,u.a.createElement(pr.a,null),u.a.createElement(pr.a,null)))),u.a.createElement(Br.a,{item:!0,xs:6,md:3},u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("priority")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(R.a,{display:"flex"},g?u.a.createElement(qc,{name:g?g.priority:null,withText:!0,withChip:!0}):u.a.createElement(_c,null))))),u.a.createElement(Br.a,{item:!0,xs:6,md:3},u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("status")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},g?u.a.createElement(Fc,{name:g.status}):u.a.createElement(_c,null)))),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("label")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(wc,{items:g?g.label.map((function(e){return{label:e,variant:"outlined"}})):null}))))),u.a.createElement(Br.a,{container:!0,spacing:2},u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("dates")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:3,sm:2,md:4},r("received_date")),u.a.createElement(Br.a,{item:!0,xs:9,sm:10,md:8},g?"".concat(g.ts.replace("T"," ").replace("Z","")," (UTC)"):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:3,sm:2,md:4},r("alerted_date")),u.a.createElement(Br.a,{item:!0,xs:9,sm:10,md:8},g?"".concat(g.reporting_ts.replace("T"," ").replace("Z","")," (UTC)"):u.a.createElement(pr.a,null)))))),u.a.createElement(Br.a,{item:!0,xs:6,md:3},u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("type")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},g?g.type:u.a.createElement(pr.a,null)))),u.a.createElement(Br.a,{item:!0,xs:6,md:3},u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("ownership")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},g?g.owner?g.owner:g.hint_owner?"assigned":null:u.a.createElement(pr.a,null))))),u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("file_info")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:12,style:{marginBottom:i.spacing(1)}},u.a.createElement("span",null,g?g.file.name:u.a.createElement(Mc,null)),u.a.createElement("span",{style:{marginLeft:i.spacing(1),marginRight:i.spacing(1),wordBreak:"break-all"}},g?u.a.createElement(mi,{label:g.file.type,variant:"outlined",size:"small"}):u.a.createElement(xc,null)),u.a.createElement(Kt.a,{variant:"caption"},g?"".concat(g.file.size," (").concat((g.file.size/1024).toFixed(2)," Kb)"):u.a.createElement(Mc,null))),u.a.createElement(Br.a,{item:!0,xs:3,sm:2},u.a.createElement(Pl.a,{className:l.clipboardIcon,onClick:g?function(){return m(g.file.md5,"drawerTop")}:null}),u.a.createElement(Kt.a,{variant:"caption",style:{marginLeft:i.spacing(.5)}},"MD5:")),u.a.createElement(Br.a,{item:!0,xs:9,sm:10,style:{wordBreak:"break-all"}},g?g.file.md5:u.a.createElement(Mc,null)),u.a.createElement(Br.a,{item:!0,xs:3,sm:2},u.a.createElement(Pl.a,{className:l.clipboardIcon,onClick:g?function(){return m(g.file.sha1,"drawerTop")}:null}),u.a.createElement(Kt.a,{variant:"caption",style:{marginLeft:i.spacing(.5)}},"SHA1:")),u.a.createElement(Br.a,{item:!0,xs:9,sm:10,style:{wordBreak:"break-all"}},g?g.file.sha1:u.a.createElement(Mc,null)),u.a.createElement(Br.a,{item:!0,xs:3,sm:2},u.a.createElement(Pl.a,{className:l.clipboardIcon,onClick:g?function(){return m(g.file.sha256,"drawerTop")}:null}),u.a.createElement(Kt.a,{variant:"caption",style:{marginLeft:i.spacing(.5)}},"SHA256:")),u.a.createElement(Br.a,{item:!0,xs:9,sm:10,style:{wordBreak:"break-all"}},g?g.file.sha256:u.a.createElement(Mc,null))))),!g||g.metadata&&Object.keys(g.metadata).length>0?u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("metadata")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement("pre",{style:{margin:0,fontSize:"larger",whiteSpace:"pre-wrap",wordBreak:"break-all"}},g?Object.keys(g.metadata).map((function(e){return u.a.createElement(Br.a,{container:!0,spacing:1,key:"alert-metadata-".concat(e)},u.a.createElement(Br.a,{item:!0,xs:3,sm:2},e),u.a.createElement(Br.a,{item:!0,xs:9,sm:10},g.metadata[e]))})):u.a.createElement(u.a.Fragment,null,u.a.createElement(pr.a,null),u.a.createElement(pr.a,null),u.a.createElement(pr.a,null))))):null,g&&0===g.al.attrib.length?null:u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("attributions")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(wc,{items:g?g.al.attrib.map((function(e){return{label:e,variant:"outlined",color:"error"}})):null}))),g&&0===g.al.av.length?null:u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("avhits")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(wc,{items:g?g.al.av.map((function(e){return{label:e,variant:"outlined",color:"warning"}})):null}))),g&&0===g.al.ip.length?null:u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("ip")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption"},u.a.createElement("i",null,r("ip_dynamic"))),u.a.createElement(wc,{items:g?g.al.ip_dynamic.map((function(e){return{label:e,variant:"outlined",color:"primary"}})):null})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption"},u.a.createElement("i",null,r("ip_static"))),u.a.createElement(wc,{items:g?g.al.ip_static.map((function(e){return{label:e,variant:"outlined",color:"primary"}})):null})," ")))),g&&0===g.al.domain.length?null:u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("domain")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption"},u.a.createElement("i",null,r("domain_dynamic"))),u.a.createElement(wc,{items:g?g.al.domain_dynamic.map((function(e){return{label:e,variant:"outlined",color:"success"}})):null})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption"},u.a.createElement("i",null,r("domain_static"))),u.a.createElement(wc,{items:g?g.al.domain_static.map((function(e){return{label:e,variant:"outlined",color:"success"}})):null})," ")))),g&&0===g.attack.category.length?null:u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("attack")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption",style:{marginRight:i.spacing(1)}},u.a.createElement("i",null,r("attack_category"))),u.a.createElement("div",{style:{verticalAlign:"middle",display:"inline-block"}},u.a.createElement(wc,{items:g?g.attack.category.map((function(e){return{label:e,variant:"outlined"}})):null}))),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(Kt.a,{variant:"caption",style:{marginRight:i.spacing(1)}},u.a.createElement("i",null,r("attack_pattern"))),u.a.createElement("div",{style:{verticalAlign:"middle",display:"inline-block"}},u.a.createElement(wc,{items:g?g.attack.pattern.map((function(e){return{label:e,variant:"outlined"}})):null})))))),!g||g.heuristic&&g.heuristic.name&&0!==g.heuristic.name.length?u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("heuristic")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(wc,{items:g?g.heuristic.name.map((function(e){return{label:e,variant:"outlined"}})):null}))):null,g&&0===g.al.behavior.length?null:u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("behaviors")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(wc,{items:g?g.al.behavior.map((function(e){return{label:e,variant:"outlined"}})):null}))),g&&0===g.al.yara.length?null:u.a.createElement("div",{className:l.section},u.a.createElement(Kt.a,{className:l.sectionTitle},r("yara")),u.a.createElement(j.a,null),u.a.createElement("div",{className:l.sectionContent},u.a.createElement(wc,{items:g?g.al.yara.map((function(e){return{label:e,variant:"outlined"}})):null})))))},Uc=a(424),Hc=a.n(Uc),Vc=a(423),Gc=a.n(Vc),Yc=Object(i.a)((function(e){return{container:{outline:"none"}}})),Jc=function(e){var t=e.enableSwipe,a=e.disableArrowUp,n=e.disableArrowDown,r=e.disableArrowLeft,i=e.disableArrowRight,l=e.children,s=e.onPrevious,c=e.onNext,m=Yc(),d=Object(o.useRef)(-1),p=Object(o.useRef)(-1),g=Object(o.useRef)(-1),f=Object(o.useRef)(-1),h=Object(o.useRef)(),b=Object(o.useRef)(!1);return u.a.createElement("div",{tabIndex:-1,className:m.container,onKeyDown:function(e){var t=e.key;!r&&ol(t)||!a&&sl(t)?s():(!i&&ul(t)||!n&&cl(t))&&c()},onTouchStart:t&&function(e){d.current=e.touches[0].clientX,p.current=e.touches[0].clientY,g.current=e.touches[0].clientX,f.current=e.touches[0].clientY},onTouchMove:t&&function(e){if(!b.current){var t=e.touches[0].clientX,a=e.touches[0].clientY,n=null;n=Math.abs(t-g.current)>Math.abs(a-f.current)?t>d.current?"right":t<d.current?"left":"scroll":"scroll","scroll"!==h.current&&"scroll"!==n&&h.current&&n!==h.current?(b.current=!0,h.current=null):h.current=n,d.current=t,p.current=a}},onTouchEnd:t&&function(){"right"===h.current?s():"left"===h.current&&c(),h.current=null,b.current=!1}},l)},Qc=function(){function e(t){Object(El.a)(this,e),this.throttleId=null,this.delayId=null,this.msec=null,this.msec=t,this.delay=this.delay.bind(this)}return Object(yl.a)(e,[{key:"throttle",value:function(e){var t=this;this.throttleId||(this.throttleId=setTimeout((function(){e(),t.throttleId=null}),this.msec))}},{key:"delay",value:function(e){this.delayId&&clearTimeout(this.delayId),this.delayId=setTimeout(e,this.msec)}}]),e}(),Kc=new Qc(10);function Xc(e){return{select:Object(o.useCallback)((function(t){Kc.throttle((function(){return window.dispatchEvent(new CustomEvent("".concat("mui.elements.list.cursor.set",".").concat(e),{detail:{cursor:t}}))}))}),[]),selectNext:Object(o.useCallback)((function(){Kc.throttle((function(){return window.dispatchEvent(new CustomEvent("".concat("mui.elements.list.cursor.next",".").concat(e)))}))}),[]),selectPrevious:Object(o.useCallback)((function(){Kc.throttle((function(){return window.dispatchEvent(new CustomEvent("".concat("mui.elements.list.cursor.previous",".").concat(e)))}))}),[]),register:Object(o.useCallback)((function(t){return window.addEventListener("".concat("mui.elements.list.cursor.set",".").concat(e),t.onSelect),window.addEventListener("".concat("mui.elements.list.cursor.next",".").concat(e),t.onSelectNext),window.addEventListener("".concat("mui.elements.list.cursor.previous",".").concat(e),t.onSelectPrevious),function(){window.removeEventListener("".concat("mui.elements.list.cursor.set",".").concat(e),t.onSelect),window.removeEventListener("".concat("mui.elements.list.cursor.next",".").concat(e),t.onSelectNext),window.removeEventListener("".concat("mui.elements.list.cursor.previous",".").concat(e),t.onSelectPrevious)}}),[])}}var Zc=function(e){var t=e.id,a=e.enableSwipe,n=e.disableArrowUp,r=e.disableArrowDown,i=e.disableArrowLeft,l=e.disableArrowRight,s=e.children,c=Xc(t),o=c.selectNext,m=c.selectPrevious;return u.a.createElement(Jc,{enableSwipe:a,disableArrowDown:r,disableArrowLeft:i,disableArrowRight:l,disableArrowUp:n,onNext:o,onPrevious:m},s)},$c=function(e){var t=Xc(e.id),a=t.selectNext,n=t.selectPrevious;return u.a.createElement(R.a,{display:"flex",alignItems:"center"},u.a.createElement(Z.a,{onClick:function(){n()}},u.a.createElement(B.a,null)),u.a.createElement(Z.a,{onClick:function(){a()}},u.a.createElement(L.a,null)))},eo=new Qc(10);var to=Object(i.a)((function(e){return{outer:{position:"relative",display:"flex",flexDirection:"row",overflow:"auto",width:"100%",height:"100%",outline:"none"},inner:{position:"relative",width:"100%",overflow:"hidden"},frame:{position:"absolute",top:0,left:0,right:0,bottom:0},progressCt:{position:"absolute",top:0,bottom:0,left:0,right:0,opacity:.7,zIndex:1,alignItems:"center",backgroundColor:e.palette.background.default},progressSpinner:{position:"absolute",left:"50%",top:"50%"}}})),ao=Object(i.a)((function(e){return{outer:{position:"relative",display:"flex",flexDirection:"column",height:"100%"},inner:{position:"relative",overflow:"auto",outline:"none"},pager:{position:"relative",display:"flex",flexDirection:"row",padding:e.spacing(1)},pagerSpacer:{flex:1},pagerItems:{display:"flex",flexDirection:"row"},pagerItem:{marginLeft:e.spacing(1),display:"inline-block"},progressCt:{position:"absolute",top:0,bottom:0,left:0,right:0,opacity:.7,zIndex:1,alignItems:"center",backgroundColor:e.palette.background.default},progressSpinner:{position:"absolute",left:"50%",top:"50%"}}})),no=Object(i.a)((function(e){return{outer:{position:"relative",display:"flex",flexDirection:"column",overflow:"auto",minHeight:300,height:"100%",width:"100%",outline:"none"},inner:{position:"relative",width:"100%"},progressCt:{position:"absolute",top:0,bottom:0,left:0,right:0,opacity:.7,zIndex:1,alignItems:"center",backgroundColor:e.palette.background.default},progressSpinner:{position:"absolute",left:"50%",top:"50%"}}})),ro=Object(i.a)((function(e){return{itemCt:{position:"relative","&:hover":{cursor:"pointer"},"&:hover $itemActions":{display:"inherit"}},itemDefaultBackgrounds:{"&:hover":{backgroundColor:"dark"===e.palette.type?"hsl(0, 0%, 17%)":"hsl(0, 0%, 95%)"},'&[data-listitem-focus="true"]':{backgroundColor:"dark"===e.palette.type?"hsl(0, 0%, 17%)":"hsl(0, 0%, 95%)"},'&[data-listitem-selected="true"]':{backgroundColor:"dark"===e.palette.type?"hsl(0, 0%, 15%)":"hsl(0, 0%, 92%)"}},itemOuter:{position:"relative",overflow:"auto"},itemInner:{},itemDivider:{position:"absolute",bottom:0,left:0,right:0},itemActions:{position:"absolute",top:e.spacing(1),right:e.spacing(1),display:"none",backgroundColor:"transparent","& button":{marginRight:e.spacing(1),boxShadow:e.shadows[2]}}}}));function io(){return{listItemClasses:ro(),metaListClasses:to(),booklistClasses:ao(),simpleListStyles:no()}}var lo=u.a.memo((function(e){var t=e.selected,a=e.item,n=e.index,r=e.height,i=e.noDivider,l=e.disableBackgrounds,s=e.children,c=e.onRenderActions,m=e.onClick,d=io().listItemClasses,p=Object(o.useCallback)((function(){m&&m(a,n)}),[m,a,n]),g=Object(o.useCallback)((function(e){return e.stopPropagation()}),[]);return u.a.createElement("div",{className:"".concat(d.itemCt," ").concat(!l&&d.itemDefaultBackgrounds),"data-listitem-position":n,"data-listitem-selected":t,"data-listitem-focus":"false",onClick:p,style:{height:r}},s(a),u.a.createElement("div",{className:d.itemDivider,style:{display:i?"none":null}},u.a.createElement(j.a,null)),u.a.createElement("div",{className:d.itemActions,onClick:g},c&&c(a,n)))})),so=function(){function e(t,a,n){Object(El.a)(this,e),this.scrollTarget=t,this.listElement=a,this.rowHeight=n}return Object(yl.a)(e,[{key:"scrollTo",value:function(e){var t=this.scrollElement(e);if(null!==t){var a=this.offset();if(a>0){var n=this.getScrollBlock(t,a);n&&t.scrollIntoView({block:n})}else t.scrollIntoView({block:"nearest"})}}},{key:"getScrollBlock",value:function(e,t){var a=e.offsetTop,n=e.offsetHeight,r=this.listElement.getBoundingClientRect(),i=this.scrollTarget.getBoundingClientRect();return t-r.top!==0&&a<-r.top+i.height/2?"center":a+n>-r.top+i.height?"end":null}},{key:"scrollElement",value:function(e){return this.scrollTarget.querySelector('[data-listitem-position="'.concat(e,'"]'))}},{key:"offset",value:function(){return this.scrollTarget===this.listElement?0:this.scrollTarget.scrollTop+this.listElement.getBoundingClientRect().top}}]),e}(),co=function(e){var t=e.id,a=e.loading,r=e.items,i=e.disableProgress,l=e.scrollTargetId,s=e.scrollInfinite,c=e.scrollLoadNextThreshold,m=void 0===c?75:c,d=e.scrollReset,p=e.disableBackgrounds,g=e.noDivider,f=e.children,h=e.emptyValue,b=e.onCursorChange,v=e.onItemSelected,E=e.onRenderActions,y=e.onLoadNext,O=io().simpleListStyles,_=Xc(t).register,x=Object(o.useRef)(),w=Object(o.useRef)(),j=Object(o.useRef)(),k=Object(o.useRef)(),S=Object(o.useRef)(m),C=function(e){e.id;var t=e.count,a=e.infinite,r=e.scroller,i=e.pause,l=e.onCursorChange,s=e.onEscape,c=e.onEnter,u=Object(o.useState)(0),m=Object(n.a)(u,2),d=m[0],p=m[1],g=function(e){p(e),r.scrollTo(e),l&&l(e)},f=function(){g(d+1<t||a?d+1:0)},h=function(){g(d-1>-1?d-1:a?0:t-1)};return{cursor:d,setCursor:p,next:f,previous:h,onKeyDown:function(e){if(!i){var t=e.key;(dl(t)||ml(t)||sl(t)||cl(t))&&(e.preventDefault(),eo.throttle((function(){dl(t)?c&&c(d):ml(t)?s&&s(d):sl(t)?h():cl(t)&&f()})))}}}}({id:t,scroller:k.current,infinite:s,count:r.length,pause:a,onEscape:function(){v&&v(null,-1)},onEnter:function(e){v&&v(r[e],e)},onCursorChange:function(e){var t=r[e];b&&b(t,e)}}),T=C.cursor,A=C.next,N=C.previous,I=C.setCursor,R=C.onKeyDown,z=!a&&y&&s,D=Object(o.useCallback)((function(e,t){I(t),v&&v(e,t)}),[I,v]);return Object(o.useLayoutEffect)((function(){d&&(S.current=m,w.current.scrollTo({top:0}))}),[d,m]),Object(o.useEffect)((function(){var e=function(){var e=w.current.getBoundingClientRect().height,t=w.current.scrollTop,n=j.current.scrollHeight,r=t+e;Math.ceil(r/n*100)>=S.current&&!a&&(S.current=100,y())};return w.current=l?document.getElementById(l):x.current,w.current&&z&&w.current.addEventListener("scroll",e),k.current=new so(w.current,x.current),function(){w.current.removeEventListener("scroll",e)}}),[l,x,z,a,y]),Object(o.useEffect)((function(){return _({onSelect:function(){return null},onSelectNext:function(){return A()},onSelectPrevious:function(){return N()}})})),u.a.createElement("div",{id:t,tabIndex:0,ref:x,className:O.outer,onKeyDown:a?null:R,style:{overflow:l?null:"auto"}},a&&!i&&u.a.createElement("div",{className:O.progressCt},u.a.createElement(tr.a,{className:O.progressSpinner})),u.a.createElement("div",{ref:j,className:O.inner},r&&0!==r.length?r.map((function(e,t){return u.a.createElement(lo,{key:"list.rowitem[".concat(t,"]"),index:t,selected:T===t,item:e,disableBackgrounds:p,noDivider:g,onRenderActions:E,onClick:D},f)})):a?null:h))},oo=a(425),uo=a(421),mo=a.n(uo),po=a(420),go=a.n(po),fo=function(e){var t=e.item,a=Object(v.a)(),n=Object(X.a)("alerts"),r=n.t,i=n.i18n,l=[];return 0!==t.al.av.length&&l.push({label:"".concat(t.al.av.length,"x AV"),color:"warning",size:"tiny",variant:"outlined"}),0!==t.al.ip.length&&l.push({label:"".concat(t.al.ip.length,"x IP"),color:"primary",size:"tiny",variant:"outlined"}),0!==t.al.domain.length&&l.push({label:"".concat(t.al.domain.length,"x DOM"),color:"success",size:"tiny",variant:"outlined"}),u.a.createElement("div",{style:{padding:a.spacing(2)}},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,md:8},u.a.createElement(qc,{name:t.priority}),t.group_count&&u.a.createElement("span",{style:{marginLeft:a.spacing(1)}},t.group_count,"x"),u.a.createElement("span",{style:{marginLeft:a.spacing(1),wordBreak:"break-all"}},t.file.name)),u.a.createElement(Br.a,{item:!0,xs:6,md:2},t.verdict.malicious.length>t.verdict.non_malicious.length?u.a.createElement(I.a,{title:"".concat(t.verdict.malicious.length,"/").concat(t.verdict.malicious.length+t.verdict.non_malicious.length," ").concat(r("verdict.user.malicious"))},u.a.createElement(vc.a,null)):null,t.verdict.non_malicious.length>t.verdict.malicious.length?u.a.createElement(I.a,{title:"".concat(t.verdict.non_malicious.length,"/").concat(t.verdict.malicious.length+t.verdict.non_malicious.length," ").concat(r("verdict.user.non_malicious"))},u.a.createElement(yc.a,null)):null,t.owner?u.a.createElement(u.a.Fragment,null,u.a.createElement(I.a,{title:"".concat(r("owned_by")," ").concat(t.owner)},u.a.createElement(go.a,null))):t.hint_owner?u.a.createElement(u.a.Fragment,null,u.a.createElement(I.a,{title:r("hint_owned_by")},u.a.createElement(mo.a,null))):null),u.a.createElement(Br.a,{item:!0,xs:6,md:2,style:{textAlign:"right"}},u.a.createElement(Dl.a,{fromNow:!0,locale:i.language},t.reporting_ts)),u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement(Fc,{name:t.status,size:"tiny"})),u.a.createElement(Br.a,{item:!0,xs:12,md:6},u.a.createElement(wc,{items:t.label.map((function(e){return{label:e,size:"tiny",variant:"outlined"}})).concat(t.al.attrib.map((function(e){return{label:e,size:"tiny",color:"error",variant:"outlined"}})))})),u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement(wc,{items:l})),u.a.createElement(Br.a,{item:!0,xs:12,md:2,style:{textAlign:"right"}},u.a.createElement(Cc,{score:t.al.score}))))},ho=a(45),bo=a.n(ho),vo=a(100),Eo=a(422),yo=a.n(Eo),Oo=a(206),_o=a.n(Oo),xo=a(813),wo=a(831),jo=a(832);function ko(){var e=dr(),t=function(){var t=Object(vo.a)(bo.a.mark((function t(a){return bo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r="/api/v4/alert/".concat(a,"/");e({url:r,onSuccess:function(e){t(e.api_response)},onFailure:function(e){return n(e)}})})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),a=function(){var t=Object(vo.a)(bo.a.mark((function t(a,n,r,i){var l,s,c;return bo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=new Promise((function(t,r){n?e({url:"/api/v4/alert/status/batch/?".concat(a.buildAPIQueryString()),method:"post",body:n,onSuccess:function(){t(!0)},onFailure:function(e){return r(e)}}):t(!1)})),s=new Promise((function(t,n){r?e({url:"/api/v4/alert/priority/batch/?".concat(a.buildAPIQueryString()),method:"post",body:r,onSuccess:function(){t(!0)},onFailure:function(e){return n(e)}}):t(!1)})),c=new Promise((function(t,n){i&&i.length>0?e({url:"/api/v4/alert/label/batch/?".concat(a.buildAPIQueryString()),method:"post",body:i,onSuccess:function(){t(!0)},onFailure:function(e){return n(e)}}):t(!0)})),t.abrupt("return",Promise.all([l,s,c]).then((function(){return!0})));case 4:case"end":return t.stop()}}),t)})));return function(e,a,n,r){return t.apply(this,arguments)}}(),n=function(){var t=Object(vo.a)(bo.a.mark((function t(a){return bo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){e({url:"/api/v4/alert/ownership/batch/?".concat(a.buildAPIQueryString()),onSuccess:function(){t(!0)},onFailure:function(e){return n(e)}})})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r=function(){var t=Object(vo.a)(bo.a.mark((function t(a,n){return bo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e({method:"PUT",url:"/api/v4/alert/verdict/".concat(a,"/").concat(n,"/"),onSuccess:function(){t(!0)},onFailure:function(e){return r(e)}})})));case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();return{fetchAlert:Object(o.useCallback)(t,[]),onApplyWorkflowAction:Object(o.useCallback)(a,[]),onTakeOwnership:Object(o.useCallback)(n,[]),setVerdict:Object(o.useCallback)(r,[])}}var So,Co=Object(i.a)((function(e){return{verticalSpeedDial:{backgroundColor:e.palette.background.paper,boxShadow:e.shadows[0],"&.MuiFab-primary":{backgroundColor:e.palette.background.paper},"&.MuiFab-primary:hover":{backgroundColor:e.palette.action.hover},color:e.palette.text.secondary},actionsClosed:{width:0}}})),To={open:!1,query:null},Ao=function(e){var t=e.to,a=Object(b.a)(e,["to"]);return u.a.createElement(Y.b,{to:t},u.a.createElement(xo.a,a))},No=u.a.memo((function(e){var t=e.item,a=e.index,r=e.currentQuery,i=e.setDrawer,l=e.onTakeOwnershipComplete,s=e.onVerdictComplete,c=e.vertical,m=void 0!==c&&c,d=ko(),p=d.onTakeOwnership,g=d.setVerdict,f=Co(),h=r.getGroupBy(),b=Object(X.a)("alerts").t,E=Object(v.a)(),y=$n(),O=y.showErrorMessage,_=y.showSuccessMessage,x=Object(o.useState)(To),w=Object(n.a)(x,2),j=w[0],k=w[1],S=Object(o.useState)(!1),C=Object(n.a)(S,2),T=C[0],A=C[1],N=Ma().user,I=-1!==t.verdict.malicious.indexOf(N.username),R=-1!==t.verdict.non_malicious.indexOf(N.username),z=function(){var e=Object(vo.a)(bo.a.mark((function e(a){return bo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g(t.alert_id,a);case 3:_(b("verdict.".concat(a,".success"))),s&&s(a),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),O(b("verdict.failed"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(vo.a)(bo.a.mark((function e(){return bo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p(j.query);case 3:k({open:!1,query:null}),l&&l(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),k({open:!1,query:null});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=r.newBase((function(e){return"tc_start"===e}));return e.setGroupBy(""),h?e.setQuery("".concat(h,":").concat(Sc(t,h))):e.setQuery("alert_id:".concat(t.alert_id)),e};return u.a.createElement("div",{style:{marginTop:m?null:E.spacing(-1),marginRight:m?null:E.spacing(-1)}},u.a.createElement(wo.a,{ariaLabel:b("action_menu"),icon:u.a.createElement(jo.a,{icon:m?u.a.createElement(V.a,null):u.a.createElement(B.a,null),openIcon:m?u.a.createElement(U.a,null):u.a.createElement(L.a,null)}),classes:{actionsClosed:m?null:f.actionsClosed},onClose:function(){A(!1)},onOpen:function(){A(!0)},open:T,FabProps:{size:m?"medium":"small",className:m?f.verticalSpeedDial:null},direction:m?"down":"left"},u.a.createElement(xo.a,{icon:u.a.createElement(vc.a,null),tooltipTitle:b(I?"verdict.malicious.set":"verdict.malicious.action"),tooltipPlacement:m?"left":"bottom",FabProps:{style:{color:I?"dark"===E.palette.type?E.palette.error.light:E.palette.error.dark:null}},onClick:I?null:function(){return z("malicious")}}),u.a.createElement(xo.a,{icon:u.a.createElement(yc.a,null),tooltipTitle:b(R?"verdict.non_malicious.set":"verdict.non_malicious.action"),tooltipPlacement:m?"left":"bottom",FabProps:{style:{color:R?"dark"===E.palette.type?E.palette.success.light:E.palette.success.dark:null}},onClick:R?null:function(){return z("non_malicious")}}),u.a.createElement(xo.a,{icon:u.a.createElement(Tn.a,{style:{height:"1.3rem",width:"1.3rem"}}),tooltipTitle:b("workflow_action"),tooltipPlacement:m?"left":"bottom",onClick:function(){var e=q();i({open:!0,type:"actions",actionData:{query:e,alert:{index:a,alert_id:t.alert_id,priority:t.priority,status:t.status,labels:t.label}}})}}),u.a.createElement(Ao,{icon:u.a.createElement(Ya.a,null),to:"/submission/".concat(t.sid),tooltipTitle:b("submission"),tooltipPlacement:m?"left":"bottom"}),!t.owner&&u.a.createElement(xo.a,{icon:u.a.createElement(yo.a,null),tooltipTitle:b("take_ownership"),tooltipPlacement:m?"left":"bottom",onClick:function(){k({open:!0,query:q()})}}),t.group_count&&u.a.createElement(Ao,{icon:u.a.createElement(_o.a,null),to:"/alerts/?".concat(function(){var e=r.build();return e.setGroupBy(""),e.addFq("".concat(h,":").concat(Sc(t,h))),e}().buildURLQueryString()),tooltipTitle:b("focus"),tooltipPlacement:m?"left":"bottom"})),j.open&&u.a.createElement(Si,{open:j.open,handleClose:function(){k({open:!1,query:null})},handleAccept:D,title:b("actions.takeownershipdiag.header"),cancelText:b("actions.cancel"),acceptText:b("actions.ok"),text:h?u.a.createElement(u.a.Fragment,null,u.a.createElement("span",{style:{display:"inline-block"}},b("actions.takeownershipdiag.content.grouped")),u.a.createElement("span",{style:{display:"inline-block",padding:E.spacing(1),wordBreak:"break-all"}},u.a.createElement(Kt.a,{variant:"caption"},"".concat(h,": ").concat(Sc(t,h))))):b("actions.takeownershipdiag.content.single")}))})),Io=a(242),Ro=a(826);!function(e){e.BLANK="blank",e.STATUS="status",e.PRIORITY="priority",e.LABEL="label",e.QUERY="query"}(So||(So={}));So.BLANK;var zo=function(){function e(t,a,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Object(El.a)(this,e),this.path=t,this.pageSize=n,this.params=null,this.params=new URLSearchParams(a),r&&(this.hasOffset()||this.setOffset("".concat(0)),this.hasTc()||this.setTc("4d"),this.hasRows()||this.setRows("".concat(n)),this.hasGroupBy()||this.setGroupBy("file.sha256"))}return Object(yl.a)(e,[{key:"setRows",value:function(e){return this.params.set("rows",e),this}},{key:"hasRows",value:function(){return this.params.has("rows")}},{key:"getRows",value:function(){return this.hasRows()?this.params.get("rows"):"".concat(this.pageSize)}},{key:"getRowsNumber",value:function(){return this.hasRows()?parseInt(this.params.get("rows")):this.pageSize}},{key:"setOffset",value:function(e){return this.params.set("offset",e),this}},{key:"hasOffset",value:function(){return this.params.has("offset")}},{key:"getOffset",value:function(){return this.hasOffset()?this.params.get("offset"):"0"}},{key:"getOffsetNumber",value:function(){return this.hasOffset()?parseInt(this.params.get("offset")):0}},{key:"tickOffset",value:function(){return this.setOffset("".concat(this.getOffsetNumber()+this.pageSize)).setRows(this.getRows()),this}},{key:"setQuery",value:function(e){return this.params.set("q",e),this}},{key:"hasQuery",value:function(){return this.params.has("q")}},{key:"getQuery",value:function(){return this.params.has("q")?this.params.get("q"):""}},{key:"setTc",value:function(e){return this.params.set("tc",e),this}},{key:"hasTc",value:function(){return this.params.has("tc")}},{key:"getTc",value:function(){return this.hasTc()?this.params.get("tc"):""}},{key:"setTcStart",value:function(e){return this.params.set("tc_start",e),this}},{key:"hasTcStart",value:function(){return this.params.has("tc_start")}},{key:"getTcStart",value:function(){return this.hasTcStart()?this.params.get("tc_start"):""}},{key:"addFq",value:function(e){return this.params.append("fq",e),this}},{key:"getFqList",value:function(){return this.params.getAll("fq")}},{key:"clearFq",value:function(){return this.params.delete("fq"),this}},{key:"setGroupBy",value:function(e){return this.params.set("group_by",e),this}},{key:"hasGroupBy",value:function(){return this.params.has("group_by")}},{key:"getGroupBy",value:function(){return this.hasGroupBy()?this.params.get("group_by"):"file.sha256"}},{key:"setFilters",value:function(e){var t=this;return this.reset(!1).setTc(e.tc).setGroupBy(e.groupBy),[].concat(Object(oe.a)(e.statuses),Object(oe.a)(e.priorities),Object(oe.a)(e.labels),Object(oe.a)(e.queries)).forEach((function(e){return t.addFq(e.value)})),this}},{key:"deleteQuery",value:function(){return this.params.delete("q"),this}},{key:"deleteTCStart",value:function(){return this.params.delete("tc_start"),this}},{key:"reset",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.setOffset("0").setRows("".concat(this.pageSize)).setTc("4d").setGroupBy("file.sha256").setTcStart("").clearFq(),e&&this.setQuery(""),this}},{key:"buildURLQueryString",value:function(){var e=new URLSearchParams(this.params.toString());return e.delete("tc_start"),e.delete("offset"),e.delete("rows"),"4d"===this.getTc()&&e.delete("tc"),"file.sha256"===this.getGroupBy()&&e.delete("group_by"),""===this.getQuery()&&e.delete("q"),e.toString()}},{key:"buildAPIQueryString",value:function(){var e=new URLSearchParams(this.params.toString());return e.delete("group_by"),""===this.getTc()&&e.delete("tc"),""===this.getQuery()&&e.delete("q"),e.toString()}},{key:"newBase",value:function(t){var a=new e(this.path,"",this.pageSize),n=new URLSearchParams;return t&&this.params.forEach((function(e,a){t(a)&&n.set(a,e)})),a.params=n,a}},{key:"build",value:function(){return new e(this.path,this.params.toString(),this.pageSize)}},{key:"parseFilters",value:function(){var t=[],a=[],n=[],r=[],i=[];return this.getFqList().length&&(a=(t=this.getFqList().map((function(t,a){return e.parseFilterValue(a,t)}))).filter((function(e){return e.type===So.STATUS})),n=t.filter((function(e){return e.type===So.PRIORITY})),r=t.filter((function(e){return e.type===So.LABEL})),i=t.filter((function(e){return e.type===So.QUERY}))),{tc:this.getTc(),groupBy:this.getGroupBy(),statuses:a,priorities:n,labels:r,queries:i}}}],[{key:"parseFilterValue",value:function(e,t){var a=t.split(":"),r=Object(n.a)(a,1)[0];return{id:e,type:function(){switch(r){case"status":return So.STATUS;case"priority":return So.PRIORITY;case"label":return So.LABEL;default:return So.QUERY}}(),label:t,value:t,other:null}}}]),e}(),Do=function(e,t){return t.find((function(t){return t.value===e}))},Bo=function(e,t){return e.map((function(e){return{filter:e,isFavorite:!!t&&t.some((function(t){return t.value===e.value}))}}))};var qo=Object(i.a)((function(e){return{option:{backgroundColor:e.palette.background.default}}})),Lo=function(e){var t=e.searchQuery,a=e.valueFilters,r=e.statusFilters,i=e.priorityFilters,l=e.labelFilters,s=e.userFavorites,c=e.globalFavorites,m=e.onApplyBtnClick,d=Object(v.a)(),p=qo(),g=Object(X.a)("alerts").t,f=[{value:"",label:g("groupBy.none")},{value:"file.md5",label:g("groupBy.md5")},{value:"file.name",label:g("groupBy.name")},{value:"file.sha256",label:g("groupBy.sha256")},{value:"priority",label:g("groupBy.priority")},{value:"status",label:g("groupBy.status")}],b=[{value:"",label:g("tc.none")},{value:"24h",label:g("tc.24h")},{value:"4d",label:g("tc.4d")},{value:"1w",label:g("tc.1week")},{value:"1M",label:g("tc.1month")}],E=t.parseFilters(),y=Do(E.tc,b),O=Do(E.groupBy,f),_=Object(o.useState)(y||Do(E.tc,b)),x=Object(n.a)(_,2),w=x[0],j=x[1],k=Object(o.useState)(O||Do("file.sha256",f)),S=Object(n.a)(k,2),C=S[0],T=S[1],A=Object(o.useState)([].concat(Object(oe.a)(s.map((function(e,t){return{id:"u_".concat(t),type:So.QUERY,label:e.name,value:e.query}}))),Object(oe.a)(c.map((function(e,t){return{id:"g_".concat(t),type:So.QUERY,label:"".concat(e.name," (").concat(e.created_by,")"),value:e.query}}))))),N=Object(n.a)(A,1)[0],I=Object(o.useState)(E.statuses),R=Object(n.a)(I,2),z=R[0],D=R[1],B=Object(o.useState)(E.priorities),q=Object(n.a)(B,2),L=q[0],F=q[1],P=Object(o.useState)(E.labels),M=Object(n.a)(P,2),W=M[0],U=M[1],H=Object(o.useState)(Bo(E.queries,N)),V=Object(n.a)(H,2),G=V[0],Y=V[1],J=function(e,t){return null!==e&&null!==t&&e.value===t.value},Q=function(e){return u.a.createElement("div",null,e.other&&u.a.createElement(mi,{label:e.other.count,size:"tiny"})," ",e.label)};return Object(o.useEffect)((function(){var e=t.parseFilters();j(Do(e.tc,b)||Do("4d",b)),T(Do(e.groupBy,f)||Do("file.sha256",f)),D(e.statuses),F(e.priorities),U(e.labels),Y(Bo(e.queries,N))}),[t,N,g]),u.a.createElement("div",null,u.a.createElement("div",{style:{paddingBottom:d.spacing(2)}},u.a.createElement("div",{style:{float:"right"}},u.a.createElement(ma.a,{variant:"contained",onClick:function(){j(y),T(O),D([]),F([]),U([]),Y([])}},g("filters.clear"))),u.a.createElement(Kt.a,{variant:"h4"},g("filters"))),u.a.createElement("div",{style:{marginBottom:d.spacing(2),marginTop:d.spacing(2)}},u.a.createElement("div",{style:{marginBottom:d.spacing(2)}},u.a.createElement(Io.a,{fullWidth:!0,variant:"outlined"},u.a.createElement("label",null,g("tc")),u.a.createElement(Qr.a,{displayEmpty:!0,value:w?w.value:"4d",onChange:function(e){return function(e){var t=b.find((function(t){return t.value===e}));j(t)}(e.target.value)}},b.map((function(e){return u.a.createElement(Kr.a,{key:e.value,className:p.option,value:e.value},e.label)}))))),u.a.createElement("div",{style:{marginBottom:d.spacing(2)}},u.a.createElement(Io.a,{fullWidth:!0,variant:"outlined"},u.a.createElement("label",null,g("groupBy")),u.a.createElement(Qr.a,{displayEmpty:!0,value:C?C.value:"file.sha256",onChange:function(e){return function(e){var t=f.find((function(t){return t.value===e}));T(t)}(e.target.value)}},f.map((function(e){return u.a.createElement(Kr.a,{key:e.value,className:p.option,value:e.value},e.label)}))))),u.a.createElement("div",{style:{marginBottom:d.spacing(2)}},u.a.createElement("label",null,g("status")),u.a.createElement(Ro.a,{fullWidth:!0,multiple:!0,classes:{option:p.option},options:r,value:z,getOptionLabel:function(e){return e.label},getOptionSelected:J,renderOption:Q,renderInput:function(e){return u.a.createElement(hr.a,Object.assign({},e,{variant:"outlined"}))},onChange:function(e,t){D(t)}})),u.a.createElement("div",{style:{marginBottom:d.spacing(2)}},u.a.createElement("label",null,g("priority")),u.a.createElement(Ro.a,{fullWidth:!0,multiple:!0,classes:{option:p.option},options:i,value:L,getOptionLabel:function(e){return e.label},getOptionSelected:J,renderOption:Q,renderInput:function(e){return u.a.createElement(hr.a,Object.assign({},e,{variant:"outlined"}))},onChange:function(e,t){F(t)}})),u.a.createElement("div",{style:{marginBottom:d.spacing(2)}},u.a.createElement("label",null,g("labels")),u.a.createElement(Ro.a,{fullWidth:!0,multiple:!0,classes:{option:p.option},options:l,value:W,getOptionLabel:function(e){return e.label},getOptionSelected:J,renderOption:Q,renderInput:function(e){return u.a.createElement(hr.a,Object.assign({},e,{variant:"outlined"}))},onChange:function(e,t){U(t)}})),u.a.createElement("div",{style:{marginBottom:d.spacing(2)}},u.a.createElement("label",null,g("favorites")),u.a.createElement(Ro.a,{fullWidth:!0,multiple:!0,classes:{option:p.option},options:N,value:G.filter((function(e){return e.isFavorite})).map((function(e){return e.filter})),getOptionLabel:function(e){return e.label},getOptionSelected:J,renderOption:Q,renderInput:function(e){return u.a.createElement(hr.a,Object.assign({},e,{variant:"outlined"}))},onChange:function(e,t){return function(e){var t=e.map((function(e){return{filter:e,isFavorite:!0}})),a=G.filter((function(e){return!e.isFavorite}));Y([].concat(Object(oe.a)(t),Object(oe.a)(a)))}(t)}})),u.a.createElement("div",{style:{marginBottom:d.spacing(2)}},u.a.createElement("label",null,g("others")),u.a.createElement(Ro.a,{fullWidth:!0,multiple:!0,classes:{option:p.option},options:a,value:G.filter((function(e){return!e.isFavorite})).map((function(e){return e.filter})),getOptionLabel:function(e){return e.label},getOptionSelected:J,renderOption:Q,renderInput:function(e){return u.a.createElement(hr.a,Object.assign({},e,{variant:"outlined"}))},onChange:function(e,t){return function(e){var t=e.map((function(e){return{filter:(t=e,"string"===typeof t?{id:"id_".concat(t),type:So.QUERY,label:t,value:t}:t),isFavorite:!1};var t})),a=G.filter((function(e){return e.isFavorite}));Y([].concat(Object(oe.a)(t),Object(oe.a)(a)))}(t)}}))),u.a.createElement("div",{style:{textAlign:"right",marginTop:d.spacing(1)}},u.a.createElement(ma.a,{variant:"contained",color:"primary",onClick:function(){m(Object(h.a)(Object(h.a)({},E),{},{tc:w.value,groupBy:C.value,statuses:z,priorities:L,labels:W,queries:G.map((function(e){return e.filter}))}))}},g("filters.apply"))))};function Fo(){var e=dr(),t=Ma().user,a=Object(o.useState)([]),r=Object(n.a)(a,2),i=r[0],l=r[1],s=Object(o.useState)([]),c=Object(n.a)(s,2),u=c[0],m=c[1],d=function(){var a="/api/v4/user/favorites/".concat(t.username,"/");e({url:a,onSuccess:function(e){l(e.api_response.alert)}})},p=function(){e({url:"/api/v4/user/favorites/__global__/",onSuccess:function(e){m(e.api_response.alert)}})};return Object(o.useEffect)((function(){d(),p()}),[]),{userFavorites:i,globalFavorites:u,onAddUserFavorite:function(a,n){var r="/api/v4/user/favorites/".concat(t.username,"/alert/");e({url:r,method:"put",body:a,onSuccess:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){e.api_response.success&&(d(),n&&n(a))}))})},onAddGlobalFavorite:function(a,n){var r=Object(h.a)(Object(h.a)({},a),{},{created_by:t.username});e({url:"/api/v4/user/favorites/__global__/alert/",method:"put",body:r,onSuccess:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){e.api_response.success&&(p(),n&&n(r))}))})},onDeleteUserFavorite:function(a,n){var r="/api/v4/user/favorites/".concat(t.username,"/alert/");e({url:r,method:"delete",body:a.name,onSuccess:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){e.api_response.success&&(d(),n&&n(a))}))})},onDeleteGlobalFavorite:function(t,a){e({url:"/api/v4/user/favorites/__global__/alert/",method:"delete",body:t.name,onSuccess:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){e.api_response.success&&(p(),a&&a(t))}))})}}}var Po=function(e){var t=e.initValue,a=e.onSaved,r=e.onSelected,i=e.onDeleted,l=Object(v.a)(),s=Object(X.a)("favorites").t,c=Fo(),m=c.userFavorites,d=c.globalFavorites,p=c.onAddUserFavorite,g=c.onDeleteUserFavorite,f=c.onAddGlobalFavorite,b=c.onDeleteGlobalFavorite,E=$n(),y=E.showErrorMessage,O=E.showSuccessMessage,_=Ma(),x=_.c12nDef,w=_.user,k=Object(o.useState)(!1),S=Object(n.a)(k,2),C=S[0],T=S[1],A=Object(o.useState)(x.UNRESTRICTED),N=Object(n.a)(A,2),I=N[0],R=N[1],z=Object(o.useState)({valid:!0,value:t}),D=Object(n.a)(z,2),B=D[0],q=D[1],L=Object(o.useState)({valid:!0,value:""}),F=Object(n.a)(L,2),P=F[0],M=F[1],W=Object(o.useState)(!1),U=Object(n.a)(W,2),H=U[0],V=U[1],G=Object(o.useState)({open:!1,favorite:null,isPublic:!1}),Y=Object(n.a)(G,2),J=Y[0],Q=Y[1],K=function(e,t){T(!!e.value&&!!t.value)},Z=function(e,t){Q({open:!0,favorite:e,isPublic:t})},$=function(e){r(e)},ee=function(e){V(e)};return u.a.createElement("div",null,u.a.createElement("div",{style:{paddingBottom:l.spacing(2)}},u.a.createElement(Kt.a,{variant:"h4"},s("addfavorites"))),u.a.createElement("div",{style:{textAlign:"right"}},u.a.createElement(ma.a,{onClick:function(){return ee(!H)},size:"small",color:"primary",disableElevation:!0,disableRipple:!0},u.a.createElement("div",null,s("private")),u.a.createElement("div",{style:{flex:1}},u.a.createElement(ja.a,{checked:H,onChange:function(e){return ee(e.target.checked)},color:"primary"})),u.a.createElement("div",null,s("public")))),H&&x.enforce?u.a.createElement(ki,{type:"picker",c12n:I,setClassification:R}):u.a.createElement("div",{style:{padding:l.spacing(2.25)}}),u.a.createElement("div",{style:{marginTop:l.spacing(1),marginBottom:l.spacing(2)}},u.a.createElement("div",null,u.a.createElement(Kt.a,{variant:"subtitle2"},s("query")),u.a.createElement(hr.a,{error:!B.valid,variant:"outlined",value:B.value,onChange:function(e){var t=e.currentTarget.value,a={valid:!!t,value:t};q(a),K(a,P)},onBlur:function(){return q(Object(h.a)(Object(h.a)({},B),{},{valid:!!B.value}))},fullWidth:!0})),u.a.createElement("div",{style:{marginTop:l.spacing(2)}},u.a.createElement(Kt.a,{variant:"subtitle2"},s("name")),u.a.createElement(hr.a,{error:!P.valid,variant:"outlined",value:P.value,onChange:function(e){var t=e.currentTarget.value,a={valid:!!t,value:t};M({valid:!!t,value:t}),K(B,a)},onBlur:function(){return M(Object(h.a)(Object(h.a)({},P),{},{valid:!!P.value}))},fullWidth:!0}))),u.a.createElement("div",{style:{paddingTop:l.spacing(2),paddingBottom:l.spacing(4),textAlign:"right"}},u.a.createElement(ma.a,{variant:"contained",color:"primary",onClick:function(){if(B.value&&P.value){var e={query:B.value,name:P.value,classification:H&&x.enforce?I:x.UNRESTRICTED,created_by:w.username};H?f(e,(function(){O(s("added.global")),a(e)})):p(e,(function(){O(s("added.personal")),a(e)}))}else y(s("form.field.required"))},disabled:!C},s("save"))),u.a.createElement(Kt.a,{variant:"h6"},s("yourfavorites")),u.a.createElement(j.a,null),u.a.createElement("div",{style:{marginTop:l.spacing(1),marginBottom:l.spacing(4)}},u.a.createElement(wc,{items:m.map((function(e){return{size:"medium",variant:"outlined",label:e.name,tooltip:e.query,onClick:function(){return $(e)},onDelete:function(){return Z(e,!1)}}}))})),u.a.createElement(Kt.a,{variant:"h6"},s("globalfavorites")),u.a.createElement(j.a,null),u.a.createElement("div",{style:{marginTop:l.spacing(1)}},u.a.createElement(wc,{items:d.map((function(e){return{size:"medium",variant:"outlined",label:e.name,tooltip:e.query,onClick:function(){return $(e)},onDelete:function(){return Z(e,!0)}}}))})),u.a.createElement(Si,{open:J.open,handleClose:function(){Q({open:!1,favorite:null,isPublic:!1})},handleAccept:function(){!function(e,t){t?b(e,(function(){i(e)})):g(e,(function(){i(e)}))}(J.favorite,J.isPublic),Q({open:!1,favorite:null,isPublic:!1})},title:s("confirmdiag.header"),cancelText:s("cancel"),acceptText:s("ok"),text:u.a.createElement(u.a.Fragment,null,u.a.createElement("span",{style:{display:"block",paddingBottom:l.spacing(1)}},s("confirmdiag.content")),u.a.createElement("span",{style:{display:"block",fontWeight:500}},J.favorite?J.favorite.name:null))}))},Mo=function(e){var t=e.searchQuery,a=e.hideQuery,n=void 0!==a&&a,r=e.hideGroupBy,i=void 0!==r&&r,l=e.disableActions,s=void 0!==l&&l,c=e.onChange,o=void 0===c?function(){return null}:c,m=Object(X.a)("alerts").t,d=t.parseFilters(),p=t.getQuery();return u.a.createElement("div",null,u.a.createElement("div",null,p&&!n&&u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement(wc,{items:[p].map((function(e){return{variant:"outlined",label:"".concat(e),onDelete:s?null:function(){o(d,"")}}}))})),d&&d.tc&&u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement(wc,{items:[d.tc].map((function(e){return{variant:"outlined",label:"".concat(m("tc"),"=").concat(e),onDelete:s?null:function(){o(Object(h.a)(Object(h.a)({},d),{},{tc:""}))}}}))})),d&&d.groupBy&&!i&&u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement(wc,{items:[d.groupBy].map((function(e){return{variant:"outlined",label:"".concat(m("groupBy"),"=").concat(e),onDelete:s?null:function(){o(Object(h.a)(Object(h.a)({},d),{},{groupBy:""}))}}}))})),d&&0!==d.statuses.length&&u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement(wc,{items:d.statuses.map((function(e){return{variant:"outlined",label:e.value,onDelete:s?null:function(){return function(e){var t=d.statuses.filter((function(t){return t.value!==e.value}));o(Object(h.a)(Object(h.a)({},d),{},{statuses:t}))}(e)}}}))})),d&&0!==d.priorities.length&&u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement(wc,{items:d.priorities.map((function(e){return{variant:"outlined",label:e.value,onDelete:s?null:function(){return function(e){var t=d.priorities.filter((function(t){return t.value!==e.value}));o(Object(h.a)(Object(h.a)({},d),{},{priorities:t}))}(e)}}}))})),d&&0!==d.labels.length&&u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement(wc,{items:d.labels.map((function(e){return{variant:"outlined",label:e.value,onDelete:s?null:function(){return function(e){var t=d.labels.filter((function(t){return t.value!==e.value}));o(Object(h.a)(Object(h.a)({},d),{},{labels:t}))}(e)}}}))})),d&&0!==d.queries.length&&u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement(wc,{items:d.queries.map((function(e){return{variant:"outlined",label:e.value,onDelete:s?null:function(){return function(e){var t=d.queries.filter((function(t){return t.value!==e.value}));o(Object(h.a)(Object(h.a)({},d),{},{queries:t}))}(e)}}}))}))))},Wo=["ASSESS","MALICIOUS","NON-MALICIOUS"],Uo=["LOW","MEDIUM","HIGH","CRITICAL"],Ho=["PHISHING","CRIME","ATTRIBUTED","WHITELISTED","FALSE_POSITIVE","REPORTED","MITIGATED","PENDING"],Vo=function(e){var t=e.searchQuery,a=e.alert,r=e.labelFilters,i=e.onApplyBtnClick,l=Object(X.a)("alerts").t,s=Object(v.a)(),c=Object(o.useState)(!1),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Object(o.useState)(!1),f=Object(n.a)(g,2),h=f[0],b=f[1],E=Object(o.useState)([].concat(Ho,Object(oe.a)(r.map((function(e){return e.label}))))),y=Object(n.a)(E,1)[0],O=Object(o.useState)(null),_=Object(n.a)(O,2),x=_[0],w=_[1],j=Object(o.useState)(null),k=Object(n.a)(j,2),S=k[0],C=k[1],T=Object(o.useState)([]),A=Object(n.a)(T,2),N=A[0],I=A[1],R=function(e,t,a){var n=e||t||a&&a.length>0;p(n)},z=t.getQuery();return u.a.createElement("div",null,u.a.createElement("div",{style:{margin:s.spacing(1),marginBottom:s.spacing(2)}},u.a.createElement(Kt.a,{variant:"h4"},l("workflow.title"))),u.a.createElement("div",{style:{margin:s.spacing(1)}},u.a.createElement(Bl.a,{severity:z&&z.startsWith("alert_id")&&a?"info":"warning"},z&&z.startsWith("alert_id")&&a?l("workflow.impact.low"):l("workflow.impact.high"))),u.a.createElement("div",{style:{margin:s.spacing(1)}},u.a.createElement("div",{style:{wordBreak:"break-all",marginTop:s.spacing(1),padding:s.spacing(2),color:s.palette.primary.light,backgroundColor:"dark"===s.palette.type?s.palette.grey[900]:s.palette.grey[200]}},u.a.createElement(Mo,{searchQuery:t,disableActions:!0,hideGroupBy:!0}))),u.a.createElement("div",{style:{margin:s.spacing(1),marginTop:s.spacing(2)}},u.a.createElement("div",{style:{marginBottom:s.spacing(2)}},u.a.createElement(Ro.a,{fullWidth:!0,options:Wo,value:x,renderInput:function(e){return u.a.createElement(hr.a,Object.assign({},e,{label:l("status"),variant:"outlined"}))},onChange:function(e,t){return R(a=t,S,N),void w(a);var a}})),u.a.createElement("div",{style:{marginBottom:s.spacing(2)}},u.a.createElement(Ro.a,{fullWidth:!0,options:Uo,value:S,renderInput:function(e){return u.a.createElement(hr.a,Object.assign({},e,{label:l("priority"),variant:"outlined"}))},onChange:function(e,t){return R(x,a=t,N),void C(a);var a}})),u.a.createElement("div",{style:{marginBottom:s.spacing(2)}},u.a.createElement(Ro.a,{fullWidth:!0,multiple:!0,freeSolo:!0,options:y,value:N,renderInput:function(e){return u.a.createElement(hr.a,Object.assign({},e,{label:l("labels"),variant:"outlined"}))},onChange:function(e,t){return R(x,S,a=t),void I(a.map((function(e){return e.toUpperCase()})));var a}}))),u.a.createElement("div",{style:{textAlign:"right",marginTop:s.spacing(1)}},u.a.createElement(ma.a,{variant:"contained",color:"primary",onClick:function(){d&&(b(!0),i(x,S,N))},startIcon:h?u.a.createElement(tr.a,{size:20}):null,disabled:h||!d},l("workflow.apply"))))},Go={loading:!0,total:0,countedTotal:0,alerts:[]},Yo=function(e,t){var a=t.action,n=t.loading,r=t.total,i=t.countedTotal,l=t.alerts,s=t.updateAlert;if("update"===a){var c=Object(oe.a)(e.alerts);return c[s.alertIndex]=Object(h.a)(Object(h.a)({},c[s.alertIndex]),s.alertChanges),{loading:e.loading,total:e.total,countedTotal:e.countedTotal,alerts:c}}return"set"===a?{loading:void 0!==n?n:e.loading,total:void 0!==r?r:e.total,countedTotal:void 0!==i?i:e.countedTotal,alerts:l||e.alerts}:{loading:void 0!==n?n:e.loading,total:void 0!==r?r:e.total,countedTotal:void 0!==i?e.countedTotal+i:e.countedTotal,alerts:l?e.alerts.concat(l):e.alerts}};var Jo=Object(i.a)((function(e){return{pageTitle:{paddingBottom:e.spacing(3)},drawerInner:Object(r.a)({display:"flex",flexDirection:"column",padding:e.spacing(3),width:"600px"},e.breakpoints.down("xs"),{width:"100%"}),searchresult:{marginTop:e.spacing(1),fontStyle:"italic",minHeight:e.spacing(3)},modeToggler:{border:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0,marginRight:"0px !important"}}})),Qo=function(e){var t=e.searching,a=e.total,n=e.query,r=e.onApplyFilters,i=Object(v.a)(),l=Object(X.a)("alerts").t;return u.a.createElement("div",{style:{position:"relative"}},u.a.createElement(Mo,{searchQuery:n,onChange:r,hideQuery:!0}),u.a.createElement("div",{style:{position:"absolute",top:i.spacing(.5),right:i.spacing(1)}},t?"":u.a.createElement("span",null,"".concat(a," ").concat(l(a>1?"results":"result")))))},Ko=function(e){var t=e.searching,a=e.total,n=e.query,r=Object(v.a)(),i=Object(X.a)("alerts").t,l=!!n&&function(e){var t=e.statuses,a=e.priorities,n=e.labels,r=e.queries;return t.length>0||a.length>0||n.length>0||r.length>0}(n.parseFilters());return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{marginTop:r.spacing(2),alignItems:"center"}},!t&&l&&u.a.createElement(u.a.Fragment,null,u.a.createElement(oo.a,{style:{marginRight:r.spacing(1)}})),t?"":"".concat(a," ").concat(i(a>1?"results":"result"))))},Xo=function(){var e=Object(X.a)("alerts").t,t=Jo(),a=Object(v.a)(),r=Ma().user,i=Object(l.a)(a.breakpoints.up("md")),s=el().setGlobalDrawer,c=function(e){var t=Object(ue.h)(),a=dr(),r=Ma().indexes,i=Object(o.useState)(null),l=Object(n.a)(i,2),s=l[0],c=l[1],u=Object(o.useState)([]),m=Object(n.a)(u,2),d=m[0],p=m[1],g=Object(o.useState)([]),f=Object(n.a)(g,2),b=f[0],v=f[1],E=Object(o.useState)([]),y=Object(n.a)(E,2),O=y[0],_=y[1],x=Object(o.useState)([]),w=Object(n.a)(x,2),j=w[0],k=w[1],S=Object(o.useState)([]),C=Object(n.a)(S,2),T=C[0],A=C[1],N=Object(o.useReducer)(Yo,Go),I=Object(n.a)(N,2),R=I[0],z=I[1],D=function(e,t){return e.map((function(e,a){return Object(h.a)(Object(h.a)({},e),{},{id:e.alert_id,index:a+t})}))},B=Object(o.useCallback)((function(){return s.getGroupBy()?"/api/v4/alert/grouped/".concat(s.getGroupBy(),"/?").concat(s.buildAPIQueryString()):"/api/v4/alert/list/?".concat(s.buildAPIQueryString())}),[s]),q=Object(o.useCallback)((function(e,t){z({action:"update",updateAlert:{alertIndex:e,alertChanges:t}})}),[]),L=Object(o.useCallback)((function(e){z({action:"set",loading:!0}),a({url:B(),onSuccess:function(t){var a=t.api_response,n=a.items,r=a.tc_start,i=a.total,l=a.counted_total,c=D(n,0);r?s.setTcStart(r):!s.getTcStart()&&c.length>0&&s.setTcStart(c[0].reporting_ts),z({action:"set",loading:!1,total:i,countedTotal:s.getGroupBy()?l:n.length,alerts:c}),e&&e(!0)},onFailure:function(){z({action:"set",loading:!1}),e&&e(!1)}})}),[s]),F=Object(o.useCallback)((function(e){s.tickOffset();var t=s.getOffsetNumber();z({action:"set",loading:!0}),a({url:B(),onSuccess:function(a){var n=a.api_response,r=n.items,i=n.total,l=n.counted_total,c=D(r,t);z({action:"append",loading:!1,total:i,countedTotal:s.getGroupBy()?l:r.length,alerts:c}),e&&e(!0)},onFailure:function(){z({action:"set",loading:!1}),e&&e(!1)}})}),[s]),P=Object(o.useCallback)((function(){a({url:"/api/v4/alert/statuses/?".concat(s.buildAPIQueryString()).concat(s.getGroupBy()?"&fq=".concat(s.getGroupBy(),":*"):""),onSuccess:function(e){var t=e.api_response,a=Object.keys(t).map((function(e,a){return{id:a,type:So.STATUS,label:e,value:"status:".concat(e),other:{count:t[e]}}}));v(a)}})}),[s]),M=Object(o.useCallback)((function(){a({url:"/api/v4/alert/priorities/?".concat(s.buildAPIQueryString()).concat(s.getGroupBy()?"&fq=".concat(s.getGroupBy(),":*"):""),onSuccess:function(e){var t=e.api_response,a=Object.keys(t).map((function(e,a){return{id:a,type:So.PRIORITY,label:e,value:"priority:".concat(e),other:{count:t[e]}}}));_(a)}})}),[s]),W=Object(o.useCallback)((function(){a({url:"/api/v4/alert/labels/?".concat(s.buildAPIQueryString()).concat(s.getGroupBy()?"&fq=".concat(s.getGroupBy(),":*"):""),onSuccess:function(e){var t=e.api_response,a=Object.keys(t).map((function(e,a){return{id:a,type:So.LABEL,label:e,value:"label:".concat(e),other:{count:t[e]}}}));k(a)}})}),[s]),U=Object(o.useCallback)((function(){a({url:"/api/v4/alert/statistics/?".concat(s.buildAPIQueryString()).concat(s.getGroupBy()?"&fq=".concat(s.getGroupBy(),":*"):""),onSuccess:function(e){var t=e.api_response,a=[];Object.keys(t).forEach((function(e,n){var r=t[e];Object.keys(r).forEach((function(t,i){var l=r[t];a.push({id:"".concat(n,".").concat(i,"}"),type:So.QUERY,label:"".concat(e,":").concat(t),value:"".concat(e,':"').concat(t,'"'),other:{count:l}})}))})),A(a)}})}),[s]);return Object(o.useEffect)((function(){s&&(L(),P(),M(),W(),U())}),[s]),Object(o.useEffect)((function(){c(new zo(t.pathname,t.search,e))}),[t.pathname,t.search,e]),Object(o.useEffect)((function(){if(r){var e=Object.keys(r.alert).map((function(e){var t=r.alert[e];return Object(h.a)(Object(h.a)({},t),{},{name:e})}));p(e)}}),[r]),Object(h.a)(Object(h.a)({},R),{},{fields:d,searchQuery:s,statusFilters:b,priorityFilters:O,labelFilters:j,valueFilters:T,updateAlert:q,updateQuery:c,onLoad:L,onLoadMore:F})}(50),m=c.loading,d=c.alerts,p=c.total,g=c.countedTotal,f=c.fields,b=c.searchQuery,E=c.valueFilters,y=c.statusFilters,O=c.priorityFilters,_=c.labelFilters,x=c.onLoad,w=c.onLoadMore,j=c.updateAlert,k=ko().onApplyWorkflowAction,S=Object(o.useState)(!1),C=Object(n.a)(S,2),T=C[0],A=C[1],I=Object(o.useState)({open:!1,type:null}),z=Object(n.a)(I,2),D=z[0],B=z[1],q=Object(ue.g)(),L=Object(ue.h)(),F=Fo(),P=F.userFavorites,M=F.globalFavorites,W=Object(o.useRef)("");Object(o.useEffect)((function(){b&&(A(!0),W.current=b.getQuery())}),[b]);var U=Object(l.a)(a.breakpoints.up("md")),H=Object(l.a)(a.breakpoints.down("lg")),V=Object(o.useCallback)((function(e,t,a){var n={verdict:Object(h.a)({},t.verdict)};"malicious"===a?(-1===n.verdict.malicious.indexOf(r.username)&&n.verdict.malicious.push(r.username),-1!==n.verdict.non_malicious.indexOf(r.username)&&n.verdict.non_malicious.splice(n.verdict.non_malicious.indexOf(r.username),1)):(-1===n.verdict.non_malicious.indexOf(r.username)&&n.verdict.non_malicious.push(r.username),-1!==n.verdict.malicious.indexOf(r.username)&&n.verdict.malicious.splice(n.verdict.malicious.indexOf(r.username),1)),j(e,n),window.dispatchEvent(new CustomEvent("alertUpdate",{detail:{id:t.id,changes:n}}))}),[r.username,j]),G=Object(o.useCallback)((function(e,t){var a={owner:r.username};j(e,a),window.dispatchEvent(new CustomEvent("alertUpdate",{detail:{id:t.id,changes:a}}))}),[r.username,j]),Y=Object(o.useCallback)((function(e,t){null!==e&&void 0!==e&&(H&&document.getElementById("al.alerts.simplelist").blur(),s(u.a.createElement("div",null,u.a.createElement("div",{style:{alignItems:"start",display:"flex",float:"right",height:a.spacing(8),marginTop:a.spacing(-8),marginRight:a.spacing(-1),position:"sticky",top:a.spacing(1),zIndex:1}},u.a.createElement($c,{id:"al.alerts.simplelist"}),u.a.createElement(No,{item:e,index:t,currentQuery:b,setDrawer:B,onTakeOwnershipComplete:function(){return G(t,e)},onVerdictComplete:function(a){return V(t,e,a)},vertical:!0})),u.a.createElement(Zc,{id:"al.alerts.simplelist",disableArrowUp:!0,disableArrowDown:!0,enableSwipe:!0},u.a.createElement(Wc,{alert:e})))))}),[s,H,a,b,G,V]),J=Object(o.useCallback)((function(){A(!1),w()}),[A,w]),Q=function(e,t){void 0!==t&&null!==t&&b.setQuery(t),b.setFilters(e),q.push("".concat(L.pathname,"?").concat(b.buildURLQueryString())),D.open&&B(Object(h.a)(Object(h.a)({},D),{},{open:!1}))},K=Object(o.useCallback)((function(e){return u.a.createElement(fo,{item:e})}),[]),$=function(){B(Object(h.a)(Object(h.a)({},D),{},{open:!1,actionData:null}))},ee=Object(o.useCallback)((function(e,t){return u.a.createElement(No,{item:e,index:t,currentQuery:b,setDrawer:B,onTakeOwnershipComplete:function(){return G(t,e)},onVerdictComplete:function(a){return V(t,e,a)}})}),[G,V,b]);return u.a.createElement(Yi,{margin:4},u.a.createElement(N.a,{open:D.open,anchor:"right",onClose:$},u.a.createElement("div",{style:{padding:a.spacing(1)}},u.a.createElement(Z.a,{onClick:$},u.a.createElement(Ki.a,null))),u.a.createElement("div",{className:t.drawerInner},{filter:u.a.createElement(Lo,{searchQuery:b,valueFilters:E,statusFilters:y,priorityFilters:O,labelFilters:_,userFavorites:P,globalFavorites:M,onApplyBtnClick:Q}),favorites:u.a.createElement(Po,{initValue:W.current,onSelected:function(e){b.addFq(e.query),q.push("".concat(L.pathname,"?").concat(b.buildURLQueryString())),D.open&&B(Object(h.a)(Object(h.a)({},D),{},{open:!1}))},onDeleted:function(e){},onSaved:function(e){B(Object(h.a)(Object(h.a)({},D),{},{open:!1}))}}),actions:D.actionData&&u.a.createElement(Vo,{searchQuery:D.actionData.query,alert:D.actionData.alert,labelFilters:_,onApplyBtnClick:function(e,t,a){k(D.actionData.query,e,t,a).then((function(){B(Object(h.a)(Object(h.a)({},D),{},{open:!1}));var n=D.actionData.alert;if(n){var r={status:e||n.status,priority:t||n.priority,label:Object(oe.a)(Array.from(new Set([].concat(Object(oe.a)(n.labels),Object(oe.a)(a)))))};j(n.index,r),window.dispatchEvent(new CustomEvent("alertUpdate",{detail:{id:n.alert_id,changes:r}}))}else A(!0),x()}))}})}[D.type])),u.a.createElement("div",{style:{paddingBottom:a.spacing(2)}},u.a.createElement(Kt.a,{variant:"h4"},e("alerts"))),u.a.createElement(Ji,{isSticky:!0},u.a.createElement("div",{style:{paddingTop:a.spacing(1)}},u.a.createElement(vl,{initValue:b?b.getQuery():"",searching:m,suggestions:function(){var e=f.map((function(e){return e.name}));return[].concat(Object(oe.a)(e),Object(oe.a)(pl))}(),placeholder:"Filter alerts...",onValueChange:function(e){W.current=e},onClear:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;b.deleteQuery(),q.push("".concat(L.pathname,"?").concat(b.buildURLQueryString())),W.current="",e&&e.focus()},onSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;b.setQuery(e),q.push("".concat(L.pathname,"?").concat(b.buildURLQueryString())),t&&t.focus()},buttons:[{icon:u.a.createElement(Gc.a,{fontSize:i?"default":"small"}),tooltip:e("favorites"),props:{onClick:function(){return B({open:!0,type:"favorites"})}}},{icon:u.a.createElement(Hc.a,{fontSize:i?"default":"small"}),tooltip:e("filters"),props:{onClick:function(){return B({open:!0,type:"filter"})}}},{icon:u.a.createElement(Tn.a,{fontSize:i?"default":"small"}),tooltip:e("workflows"),props:{onClick:function(){return B({open:!0,type:"actions",actionData:{query:b}})}}}]},u.a.createElement(R.a,{className:t.searchresult},U?u.a.createElement(Qo,{searching:m,total:p,query:b,onApplyFilters:Q}):u.a.createElement(Ko,{searching:m,total:p,query:b}))))),u.a.createElement(co,{id:"al.alerts.simplelist",disableProgress:!0,scrollInfinite:g<p,scrollReset:T,scrollLoadNextThreshold:75,scrollTargetId:"app-scrollct",loading:m,items:d,emptyValue:u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(Ll,null,u.a.createElement(wl.a,null,e("no_alerts_title")),e("no_alerts_desc"))),onItemSelected:Y,onRenderActions:ee,onLoadNext:J,onCursorChange:function(e,t){Y(e,t)}},K))},Zo=a(825),$o=a(427),eu=a.n($o),tu=a(147),au=a.n(tu),nu=a(426),ru=a.n(nu),iu={incomplete:u.a.createElement(ec.a,{color:"error"}),completed:u.a.createElement(ac.a,{color:"primary"}),submitted:u.a.createElement(ru.a,{color:"secondary"}),skipped:u.a.createElement(zn.a,{color:"action"})},lu=u.a.memo((function(e){var t=e.state,a=Object(X.a)().t,n=iu[t];return u.a.createElement(I.a,{title:a("extended_scan.".concat(t))},n)})),su=u.a.memo((function(e){var t=e.verdicts,a=e.width,n=void 0===a?"100%":a,r=Object(X.a)().t,i=Object(v.a)();return u.a.createElement(I.a,{title:"".concat(r("verdict.malicious"),": ").concat(t.malicious.length," / ").concat(r("verdict.non_malicious"),": ").concat(t.non_malicious.length)},u.a.createElement("svg",{height:"15",width:n},u.a.createElement("rect",{height:"15",width:"100%",style:{fill:i.palette.background.default,stroke:i.palette.divider}}),u.a.createElement("rect",{y:"1",height:"13",fill:"#d9534f",x:"".concat(50-5*t.malicious.length,"%"),width:"".concat(5*t.malicious.length,"%")}),u.a.createElement("rect",{x:"50%",y:"1",height:"13",fill:"#5cb85c",width:"".concat(5*t.non_malicious.length,"%")}),u.a.createElement("rect",{x:"50%",y:"1",height:"13",width:"1%",fill:"lightgrey"})))})),cu=(a(516),function(e){var t=e.item,a=e.setItem,n=void 0===a?null:a,r=Object(X.a)("alerts").t,i=Object(v.a)(),s=i.spacing(1),c=i.spacing(2),o=i.spacing(4),m=Object(l.a)(i.breakpoints.down("sm")),d=dr(),p=$n().showSuccessMessage,g=Ma(),f=g.user,b=g.c12nDef;function E(e){-1===t.verdict[e].indexOf(f.username)?d({method:"PUT",url:"/api/v4/alert/verdict/".concat(t.alert_id,"/").concat(e,"/"),onSuccess:function(a){if(null!==n){var i=Object(h.a)({},t.verdict);"malicious"===e?(-1===i.malicious.indexOf(f.username)&&i.malicious.push(f.username),-1!==i.non_malicious.indexOf(f.username)&&i.non_malicious.splice(i.non_malicious.indexOf(f.username),1)):(-1===i.non_malicious.indexOf(f.username)&&i.non_malicious.push(f.username),-1!==i.malicious.indexOf(f.username)&&i.malicious.splice(i.malicious.indexOf(f.username),1)),n(Object(h.a)(Object(h.a)({},t),{},{verdict:i}))}p(r("verdict.success.".concat(e)))}}):p(r("verdict.success.".concat(e)))}return u.a.createElement(ua.a,{style:{marginTop:c,marginBottom:c,padding:c,backgroundColor:null!==t.owner?"#00f2000f":0!==t.al.attrib.length?"#f200000f":null}},b.enforce&&u.a.createElement(Zo.a,{mdUp:!0},u.a.createElement(ki,{c12n:t.classification,size:"tiny",type:"outlined"})),u.a.createElement(Br.a,{container:!0,spacing:2},u.a.createElement(Br.a,{item:!0,xs:12,md:2,lg:1,style:{display:m?"flex":null,flexDirection:"row",justifyContent:"space-between",textAlign:"center",paddingTop:m?o:0,paddingBottom:m?c:0}},u.a.createElement("div",{style:{paddingTop:m?0:s}},u.a.createElement(Cc,{score:t.al.score})),!m&&t.group_count&&u.a.createElement("div",{style:{paddingTop:c,color:i.palette.primary.main}},u.a.createElement("h2",null,"".concat(t.group_count,"x"))),!m&&t.extended_scan&&u.a.createElement("div",{style:{paddingTop:c}},u.a.createElement(lu,{state:t.extended_scan})),u.a.createElement("div",{style:{paddingTop:m?0:o,width:"100%",maxWidth:"120px",display:"inline-block"}},u.a.createElement(su,{verdicts:t.verdict}),u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:5,style:{textAlign:"left"}},u.a.createElement(Z.a,{size:"small",onClick:function(){return E("malicious")}},u.a.createElement(au.a,null))),u.a.createElement(Br.a,{item:!0,xs:2}),u.a.createElement(Br.a,{item:!0,xs:5,style:{textAlign:"right"}},u.a.createElement(Z.a,{size:"small",onClick:function(){return E("non_malicious")}},u.a.createElement(eu.a,null)))))),u.a.createElement(Br.a,{item:!0,xs:12,md:10,lg:11},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:3,md:2},u.a.createElement("b",null,t.type)),u.a.createElement(Br.a,{item:!0,xs:9,md:6},u.a.createElement(Dl.a,{format:"YYYY-MM-DD HH:mm:ss.SSS (zz)",tz:"utc"},t.ts)),b.enforce&&u.a.createElement(Zo.a,{smDown:!0},u.a.createElement(Br.a,{item:!0,md:4,style:{textAlign:"right"}},u.a.createElement(ki,{c12n:t.classification,size:"tiny",type:"outlined",inline:!0}))),t.filtered&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:"auto",md:2}),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("b",null,r("data_filtered_msg"))))),u.a.createElement(Zo.a,{mdUp:!0},u.a.createElement(Br.a,{container:!0,style:{paddingTop:c}},u.a.createElement(Br.a,{item:!0,xs:3},u.a.createElement("b",null,r("group_count"))),u.a.createElement(Br.a,{item:!0,xs:9},t.group_count),u.a.createElement(Br.a,{item:!0,xs:3},u.a.createElement("b",null,r("extended"))),u.a.createElement(Br.a,{item:!0,xs:9,style:{textTransform:"capitalize"}},t.extended_scan))),u.a.createElement(Br.a,{container:!0,style:{paddingTop:c}},u.a.createElement(Br.a,{item:!0,xs:3,md:2},u.a.createElement("b",null,r("label"))),u.a.createElement(Br.a,{item:!0,xs:9,md:10},t.label.map((function(e,t){return u.a.createElement(mi,{key:t,label:e,size:"tiny",type:"rounded"})}))),u.a.createElement(Br.a,{item:!0,xs:3,md:2},u.a.createElement("b",null,r("priority"))),u.a.createElement(Br.a,{item:!0,xs:9,md:10},u.a.createElement(mi,{label:t.priority,size:"tiny",type:"rounded"})),u.a.createElement(Br.a,{item:!0,xs:3,md:2},u.a.createElement("b",null,r("status"))),u.a.createElement(Br.a,{item:!0,xs:9,md:10},u.a.createElement(mi,{label:t.status,size:"tiny",type:"rounded"}))),u.a.createElement(Br.a,{container:!0,style:{paddingTop:c}},u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("b",null,r("file_info"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("span",{style:{color:i.palette.primary.main,fontWeight:500}},t.file.name)),u.a.createElement(Br.a,{item:!0,xs:"auto",md:2}),u.a.createElement(Br.a,{item:!0,xs:12,md:10},t.file.type),u.a.createElement(Br.a,{item:!0,xs:"auto",md:2}),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("b",null,t.file.size," "),u.a.createElement("span",{style:{fontWeight:300}},"(",jc(t.file.size),")")),u.a.createElement(Zo.a,{smDown:!0},u.a.createElement(Br.a,{item:!0,md:2},u.a.createElement("span",{style:{fontFamily:"monospace",fontWeight:600}},"MD5"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("span",{style:{fontFamily:"monospace",wordBreak:"break-word"}},t.file.md5)),u.a.createElement(Zo.a,{smDown:!0},u.a.createElement(Br.a,{item:!0,md:2},u.a.createElement("span",{style:{fontFamily:"monospace",fontWeight:600}},"SHA1"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("span",{style:{fontFamily:"monospace",wordBreak:"break-word"}},t.file.sha1)),u.a.createElement(Zo.a,{smDown:!0},u.a.createElement(Br.a,{item:!0,md:2},u.a.createElement("span",{style:{fontFamily:"monospace",fontWeight:600}},"SHA256"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("span",{style:{fontFamily:"monospace",wordBreak:"break-word"}},t.file.sha256))),(t.owner||t.hint_owner)&&u.a.createElement(Br.a,{container:!0,style:{paddingTop:c}},u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("b",null,r("ownership"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("b",null,t.owner||r("hint_owner")))),0!==Object.keys(t.metadata).length&&u.a.createElement("div",{style:{paddingTop:c}},Object.keys(t.metadata).map((function(e,a){return u.a.createElement(Br.a,{container:!0,key:a},u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("span",{style:{textTransform:"capitalize",fontWeight:600}},e.replace("."," ").replace("_"," "))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},t.metadata[e]))}))),u.a.createElement(Br.a,{container:!0,style:{paddingTop:c}},u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("b",null,r("category"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("span",{style:{color:i.palette.primary.light,fontWeight:500}},t.attack.category.join(" | "))),u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("b",null,r("patterns"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("span",{style:{color:i.palette.primary.light,fontWeight:500}},t.attack.pattern.join(" | "))),u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("b",null,r("heuristic"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("span",{style:{color:i.palette.primary.light,fontWeight:300}},t.heuristic.name.join(" | "))),u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("b",null,r("behaviors"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("span",{style:{color:i.palette.primary.light,fontWeight:300}},t.al.behavior.join(" | "))),u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("b",null,r("attributions"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("span",{style:{color:i.palette.error.dark,fontWeight:500}},t.al.attrib.join(" | "))),u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("b",null,r("avhits"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},u.a.createElement("span",{style:{color:i.palette.secondary.dark,fontWeight:500}},t.al.av.join(" | "))),u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("b",null,r("ip"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10,style:{color:i.palette.success.dark}},u.a.createElement("span",{style:{fontWeight:500}},t.al.ip_dynamic.join(" | ")),u.a.createElement("span",null,0!==t.al.ip_dynamic.length&&" | ",t.al.ip_static.join(" | "))),u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("b",null,r("domain"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10,style:{color:i.palette.success.dark}},u.a.createElement("span",{style:{fontWeight:500}},t.al.domain_dynamic.join(" | ")),u.a.createElement("span",null,0!==t.al.domain_dynamic.length&&" | ",t.al.domain_static.join(" | "))),u.a.createElement(Br.a,{item:!0,xs:12,md:2},u.a.createElement("b",null,r("yara"))),u.a.createElement(Br.a,{item:!0,xs:12,md:10},t.al.yara.join(" | "))),u.a.createElement("div",{style:{paddingTop:c}},u.a.createElement(ma.a,{component:Y.b,size:"small",variant:"outlined",style:{fontSize:"80%",marginBottom:"4px",marginRight:"4px"},to:"/submission/".concat(t.sid)},r("btn.submission")),u.a.createElement(ma.a,{component:Y.b,size:"small",variant:"outlined",style:{fontSize:"80%",marginBottom:"4px",marginRight:"4px"},to:"/search/?query=".concat(t.file.sha256)},r("btn.sha256")),u.a.createElement(ma.a,{disabled:null!==t.owner,size:"small",variant:"outlined",style:{fontSize:"80%",marginBottom:"4px",marginRight:"4px"},onClick:function(){d({url:"/api/v4/alert/ownership/".concat(t.alert_id,"/"),onSuccess:function(e){null!==n&&n(Object(h.a)(Object(h.a)({},t),{},{owner:f.username})),p(r("take_ownership.success"))}})}},r("btn.ownership")),u.a.createElement(ma.a,{size:"small",variant:"outlined",style:{fontSize:"80%",marginBottom:"4px",marginRight:"4px"},onClick:function(){return alert("NOT DONE YET")}},r("btn.workflow")))),u.a.createElement(Br.a,{item:!0,xs:12,style:{textAlign:"right"}},u.a.createElement(Kt.a,{variant:"caption",color:"secondary",style:{fontSize:"80%"}},"".concat(t.alert_id," :: "),u.a.createElement(Dl.a,{fromNow:!0},t.reporting_ts)))))});function ou(){var e=dr(),t=Object(o.useState)(null),a=Object(n.a)(t,2),r=a[0],i=a[1];return Object(o.useEffect)((function(){e({method:"GET",url:"/api/v4/alert/grouped/file.sha256/?offset=0&rows=25&q=&tc=4d",onSuccess:function(e){i(e.api_response.items)}})}),[]),u.a.createElement(ir,{margin:4,width:"100%"},u.a.createElement("h1",null,"Alert Legacy Test"),u.a.createElement("div",{style:{textAlign:"left"}},r&&r.map((function(e,t){return u.a.createElement("div",{key:t},u.a.createElement(cu,{item:e}))}))))}var uu=a(459),mu=["r","w","rw"];function du(){var e=Object(ue.h)(),t=Object(ue.g)(),a=Object(X.a)(["authorize"]).t,n=Object(v.a)(),r=Pa().getBanner,i=new URLSearchParams(e.search),l=i.get("redirect_url"),s=i.get("client_id"),c=i.get("scope"),o=i.get("server");return u.a.createElement(uu.a,{open:!0,style:{backgroundColor:n.palette.background.default,zIndex:1e4},transitionDuration:0},u.a.createElement(ur,null,r(n),u.a.createElement("div",{style:{display:"flex",flexDirection:"column",textAlign:"center",justifyContent:"center"}},l&&s&&c&&o&&-1!==mu.indexOf(c)?u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{marginBottom:"2rem"}},u.a.createElement(Kt.a,{component:"span",variant:"h6",color:"primary"},o," "),u.a.createElement(Kt.a,{component:"span",variant:"h6"},a("access"))),u.a.createElement(Kt.a,{variant:"subtitle2",gutterBottom:!0},a("scope")),u.a.createElement(Kt.a,{variant:"caption",color:"secondary",gutterBottom:!0,style:{marginTop:"1rem"}},a("scope.".concat(c))),u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0,style:{marginTop:"2rem",textAlign:"left"}},a("warning")),u.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"3rem"}},u.a.createElement(ma.a,{variant:"text",href:"".concat(l).concat(-1===l.indexOf("?")?"?":"&","error=cancelled")},a("button.cancel")),u.a.createElement(ma.a,{variant:"contained",color:"primary",href:"/api/v4/auth/obo_token/?XSRF_TOKEN=".concat(mr(),"&").concat(e.search.substring(1))},a("button.allow")))):u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{marginBottom:"3rem"}},a("invalid")),u.a.createElement(ma.a,{variant:"contained",color:"primary",onClick:function(){return t.goBack()}},a("button.back"))))))}var pu=a(430),gu=a.n(pu),fu=a(429),hu=a.n(fu),bu=a(428),vu=a.n(bu);function Eu(){if("undefined"!==typeof document.fullscreenElement)return"fullscreenElement";if("undefined"!==typeof document.mozFullScreenElement)return"mozFullScreenElement";if("undefined"!==typeof document.msFullscreenElement)return"msFullscreenElement";if("undefined"!==typeof document.webkitFullscreenElement)return"webkitFullscreenElement";throw new Error("fullscreenElement is not supported by this browser")}var yu=Object(i.a)((function(e){return{root:{backgroundColor:e.palette.background.default},toggle:{float:"right",paddingTop:e.spacing(2),position:"sticky",right:e.spacing(2),zIndex:e.zIndex.appBar+1}}})),Ou=function(e){var t,a,r,i=e.children,s=e.margin,c=void 0===s?null:s,o=e.mb,m=void 0===o?2:o,d=e.ml,p=void 0===d?2:d,g=e.mr,f=void 0===g?2:g,h=e.mt,b=void 0===h?2:h,E=u.a.useRef(null),y=se(),O=Pa(),_=O.currentLayout,x=O.autoHideAppbar,w="top"!==_&&x;try{var j=function(e){var t=u.a.useState(null!=document[Eu()]),a=Object(n.a)(t,2),r=a[0],i=a[1];return u.a.useLayoutEffect((function(){return document.onfullscreenchange=function(){return i(null!=document[Eu()])},function(){document.onfullscreenchange=void 0}})),[r,function(){null!=e.current&&e.current.requestFullscreen().then((function(){i(null!=document[Eu()])})).catch((function(){i(!1)}))}]}(E),k=Object(n.a)(j,2);t=k[0],a=k[1]}catch(A){r=!1,t=!1,a=void 0}var S=yu(),C=Object(v.a)(),T=Object(l.a)(C.breakpoints.up("md"))?1:2;return u.a.createElement("div",{ref:E,className:S.root},u.a.createElement("div",{className:S.toggle,style:{top:w||t?0:y}},r?null:t?u.a.createElement(Z.a,{onClick:function(){document.exitFullscreen()}},u.a.createElement(vu.a,null)):u.a.createElement(Z.a,{onClick:function(){a()}},u.a.createElement(hu.a,null))),u.a.createElement("div",{style:{marginBottom:C.spacing(c/T||m/T),marginLeft:C.spacing(c/T||p/T),marginRight:C.spacing(c/T||f/T),marginTop:C.spacing(c/T||b/T)}},i))},_u=a(818),xu=a(823),wu=Object(i.a)((function(e){return{caption:{color:e.palette.text.secondary,fontSize:"x-small",fontWeight:500,textAlign:"center",width:"100%"},graph:{gridColumn:"1 / 1",gridRow:"1 / 1"},outer:{display:"grid",gridTemplate:"1fr / 1fr",placeItems:"end"},text:{color:e.palette.text.secondary,fontWeight:900,gridColumn:"1 / 1",gridRow:"1 / 1",textAlign:"center",width:"100%"},title:{color:e.palette.text.secondary,fontWeight:500,textAlign:"center",width:"100%"}}})),ju=function(e){var t=e.pctValue,a=e.caption,n=void 0===a?"":a,r=e.colorBack,i=void 0===r?"#68686815":r,l=e.fontSize,s=void 0===l?"22px":l,c=e.initialized,o=void 0!==c&&c,m=e.title,d=void 0===m?"":m,p=e.width,g=void 0===p?"100px":p,f=wu(),h=Object(v.a)(),b="dark"===h.palette.type?h.palette.primary.light:h.palette.primary.dark,E=Object(xu.a)().innerRadius(.7).outerRadius(.95).startAngle(-Math.PI/2).endAngle(Math.PI/2).cornerRadius(0)(),y=Object(_u.a)().domain([0,100]).range([0,1]),O=Object(_u.a)().domain([0,1]).range([-Math.PI/2,Math.PI/2]).clamp(!0),_=Object(xu.a)().innerRadius(.7).outerRadius(.95).startAngle(-Math.PI/2).endAngle(O(y(t))).cornerRadius(0)();return u.a.createElement("div",null,d&&u.a.createElement("div",{className:f.title},d),u.a.createElement("div",{className:f.outer,style:{fontSize:s,lineHeight:s,width:g}},o?u.a.createElement("span",{className:f.text},"".concat(Number(t).toFixed(0),"%")):u.a.createElement("span",{className:f.text},u.a.createElement(pr.a,{variant:"rect",width:"2rem",style:{borderRadius:"4px",display:"inline-block"}})),u.a.createElement("svg",{className:f.graph,viewBox:[-1,-1,2,1].join(" ")},u.a.createElement("g",null,u.a.createElement("path",{d:E,fill:i}),u.a.createElement("path",{d:_,fill:b})))),n&&u.a.createElement("div",{className:f.caption},n))},ku=a(207),Su=a.n(ku),Cu=Object(i.a)((function(e){return{card:{flexGrow:1,padding:e.spacing(1),minHeight:"120px","&:hover":{boxShadow:e.shadows[6]}},core_card:{flexGrow:1,padding:e.spacing(1),minHeight:"170px","&:hover":{boxShadow:e.shadows[6]}},error:{backgroundColor:"dark"===e.palette.type?"#ff000017":"#FFE4E4",border:"solid 1px ".concat("dark"===e.palette.type?e.palette.error.light:e.palette.error.dark)},error_icon:{color:"dark"===e.palette.type?e.palette.error.light:e.palette.error.dark,float:"right"},icon:{marginRight:"4px",verticalAlign:"middle",height:"20px",color:e.palette.action.active},metric:{display:"inline-block",marginRight:e.spacing(1)},muted:{color:e.palette.text.secondary},ok:{border:"solid 1px ".concat(e.palette.divider)},title:{fontWeight:500,fontSize:"120%"}}})),Tu=u.a.memo((function(e){var t=e.value,a=e.title,n=e.tooltip,r=e.init,i=void 0!==r&&r,l=e.margin,s=void 0===l?"8px":l,c=Cu();return i?u.a.createElement(I.a,{title:n},u.a.createElement("span",{className:c.metric},u.a.createElement(mi,{size:"tiny",type:"rounded",mono:!0,label:a}),t)):u.a.createElement(pr.a,{variant:"rect",height:"1.5rem",width:"2rem",style:{borderRadius:"4px",marginRight:s,display:"inline-block",verticalAlign:"middle"}})})),Au=u.a.memo((function(e){var t=e.ingester,a=Object(X.a)(["dashboard"]).t,r=Object(o.useState)(null),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(o.useState)(null),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Cu(),f=t.metrics.busy_seconds*t.metrics.busy_seconds_count/t.instances/60;return Object(o.useEffect)((function(){1!==t.processing_chance.critical?p(a("ingest.error.chance.critical")):1!==t.processing_chance.high?p(a("ingest.error.chance.high")):1!==t.processing_chance.medium?p(a("ingest.error.chance.medium")):1!==t.processing_chance.low?p(a("ingest.error.chance.low")):0===t.metrics.bytes_completed&&0!==t.metrics.bytes_ingested?p(a("ingest.error.bytes")):t.ingest>1e5?p(a("ingest.error.queue")):f>=.8?p(a("ingest.error.busy")):(null!==l&&t.initialized||null===l&&!t.initialized)&&(null!==d&&p(null),null!==l&&clearTimeout(l),s(setTimeout((function(){p(a("timeout"))}),1e4)))}),[t]),u.a.createElement(cr.a,{className:"".concat(g.core_card," ").concat(d||t.error?g.error:g.ok)},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12},(d||t.error)&&u.a.createElement(I.a,{title:d||t.error},u.a.createElement("div",{className:g.error_icon},u.a.createElement(ln.a,null))),u.a.createElement("div",{className:g.title},"".concat(a("ingester")," :: x").concat(t.instances))),u.a.createElement(Br.a,{item:!0,xs:12,sm:3},u.a.createElement("div",null,u.a.createElement("label",null,a("ingest"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.queues.ingest,title:"Q",tooltip:a("ingest.queue")}))),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement("div",null,u.a.createElement("label",null,a("queued"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.queues.critical,title:"C",tooltip:a("ingest.critical")}),u.a.createElement(Tu,{init:t.initialized,value:t.queues.high,title:"H",tooltip:a("ingest.high")}),u.a.createElement(Tu,{init:t.initialized,value:t.queues.medium,title:"M",tooltip:a("ingest.medium")}),u.a.createElement(Tu,{init:t.initialized,value:t.queues.low,title:"L",tooltip:a("ingest.low")}))),u.a.createElement(Br.a,{item:!0,xs:12,sm:3},u.a.createElement("div",null,u.a.createElement("label",null,a("processing"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.processing.inflight,title:"I",tooltip:a("processing.inflight")}),u.a.createElement(Tu,{init:t.initialized,value:"".concat(Number(100*f).toFixed(2)," %"),title:"B",tooltip:a("throughput.busy")}))),u.a.createElement(Br.a,{item:!0,xs:12,sm:3},u.a.createElement("div",null,u.a.createElement("label",null,a("caching"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.metrics.cache_hit,title:"H",tooltip:a("caching.hits")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.cache_miss,title:"M",tooltip:a("caching.miss")}))),u.a.createElement(Br.a,{item:!0,xs:12,sm:9},u.a.createElement("div",null,u.a.createElement("label",null,a("throughput"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.metrics.files_completed,title:"F",tooltip:a("throughput.files_completed")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.submissions_completed,title:"C",tooltip:a("throughput.submissions_completed")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.whitelisted,title:"W",tooltip:a("throughput.whitelisted")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.skipped,title:"S",tooltip:a("throughput.skipped")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.duplicates,title:"D",tooltip:a("throughput.duplicates")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.error,title:"E",tooltip:a("throughput.error"),margin:"16px"}),u.a.createElement(I.a,{title:a("throughput.bytes")},u.a.createElement("span",{style:{display:"inline-block"}},u.a.createElement(gu.a,{className:g.icon}),t.initialized?"".concat(Number((1*t.metrics.bytes_completed/7864320).toFixed(2))," / ").concat(Number((1*t.metrics.bytes_ingested/7864320).toFixed(2))," Mbps"):u.a.createElement(pr.a,{height:"1.5rem",width:"3rem",style:{display:"inline-block"}})))))))})),Nu=u.a.memo((function(e){var t=e.dispatcher,a=e.up,r=e.down,i=Object(X.a)(["dashboard"]).t,l=Object(o.useState)(null),s=Object(n.a)(l,2),c=s[0],m=s[1],d=Object(o.useState)(null),p=Object(n.a)(d,2),g=p[0],f=p[1],h=Cu(),b=t.metrics.cpu_seconds*t.metrics.cpu_seconds_count/t.instances/60,v=t.queues.start.reduce((function(e,t){return e+t}),0),E=t.queues.result.reduce((function(e,t){return e+t}),0),y=t.queues.command.reduce((function(e,t){return e+t}),0);return Object(o.useEffect)((function(){t.initialized&&t.queues.ingest>=t.inflight.max/10?f(i("dispatcher.error.queue.ingest")):t.initialized&&t.queues.files>=t.inflight.max/10?f(i("dispatcher.error.queue.files")):t.initialized&&v>=t.inflight.max/10?f(i("dispatcher.error.queue.start")):t.initialized&&E>=t.inflight.max/10?f(i("dispatcher.error.queue.result")):t.initialized&&y>=t.inflight.max/10?f(i("dispatcher.error.queue.command")):t.initialized&&b>=.8?f(i("dispatcher.error.busy")):t.inflight.outstanding/t.inflight.max>.9?f(i("dispatcher.error.inflight")):(null!==c&&t.initialized||null===c&&!t.initialized)&&(null!==g&&f(null),null!==c&&clearTimeout(c),m(setTimeout((function(){f(i("timeout"))}),1e4)))}),[t]),u.a.createElement(cr.a,{className:"".concat(h.core_card," ").concat(g||t.error?h.error:h.ok)},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12},(g||t.error)&&u.a.createElement(I.a,{title:g||t.error},u.a.createElement("div",{className:h.error_icon},u.a.createElement(ln.a,null))),u.a.createElement("div",{className:h.title},"".concat(i("dispatcher")," :: x").concat(t.instances))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",null,u.a.createElement("label",null,i("services"))),t.initialized?u.a.createElement("div",null,0===a.length&&0===r.length&&u.a.createElement("span",{className:h.muted},i("no_services")),0!==a.length&&u.a.createElement("span",null,a.join(" | ")),0!==a.length&&0!==r.length&&u.a.createElement("span",null," :: "),0!==r.length&&u.a.createElement("span",null,r.join(" | "))):u.a.createElement("div",null,u.a.createElement(pr.a,null))),u.a.createElement(Br.a,{item:!0,xs:12,sm:4,md:2},u.a.createElement("div",null,u.a.createElement("label",null,i("submissions"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:u.a.createElement("span",null,t.inflight.outstanding," / ",t.inflight.max),title:"O",tooltip:i("submissions.outstanding")}))),u.a.createElement(Br.a,{item:!0,xs:12,sm:4,md:2},u.a.createElement("div",null,u.a.createElement("label",null,i("queues"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.queues.ingest,title:"I",tooltip:i("queues.ingest")}),0===t.queues.start.length&&0===t.queues.result.length&&0===t.queues.command.length&&u.a.createElement(Tu,{init:t.initialized,value:t.queues.files,title:"F",tooltip:i("queues.file")}),t.queues.start.length>0&&u.a.createElement(Tu,{init:t.initialized,value:v,title:"S",tooltip:i("queues.start")}),t.queues.result.length>0&&u.a.createElement(Tu,{init:t.initialized,value:E,title:"R",tooltip:i("queues.result")}),t.queues.command.length>0&&u.a.createElement(Tu,{init:t.initialized,value:y,title:"C",tooltip:i("queues.command")}))),u.a.createElement(Br.a,{item:!0,xs:12,sm:4,md:3},u.a.createElement("div",null,u.a.createElement("label",null,i("busyness"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:"".concat(Number(100*b).toFixed(2)," %"),title:"B",tooltip:i("throughput.busy")}))),u.a.createElement(Br.a,{item:!0,xs:12,md:4},u.a.createElement("div",null,u.a.createElement("label",null,i("throughput"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.metrics.files_completed,title:"F",tooltip:i("throughput.files_completed")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.submissions_completed,title:"S",tooltip:i("throughput.submissions_completed")})))))})),Iu=u.a.memo((function(e){var t=e.expiry,a=Object(X.a)(["dashboard"]).t,r=Object(o.useState)(null),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(o.useState)(null),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Cu();return Object(o.useEffect)((function(){(null!==l&&t.initialized||null===l&&!t.initialized)&&(null!==d&&p(null),null!==l&&clearTimeout(l),s(setTimeout((function(){p(a("timeout"))}),1e4)))}),[t]),u.a.createElement(cr.a,{className:"".concat(g.core_card," ").concat(d||t.error?g.error:g.ok)},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12},(d||t.error)&&u.a.createElement(I.a,{title:d||t.error},u.a.createElement("div",{className:g.error_icon},u.a.createElement(ln.a,null))),u.a.createElement("div",{className:g.title},"".concat(a("expiry")," :: x").concat(t.instances))),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement("div",null,u.a.createElement("label",null,a("queues"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.queues.alert,title:"A",tooltip:a("queues.alert")}),u.a.createElement(Tu,{init:t.initialized,value:t.queues.error,title:"E",tooltip:a("queues.error")}),u.a.createElement(Tu,{init:t.initialized,value:t.queues.cached_file+t.queues.file+t.queues.filescore,title:"F",tooltip:a("queues.file")}),u.a.createElement(Tu,{init:t.initialized,value:t.queues.result+t.queues.emptyresult,title:"R",tooltip:a("queues.result")}),u.a.createElement(Tu,{init:t.initialized,value:t.queues.submission+t.queues.submission_summary+t.queues.submission_tree,title:"S",tooltip:a("queues.submission")}))),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement("div",null,u.a.createElement("label",null,a("expired"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.metrics.alert,title:"A",tooltip:a("expired.alert")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.error,title:"E",tooltip:a("expired.error")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.cached_file+t.metrics.file+t.metrics.filescore,title:"F",tooltip:a("expired.file")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.result+t.metrics.emptyresult,title:"R",tooltip:a("expired.result")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.submission+t.metrics.submission_summary+t.metrics.submission_tree,title:"S",tooltip:a("expired.submission")}))),u.a.createElement(Br.a,{item:!0,xs:12,sm:6}),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement("div",null,u.a.createElement("label",null,a("archived"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.archive.alert,title:"A",tooltip:a("archived.alert")}),u.a.createElement(Tu,{init:t.initialized,value:t.archive.error,title:"E",tooltip:a("archived.error")}),u.a.createElement(Tu,{init:t.initialized,value:t.archive.cached_file+t.archive.file+t.archive.filescore,title:"F",tooltip:a("archived.file")}),u.a.createElement(Tu,{init:t.initialized,value:t.archive.result+t.archive.emptyresult,title:"R",tooltip:a("archived.result")}),u.a.createElement(Tu,{init:t.initialized,value:t.archive.submission+t.archive.submission_summary+t.archive.submission_tree,title:"S",tooltip:a("archived.submission")})))))})),Ru=u.a.memo((function(e){var t=e.alerter,a=Object(X.a)(["dashboard"]).t,r=Object(o.useState)(null),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(o.useState)(null),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Cu();return Object(o.useEffect)((function(){t.metrics.error>0?p(a("alerter.error")):(null!==l&&t.initialized||null===l&&!t.initialized)&&(null!==d&&p(null),null!==l&&clearTimeout(l),s(setTimeout((function(){p(a("timeout"))}),1e4)))}),[t]),u.a.createElement(cr.a,{className:"".concat(g.core_card," ").concat(d||t.error?g.error:g.ok)},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12},(d||t.error)&&u.a.createElement(I.a,{title:d||t.error},u.a.createElement("div",{className:g.error_icon},u.a.createElement(ln.a,null))),u.a.createElement("div",{className:g.title},"".concat(a("alerter")," :: x").concat(t.instances))),u.a.createElement(Br.a,{item:!0,xs:12,sm:4},u.a.createElement("div",null,u.a.createElement("label",null,a("queues"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.queues.alert,title:"A",tooltip:a("queues.alert")}))),u.a.createElement(Br.a,{item:!0,xs:12,sm:8},u.a.createElement("div",null,u.a.createElement("label",null,a("throughput"))),u.a.createElement("div",null,u.a.createElement(Tu,{init:t.initialized,value:t.metrics.created,title:"C",tooltip:a("throughput.created")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.error,title:"E",tooltip:a("throughput.error")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.received,title:"R",tooltip:a("throughput.received")}),u.a.createElement(Tu,{init:t.initialized,value:t.metrics.updated,title:"U",tooltip:a("throughput.updated")})))))})),zu=u.a.memo((function(e){var t=e.scaler,a=Object(X.a)(["dashboard"]).t,r=Object(o.useState)(null),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(o.useState)(null),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Cu();return Object(o.useEffect)((function(){(null!==l&&t.initialized||null===l&&!t.initialized)&&(null!==d&&p(null),null!==l&&clearTimeout(l),s(setTimeout((function(){p(a("timeout"))}),1e4)))}),[t]),u.a.createElement(cr.a,{className:"".concat(g.core_card," ").concat(d||t.error?g.error:g.ok)},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12},(d||t.error)&&u.a.createElement(I.a,{title:d||t.error},u.a.createElement("div",{className:g.error_icon},u.a.createElement(ln.a,null))),u.a.createElement("div",{className:g.title},a("resources"))),u.a.createElement(Br.a,{item:!0,xs:6,style:{textAlign:"center"}},u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement(ju,{initialized:!!t&&t.initialized,pctValue:0===t.metrics.cpu_total?0:(t.metrics.cpu_total-t.metrics.cpu_free)/t.metrics.cpu_total*100,title:a("cpu"),caption:"".concat(Number((t.metrics.cpu_total-t.metrics.cpu_free).toFixed(1))," / ").concat(Number(t.metrics.cpu_total.toFixed(1))," ").concat(a("cores")),width:"120px"}))),u.a.createElement(Br.a,{item:!0,xs:6,style:{textAlign:"center"}},u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement(ju,{initialized:!!t&&t.initialized,pctValue:0===t.metrics.memory_total?0:(t.metrics.memory_total-t.metrics.memory_free)/t.metrics.memory_total*100,title:a("ram"),caption:"".concat(Number(((t.metrics.memory_total-t.metrics.memory_free)/1024).toFixed(1))," / ").concat(Number((t.metrics.memory_total/1024).toFixed(1))," ").concat(a("gb")),width:"120px"})))))})),Du=u.a.memo((function(e){var t=e.service,a=e.max_inflight,r=Object(X.a)(["dashboard"]).t,i=Object(o.useState)(null),l=Object(n.a)(i,2),s=l[0],c=l[1],m=Cu();return Object(o.useEffect)((function(){0!==t.total&&0===t.instances?c(r("service.error.none")):t.metrics.fail_nonrecoverable>0?c(r("service.error.fail_nonrecoverable")):t.queue>a/4?c(r("service.error.queue")):null!==s&&c(null)}),[t]),u.a.createElement(cr.a,{className:"".concat(m.card," ").concat(s||t.error?m.error:m.ok)},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12},(s||t.error)&&u.a.createElement(I.a,{title:s||t.error},u.a.createElement("div",{className:m.error_icon},u.a.createElement(ln.a,null))),u.a.createElement("div",{className:m.title},"".concat(t.service_name," :: ").concat(t.instances," / ").concat(t.scaler.target||"-"))),u.a.createElement(Br.a,{item:!0,xs:6},u.a.createElement(Tu,{init:!0,value:t.queue,title:"Q",tooltip:r("service.queue")})),u.a.createElement(Br.a,{item:!0,xs:6},u.a.createElement(Tu,{init:!0,value:t.activity.busy,title:"B",tooltip:r("service.busy")})),u.a.createElement(Br.a,{item:!0,xs:6},u.a.createElement(Tu,{init:!0,value:t.metrics.execute,title:"P",tooltip:r("service.processed")})),u.a.createElement(Br.a,{item:!0,xs:6},u.a.createElement(Tu,{init:!0,value:t.metrics.fail_nonrecoverable,title:"F",tooltip:r("service.failed")}),u.a.createElement(Tu,{init:!0,value:t.metrics.fail_recoverable,title:"R",tooltip:r("service.retried")}))))})),Bu=function(e,t){return Object(h.a)(Object(h.a)({},e),t)},qu=function(e,t){var a=t.type,n=t.hb,r=e[n.service_name]||{};if("scaler"===a){var i={};return i[n.service_name]=Object(h.a)(Object(h.a)(Object(h.a)({},Hu),r),{},{service_name:n.service_name,scaler:n.metrics}),Object(h.a)(Object(h.a)({},e),i)}var l={};return l[n.service_name]=Object(h.a)(Object(h.a)(Object(h.a)({},Hu),r),n),Object(h.a)(Object(h.a)({},e),l)},Lu=function(e,t){var a=e.up,n=e.down,r=e.timing,i=Math.floor((new Date).getTime()/1e3);return r[t]=i,-1===a.indexOf(t)&&a.push(t),-1!==n.indexOf(t)&&n.pop(t),{up:a,down:n,timing:r}},Fu={instances:0,queues:{alert:0},metrics:{created:0,error:0,received:0,updated:0},error:null,initialized:!1},Pu={instances:0,inflight:{outstanding:0,max:0,per_instance:[]},queues:{ingest:0,files:0,start:[],result:[],command:[]},metrics:{busy_seconds:0,busy_seconds_count:0,cpu_seconds:0,cpu_seconds_count:0,files_completed:0,submissions_completed:0},error:null,initialized:!1},Mu={instances:0,queues:{alert:0,cached_file:0,emptyresult:0,error:0,file:0,filescore:0,result:0,submission:0,submission_tree:0,submission_summary:0},metrics:{alert:0,cached_file:0,emptyresult:0,error:0,file:0,filescore:0,result:0,submission:0,submission_tree:0,submission_summary:0},archive:{alert:0,cached_file:0,emptyresult:0,error:0,file:0,filescore:0,result:0,submission:0,submission_tree:0,submission_summary:0},error:null,initialized:!1},Wu={instances:0,metrics:{busy_seconds:0,busy_seconds_count:0,cache_miss:0,cache_expired:0,cache_stale:0,cache_hit_local:0,cache_hit:0,bytes_completed:0,bytes_ingested:0,duplicates:0,error:0,files_completed:0,skipped:0,submissions_completed:0,submissions_ingested:0,timed_out:0,whitelisted:0},processing:{inflight:0},processing_chance:{critical:1,high:1,medium:1,low:1},queues:{ingest:0,critical:0,high:0,medium:0,low:0},error:null,initialized:!1},Uu={instances:0,metrics:{memory_total:0,memory_free:0,cpu_total:0,cpu_free:0},error:null,initialized:!1},Hu={duty_cycle:0,instances:0,last_hb:0,metrics:{cache_hit:0,cache_miss:0,cache_skipped:0,execute:0,fail_recoverable:0,fail_nonrecoverable:0,scored:0,not_scored:0},scaler:{running:0,target:0,minimum:0,maximum:0,dynamic_maximum:0,queue:0,pressure:0,duty_cycle:0},queue:0,activity:{busy:0,idle:0},service_name:null,error:null},Vu={up:[],down:[],timing:{}},Gu=function(){var e=Object(X.a)(["dashboard"]).t,t=Object(o.useReducer)(Bu,Fu),a=Object(n.a)(t,2),r=a[0],i=a[1],l=Object(o.useReducer)(Bu,Pu),s=Object(n.a)(l,2),c=s[0],m=s[1],d=Object(o.useReducer)(Bu,Mu),p=Object(n.a)(d,2),g=p[0],f=p[1],b=Object(o.useReducer)(Bu,Wu),v=Object(n.a)(b,2),E=v[0],y=v[1],O=Object(o.useReducer)(Bu,Uu),_=Object(n.a)(O,2),x=_[0],w=_[1],j=Object(o.useReducer)(qu,{}),k=Object(n.a)(j,2),S=k[0],C=k[1],T=Object(o.useReducer)(Lu,Vu),A=Object(n.a)(T,2),N=A[0],I=A[1],R=function(e){console.debug("Socket-IO :: AlerterHeartbeat",e),i(Object(h.a)(Object(h.a)({},e),{},{initialized:!0}))},z=function(e){console.debug("Socket-IO :: ArchiveHeartbeat",e),f({archive:e.metrics,initialized:!0})},D=function(e){console.debug("Socket-IO :: DispatcherHeartbeat",e),m(Object(h.a)(Object(h.a)({},e),{},{initialized:!0}))},B=function(e){console.debug("Socket-IO :: ExpiryHeartbeat",e),f(Object(h.a)(Object(h.a)({},e),{},{initialized:!0}))},q=function(e){console.debug("Socket-IO :: IngestHeartbeat",e),y(Object(h.a)(Object(h.a)({},e),{},{initialized:!0}))},L=function(e){console.debug("Socket-IO :: ScalerHeartbeat",e),w(Object(h.a)(Object(h.a)({},e),{},{initialized:!0}))},F=function(e){console.debug("Socket-IO :: ServiceHeartbeat ".concat(e.service_name),e),I(e.service_name),C({type:"service",hb:Object(h.a)(Object(h.a)({},e),{},{last_hb:Math.floor((new Date).getTime()/1e3)})})},P=function(e){console.debug("Socket-IO :: ScalerStatusHeartbeat ".concat(e.service_name),e),C({type:"scaler",hb:e})};return Object(o.useEffect)((function(){var e=Su()("/status");return e.on("connect",(function(){e.emit("monitor",{status:"start"}),console.debug("Socket-IO :: Connecting to socketIO server...")})),e.on("disconnect",(function(){console.debug("Socket-IO :: Disconnected from socketIO server.")})),e.on("monitoring",(function(e){return console.debug("Socket-IO :: Connected to socket server",e)})),e.on("AlerterHeartbeat",R),e.on("ArchiveHeartbeat",z),e.on("DispatcherHeartbeat",D),e.on("ExpiryHeartbeat",B),e.on("IngestHeartbeat",q),e.on("ScalerHeartbeat",L),e.on("ScalerStatusHeartbeat",P),e.on("ServiceHeartbeat",F),function(){e.disconnect()}}),[]),u.a.createElement(Ou,{margin:4},u.a.createElement(Kt.a,{gutterBottom:!0,color:"primary",variant:"h2",align:"center"},e("title")),u.a.createElement(Br.a,{container:!0,spacing:2},u.a.createElement(Br.a,{item:!0,xs:12,xl:6},u.a.createElement(Au,{ingester:E})),u.a.createElement(Br.a,{item:!0,xs:12,xl:6},u.a.createElement(Nu,{dispatcher:c,up:N.up,down:N.down})),u.a.createElement(Br.a,{item:!0,xs:12,xl:5},u.a.createElement(Iu,{expiry:g})),u.a.createElement(Br.a,{item:!0,xs:12,md:8,xl:4},u.a.createElement(Ru,{alerter:r})),u.a.createElement(Br.a,{item:!0,xs:12,md:4,xl:3},u.a.createElement(zu,{scaler:x})),Object.keys(S).map((function(e){return u.a.createElement(Br.a,{key:e,item:!0,xs:12,md:4,xl:3},u.a.createElement(Du,{service:S[e],max_inflight:c.inflight.max}))}))))},Yu=a(126),Ju=a.n(Yu),Qu=a(431),Ku=a.n(Qu),Xu=a(793),Zu=u.a.createContext(null);var $u=function(e){var t=e.children,a=Object(o.useState)(new Set),r=Object(n.a)(a,2),i=r[0],l=r[1],s=Object(o.useState)(new Set),c=Object(n.a)(s,2),m=c[0],d=c[1],p=Object(o.useState)({}),g=Object(n.a)(p,2),f=g[0],h=g[1],b=Object(o.useCallback)((function(e,t){return"".concat(e,"__").concat(t)}),[]),v=Object(o.useCallback)((function(e){return f?i.has(e)||m.has(e):i.has(e)}),[i,m,f]),E=Object(o.useCallback)((function(e){return e.some((function(e){return v(e)}))}),[v]),y=Object(o.useCallback)((function(e){window.dispatchEvent(new CustomEvent("tiggerHighlight",{detail:e}))}),[]);return Object(o.useEffect)((function(){function e(e){var t=e.detail,a=new Set(i);if(a.has(t)?a.delete(t):a.add(t),f){var n=new Set;a.forEach((function(e){var t=f[e];if(t){var a,r=Object(di.a)(t);try{for(r.s();!(a=r.n()).done;){var i=a.value;n.add(i)}}catch(l){r.e(l)}finally{r.f()}}})),d(n)}l(a)}return window.addEventListener("tiggerHighlight",e),function(){window.removeEventListener("tiggerHighlight",e)}}),[f,i]),u.a.createElement(Zu.Provider,{value:{getKey:b,triggerHighlight:y,isHighlighted:v,hasHighlightedKeys:E,setHighlightMap:h}},t)};function em(){return Object(o.useContext)(Zu)}var tm=Object(i.a)((function(e){return{muted:{color:e.palette.text.secondary}}})),am=u.a.memo((function(e){var t=e.file,a=e.download,n=void 0!==a&&a,r=e.sid,i=void 0===r?null:r,l=Object(X.a)(["fileDetail"]).t,s=tm();return u.a.createElement("div",null,n?u.a.createElement($t.a,{href:"/api/v4/file/download/".concat(t.sha256,"/?name=").concat(encodeURI(t.name))},t.name):u.a.createElement($t.a,{component:Y.b,to:i?"/submission/detail/".concat(i,"/").concat(t.sha256,"?name=").concat(encodeURI(t.name)):"/file/detail/".concat(t.sha256,"?name=").concat(encodeURI(t.name))},t.name),u.a.createElement("small",{className:s.muted}," :: ".concat(t.description)),u.a.createElement(I.a,{title:l("view_file")},u.a.createElement($t.a,{component:Y.b,to:"/file/viewer/".concat(t.sha256)},u.a.createElement(Jn.a,{style:{fontSize:"1.4em",marginLeft:"0.5rem",verticalAlign:"bottom"}}))))})),nm=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),rm=u.a.memo((function(e){var t=e.extracted,a=e.sid,r=Object(X.a)(["fileDetail"]).t,i=u.a.useState(!0),l=Object(n.a)(i,2),s=l[0],c=l[1],m=nm();return u.a.createElement("div",null,u.a.createElement(R.a,{className:m.title,onClick:function(){c(!s)}},u.a.createElement("h3",null,r("extracted"))),u.a.createElement(P.a,{in:s,timeout:"auto"},Object(o.useMemo)((function(){return t.map((function(e,t){return u.a.createElement(am,{key:t,file:e,sid:a})}))}),[t,a])))})),im=a(814),lm=a(815),sm=a(125),cm=a.n(sm),om={height:"auto",minHeight:"20px"},um=u.a.createElement(cm.a,{style:{marginLeft:"2px",height:"18px",width:"18px"}}),mm=function(e){var t=e.text,a=e.lvl,n=void 0===a?null:a,r=e.score,i=void 0===r?null:r,l=e.show_type,s=void 0!==l&&l,c=e.highlight_key,m=void 0===c?null:c,d=e.fullWidth,p=void 0!==d&&d,g=Object(ue.g)(),f=em(),h=f.isHighlighted,b=f.triggerHighlight,v=Object(o.useCallback)((function(){return b(m)}),[b,m]),E=Object(o.useCallback)((function(){return g.push('/search/result?query=result.sections.heuristic.attack.pattern:"'.concat(t,'"'))}),[t]),y="default";return n?y={info:"default",suspicious:"warning",malicious:"error"}[n]:i&&(y={suspicious:"warning",malicious:"error",safe:"success",info:"default",highly_suspicious:"warning"}[kc(i)]),u.a.createElement(mi,{wrap:!0,size:"tiny",type:"rounded",color:m&&h(m)?"primary":y,label:s?"[ATT&CK] ".concat(t):t,onDelete:E,deleteIcon:um,style:om,onClick:m?v:null,fullWidth:p})},dm={height:"auto",minHeight:"20px"},pm=u.a.createElement(cm.a,{style:{marginLeft:"2px",height:"18px",width:"18px"}}),gm=function(e){var t=e.text,a=e.lvl,n=void 0===a?null:a,r=e.score,i=void 0===r?null:r,l=e.signature,s=void 0!==l&&l,c=e.show_type,m=void 0!==c&&c,d=e.highlight_key,p=void 0===d?null:d,g=e.fullWidth,f=void 0!==g&&g,h=Object(ue.g)(),b=em(),v=b.isHighlighted,E=b.triggerHighlight,y=Object(o.useCallback)((function(){return E(p)}),[E,p]),O=Object(o.useCallback)((function(){return h.push("/search/result?query=result.sections.heuristic".concat(s?".signature":"",'.name:"').concat(t,'"'))}),[s,t]),_="default";return n?_={info:"default",suspicious:"warning",malicious:"error"}[n]:i&&(_={suspicious:"warning",malicious:"error",safe:"success",info:"default",highly_suspicious:"warning"}[kc(i)]),u.a.createElement(mi,{wrap:!0,size:"tiny",type:"rounded",color:p&&v(p)?"primary":_,label:m?s?"[SIGNATURE] ".concat(t):"[HEURISTIC] ".concat(t):t,onDelete:O,deleteIcon:pm,style:dm,onClick:p?y:null,fullWidth:f})},fm=function(e){var t=e.score,a=e.indent,n=e.depth,r=void 0===n?1:n,i=e.highlighted,l=void 0!==i&&i,s=Object(v.a)(),c={info:"dark"===s.palette.type?"#393939":"#f0f0f0",safe:"dark"===s.palette.type?"#2a492b":"#9ae99d",suspicious:"dark"===s.palette.type?"#654312":"#ffd395",highly_suspicious:"dark"===s.palette.type?"#654312":"#ffd395",malicious:"dark"===s.palette.type?"#6e2b2b":"#ffa1a1"};return u.a.createElement("div",{style:{backgroundColor:l?"dark"===s.palette.type?"#343a44":"#d8e3ea":c[kc(t)],minWidth:"0.5rem",marginLeft:"".concat(-1*a+-.5*(a-r),"rem"),marginRight:"".concat(1*a+.5*(a-r),"rem")}})},hm={height:"auto",minHeight:"20px"},bm=u.a.createElement(cm.a,{style:{marginLeft:"2px",height:"18px",width:"18px"}}),vm=function(e){var t=e.type,a=e.value,n=e.lvl,r=void 0===n?null:n,i=e.score,l=void 0===i?null:i,s=e.short_type,c=void 0===s?null:s,m=e.highlight_key,d=void 0===m?null:m,p=e.fullWidth,g=void 0!==p&&p,f=Object(ue.g)(),h=em(),b=h.isHighlighted,v=h.triggerHighlight,E=Object(o.useCallback)((function(){return v(d)}),[v,d]),y=Object(o.useCallback)((function(){return f.push("/search/result?query=result.sections.tags.".concat(t,':"').concat(a,'"'))}),[t,a]),O="default";return r?O={info:"default",suspicious:"warning",malicious:"error"}[r]:l&&(O={suspicious:"warning",malicious:"error",safe:"success",info:"default",highly_suspicious:"warning"}[kc(l)]),u.a.createElement(mi,{wrap:!0,size:"tiny",type:"rounded",color:d&&b(d)?"primary":O,label:c?"[".concat(c.toUpperCase(),"] ").concat(a):a,onDelete:y,deleteIcon:bm,style:hm,onClick:d?E:null,fullWidth:g})},Em=function(e){var t=e.title;return u.a.createElement("span",{style:{fontWeight:500,textTransform:"capitalize"}},t.replace(/[-_.]/g," "))},ym=Object(i.a)((function(e){return{section_title:{"&:hover":{backgroundColor:e.palette.action.hover,cursor:"pointer"}}}})),Om=Object(i.a)((function(e){return{root:{"&:hover > .MuiTreeItem-content":{backgroundColor:"transparent"},"&:focus > .MuiTreeItem-content, &$root.Mui-selected > .MuiTreeItem-content":{backgroundColor:"transparent"},"&:focus > .MuiTreeItem-content .MuiTreeItem-label, &:hover > .MuiTreeItem-content .MuiTreeItem-label, &$root.Mui-selected > .MuiTreeItem-content .MuiTreeItem-label":{backgroundColor:"transparent"}},suspicious:{backgroundColor:"dark"===e.palette.type?"#654312":"#ffedd4"},malicious:{backgroundColor:"dark"===e.palette.type?"#4e2525":"#ffd0d0"}}})),_m=function(e){var t=e.body;return u.a.createElement("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"}},t)},xm=function(e){var t=e.body,a=Object(v.a)();return u.a.createElement("pre",{style:{backgroundColor:"dark"===a.palette.type?"#ffffff05":"#00000005",border:"1px solid ".concat(a.palette.divider),borderRadius:"4px",padding:"4px",whiteSpace:"pre-wrap",fontSize:"1rem",wordBreak:"break-word",margin:"0.25rem 0"}},t)},wm=function(e){var t=e.body;return u.a.createElement("table",{cellSpacing:0},u.a.createElement("tbody",null,Object.keys(t).map((function(e,a){var n=t[e];return n instanceof Array?n=n.join(" | "):!0===n?n="true":!1===n?n="false":"object"===typeof n&&(n=JSON.stringify(n)),u.a.createElement("tr",{key:a},u.a.createElement("td",{style:{paddingRight:"16px",wordBreak:"normal"}},u.a.createElement(Em,{title:e})),u.a.createElement("td",{style:{wordBreak:"break-word"}},n))}))))},jm=function(e){var t=e.body,a=Object(v.a)();if("colormap"===t.type){var n=["#87c6fb","#111920"],r=100/t.data.values.length,i=Object(_u.a)().domain(t.data.domain).range(n);return u.a.createElement("svg",{width:"100%",height:"70"},u.a.createElement("rect",{y:10,x:0,width:15,height:15,fill:n[0]}),u.a.createElement("text",{y:22,x:20,fill:a.palette.text.primary},": ".concat(t.data.domain[0])),u.a.createElement("rect",{y:10,x:80,width:15,height:15,fill:n[1]}),u.a.createElement("text",{y:22,x:100,fill:a.palette.text.primary},": ".concat(t.data.domain[1])),t.data.values.map((function(e,t){return u.a.createElement("rect",{key:t,y:30,x:"".concat(t*r,"%"),width:"".concat(r,"%"),height:40,stroke:i(e),fill:i(e)})})))}return u.a.createElement("div",{style:{margin:"2rem"}},"Unsupported graph...")},km=function(e){var t=e.body,a=[];return t instanceof Array?Array.prototype.push.apply(a,t):a.push(t),u.a.createElement("ul",{style:{listStyleType:"none",paddingInlineStart:0,marginBlockStart:"0.25rem",marginBlockEnd:"0.25rem"}},a.map((function(e,t){return u.a.createElement("li",{key:t},u.a.createElement($t.a,{href:e.url},e.name?e.name:e.url))})))},Sm=function(e){var t=e.body,a=Object(v.a)(),n={base00:"transparent",base01:"#f1f1f1",base02:"dark"===a.palette.type?a.palette.text.hint:a.palette.divider,base03:"#444",base04:a.palette.grey["dark"===a.palette.type?700:400],base05:a.palette.grey[(a.palette.type,700)],base06:"#444",base07:a.palette.text.primary,base08:a.palette.text.secondary,base09:"dark"===a.palette.type?a.palette.warning.light:a.palette.warning.dark,base0A:"#333",base0B:"dark"===a.palette.type?a.palette.error.light:a.palette.error.dark,base0C:"dark"===a.palette.type?a.palette.secondary.light:a.palette.secondary.dark,base0D:"dark"===a.palette.type?a.palette.info.light:a.palette.info.dark,base0E:"dark"===a.palette.type?a.palette.info.light:a.palette.info.dark,base0F:"dark"===a.palette.type?a.palette.error.light:a.palette.error.dark};return u.a.createElement(vs.a,{name:!1,src:t,theme:n,enableClipboard:!1,collapsed:!0,groupArraysAfterLength:10,displayDataTypes:!1,displayObjectSize:!1,style:{backgroundColor:"dark"===a.palette.type?"#FFFFFF05":"#00000005",border:"1px solid ".concat(a.palette.divider),borderRadius:"4px",fontSize:"1rem",padding:"4px"}})},Cm=function(e){var t=e.process,a=Object(X.a)(["fileDetail"]).t,n=Object(v.a)(),r=Om(),i={suspicious:r.suspicious,highly_suspicious:r.suspicious,malicious:r.malicious};return u.a.createElement(im.a,{nodeId:t.process_pid.toString(),classes:{root:r.root},label:u.a.createElement("div",{className:i[kc(Object.keys(t.signatures).reduce((function(e,a){return e+parseFloat(t.signatures[a]||0)}),0))],style:{border:"1px solid ".concat(n.palette.divider),margin:"0.2em 0em",borderRadius:"4px",display:"flex",maxWidth:"50rem",minWidth:"30rem"}},u.a.createElement("div",{style:{padding:"5px",backgroundColor:"dark"===n.palette.type?"#FFFFFF10":"#00000010",borderRadius:"4px 0px 0px 4px"}},t.process_pid),u.a.createElement("div",{style:{padding:"5px",flexGrow:1,wordBreak:"break-word"}},u.a.createElement("div",{style:{paddingBottom:"5px"}},u.a.createElement("b",null,t.process_name)),u.a.createElement("div",null,u.a.createElement("samp",null,u.a.createElement("small",null,t.command_line)))),u.a.createElement("div",{style:{alignSelf:"center",color:n.palette.text.secondary}},0!==Object.keys(t.signatures).length&&u.a.createElement("div",null,u.a.createElement(I.a,{title:"".concat(a("process_signatures"),": ").concat(Object.keys(t.signatures).join(" | "))},u.a.createElement("span",null,Object.keys(t.signatures).length,"x",u.a.createElement(un.a,{style:{verticalAlign:"middle"}}))))))},0!==t.children.length&&u.a.createElement(Tm,{processes:t.children}))},Tm=function(e){return e.processes.map((function(e,t){return u.a.createElement(Cm,{key:t,process:e})}))},Am=function(e){var t=e.body;try{var a=JSON.parse(t),n=[];return a.forEach((function(e){void 0!==e.process_pid&&null!==e.process_pid&&n.push(e.process_pid.toString()),void 0!==e.children&&null!==e.children&&0!==e.children.length&&e.children.forEach((function(e){void 0!==e.process_pid&&null!==e.process_pid&&n.push(e.process_pid.toString())}))})),u.a.createElement("div",{style:{overflowX:"auto"}},u.a.createElement(lm.a,{defaultExpanded:n,defaultCollapseIcon:u.a.createElement(V.a,null),defaultExpandIcon:u.a.createElement(L.a,null)},u.a.createElement(Tm,{processes:a})))}catch(r){console.log("[WARNING] Could not parse ProcessTree body. The section will be skipped...")}return null},Nm=Object(Dr.a)((function(e){return Object(G.a)({root:{fontSize:"inherit",lineHeight:"inherit"},head:{backgroundColor:"dark"===e.palette.type?"#404040":"#EEE"},body:{wordBreak:"break-word"}})}))(Mr.a),Im=Object(Dr.a)((function(e){return Object(G.a)({root:{"&:nth-of-type(odd)":{backgroundColor:"dark"===e.palette.type?"#ffffff08":"#00000008"}}})}))(Pr.a),Rm=Object(Dr.a)((function(e){return Object(G.a)({root:Object(r.a)({},e.breakpoints.down("sm"),{width:"max-content"})})}))(Lr.a),zm=function(e){var t=e.body,a=null;try{a=JSON.parse(t)}catch(o){console.log("[WARNING] Could not parse Table body. The section will be skipped...")}var n=[];if(a){var r,i=Object(di.a)(a);try{for(i.s();!(r=i.n()).done;){var l=r.value;for(var s in l){var c=l[s];null!==c&&""!==c&&(n.includes(s)||n.push(s))}}}catch(m){i.e(m)}finally{i.f()}}return a&&u.a.createElement(qr.a,{style:{fontSize:"90%",maxHeight:"500px"}},u.a.createElement(Rm,{stickyHeader:!0,size:"small"},u.a.createElement(Fr.a,null,u.a.createElement(Pr.a,null,n.map((function(e,t){return u.a.createElement(Nm,{key:t},u.a.createElement(Em,{title:e}))})))),u.a.createElement(Wr.a,null,a.map((function(e,t){return u.a.createElement(Im,{key:t},n.map((function(t,a){var n=e[t];return n instanceof Array?n=n.join(" | "):!0===n?n="true":!1===n?n="false":"object"===typeof n&&null!==n&&void 0!==n&&(n=u.a.createElement(wm,{body:n})),u.a.createElement(Nm,{key:a},n)})))})))))},Dm=function e(t){var a=t.section_list,r=t.id,i=t.sub_sections,l=t.indent,s=t.depth,c=void 0===s?1:s,m=ym(),d=Object(v.a)(),p=a[r],g=u.a.useState(!0),f=Object(n.a)(g,2),h=f[0],b=f[1],E=em(),y=E.getKey,O=E.hasHighlightedKeys,_=Ma().c12nDef,x=O(Object(o.useMemo)((function(){var e,t=[],a=Object(di.a)(p.tags);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.push(y(n.type,n.value))}}catch(u){a.e(u)}finally{a.f()}if(void 0!==p.heuristic&&null!==p.heuristic){if(void 0!==p.heuristic.attack&&0!==p.heuristic.attack.length){var r,i=Object(di.a)(p.heuristic.attack);try{for(i.s();!(r=i.n()).done;){var l=r.value;t.push(y("attack_pattern",l.attack_id))}}catch(u){i.e(u)}finally{i.f()}}if(void 0!==p.heuristic.heur_id&&null!==p.heuristic.heur_id&&t.push(y("heuristic",p.heuristic.heur_id)),void 0!==p.heuristic.signature&&0!==p.heuristic.signature.length){var s,c=Object(di.a)(p.heuristic.signature);try{for(c.s();!(s=c.n()).done;){var o=s.value;t.push(y("heuristic.signature",o.name))}}catch(u){c.e(u)}finally{c.f()}}}return t}),[p]));return u.a.createElement("div",{style:{display:"flex",flexWrap:"nowrap",marginLeft:"".concat(c,"rem"),backgroundColor:x?"dark"===d.palette.type?"#343a44":"#d8e3ea":null}},u.a.createElement(fm,{score:p.heuristic?p.heuristic.score:0,indent:l,depth:c,highlighted:x}),u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(R.a,{className:m.section_title,onClick:function(){b(!h)}},_.enforce&&u.a.createElement("span",null,u.a.createElement(ki,{c12n:p.classification,type:"text"}),"\xa0\xa0::\xa0\xa0"),p.heuristic&&u.a.createElement("span",null,u.a.createElement(Cc,{score:p.heuristic.score,mono:!0,short:!0,size:"tiny"}),"\xa0::\xa0\xa0"),u.a.createElement("span",{style:{fontWeight:500,wordBreak:"break-word"}},p.title_text)),u.a.createElement(P.a,{in:h,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{marginLeft:"1rem",marginBottom:"0.75rem"}},function(){switch(p.body_format){case"TEXT":return u.a.createElement(_m,{body:p.body});case"MEMORY_DUMP":return u.a.createElement(xm,{body:p.body});case"GRAPH_DATA":return u.a.createElement(jm,{body:p.body});case"URL":return u.a.createElement(km,{body:p.body});case"JSON":return u.a.createElement(Sm,{body:p.body});case"KEY_VALUE":return u.a.createElement(wm,{body:p.body});case"PROCESS_TREE":return u.a.createElement(Am,{body:p.body});case"TABLE":return u.a.createElement(zm,{body:p.body});default:return u.a.createElement("div",{style:{margin:"2rem"}},"INVALID SECTION TYPE")}}(),p.heuristic&&u.a.createElement(gm,{text:p.heuristic.name,score:p.heuristic.score,show_type:!0,highlight_key:y("heuristic",p.heuristic.heur_id)}),p.heuristic&&p.heuristic.attack.map((function(e,t){return u.a.createElement(mm,{key:t,text:e.pattern,score:p.heuristic.score,show_type:!0,highlight_key:y("attack_pattern",e.attack_id)})})),p.heuristic&&p.heuristic.signature.map((function(e,t){return u.a.createElement(gm,{key:t,text:e.name,score:p.heuristic.score,signature:!0,show_type:!0,highlight_key:y("heuristic.signature",e.name)})})),p.tags.map((function(e,t){return u.a.createElement(vm,{key:t,type:e.type,value:e.value,short_type:e.short_type,score:p.heuristic?p.heuristic.score:0,highlight_key:y(e.type,e.value)})}))),u.a.createElement("div",null,i.map((function(t){return u.a.createElement(e,{key:t.id,section_list:a,id:t.id,sub_sections:t.children,indent:l+1})}))))}),[y,l,p.body,p.body_format,p.heuristic,p.tags,a,i]))))},Bm=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),qm=u.a.memo((function(e){var t=e.extracted,a=Object(X.a)(["fileDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Bm();return u.a.createElement("div",null,u.a.createElement(R.a,{className:c.title,onClick:function(){s(!l)}},u.a.createElement("h3",null,a("supplementary"))),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return t.map((function(e,t){return u.a.createElement(am,{key:t,file:e,download:!0})}))}),[t])))})),Lm=Object(i.a)((function(e){return{card:{backgroundColor:e.palette.background.default,border:"solid 1px ".concat("dark"===e.palette.type?"#393939":"#ddd"),borderRadius:"4px"},card_title:{backgroundColor:"dark"===e.palette.type?"#393939":"#f0f0f0",padding:"6px",borderRadius:"4px 4px 0px 0px",display:"flex",alignItems:"center",flexWrap:"wrap","&:hover":{backgroundColor:"dark"===e.palette.type?"#505050":"#e6e6e6",cursor:"pointer"}},content:{padding:"6px"},muted:{color:e.palette.text.secondary}}})),Fm=function(e){return 0===e.result.score&&0===e.result.sections.length&&0===e.response.extracted.length&&0===e.response.supplementary.length},Pm=function(e){var t=e.result,a=e.sid,r=e.alternates,i=void 0===r?null:r,l=Object(X.a)(["fileDetail"]).t,s=Lm(),c=Object(v.a)(),m=dr(),d=c.spacing(2),p=Ma(),g=p.c12nDef,f=p.settings,h=Fm(t),b=u.a.useState(t),E=Object(n.a)(b,2),y=E[0],O=E[1],_=u.a.useState(!h&&y.result.score>=f.expand_min_score),x=Object(n.a)(_,2),w=x[0],j=x[1],k=u.a.useState(null),S=Object(n.a)(k,2),C=S[0],T=S[1],N=u.a.useState(null),I=Object(n.a)(N,2),z=I[0],D=I[1],B=em(),q=B.getKey,L=B.hasHighlightedKeys,F=Boolean(C),M=Object(o.useMemo)((function(){var e=[];return y.result.sections.forEach((function(t){var a,n=Object(di.a)(t.tags);try{for(n.s();!(a=n.n()).done;){var r=a.value;e.push(q(r.type,r.value))}}catch(m){n.e(m)}finally{n.f()}if(void 0!==t.heuristic&&null!==t.heuristic){if(void 0!==t.heuristic.attack&&0!==t.heuristic.attack.length){var i,l=Object(di.a)(t.heuristic.attack);try{for(l.s();!(i=l.n()).done;){var s=i.value;e.push(q("attack_pattern",s.attack_id))}}catch(m){l.e(m)}finally{l.f()}}if(void 0!==t.heuristic.heur_id&&null!==t.heuristic.heur_id&&e.push(q("heuristic",t.heuristic.heur_id)),void 0!==t.heuristic.signature&&0!==t.heuristic.signature.length){var c,o=Object(di.a)(t.heuristic.signature);try{for(o.s();!(c=o.n()).done;){var u=c.value;e.push(q("heuristic.signature",u.name))}}catch(m){o.e(m)}finally{o.f()}}}})),e}),[y]);void 0===y.section_hierarchy&&console.log("[WARNING] Using old rendering method because the section hierarchy is missing...");return Object(o.useEffect)((function(){null!==z?(T(null),m({url:"/api/v4/result/".concat(z,"/"),onSuccess:function(e){O(e.api_response),j(!0)}})):y!==t&&(T(null),O(t),j(!0))}),[z]),u.a.createElement("div",{className:s.card,style:{marginBottom:d}},u.a.createElement(ca.a,{open:F,anchorEl:C,placement:"bottom-end",transition:!0},(function(e){var a=e.TransitionProps;return u.a.createElement(oa.a,a,u.a.createElement(ua.a,null,u.a.createElement(A.a,{onClickAway:function(){return T(null)}},u.a.createElement(Xu.a,{dense:!0},u.a.createElement(Kr.a,{disabled:null===z,onClick:function(){return D(null)}},u.a.createElement("span",{style:{paddingRight:c.spacing(2)}},"".concat(t.response.service_version," :: [").concat(t.result.score,"]")),u.a.createElement(Dl.a,{format:"YYYY-MM-DD HH:mm:ss"},t.created)),i.map((function(e){return u.a.createElement(Kr.a,{disabled:z===e.id,key:e.id,onClick:function(){return D(e.id)}},u.a.createElement("span",{style:{paddingRight:c.spacing(2)}},"".concat(e.response.service_version," :: [").concat(e.result.score,"]")),u.a.createElement(Dl.a,{format:"YYYY-MM-DD HH:mm:ss"},e.created))}))))))})),u.a.createElement(R.a,{className:s.card_title,onClick:function(){j(!w)},style:{backgroundColor:L(M)?"dark"===c.palette.type?"#343a44":"#d8e3ea":null}},g.enforce&&u.a.createElement(ki,{c12n:y.classification,type:"text"}),u.a.createElement("span",null,g.enforce&&u.a.createElement("span",null,"\xa0::\xa0"),u.a.createElement("b",null,y.response.service_name),"\xa0"),!h&&u.a.createElement(Cc,{score:y.result.score,mono:!0,short:!0,size:"tiny"}),u.a.createElement("small",{className:s.muted}," :: ".concat(y.response.service_version.replace(/_/g,"."))),u.a.createElement("small",{className:s.muted,style:{flexGrow:1}},"\xa0",y.response.service_context?"(".concat(y.response.service_context,")"):""),!h&&!a&&u.a.createElement("div",null,i?u.a.createElement(ma.a,{className:s.muted,variant:"outlined",size:"small",onClick:function(e){e.stopPropagation(),T(C?null:e.currentTarget)},style:{fontSize:"smaller"}},u.a.createElement(Dl.a,{fromNow:!0},y.created)):u.a.createElement(Kt.a,{className:s.muted,variant:"button",style:{fontSize:"smaller",paddingRight:c.spacing(1.4)}},u.a.createElement(Dl.a,{fromNow:!0},y.created))),w?u.a.createElement(U.a,{className:s.muted}):u.a.createElement(V.a,{className:s.muted})),u.a.createElement(P.a,{in:w,timeout:"auto"},Object(o.useMemo)((function(){return h?u.a.createElement("div",{className:s.content,style:{color:c.palette.text.secondary}},l("nothing_to_report")):u.a.createElement("div",{className:s.content},y.section_hierarchy?y.section_hierarchy.map((function(e){return u.a.createElement(Dm,{key:e.id,section_list:y.result.sections,id:e.id,sub_sections:e.children,indent:1})})):y.result.sections.map((function(e,t){return u.a.createElement(Dm,{key:t,section_list:y.result.sections,id:t,sub_sections:[],indent:e.depth,depth:e.depth})})),0!==y.response.supplementary.length&&u.a.createElement(qm,{extracted:y.response.supplementary}),0!==y.response.extracted.length&&u.a.createElement(rm,{extracted:y.response.extracted,sid:a}))}),[h,y.response.extracted,y.response.supplementary,y.result.sections,y.section_hierarchy,a])))},Mm=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),Wm=u.a.memo((function(e){var t=e.attacks,a=Object(X.a)(["fileDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=Mm(),d=c.spacing(2),p=em().getKey;return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("attack_matrix")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},t?Object.keys(t).map((function(e,a){return u.a.createElement(Br.a,{container:!0,key:a},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500,textTransform:"capitalize"}},e.replace(/-/g," "))),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},t[e].map((function(e,t){var a=Object(n.a)(e,3),r=a[0],i=a[1],l=a[2];return u.a.createElement(mm,{key:"".concat(r,"_").concat(t),text:i,lvl:l,highlight_key:p("attack_pattern",r)})}))))})):Object(oe.a)(Array(3)).map((function(e,t){return u.a.createElement(Br.a,{container:!0,key:t,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement(pr.a,{style:{height:"2rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},u.a.createElement(pr.a,{style:{height:"2rem"}})))})))}),[t])))})),Um=Object(i.a)((function(e){return{clickable:{cursor:"pointer","&:hover, &:focus":{backgroundColor:e.palette.action.hover}},title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),Hm=u.a.memo((function(e){var t=e.childrens,a=Object(X.a)(["fileDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=Um(),d=c.spacing(2),p=Object(ue.g)();return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("childrens")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},t.map((function(e,t){return u.a.createElement(R.a,{key:t,className:m.clickable,onClick:function(){p.push("/file/detail/".concat(e.sha256,"?name=").concat(encodeURI(e.name)))},style:{wordBreak:"break-word"}},u.a.createElement("span",null,e.name),u.a.createElement("span",{style:{fontSize:"80%",color:c.palette.text.secondary}}," :: ".concat(e.sha256)))})))}),[t])))})),Vm=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),Gm=u.a.memo((function(e){var t=e.emptys,a=e.sid,r=Object(X.a)(["fileDetail"]).t,i=u.a.useState(!0),l=Object(n.a)(i,2),s=l[0],c=l[1],m=Object(v.a)(),d=Vm(),p=m.spacing(2);return u.a.createElement("div",{style:{paddingBottom:p,paddingTop:p}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){c(!s)},className:d.title},r("emptys")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:s,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:p,paddingTop:p}},t?t.map((function(e,t){return u.a.createElement(Pm,{key:t,result:e,sid:a})})):Object(oe.a)(Array(2)).map((function(e,t){return u.a.createElement(pr.a,{key:t,style:{height:"16rem"}})})))}),[t,a])))})),Ym=Object(i.a)((function(e){return{card:{backgroundColor:"dark"===e.palette.type?"#371a1a":"#fce9e9",border:"solid 1px ".concat("dark"===e.palette.type?"#502121":"#ffcbcb"),borderRadius:"4px"},card_title:{backgroundColor:"dark"===e.palette.type?"#502121":"#ffd9d9",padding:"6px",borderRadius:"4px 4px 0px 0px",display:"flex",alignItems:"center",flexWrap:"wrap","&:hover":{backgroundColor:"dark"===e.palette.type?"#6e2b2b":"#ffc5c5",cursor:"pointer"}},content:{padding:"6px"},muted:{color:e.palette.text.secondary}}})),Jm=function(e){var t=e.error,a=Ym(),r=Object(X.a)(["adminErrorViewer"]).t,i=Object(v.a)().spacing(2),l=u.a.useState(!1),s=Object(n.a)(l,2),c=s[0],o=s[1];return u.a.createElement("div",{className:a.card,style:{marginBottom:i}},u.a.createElement(R.a,{className:a.card_title,onClick:function(){o(!c)}},u.a.createElement("span",null,u.a.createElement("b",null,t.response.service_name),"\xa0"),u.a.createElement("span",null,"[",r("type.".concat(t.type)),"]\xa0"),u.a.createElement("small",{className:a.muted}," :: ".concat(t.response.service_version)),u.a.createElement("small",{className:a.muted,style:{flexGrow:1}},"\xa0",t.response.service_tool_version?"(".concat(t.response.service_tool_version,")"):""),u.a.createElement("small",null,u.a.createElement(Dl.a,{className:a.muted,fromNow:!0},t.created)),c?u.a.createElement(U.a,{className:a.muted}):u.a.createElement(V.a,{className:a.muted})),u.a.createElement(P.a,{in:c,timeout:"auto"},u.a.createElement("div",{className:a.content},t.response.message)))},Qm=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),Km=u.a.memo((function(e){var t=e.errors,a=Object(X.a)(["fileDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=Qm(),d=c.spacing(2);return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("errors")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},t.map((function(e,t){return u.a.createElement(Jm,{key:t,error:e})})))}),[t])))})),Xm=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),Zm=u.a.memo((function(e){var t=e.fileinfo,a=Object(X.a)(["fileDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=Xm(),d=c.spacing(2);return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("frequency")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("seen.first"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},t?u.a.createElement("div",null,u.a.createElement(Dl.a,{fromNow:!0},t.seen.first)," (",u.a.createElement(Dl.a,{format:"YYYY-MM-DD HH:mm:ss"},t.seen.first),")"):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("seen.last"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},t?u.a.createElement("div",null,u.a.createElement(Dl.a,{fromNow:!0},t.seen.last)," (",u.a.createElement(Dl.a,{format:"YYYY-MM-DD HH:mm:ss"},t.seen.last),")"):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("seen.count"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},t?t.seen.count:u.a.createElement(pr.a,null))))}),[t])))})),$m=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),ed=u.a.memo((function(e){var t=e.heuristics,a=Object(X.a)(["fileDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=$m(),d=c.spacing(2),p=em().getKey;return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("heuristics")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},t?Object.keys(t).map((function(e,r){return u.a.createElement(Br.a,{container:!0,key:r},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500,wordBreak:"break-word"}},a("verdict.".concat(e)))),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},t[e].map((function(t,a){var r=Object(n.a)(t,2),i=r[0],l=r[1];return u.a.createElement(gm,{key:"".concat(i,"_").concat(a),text:l,lvl:e,highlight_key:p("heuristic",i)})}))))})):Object(oe.a)(Array(3)).map((function(e,t){return u.a.createElement(Br.a,{container:!0,key:t,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement(pr.a,{style:{height:"2rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},u.a.createElement(pr.a,{style:{height:"2rem"}})))})))}),[t])))})),td=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),ad=u.a.memo((function(e){var t=e.fileinfo,a=Object(X.a)(["fileDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=td(),d=c.spacing(2);return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("identification")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},"MD5")),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{fontSize:"110%",fontFamily:"monospace",wordBreak:"break-word"}},t?t.md5:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},"SHA1")),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{fontSize:"110%",fontFamily:"monospace",wordBreak:"break-word"}},t?t.sha1:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},"SHA256")),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{fontSize:"110%",fontFamily:"monospace",wordBreak:"break-word"}},t?t.sha256:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},"SSDEEP")),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{fontSize:"110%",fontFamily:"monospace",wordBreak:"break-word"}},t?t.ssdeep:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("size"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},t?u.a.createElement("span",null,t.size,u.a.createElement("span",{style:{fontWeight:300}}," (",jc(t.size),")")):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("type"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{wordBreak:"break-word"}},t?t.type:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("mime"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{wordBreak:"break-word"}},t?t.mime:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("magic"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{wordBreak:"break-word"}},t?t.magic:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("entropy"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},t?t.entropy:u.a.createElement(pr.a,null))))}),[t])))})),nd=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),rd=u.a.memo((function(e){var t=e.metadata,a=Object(X.a)(["fileDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=nd(),d=c.spacing(2);return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("metadata")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},t?Object.keys(t).map((function(e,a){return u.a.createElement(Br.a,{container:!0,key:a},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500,wordBreak:"break-word"}},e)),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},Object.keys(t[e]).map((function(a,n){return u.a.createElement(mi,{size:"tiny",key:n,label:"".concat(t[e][a],"x ").concat(a)})}))))})):Object(oe.a)(Array(3)).map((function(e,t){return u.a.createElement(Br.a,{container:!0,key:t,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement(pr.a,{style:{height:"2rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},u.a.createElement(pr.a,{style:{height:"2rem"}})))})))}),[t])))})),id=Object(i.a)((function(e){return{clickable:{cursor:"pointer","&:hover, &:focus":{backgroundColor:e.palette.action.hover}},title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),ld=u.a.memo((function(e){var t=e.parents,a=Object(X.a)(["fileDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=id(),d=c.spacing(2),p=Object(ue.g)();return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("parents")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},t.map((function(e,t){var a=e.split(".",2),r=Object(n.a)(a,2),i=r[0],l=r[1];return u.a.createElement(R.a,{key:t,className:m.clickable,onClick:function(){p.push("/file/detail/".concat(i))},style:{wordBreak:"break-word"}},u.a.createElement("span",null,i),u.a.createElement("span",{style:{fontSize:"80%",color:c.palette.text.secondary}}," :: ".concat(l)))})))}),[t])))})),sd=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),cd=u.a.memo((function(e){var t=e.results,a=e.sid,r=e.alternates,i=Object(X.a)(["fileDetail"]).t,l=u.a.useState(!0),s=Object(n.a)(l,2),c=s[0],m=s[1],d=Object(v.a)(),p=sd(),g=d.spacing(2);return u.a.createElement("div",{style:{paddingBottom:g,paddingTop:g}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){m(!c)},className:p.title},i("results")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:c,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:g,paddingTop:g}},t?t.map((function(e,t){return u.a.createElement(Pm,{key:t,result:e,sid:a,alternates:r?r[e.response.service_name]:null})})):Object(oe.a)(Array(2)).map((function(e,t){return u.a.createElement(pr.a,{key:t,style:{height:"16rem"}})})))}),[t,a])))})),od=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}},meta_key:{overflowX:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}})),ud=u.a.memo((function(e){var t=e.signatures,a=e.tags,r=Object(X.a)(["fileDetail"]).t,i=u.a.useState(!0),l=Object(n.a)(i,2),s=l[0],c=l[1],m=Object(v.a)(),d=od(),p=m.spacing(2),g=em().getKey;return u.a.createElement("div",{style:{paddingBottom:p,paddingTop:p}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){c(!s)},className:d.title},r("generated_tags")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:s,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:p,paddingTop:p}},t&&0!==t.length&&u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{className:d.meta_key,item:!0,xs:12,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},"heuristic.signature")),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},t.map((function(e,t){var a=Object(n.a)(e,2),r=a[0],i=a[1];return u.a.createElement(gm,{key:t,signature:!0,text:r,lvl:i,highlight_key:g("heuristic.signature",r)})})))),a?Object.keys(a).map((function(e,t){return u.a.createElement(Br.a,{container:!0,key:t},u.a.createElement(Br.a,{className:d.meta_key,item:!0,xs:12,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e)),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},a[e].map((function(t,a){var r=Object(n.a)(t,2),i=r[0],l=r[1];return u.a.createElement(vm,{key:a,value:i,type:e,lvl:l,highlight_key:g(e,i)})}))))})):Object(oe.a)(Array(3)).map((function(e,t){return u.a.createElement(Br.a,{container:!0,key:t,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement(pr.a,{style:{height:"2rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},u.a.createElement(pr.a,{style:{height:"2rem"}})))})))}),[t,a])))})),md=u.a.memo((function(e){var t=e.sha256,a=e.sid,r=void 0===a?null:a,i=e.liveResultKeys,l=void 0===i?null:i,s=e.liveErrors,c=void 0===s?null:s,m=Object(X.a)(["fileDetail"]).t,d=Object(o.useState)(null),p=Object(n.a)(d,2),g=p[0],f=p[1],b=dr(),E=Ma().c12nDef,y=Object(v.a)(),O=Object(ue.g)(),_=$n().showSuccessMessage,x=y.spacing(2),w=y.spacing(4),j=Object(ue.h)(),k=new URLSearchParams(j.search),S=g?k.get("name")||t:null,C=function(e){var t=document.getElementById(e);t&&!function(e){var t=e.getBoundingClientRect(),a=e.offsetHeight,n=e.offsetWidth;return t.top>=-a&&t.left>=-n&&t.right<=(window.innerWidth||document.documentElement.clientWidth)+n&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)+a}(t)&&t.scrollIntoView()},T=function(e){var t=Object(h.a)({},e);return t.results.sort((function(e,t){return e.response.service_name>t.response.service_name?1:-1})),t.emptys=e.results.filter((function(e){return Fm(e)})),t.results=e.results.filter((function(e){return!Fm(e)})),t.errors=c?[].concat(Object(oe.a)(e.errors),Object(oe.a)(c)):e.errors,t},A=Object(o.useCallback)((function(){b({url:"/api/v4/submit/dynamic/".concat(t,"/"),onSuccess:function(e){_(m("resubmit.success")),setTimeout((function(){O.push("/submission/detail/".concat(e.api_response.sid))}),500)}})}),[t]);return Object(o.useEffect)((function(){f(null),r&&t?b({method:l?"POST":"GET",url:"/api/v4/submission/".concat(r,"/file/").concat(t,"/"),body:l?{extra_result_keys:l}:null,onSuccess:function(e){C("drawerTop"),f(T(e.api_response))}}):t&&b({url:"/api/v4/file/result/".concat(t,"/"),onSuccess:function(e){C("fileDetailTop"),f(T(e.api_response))}})}),[t,r]),u.a.createElement("div",{id:"fileDetailTop",style:{textAlign:"left"}},Object(o.useMemo)((function(){return u.a.createElement(u.a.Fragment,null,E.enforce&&u.a.createElement("div",{style:{paddingBottom:w,paddingTop:x}},u.a.createElement(ki,{size:"tiny",c12n:g?g.file_info.classification:null})),u.a.createElement("div",{style:{paddingBottom:w}},u.a.createElement(Br.a,{container:!0,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement("div",null,u.a.createElement(Kt.a,{variant:"h4"},m("title")),u.a.createElement(Kt.a,{variant:"caption",style:{wordBreak:"break-word"}},g?S:u.a.createElement(pr.a,{style:{width:"10rem"}})))),u.a.createElement(Br.a,{item:!0,xs:12,sm:!0},u.a.createElement("div",{style:{textAlign:"right"}},u.a.createElement(I.a,{title:m("related")},u.a.createElement(Z.a,{component:Y.b,to:"/search/submission?query=files.sha256:".concat(g&&g.file_info.sha256," OR results:").concat(g&&g.file_info.sha256,"*")},u.a.createElement(Ya.a,null))),u.a.createElement(I.a,{title:m("download")},u.a.createElement(Z.a,{component:$t.a,href:"/api/v4/file/download/".concat(g&&g.file_info.sha256,"/?XSRF_TOKEN=").concat(mr())},u.a.createElement(Ju.a,{color:"action"}))),u.a.createElement(I.a,{title:m("file_viewer")},u.a.createElement(Z.a,{component:Y.b,to:"/file/viewer/".concat(g&&g.file_info.sha256)},u.a.createElement(Jn.a,null))),u.a.createElement(I.a,{title:m("resubmit_dynamic")},u.a.createElement(Z.a,{onClick:A},u.a.createElement(Ku.a,null))))))))}),[g,S,A]),u.a.createElement("div",{style:{paddingBottom:x}},u.a.createElement(ad,{fileinfo:g?g.file_info:null}),u.a.createElement(Zm,{fileinfo:g?g.file_info:null}),(!g||0!==Object.keys(g.metadata).length)&&u.a.createElement(rd,{metadata:g?g.metadata:null}),g&&g.childrens&&0!==g.childrens.length&&u.a.createElement(Hm,{childrens:g.childrens}),g&&g.parents&&0!==g.parents.length&&u.a.createElement(ld,{parents:g.parents}),(!g||0!==Object.keys(g.attack_matrix).length)&&u.a.createElement(Wm,{attacks:g?g.attack_matrix:null}),(!g||0!==Object.keys(g.heuristics).length)&&u.a.createElement(ed,{heuristics:g?g.heuristics:null}),(!g||0!==Object.keys(g.tags).length||0!==g.signatures.length)&&u.a.createElement(ud,{signatures:g?g.signatures:null,tags:g?g.tags:null}),(!g||0!==g.results.length)&&u.a.createElement(cd,{results:g?g.results:null,sid:r,alternates:g?g.alternates:null}),(!g||0!==g.emptys.length)&&u.a.createElement(Gm,{emptys:g?g.emptys:null,sid:r}),g&&0!==g.errors.length&&u.a.createElement(Km,{errors:g.errors})))}));var dd=function(){var e=Object(ue.i)().id;return u.a.createElement(ir,{margin:4,width:"100%"},u.a.createElement(md,{sha256:e}))},pd=Object(i.a)((function(e){return{pre:{backgroundColor:"dark"===e.palette.type?"#ffffff05":"#00000005",border:"1px solid ".concat(e.palette.divider),borderRadius:"4px",fontSize:"1rem",padding:"16px 8px",margin:"0.25rem 0",overflow:"auto",wordBreak:"break-word"},no_pad:{padding:0}}})),gd=u.a.memo((function(e){var t=e.sha256,a=Object(o.useState)(null),r=Object(n.a)(a,2),i=r[0],l=r[1],s=Object(o.useState)(null),c=Object(n.a)(s,2),m=c[0],d=c[1],p=pd(),g=dr();return Object(o.useEffect)((function(){g({url:"/api/v4/file/ascii/".concat(t,"/"),onSuccess:function(e){l(e.api_response)},onFailure:function(e){d(e.api_error_message)}})}),[t]),i?u.a.createElement("pre",{className:p.pre},i):m?u.a.createElement(Bl.a,{severity:"error"},m):u.a.createElement(tl.a,null)})),fd=u.a.memo((function(e){var t=e.sha256,a=Object(o.useState)(null),r=Object(n.a)(a,2),i=r[0],l=r[1],s=Object(o.useState)(null),c=Object(n.a)(s,2),m=c[0],d=c[1],p=pd(),g=dr();return Object(o.useEffect)((function(){g({url:"/api/v4/file/hex/".concat(t,"/"),onSuccess:function(e){l(e.api_response)},onFailure:function(e){d(e.api_error_message)}})}),[t]),i?u.a.createElement("pre",{className:p.pre},u.a.createElement("div",{style:{minWidth:"580px"}},i)):m?u.a.createElement(Bl.a,{severity:"error"},m):u.a.createElement(tl.a,null)})),hd=u.a.memo((function(e){var t=e.sha256,a=Object(o.useState)(null),r=Object(n.a)(a,2),i=r[0],l=r[1],s=Object(o.useState)(null),c=Object(n.a)(s,2),m=c[0],d=c[1],p=pd(),g=dr();return Object(o.useEffect)((function(){g({url:"/api/v4/file/strings/".concat(t,"/"),onSuccess:function(e){l(e.api_response)},onFailure:function(e){d(e.api_error_message)}})}),[t]),i?u.a.createElement("pre",{className:p.pre},i):m?u.a.createElement(Bl.a,{severity:"error"},m):u.a.createElement(tl.a,null)})),bd=function(){var e=Object(ue.i)().id,t=Object(X.a)(["fileViewer"]).t,a=pd(),r=Object(v.a)(),i=Object(ue.h)(),l=Object(ue.g)(),s=Object(o.useState)("ascii"),c=Object(n.a)(s,2),m=c[0],d=c[1];return Object(o.useEffect)((function(){var e=i.hash.substring(1,i.hash.length)||"ascii";d(e)}),[i.hash]),u.a.createElement(ir,{margin:4,width:"100%"},u.a.createElement("div",{style:{textAlign:"left"}},u.a.createElement(Br.a,{container:!0,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:!0,sm:8},u.a.createElement(Kt.a,{variant:"h4"},t("title")),u.a.createElement(Kt.a,{variant:"caption",style:{wordBreak:"break-word"}},e)),u.a.createElement(Br.a,{item:!0,xs:12,sm:!0},u.a.createElement("div",{style:{textAlign:"right"}},u.a.createElement(I.a,{title:t("detail")},u.a.createElement(Z.a,{component:Y.b,to:"/file/detail/".concat(e)},u.a.createElement(Pn.a,null))),u.a.createElement(I.a,{title:t("related")},u.a.createElement(Z.a,{component:Y.b,to:"/search/submission?query=files.sha256:".concat(e," OR results:").concat(e,"*")},u.a.createElement(Ya.a,null))),u.a.createElement(I.a,{title:t("download")},u.a.createElement(Z.a,{component:$t.a,href:"/api/v4/file/download/".concat(e,"/?XSRF_TOKEN=").concat(mr())},u.a.createElement(Ju.a,{color:"action"})))))),u.a.createElement(Ql.a,{value:m},u.a.createElement(ua.a,{square:!0,style:{marginTop:r.spacing(4),marginBottom:r.spacing(2)}},u.a.createElement(Kl.a,{onChange:function(e,t){(i.hash.substring(1,i.hash.length)||"ascii")!==t&&l.push("".concat(i.pathname,"#").concat(t))},indicatorColor:"primary",textColor:"primary"},u.a.createElement(Gl.a,{label:t("ascii"),value:"ascii"}),u.a.createElement(Gl.a,{label:t("strings"),value:"strings"}),u.a.createElement(Gl.a,{label:t("hex"),value:"hex"}))),u.a.createElement(Xl.a,{value:"ascii",className:a.no_pad},u.a.createElement(gd,{sha256:e})),u.a.createElement(Xl.a,{value:"strings",className:a.no_pad},u.a.createElement(hd,{sha256:e})),u.a.createElement(Xl.a,{value:"hex",className:a.no_pad},u.a.createElement(fd,{sha256:e})))))};function vd(){var e,t=An(),a=x().validateProps,n=[],r=Object(di.a)(t.leftnav.elements);try{for(r.s();!(e=r.n()).done;){var i=e.value;"group"===i.type&&"help"===i.element.id&&(n=i.element.items.filter((function(e){return a(e.userPropValidators)})))}}catch(l){r.e(l)}finally{r.f()}return u.a.createElement(ir,{margin:4,width:"100%"},u.a.createElement(qi,{items:n}))}var Ed=a(252),yd=a.n(Ed),Od=a(148),_d=a.n(Od),xd=Object(i.a)((function(e){return{api:{minHeight:"48px",cursor:"pointer","&:hover":{backgroundColor:e.palette.action.selected}},blueprint:{minHeight:"48px",alignItems:"center",borderColor:e.palette.action.disabledBackground,cursor:"pointer","&:hover":{backgroundColor:e.palette.action.selected}},blueprintSkel:{minHeight:"48px",alignItems:"center",borderColor:e.palette.action.disabledBackground},expand:{transform:"rotate(0deg)",marginLeft:e.spacing(2),transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"}}}));function wd(){var e=dr(),t=Object(o.useState)(null),a=Object(n.a)(t,2),i=a[0],s=a[1],c=Object(o.useState)(null),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Object(o.useState)(null),f=Object(n.a)(g,2),b=f[0],E=f[1],y=xd(),O=Object(o.useState)({}),_=Object(n.a)(O,2),x=_[0],w=_[1],j=Object(v.a)(),k=Object(X.a)(["helpAPI"]).t,S=j.spacing(1),C=j.spacing(2),T=Object(l.a)(j.breakpoints.down("sm")),A=Object(l.a)(j.breakpoints.only("xs")),N="dark"===j.palette.type,I={DELETE:"error",GET:"info",POST:"success",PUT:"warning"},z={E:"error",R:"success",W:"warning"},D={admin:"error",signature_manager:"info",user:null,signature_importer:"warning"};function B(e){var t={};t[e]=!x[e],w(Object(h.a)(Object(h.a)({},x),t))}function q(e,t){return e.name<t.name?-1:e.name>t.name?1:0}return Object(o.useEffect)((function(){e(i?{url:"/api/".concat(d,"/"),onSuccess:function(e){E(e.api_response)}}:{url:"/api/",onSuccess:function(e){s(e.api_response),p(e.api_response[0])}})}),[d]),u.a.createElement(Yi,{margin:4},u.a.createElement("div",{style:{textAlign:"left"}},u.a.createElement("div",{style:{marginBottom:j.spacing(4)}},u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:12,sm:!0},u.a.createElement(Kt.a,{variant:"h4"},k("title"))),u.a.createElement(Br.a,{item:!0,xs:12,sm:!0,style:{textAlign:"end"}},i&&d?u.a.createElement(Qr.a,{id:"api",value:d,onChange:function(e){return p(e.target.value)},variant:"outlined",margin:"dense"},i.map((function(e,t){return u.a.createElement(Kr.a,{key:t,value:e},e.replace("v",k("version"))+k("version_end"))}))):u.a.createElement(pr.a,{variant:"rect",style:{display:"inline-block",height:"2rem",width:"14rem"}})))),b?u.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},Object.keys(b.blueprints).map((function(e,t){return u.a.createElement("div",{key:t},u.a.createElement(R.a,{display:"flex",flexDirection:"row",flexWrap:"wrap",className:y.blueprint,borderBottom:1,px:1,onClick:function(){return B(e)}},u.a.createElement(Kt.a,{variant:"body2",color:"textSecondary",style:{fontWeight:800,lineHeight:2}},"/api/".concat(d,"/"),"\xa0"),u.a.createElement("div",{style:{flexGrow:1}},u.a.createElement(Kt.a,{variant:"h6",style:{fontWeight:800,lineHeight:2},color:"secondary"},e)),u.a.createElement("div",{style:{display:"inline-flex",width:T?"100%":null,justifyContent:"flex-end"}},u.a.createElement(Kt.a,{variant:"body2",color:"textSecondary",align:"right",style:{lineHeight:2}},b.blueprints[e]),u.a.createElement(V.a,{className:Object(F.default)(y.expand,Object(r.a)({},y.expandOpen,x[e]))}))),u.a.createElement(P.a,{in:x[e],timeout:"auto",unmountOnExit:!0},u.a.createElement("div",{style:{backgroundColor:N?j.palette.grey[900]:j.palette.grey[100]}},function(e){var t=[];if(b){var a,n=Object(di.a)(b.apis);try{for(n.s();!(a=n.n()).done;){var r=a.value;"documentation"===e?r.path==="/api/".concat(d,"/")&&t.push(r):0===r.path.indexOf("/api/".concat(d,"/").concat(e,"/"))&&t.push(r)}}catch(i){n.e(i)}finally{n.f()}}return t.sort(q)}(e).map((function(e,t){return u.a.createElement("div",{key:t},u.a.createElement(R.a,{className:y.api,px:1,display:"flex",flexDirection:A?"column":"row",flexWrap:"wrap",alignItems:A?"flex-start":"center",onClick:function(){return B(e.name)}},u.a.createElement("div",null,e.methods.map((function(e,t){return u.a.createElement(mi,{color:I[e],type:"rounded",size:"small",key:t,label:e})}))),u.a.createElement("div",{style:{flexGrow:1}},u.a.createElement(Kt.a,{variant:"body2",color:"textSecondary",style:{wordBreak:"break-word",lineHeight:2}},e.path)),u.a.createElement("div",{style:{display:"inline-flex",width:T?"100%":null,justifyContent:"flex-end"}},u.a.createElement(Kt.a,{align:"right",variant:"caption",style:{lineHeight:2}},e.name),u.a.createElement(V.a,{className:Object(F.default)(y.expand,Object(r.a)({},y.expandOpen,x[e.name]))}))),u.a.createElement(P.a,{in:x[e.name],timeout:"auto",unmountOnExit:!0},u.a.createElement("div",{style:{border:1,borderTop:0,borderBottom:0,padding:S,borderColor:N?j.palette.grey[900]:j.palette.grey[100],backgroundColor:j.palette.background.default}},u.a.createElement(Br.a,{container:!0,alignItems:"center"},u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:8,sm:4,md:3,lg:2},u.a.createElement("div",{style:{fontWeight:500}},k("complete"),":")),u.a.createElement(Br.a,{item:!0,xs:4,sm:8,md:9,lg:4},e.complete?u.a.createElement(yd.a,{htmlColor:j.palette.success.main}):u.a.createElement(_d.a,{htmlColor:j.palette.error.main}))),u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:8,sm:4,md:3,lg:2},u.a.createElement("div",{style:{fontWeight:500}},k("protected"),":")),u.a.createElement(Br.a,{item:!0,xs:4,sm:8,md:9,lg:4},e.protected?u.a.createElement(yd.a,{htmlColor:j.palette.success.main}):u.a.createElement(_d.a,{htmlColor:j.palette.error.main}))),u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:12,sm:4,md:3,lg:2},u.a.createElement("div",{style:{fontWeight:500}},k("require_type"),":")),u.a.createElement(Br.a,{item:!0,xs:12,sm:8,md:9,lg:4},e.require_type.map((function(e,t){return u.a.createElement(mi,{key:t,color:D[e],type:"rounded",size:"tiny",label:k("user_type.".concat(e))})})))),e.required_priv?u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:12,sm:4,md:3,lg:2},u.a.createElement("div",{style:{fontWeight:500}},k("required_priv"),":")),u.a.createElement(Br.a,{item:!0,xs:12,sm:8,md:9,lg:4},e.required_priv.map((function(e,t){return u.a.createElement(mi,{key:t,color:z[e],type:"rounded",size:"tiny",label:k("priv.".concat(e))})})))):null,u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:12,sm:4,md:3,lg:2},u.a.createElement("div",{style:{fontWeight:500}},k("methods"),":")),u.a.createElement(Br.a,{item:!0,xs:12,sm:8,md:9,lg:4},e.methods.map((function(e,t){return u.a.createElement(mi,{key:t,color:I[e],type:"rounded",size:"tiny",label:k(e)})})))),u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:12,sm:4,md:3,lg:2},u.a.createElement("div",{style:{fontWeight:500}},k("path"),":")),u.a.createElement(Br.a,{item:!0,xs:12,sm:8,md:9,lg:4},u.a.createElement("div",{style:{lineHeight:2,fontFamily:"Monospace",wordBreak:"break-word"}},e.path))),u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{style:{fontWeight:500,lineHeight:2}},k("description"),":")),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(cr.a,{variant:"outlined",style:{overflowX:"auto"}},u.a.createElement("pre",{style:{paddingLeft:C,paddingRight:C}},e.description))))))))})))))}))):u.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},Object(oe.a)(Array(21)).map((function(e,t){return u.a.createElement("div",{key:t,style:{paddingLeft:S,paddingRight:S,display:"flex",flexDirection:"row",flexWrap:"wrap",borderBottom:1},className:y.blueprintSkel},u.a.createElement(Kt.a,{variant:"body2",style:{paddingRight:"8px"}},u.a.createElement(pr.a,{width:"2rem"})),u.a.createElement("div",{style:{flexGrow:1}},u.a.createElement(Kt.a,{variant:"h6"},u.a.createElement(pr.a,{width:"12rem"}))),u.a.createElement("div",{style:{display:"inline-flex",width:T?"100%":null,justifyContent:"flex-end"}},u.a.createElement(Kt.a,{variant:"body2",style:{paddingRight:"16px",lineHeight:2}},u.a.createElement(pr.a,{width:"14rem"})),u.a.createElement(pr.a,{width:"1rem"})))})))))}var jd=a(816);function kd(){var e=Object(X.a)(["helpClassification"]).t,t=Ma().c12nDef,a=Object(v.a)(),n=a.spacing(1),r=a.spacing(2),i=a.spacing(4);return t.enforce?u.a.createElement(ir,{margin:4,width:"100%"},u.a.createElement("div",{style:{marginBottom:a.spacing(4),textAlign:"left"}},u.a.createElement(Kt.a,{variant:"h4"},e("title"))),u.a.createElement("div",{style:{textAlign:"left",paddingBottom:i}},u.a.createElement(Kt.a,{variant:"h5",gutterBottom:!0},e("desc_title")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},e("desc_1")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},e("desc_2"))),u.a.createElement("div",{style:{textAlign:"left",paddingBottom:i}},u.a.createElement(Kt.a,{variant:"h5",gutterBottom:!0},e("submission_title")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},e("submission_desc")),u.a.createElement(Kt.a,{variant:"subtitle2",gutterBottom:!0},e("ex_title")),u.a.createElement("div",{style:{paddingLeft:r}},u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},e("assumptions")),u.a.createElement("ul",null,u.a.createElement("li",null,u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"submission_a_1",components:{bold:u.a.createElement("strong",null)}}),u.a.createElement(ki,{size:"tiny",type:"text",c12n:t?t.RESTRICTED:null,format:"long"})),u.a.createElement("li",null,u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"submission_a_2",components:{bold:u.a.createElement("strong",null)}}),u.a.createElement(ki,{inline:!0,size:"tiny",type:"text",c12n:t?t.UNRESTRICTED:null,format:"long"})),u.a.createElement("li",null,u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"submission_a_3",components:{bold:u.a.createElement("strong",null)}}))),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"submission_a_res_1_p1",components:{bold:u.a.createElement("strong",null)}}),u.a.createElement(ki,{size:"tiny",type:"text",c12n:t?t.UNRESTRICTED:null,format:"long"}),u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"submission_a_res_1_p2",components:{bold:u.a.createElement("strong",null)}})),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"submission_a_res_2_p1",components:{italic:u.a.createElement("i",null),bold:u.a.createElement("strong",null)}}),u.a.createElement(ki,{size:"tiny",type:"text",c12n:t?t.RESTRICTED:null,format:"long"}),u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"submission_a_res_2_p2",components:{italic:u.a.createElement("i",null),bold:u.a.createElement("strong",null)}})))),u.a.createElement("div",{style:{textAlign:"left",paddingBottom:i}},u.a.createElement(Kt.a,{variant:"h5",gutterBottom:!0},e("result_title")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},e("result_desc")),u.a.createElement(Kt.a,{variant:"subtitle2",gutterBottom:!0},e("ex_title")),u.a.createElement("div",{style:{paddingLeft:r}},u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},e("assumptions")),u.a.createElement("ul",null,u.a.createElement("li",null,u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"result_a_1",components:{bold:u.a.createElement("strong",null)}}),u.a.createElement(ki,{size:"tiny",type:"text",c12n:t?t.RESTRICTED:null,format:"long"})),u.a.createElement("li",null,u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"result_a_2",components:{bold:u.a.createElement("strong",null)}}),u.a.createElement(ki,{inline:!0,size:"tiny",type:"text",c12n:t?t.UNRESTRICTED:null,format:"long"})),u.a.createElement("li",null,u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"result_a_3",components:{bold:u.a.createElement("strong",null)}}),u.a.createElement(ki,{inline:!0,size:"tiny",type:"text",c12n:t?t.UNRESTRICTED:null,format:"long"})),u.a.createElement("li",null,u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"result_a_4",components:{bold:u.a.createElement("strong",null)}}),u.a.createElement(ki,{size:"tiny",type:"text",c12n:t?t.RESTRICTED:null,format:"long"}))),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"result_a_res_1_p1",components:{bold:u.a.createElement("strong",null)}}),u.a.createElement(ki,{size:"tiny",type:"text",c12n:t?t.RESTRICTED:null,format:"long"}),u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"result_a_res_1_p2",components:{bold:u.a.createElement("strong",null)}}),u.a.createElement(ki,{size:"tiny",type:"text",c12n:t?t.UNRESTRICTED:null,format:"long"}),u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"result_a_res_1_p3",components:{bold:u.a.createElement("strong",null)}})),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"result_a_res_2_p1",components:{bold:u.a.createElement("strong",null)}}),u.a.createElement(ki,{size:"tiny",type:"text",c12n:t?t.RESTRICTED:null,format:"long"}),u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"result_a_res_2_p2",components:{bold:u.a.createElement("strong",null)}})))),u.a.createElement("div",{style:{textAlign:"left"}},u.a.createElement(Kt.a,{variant:"h5",gutterBottom:!0},e("validation_title"))),u.a.createElement("div",{style:{textAlign:"left",paddingBottom:n}},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},e("validation_level")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"validation_level_desc",components:{bold:u.a.createElement("strong",null)}})),u.a.createElement(Kt.a,{variant:"subtitle2",gutterBottom:!0},e("validation_level_supported")),u.a.createElement("ul",null,t?t.original_definition.levels.map((function(e,t){return u.a.createElement("li",{key:t},u.a.createElement(ki,{size:"tiny",type:"text",c12n:e.name,format:"long"})," :: ",e.description)})):Object(oe.a)(Array(2)).map((function(e,t){return u.a.createElement("li",null,u.a.createElement(pr.a,null))})))),u.a.createElement("div",{style:{textAlign:"left",paddingBottom:n}},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},e("validation_required")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"validation_required_desc",components:{bold:u.a.createElement("strong",null)}})),u.a.createElement(Kt.a,{variant:"subtitle2",gutterBottom:!0},e("validation_required_supported")),u.a.createElement("ul",null,t?0!==t.original_definition.required.length?t.original_definition.required.map((function(e,t){return u.a.createElement("li",{key:t},u.a.createElement("div",{style:{display:"inline-block",fontWeight:700}},e.name)," :: ".concat(e.description))})):u.a.createElement(Kt.a,{variant:"body2",color:"secondary"},e("validation_required_none")):Object(oe.a)(Array(2)).map((function(e,t){return u.a.createElement("li",null,u.a.createElement(pr.a,null))})))),u.a.createElement("div",{style:{textAlign:"left",paddingBottom:n}},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},e("validation_groups")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"validation_groups_desc",components:{bold:u.a.createElement("strong",null)}})),u.a.createElement(Kt.a,{variant:"subtitle2",gutterBottom:!0},e("validation_groups_supported")),u.a.createElement("ul",null,t?0!==t.original_definition.groups.length?t.original_definition.groups.map((function(e,t){return u.a.createElement("li",{key:t},u.a.createElement("div",{style:{display:"inline-block",fontWeight:700}},e.name)," :: ".concat(e.description))})):u.a.createElement(Kt.a,{variant:"body2",color:"secondary"},e("validation_groups_none")):Object(oe.a)(Array(2)).map((function(e,t){return u.a.createElement("li",null,u.a.createElement(pr.a,null))}))),u.a.createElement(Kt.a,{variant:"subtitle2",gutterBottom:!0,color:"error"},u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"validation_groups_note",components:{bold:u.a.createElement("strong",null)}}))),u.a.createElement("div",{style:{textAlign:"left"}},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},e("validation_subgroups")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"validation_subgroups_desc",components:{bold:u.a.createElement("strong",null)}})),u.a.createElement(Kt.a,{variant:"subtitle2",gutterBottom:!0},e("validation_subgroups_supported")),u.a.createElement("ul",null,t?0!==t.original_definition.subgroups.length?t.original_definition.subgroups.map((function(e,t){return u.a.createElement("li",{key:t},u.a.createElement("div",{style:{display:"inline-block",fontWeight:700}},e.name)," :: ".concat(e.description))})):u.a.createElement(Kt.a,{variant:"body2",color:"secondary"},e("validation_subgroups_none")):Object(oe.a)(Array(2)).map((function(e,t){return u.a.createElement("li",null,u.a.createElement(pr.a,null))}))),u.a.createElement(Kt.a,{variant:"subtitle2",gutterBottom:!0,color:"error"},u.a.createElement(jd.a,{ns:"helpClassification",i18nKey:"validation_subgroups_note",components:{bold:u.a.createElement("strong",null)}})))):u.a.createElement(zr,null)}function Sd(){var e=dr(),t=Object(o.useState)(null),a=Object(n.a)(t,2),r=a[0],i=a[1],l=Object(o.useState)(null),s=Object(n.a)(l,2),c=s[0],m=s[1],d=Object(X.a)(["helpConfiguration"]).t,p=Object(v.a)(),g=p.spacing(1),f=p.spacing(2);return Object(o.useEffect)((function(){e({url:"/api/v4/help/constants/",onSuccess:function(e){m(e.api_response)}}),e({url:"/api/v4/help/configuration/",onSuccess:function(e){i(e.api_response)}})}),[]),u.a.createElement(Yi,{margin:4},u.a.createElement("div",{style:{textAlign:"left"}},u.a.createElement("div",{style:{marginBottom:p.spacing(4)}},u.a.createElement(Kt.a,{variant:"h4"},d("title"))),u.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},d("tags")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},d("tags.desc")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},d("tags.desc_list")),u.a.createElement("div",{style:{paddingTop:g,paddingBottom:f,display:"flex",flexDirection:"row",flexWrap:"wrap"}},c?c.tag_types.map((function(e,t){return u.a.createElement(mi,{type:"rounded",size:"tiny",key:t,label:e,style:{padding:"5px"}})})):Object(oe.a)(Array(192)).map((function(e,t){return u.a.createElement(pr.a,{key:t,style:{height:"2rem",width:"8rem",marginRight:"3px"}})}))),u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},d("priorities")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},d("priorities.desc")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},d("priorities.desc_list")),u.a.createElement("div",{style:{paddingTop:g,paddingBottom:f}},u.a.createElement(Br.a,{container:!0},c?u.a.createElement(u.a.Fragment,null,Object.keys(c.priorities).map((function(e,t){return u.a.createElement(Br.a,{key:t,item:!0,xs:12,sm:6,md:4,lg:3,xl:2},u.a.createElement("div",{style:{display:"inline-block",fontWeight:500}},e,":\xa0\xa0"),u.a.createElement("div",{style:{display:"inline-block",fontWeight:300}},c.priorities[e]))})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6,md:4,lg:3,xl:2},u.a.createElement("div",{style:{display:"inline-block",fontWeight:500}},d("priorities.max"),":\xa0\xa0"),u.a.createElement("div",{style:{display:"inline-block",fontWeight:300}},c.max_priority))):Object(oe.a)(Array(8)).map((function(e,t){return u.a.createElement(Br.a,{item:!0,key:t,xs:12,sm:6,md:4,lg:3,xl:2},u.a.createElement("div",{style:{display:"inline-block",fontWeight:500}},u.a.createElement(pr.a,{key:t,style:{height:"2rem",width:"5rem",margin:"2px"}})),u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement(pr.a,{key:t,style:{height:"2rem",width:"3rem",margin:"2px"}})))})))),u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},d("file_types")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},d("file_types.desc")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},d("file_types.specific")),u.a.createElement("div",{style:{paddingTop:g,paddingBottom:f}},u.a.createElement(Br.a,{container:!0},c?c.file_types.map((function(e,t){return"*"!==e[0]&&0!==e[1].length?u.a.createElement(Br.a,{key:t,item:!0,xs:12,md:6,lg:4,xl:3},u.a.createElement("div",{style:{display:"inline-block",fontWeight:500}},e[0]),u.a.createElement("div",{style:{display:"inline-block",fontWeight:300}},"\xa0::\xa0",e[1].join(", "))):null})):Object(oe.a)(Array(40)).map((function(e,t){return u.a.createElement(Br.a,{key:t,item:!0,xs:12,md:6,lg:4,xl:3},u.a.createElement("div",{style:{display:"inline-block",fontWeight:500}},u.a.createElement(pr.a,{style:{height:"2rem",width:"4rem",margin:"2px"}})),u.a.createElement("div",{style:{display:"inline-block"}},u.a.createElement(pr.a,{style:{height:"2rem",width:"8rem",margin:"2px"}})))})))),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},d("file_types.non_specific")),u.a.createElement("div",{style:{paddingTop:g,paddingBottom:f}},u.a.createElement(Br.a,{container:!0},c?c.file_types.map((function(e,t){return"*"!==e[0]&&0===e[1].length?u.a.createElement(Br.a,{key:t,item:!0,xs:12,sm:6,md:4,lg:3},u.a.createElement("div",{style:{display:"inline-block",fontWeight:500}},e[0])):null})):Object(oe.a)(Array(60)).map((function(e,t){return u.a.createElement(Br.a,{key:t,item:!0,xs:12,sm:6,md:4,lg:3},u.a.createElement("div",{style:{display:"inline-block",fontWeight:500}},u.a.createElement(pr.a,{style:{height:"2rem",width:"8rem",margin:"2px"}})))})))),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},d("file_types.non_specific_service")),u.a.createElement("div",{style:{paddingTop:g,paddingBottom:f}},c?u.a.createElement("div",{style:{fontWeight:500}},c.file_types[0][1].join(", ")):u.a.createElement(pr.a,{style:{height:"2rem"}})),u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},d("config")),u.a.createElement(Kt.a,{variant:"body2",gutterBottom:!0},d("config.desc")),u.a.createElement("div",{style:{paddingTop:g,paddingBottom:f}},r?Object.keys(r).map((function(e,t){return u.a.createElement(Br.a,{key:t,container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,sm:5,md:4,lg:3,style:{overflowX:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},u.a.createElement("span",{style:{fontWeight:500}},e)),u.a.createElement(Br.a,{item:!0,xs:12,sm:7,md:8,lg:9},u.a.createElement("div",{style:{fontWeight:300}},"object"!==typeof r[e]?u.a.createElement("div",null,String(r[e])):(a=r[e],Array.isArray(a)&&Array.isArray(a[0])?r[e].map((function(e,t){return u.a.createElement("div",{key:t,style:{display:"flex"}},u.a.createElement("div",{style:{fontWeight:500,whiteSpace:"nowrap"}},e[0],":\xa0"),u.a.createElement("div",null,e[1].join(", ")))})):u.a.createElement("div",null,r[e].join(" | "))))));var a})):Object(oe.a)(Array(10)).map((function(e,t){return u.a.createElement(Br.a,{key:t,container:!0,spacing:1},u.a.createElement(Br.a,{key:t,item:!0,xs:12,sm:5,md:4,lg:3},u.a.createElement(pr.a,{style:{height:"2rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:7,md:8,lg:9},u.a.createElement(pr.a,{style:{height:"2rem"}})))}))))))}var Cd=a(433),Td=a.n(Cd),Ad=function(e){var t=e.page,a=Object(X.a)().t,n=Object(v.a)();return u.a.createElement(ir,{width:"65%",margin:4},u.a.createElement("div",{style:{paddingTop:n.spacing(10),fontSize:200}},u.a.createElement(Td.a,{color:"secondary",fontSize:"inherit"})),u.a.createElement("div",{style:{paddingBottom:n.spacing(2)}},u.a.createElement(Kt.a,{variant:"h3"},t)),u.a.createElement("div",null,u.a.createElement(Kt.a,{variant:"h6"},a("under_construction"))))};function Nd(){var e=Object(X.a)(["helpSearch"]).t;return u.a.createElement(Ad,{page:e("title")})}var Id=a(817);function Rd(e){var t=e.service,a=Object(X.a)(["helpServices"]).t,n=Object(v.a)(),r="dark"===n.palette.type,i=n.spacing(1),l=n.spacing(2);return u.a.createElement(cr.a,{style:{minHeight:"240px",backgroundColor:t.enabled?null:r?"#ff000017":"#FFE4E4",border:"solid 1px ".concat(t.enabled?n.palette.divider:r?n.palette.error.light:n.palette.error.dark)}},u.a.createElement(Id.a,{title:t.name,subheader:t.version,action:t.enabled?null:u.a.createElement("div",{style:{padding:l}},u.a.createElement(mi,{type:"rounded",variant:"outlined",size:"small",color:"error",label:a("disabled")})),style:{padding:n.spacing(1)}}),u.a.createElement("div",{style:{padding:i}},u.a.createElement("div",{style:{minHeight:"110px",whiteSpace:"pre-wrap",paddingBottom:n.spacing(1)}},t.description),u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement("label",{style:{fontWeight:500}},a("accepts"),":\xa0\xa0"),u.a.createElement(Kt.a,{variant:"caption",style:{overflowWrap:"anywhere",display:"inline-block"}},t.accepts)),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement("label",{style:{fontWeight:500}},a("rejects"),":\xa0\xa0"),u.a.createElement(Kt.a,{variant:"caption",style:{overflowWrap:"anywhere",display:"inline-block"}},t.rejects)),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement("label",{style:{fontWeight:500}},a("category"),":\xa0\xa0"),u.a.createElement(Kt.a,{variant:"caption",style:{overflowWrap:"anywhere",display:"inline-block"}},t.category)),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement("label",{style:{fontWeight:500}},a("stage"),":\xa0\xa0"),u.a.createElement(Kt.a,{variant:"caption",style:{overflowWrap:"anywhere",display:"inline-block"}},t.stage)))))}function zd(){var e=dr(),t=Object(X.a)(["helpServices"]).t,a=Object(v.a)(),r=Object(o.useState)(null),i=Object(n.a)(r,2),l=i[0],s=i[1];return Object(o.useEffect)((function(){e({url:"/api/v4/service/all/",onSuccess:function(e){s(e.api_response)}})}),[]),u.a.createElement(Yi,{margin:4},u.a.createElement("div",{style:{marginBottom:a.spacing(4)}},u.a.createElement(Kt.a,{variant:"h4"},t("title")),l?u.a.createElement(Kt.a,{variant:"caption"},"".concat(l.length," ").concat(t("count"))):u.a.createElement(pr.a,{width:"8rem"})),l?u.a.createElement(Br.a,{container:!0,spacing:2},l.map((function(e,t){return u.a.createElement(Br.a,{key:t,item:!0,xs:12,md:6,xl:4},u.a.createElement(Rd,{service:e}))}))):u.a.createElement(Br.a,{container:!0,spacing:2},Object(oe.a)(Array(8)).map((function(e,t){return u.a.createElement(Br.a,{key:t,item:!0,xs:12,md:6,xl:4},u.a.createElement(pr.a,{variant:"rect",style:{height:"240px"}}))}))))}var Dd=function(){var e=Object(X.a)(["logout"]).t,t=Object(v.a)(),a=dr(),n=Pa(),r=n.getBanner,i=n.hideMenus;return Object(o.useEffect)((function(){i(),a({url:"/api/v4/auth/logout/",onSuccess:function(){setTimeout((function(){window.location.replace("".concat("","/"))}),500)}})}),[]),u.a.createElement(ur,null,u.a.createElement("div",{style:{textAlign:"center"}},r(t),u.a.createElement("div",{style:{marginBottom:t.spacing(3)}},u.a.createElement(Kt.a,null,e("title"))),u.a.createElement(tr.a,{size:24})))};function Bd(){var e,t=An(),a=[],n=Object(di.a)(t.leftnav.elements);try{for(n.s();!(e=n.n()).done;){var r=e.value;"group"===r.type&&"manage"===r.element.id&&(a=r.element.items)}}catch(i){n.e(i)}finally{n.f()}return u.a.createElement(ir,{margin:4,width:"100%"},u.a.createElement(qi,{items:a}))}var qd=u.a.memo((function(e){var t=e.heuristicResults,a=e.setHeuristicID,n=void 0===a?null:a,r=e.allowSort,i=void 0===r||r,l=Object(X.a)(["search"]),s=l.t,c=l.i18n,o=Ma().c12nDef;return t?0!==t.total?u.a.createElement(qr.a,{component:ua.a},u.a.createElement(Rl,null,u.a.createElement(Nl,null,u.a.createElement(Al,null,u.a.createElement(Cl,{sortField:"heur_id",allowSort:i},s("header.id")),u.a.createElement(Cl,{sortField:"name",allowSort:i},s("header.name")),u.a.createElement(Cl,{sortField:"filetype",allowSort:i},s("header.filetype")),u.a.createElement(Cl,{sortField:"score",allowSort:i},s("header.score")),u.a.createElement(Cl,{sortField:"stats.count",allowSort:i},s("header.hit_count")),u.a.createElement(Cl,{sortField:"stats.last_hit",allowSort:i},s("header.last_hit")),o.enforce&&u.a.createElement(Cl,{sortField:"classification",allowSort:i},s("header.classification")))),u.a.createElement(Il,null,t.items.map((function(e){return u.a.createElement(Tl,{key:e.heur_id,component:Y.b,to:"/manage/heuristic/".concat(e.heur_id),onClick:function(t){n&&(t.preventDefault(),n(e.heur_id))},hover:!0},u.a.createElement(Sl,null,e.heur_id),u.a.createElement(Sl,null,e.name),u.a.createElement(Sl,null,e.filetype),u.a.createElement(Sl,null,e.score),u.a.createElement(Sl,null,e.stats&&e.stats.count||0),u.a.createElement(Sl,null,e.stats&&e.stats.last_hit?u.a.createElement(Dl.a,{fromNow:!0,locale:c.language},e.stats.last_hit):s("never")),o.enforce&&u.a.createElement(Sl,null,u.a.createElement(ki,{type:"text",size:"tiny",c12n:e.classification,format:"short"})))}))))):u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(Ll,null,u.a.createElement(wl.a,null,s("no_heuristics_title")),s("no_results_desc"))):u.a.createElement(pr.a,{variant:"rect",style:{height:"6rem",borderRadius:"4px"}})})),Ld=a(209),Fd=a.n(Ld),Pd=a(434),Md=function(e){var t=e.data,a=e.height,r=e.title,i=e.isDate,l=Object(v.a)(),s=Object(o.useState)(5),c=Object(n.a)(s,2),m=c[0],d=c[1],p=Object(o.useState)(null),g=Object(n.a)(p,2),f=g[0],b=g[1],E={maintainAspectRatio:!1,responsive:!0,scales:{xAxes:[{gridLines:{display:!1,drawBorder:!0},ticks:{fontColor:l.palette.text.secondary},time:i?{unit:"day"}:null,type:i?"time":null}],yAxes:[{ticks:{beginAtZero:!0,suggestedMax:m,fontColor:l.palette.text.secondary,precision:0}}]},title:r?{display:!0,text:r,fontColor:l.palette.text.primary,fontFamily:"Roboto",fontSize:14}:null};return Object(o.useEffect)((function(){if(t){var e=[],a=m;t.datasets.forEach((function(t){a=Math.max.apply(Math,[a].concat(Object(oe.a)(Object.values(t.data)))),e.push(Object(h.a)(Object(h.a)({},t),{},{backgroundColor:l.palette.primary.dark,borderColor:l.palette.primary.light,borderWidth:1,hoverBackgroundColor:l.palette.primary.main}))})),d(a),b(Object(h.a)(Object(h.a)({},t),{},{datasets:e}))}}),[t,l]),f?u.a.createElement(Pd.Line,{redraw:!0,data:f,legend:{display:!1},height:a,options:E}):u.a.createElement(pr.a,{variant:"rect",height:a})};Md.defaultProps={title:null,height:null,isDate:!1};var Wd=u.a.memo(Md),Ud=u.a.memo((function(e){var t=e.resultResults,a=e.allowSort,n=void 0===a||a,r=Object(X.a)(["search"]),i=r.t,l=r.i18n,s=Ma().c12nDef;return t?0!==t.total?u.a.createElement(qr.a,{component:ua.a},u.a.createElement(Rl,null,u.a.createElement(Nl,null,u.a.createElement(Al,null,u.a.createElement(Cl,{sortField:"created",allowSort:n},i("header.created")),u.a.createElement(Cl,{sortField:"result.score",allowSort:n},i("header.verdict")),u.a.createElement(Cl,{sortField:"id",allowSort:n},i("header.sha256")),u.a.createElement(Cl,{sortField:"response.service_name",allowSort:n},i("header.service")),s.enforce&&u.a.createElement(Cl,{sortField:"classification",allowSort:n},i("header.classification")))),u.a.createElement(Il,null,t.items.map((function(e){return u.a.createElement(Tl,{key:e.id,component:Y.b,to:"/file/detail/".concat(e.id.substring(0,64)),hover:!0,style:{textDecoration:"none"}},u.a.createElement(Sl,null,u.a.createElement(I.a,{title:e.created},u.a.createElement(Dl.a,{fromNow:!0,locale:l.language},e.created))),u.a.createElement(Sl,null,u.a.createElement(Cc,{score:e.result.score,fullWidth:!0})),u.a.createElement(Sl,{style:{wordBreak:"break-word"}},e.id.substring(0,64)),u.a.createElement(Sl,null,e.response.service_name),s.enforce&&u.a.createElement(Sl,null,u.a.createElement(ki,{type:"text",size:"tiny",c12n:e.classification,format:"short"})))}))))):u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(Ll,null,u.a.createElement(wl.a,null,i("no_results_title")),i("no_results_desc"))):u.a.createElement(pr.a,{variant:"rect",style:{height:"6rem",borderRadius:"4px"}})})),Hd=Object(i.a)((function(e){return{preview:{margin:0,padding:"".concat(e.spacing(.75),"px ").concat(e.spacing(1),"px"),whiteSpace:"pre-wrap",wordBreak:"break-word"},drawerPaper:Object(r.a)({maxWidth:"1200px"},e.breakpoints.down("sm"),{width:"100%"}),buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})),Vd=function(e){var t=e.heur_id,a=Object(X.a)(["manageHeuristicDetail"]),r=a.t,i=a.i18n,l=Object(ue.i)().id,s=Object(v.a)(),c=Object(o.useState)(null),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Object(o.useState)(null),f=Object(n.a)(g,2),h=f[0],b=f[1],E=Object(o.useState)(null),y=Object(n.a)(E,2),O=y[0],_=y[1],x=Object(o.useState)(null),w=Object(n.a)(x,2),j=w[0],k=w[1],S=dr(),C=Hd(),T=Ma().c12nDef;return Object(o.useEffect)((function(){S({url:"/api/v4/heuristics/".concat(t||l,"/"),onSuccess:function(e){p(e.api_response)}})}),[t,l]),Object(o.useEffect)((function(){d&&(d.stats?b(d.stats):S({method:"POST",url:"/api/v4/search/stats/result/result.score/",body:{query:"result.sections.heuristic.heur_id:".concat(t||l)},onSuccess:function(e){b(e.api_response)}}),S({method:"POST",url:"/api/v4/search/histogram/result/created/",body:{query:"result.sections.heuristic.heur_id:".concat(t||l),mincount:0,start:"now-30d/d",end:"now+1d/d-1s",gap:"+1d"},onSuccess:function(e){var a={labels:Object.keys(e.api_response).map((function(e){return e.replace("T00:00:00.000Z","")})),datasets:[{label:t||l,data:Object.values(e.api_response)}]};_(a)}}),S({method:"GET",url:"/api/v4/search/result/?query=result.sections.heuristic.heur_id:".concat(t||l,"&rows=10"),onSuccess:function(e){k(e.api_response)}}))}),[d]),u.a.createElement(ir,{margin:l?4:2,width:"100%"},T.enforce&&u.a.createElement("div",{style:{paddingBottom:s.spacing(4)}},u.a.createElement(ki,{size:"tiny",c12n:d?d.classification:null})),u.a.createElement("div",{style:{textAlign:"left"}},u.a.createElement("div",{style:{paddingBottom:s.spacing(4)}},u.a.createElement(Br.a,{container:!0,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement(Kt.a,{variant:"h4"},r("title")),u.a.createElement(Kt.a,{variant:"caption"},d?d.heur_id:u.a.createElement(pr.a,{style:{width:"10rem"}}))),u.a.createElement(Br.a,{item:!0,xs:!0,style:{textAlign:"right",flexGrow:0}},d?u.a.createElement(I.a,{title:r("usage")},u.a.createElement(Z.a,{component:Y.b,style:{color:s.palette.action.active},to:'/search/result/?query=result.sections.heuristic.heur_id:"'.concat(d.heur_id,'"')},u.a.createElement(Fd.a,null))):u.a.createElement(pr.a,{variant:"circle",height:"2.5rem",width:"2.5rem",style:{margin:s.spacing(.5)}})))),u.a.createElement(Br.a,{container:!0,spacing:3},u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},r("name")),d?u.a.createElement(ua.a,{component:"pre",variant:"outlined",className:C.preview},d.name):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},r("filetype")),d?u.a.createElement(ua.a,{component:"pre",variant:"outlined",className:C.preview},d.filetype):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},r("desc")),d?u.a.createElement(ua.a,{component:"pre",variant:"outlined",className:C.preview},d.description):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6,md:4},u.a.createElement(Kt.a,{variant:"subtitle2"},r("score")),d?u.a.createElement(ua.a,{component:"pre",variant:"outlined",className:C.preview},d.score):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6,md:4},u.a.createElement(Kt.a,{variant:"subtitle2"},r("max_score")),d?u.a.createElement(ua.a,{component:"pre",variant:"outlined",className:C.preview},d.max_score||r("no_max")):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6,md:4},u.a.createElement(Kt.a,{variant:"subtitle2"},r("attack_id")),d?u.a.createElement(ua.a,{component:"pre",variant:"outlined",className:C.preview},d.attack_id&&0!==d.attack_id.length?d.attack_id.join(", "):r("no_attack_id")):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},r("signature_score_map")),d?u.a.createElement(ua.a,{component:"pre",variant:"outlined",className:C.preview},d.signature_score_map&&0!==Object.keys(d.signature_score_map).length?u.a.createElement(Br.a,{container:!0,spacing:1},Object.keys(d.signature_score_map).map((function(e,t){return u.a.createElement(Br.a,{key:t,item:!0,xs:!0},"".concat(e," = ").concat(d.signature_score_map[e]))}))):r("no_sigs")):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"h6"},r("statistics"))),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle1",style:{fontWeight:600,fontStyle:"italic"}},r("hits")),u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},r("hit.count"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},d&&h?h.count:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},r("hit.first"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},d&&h?h.first_hit?u.a.createElement(Dl.a,{fromNow:!0,locale:i.language},h.first_hit):r("hit.none"):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},r("hit.last"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},d&&h?h.last_hit?u.a.createElement(Dl.a,{fromNow:!0,locale:i.language},h.last_hit):r("hit.none"):u.a.createElement(pr.a,null)))),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle1",style:{fontWeight:600,fontStyle:"italic"}},r("contribution")),u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},r("score.min"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},d&&h?h.min:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},r("score.avg"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},d&&h?Number(h.avg).toFixed(0):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},r("score.max"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},d&&h?h.max:u.a.createElement(pr.a,null)))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Wd,{data:O,height:300,isDate:!0,title:r("chart.title")})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"h6"},r("last10"))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Ud,{resultResults:j,allowSort:!1})))))};Vd.defaultProps={heur_id:null};var Gd=Vd,Yd=Object(i.a)((function(e){return{searchresult:{fontStyle:"italic",paddingTop:e.spacing(.5),display:"flex",flexWrap:"wrap"},drawerPaper:Object(r.a)({width:"80%",maxWidth:"800px"},e.breakpoints.down("sm"),{width:"100%"})}}));function Jd(){var e=Object(X.a)(["manageHeuristics"]).t,t=Object(o.useState)(25),a=Object(n.a)(t,1)[0],r=Object(o.useState)(!1),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Ma().indexes,m=Object(o.useState)(null),d=Object(n.a)(m,2),p=d[0],g=d[1],f=Object(ue.h)(),h=Object(o.useState)(null),b=Object(n.a)(h,2),E=b[0],y=b[1],O=Object(ue.g)(),_=Object(v.a)(),x=dr(),w=Yd(),j=el().setGlobalDrawer,k=Object(o.useState)([].concat(Object(oe.a)(Object.keys(c.heuristic).filter((function(e){return c.heuristic[e].indexed}))),Object(oe.a)(pl))),S=Object(n.a)(k,1)[0],C=Object(o.useRef)("");Object(o.useEffect)((function(){y(new Ol(f.search,"query=*&rows=".concat(a,"&offset=0")))}),[f.pathname,f.search,a]),Object(o.useEffect)((function(){E&&(E.set("rows",25),E.set("offset",0),s(!0),x({method:"POST",url:"/api/v4/search/heuristic/",body:E.getParams(),onSuccess:function(e){g(e.api_response)},onFinalize:function(){s(!1)}}))}),[E]);var T=Object(o.useCallback)((function(){O.push(f.pathname)}),[f.pathname]),A=Object(o.useCallback)((function(){""!==C.current?(E.set("query",C.current),O.push("".concat(f.pathname,"?").concat(E.toString()))):T()}),[E,f.pathname,T]),N=function(e){C.current=e},I=Object(o.useCallback)((function(e){j(u.a.createElement(Gd,{heur_id:e}))}),[]);return u.a.createElement(Yi,{margin:4},Object(o.useMemo)((function(){return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{paddingBottom:_.spacing(2)}},u.a.createElement(Kt.a,{variant:"h4"},e("title"))),u.a.createElement(Ji,{isSticky:!0},u.a.createElement("div",{style:{paddingTop:_.spacing(1)}},u.a.createElement(vl,{initValue:E?E.get("query",""):"",placeholder:e("filter"),searching:l,suggestions:S,onValueChange:N,onClear:T,onSearch:A},null!==p&&u.a.createElement("div",{className:w.searchresult},0!==p.total&&u.a.createElement(Kt.a,{variant:"subtitle1",color:"secondary",style:{flexGrow:1}},l?u.a.createElement("span",null,e("searching")):u.a.createElement("span",null,p.total,"\xa0",E.get("query")?e("filtered".concat(1===p.total?"":"s")):e("total".concat(1===p.total?"":"s")))),u.a.createElement(xl,{total:p.total,setResults:g,pageSize:a,index:"heuristic",query:E,setSearching:s}))))))}),[w.searchresult,p,T,A,a,E,l,S,e,_]),u.a.createElement("div",{style:{paddingTop:_.spacing(2),paddingLeft:_.spacing(.5),paddingRight:_.spacing(.5)}},u.a.createElement(qd,{heuristicResults:p,setHeuristicID:I})))}var Qd=a(435),Kd=a.n(Qd),Xd={DEPLOYED:"success",NOISY:"info",DISABLED:"error"},Zd=u.a.memo((function(e){var t=e.status,a=e.fullWidth,n=void 0===a||a,r=e.onClick,i=void 0===r?null:r,l=Object(X.a)().t;return u.a.createElement(mi,{size:"tiny",fullWidth:n,color:Xd[t],label:l("signature.status.".concat(t)),onClick:i})})),$d=u.a.memo((function(e){var t=e.signatureResults,a=e.setSignatureID,n=void 0===a?null:a,r=e.allowSort,i=void 0===r||r,l=Object(X.a)(["search"]),s=l.t,c=l.i18n,o=Ma().c12nDef;return t?0!==t.total?u.a.createElement(qr.a,{component:ua.a},u.a.createElement(Rl,null,u.a.createElement(Nl,null,u.a.createElement(Al,null,u.a.createElement(Cl,{sortField:"type",allowSort:i},s("header.type")),u.a.createElement(Cl,{sortField:"source",allowSort:i},s("header.source")),u.a.createElement(Cl,{sortField:"name",allowSort:i},s("header.name")),u.a.createElement(Cl,{sortField:"stats.count",allowSort:i},s("header.hit_count")),u.a.createElement(Cl,{sortField:"stats.last_hit",allowSort:i},s("header.last_hit")),o.enforce&&u.a.createElement(Cl,{sortField:"classification",allowSort:i},s("header.classification")),u.a.createElement(Cl,{sortField:"status",allowSort:i},s("header.status")))),u.a.createElement(Il,null,t.items.map((function(e){return u.a.createElement(Tl,{key:e.signature_id,component:Y.b,to:"/manage/signature/".concat(e.id),onClick:function(t){n&&(t.preventDefault(),n(e.id))},hover:!0},u.a.createElement(Sl,null,e.type),u.a.createElement(Sl,null,e.source),u.a.createElement(Sl,null,e.name),u.a.createElement(Sl,null,e.stats&&e.stats.count||0),u.a.createElement(Sl,null,e.stats&&e.stats.last_hit?u.a.createElement(Dl.a,{fromNow:!0,locale:c.language},e.stats.last_hit):s("never")),o.enforce&&u.a.createElement(Sl,null,u.a.createElement(ki,{type:"text",size:"tiny",c12n:e.classification,format:"short"})),u.a.createElement(Sl,null,u.a.createElement(Zd,{status:e.status})))}))))):u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(Ll,null,u.a.createElement(wl.a,null,s("no_signatures_title")),s("no_results_desc"))):u.a.createElement(pr.a,{variant:"rect",style:{height:"6rem",borderRadius:"4px"}})})),ep=Object(i.a)((function(e){return{preview:{padding:e.spacing(2),whiteSpace:"pre-wrap",wordBreak:"break-word"},stats:{margin:0,padding:"".concat(e.spacing(.75),"px ").concat(e.spacing(1),"px")},openPaper:Object(r.a)({maxWidth:"1200px"},e.breakpoints.down("sm"),{width:"100%"}),buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})),tp=function(e){var t=e.signature_id,a=e.onUpdated,r=e.onDeleted,i=Object(X.a)(["manageSignatureDetail"]),l=i.t,s=i.i18n,c=Object(ue.i)().id,m=Object(v.a)(),d=Object(o.useState)(null),p=Object(n.a)(d,2),g=p[0],f=p[1],b=Object(o.useState)(null),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Object(o.useState)(null),x=Object(n.a)(_,2),w=x[0],j=x[1],k=Object(o.useState)(null),S=Object(n.a)(k,2),C=S[0],T=S[1],A=Object(o.useState)(!1),N=Object(n.a)(A,2),R=N[0],z=N[1],D=Object(o.useState)(!1),B=Object(n.a)(D,2),q=B[0],L=B[1],F=Object(o.useState)(!1),P=Object(n.a)(F,2),M=P[0],W=P[1],U=Object(o.useState)(!1),H=Object(n.a)(U,2),V=H[0],G=H[1],J=Object(ue.g)(),Q=$n().showSuccessMessage,K=dr(),$=ep(),ee=Ma(),te=ee.user,ae=ee.c12nDef;Object(o.useEffect)((function(){(t||c)&&K({url:"/api/v4/signature/".concat(t||c,"/"),onSuccess:function(e){f(e.api_response)}})}),[t,c]),Object(o.useEffect)((function(){g&&(g.stats?O(g.stats):K({method:"POST",url:"/api/v4/search/stats/result/result.score/",body:{query:"result.sections.tags.file.rule.".concat(g.type,':"').concat(g.source,".").concat(g.name,'"')},onSuccess:function(e){O(e.api_response)}}),K({method:"POST",url:"/api/v4/search/histogram/result/created/",body:{query:"result.sections.tags.file.rule.".concat(g.type,':"').concat(g.source,".").concat(g.name,'"'),mincount:0,start:"now-30d/d",end:"now+1d/d-1s",gap:"+1d"},onSuccess:function(e){var a={labels:Object.keys(e.api_response).map((function(e){return e.replace("T00:00:00.000Z","")})),datasets:[{label:t||c,data:Object.values(e.api_response)}]};j(a)}}),K({method:"GET",url:"/api/v4/search/result/?query=result.sections.tags.file.rule.".concat(g.type,':"').concat(g.source,".").concat(g.name,'"&rows=10'),onSuccess:function(e){T(e.api_response)}}))}),[g]);var ne=function(){z(!1)};return u.a.createElement(ir,{margin:c?4:2,width:"100%"},u.a.createElement(Si,{open:q,handleClose:function(){return L(!1)},handleAccept:function(){ne(),K({url:"/api/v4/signature/".concat(t||c,"/"),method:"DELETE",onSuccess:function(){Q(l("delete.success")),c&&setTimeout((function(){return J.push("/manage/signatures")}),1e3),r()}})},title:l("delete.title"),cancelText:l("delete.cancelText"),acceptText:l("delete.acceptText"),text:l("delete.text")}),u.a.createElement(Xr.a,{open:R,onClose:ne,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},u.a.createElement(Zr.a,{id:"alert-dialog-title"},l("change.title")),u.a.createElement($r.a,null,u.a.createElement("p",null,l("change.warning")),u.a.createElement("ul",null,u.a.createElement("li",null,l("change.warning.1")),u.a.createElement("li",null,l("change.warning.2"))),u.a.createElement("div",null,l("change.warning.action")),g?u.a.createElement(Qr.a,{fullWidth:!0,onChange:function(e){G(!0),f(Object(h.a)(Object(h.a)({},g),{},{status:e.target.value})),ne()},variant:"outlined",margin:"dense",value:g.status},u.a.createElement(Kr.a,{value:"DEPLOYED"},l("status.DEPLOYED")),u.a.createElement(Kr.a,{value:"NOISY"},l("status.NOISY")),u.a.createElement(Kr.a,{value:"DISABLED"},l("status.DISABLED"))):u.a.createElement(pr.a,{height:2})),u.a.createElement(ti.a,null,u.a.createElement(ma.a,{onClick:ne,color:"primary"},l("change.close")))),ae.enforce&&u.a.createElement("div",{style:{paddingBottom:m.spacing(4)}},u.a.createElement(ki,{size:"tiny",c12n:g?g.classification:null})),u.a.createElement("div",{style:{textAlign:"left"}},u.a.createElement(Br.a,{container:!0,alignItems:"center",spacing:3},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement(Kt.a,{variant:"h4"},l("title")),u.a.createElement(Kt.a,{variant:"caption"},g?"".concat(g.type,"_").concat(g.source,"_").concat(g.signature_id):u.a.createElement(pr.a,{style:{width:"10rem"}}))),u.a.createElement(Br.a,{item:!0,xs:!0,style:{textAlign:"right",flexGrow:0}},g?u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{display:"flex",marginBottom:m.spacing(1),justifyContent:"flex-end"}},u.a.createElement(I.a,{title:l("usage")},u.a.createElement(Z.a,{component:Y.b,style:{color:m.palette.action.active},to:"/search/result/?query=result.sections.tags.file.rule.".concat(g.type,':"').concat(g.source,".").concat(g.name,'"')},u.a.createElement(Fd.a,null))),(te.is_admin||-1!==te.roles.indexOf("signature_manager"))&&u.a.createElement(I.a,{title:l("remove")},u.a.createElement(Z.a,{style:{color:"dark"===m.palette.type?m.palette.error.light:m.palette.error.dark},onClick:function(){L(!0)}},u.a.createElement(Jl.a,null)))),u.a.createElement(Zd,{status:g.status,onClick:te.is_admin||-1!==te.roles.indexOf("signature_manager")?function(){return z(!0)}:null})):u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{display:"flex"}},u.a.createElement(pr.a,{variant:"circle",height:"2.5rem",width:"2.5rem",style:{margin:m.spacing(.5)}}),u.a.createElement(pr.a,{variant:"circle",height:"2.5rem",width:"2.5rem",style:{margin:m.spacing(.5)}})),u.a.createElement(pr.a,{variant:"rect",height:"1rem",width:"6rem",style:{marginBottom:m.spacing(1),marginTop:m.spacing(1),borderRadius:m.spacing(1)}}))),u.a.createElement(Br.a,{item:!0,xs:12},g?u.a.createElement(ua.a,{component:"pre",variant:"outlined",className:$.preview},g.data):u.a.createElement(pr.a,{variant:"rect",height:"6rem"})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"h6"},l("statistics"))),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle1",style:{fontWeight:600,fontStyle:"italic"}},l("hits")),u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},l("hit.count"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},g&&y?y.count:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},l("hit.first"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},g&&y?y.first_hit?u.a.createElement(Dl.a,{fromNow:!0,locale:s.language},y.first_hit):l("hit.none"):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},l("hit.last"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},g&&y?y.last_hit?u.a.createElement(Dl.a,{fromNow:!0,locale:s.language},y.last_hit):l("hit.none"):u.a.createElement(pr.a,null)))),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle1",style:{fontWeight:600,fontStyle:"italic"}},l("contribution")),u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},l("score.min"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},g&&y?y.min:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},l("score.avg"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},g&&y?Number(y.avg).toFixed(0):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:3,sm:4,md:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},l("score.max"))),u.a.createElement(Br.a,{item:!0,xs:9,sm:8,md:9,lg:10},g&&y?y.max:u.a.createElement(pr.a,null)))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Wd,{data:w,height:300,isDate:!0,title:l("chart.title")})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"h6"},l("last10"))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Ud,{resultResults:C,allowSort:!1}))),g&&V?u.a.createElement("div",{style:{paddingTop:c?m.spacing(1):m.spacing(2),paddingBottom:c?m.spacing(1):m.spacing(2),position:c?"fixed":"inherit",bottom:c?0:"inherit",left:c?0:"inherit",width:c?"100%":"inherit",textAlign:c?"center":"right",zIndex:c?m.zIndex.drawer-1:"auto",backgroundColor:c?m.palette.background.default:"inherit",boxShadow:c?m.shadows[4]:"inherit"}},u.a.createElement(ma.a,{variant:"contained",color:"primary",disabled:M,onClick:function(){K({url:"/api/v4/signature/change_status/".concat(t||c,"/").concat(g.status,"/"),onSuccess:function(){Q(l("change.success")),G(!1),a()},onEnter:function(){return W(!0)},onExit:function(){return W(!1)}})}},l("change.save"),M&&u.a.createElement(tr.a,{size:24,className:$.buttonProgress}))):null))};tp.defaultProps={signature_id:null,onUpdated:function(){},onDeleted:function(){}};var ap=tp,np=Object(i.a)((function(e){return{searchresult:{fontStyle:"italic",paddingTop:e.spacing(.5),display:"flex",flexWrap:"wrap"},drawerPaper:Object(r.a)({width:"80%",maxWidth:"800px"},e.breakpoints.down("sm"),{width:"100%"})}}));function rp(){var e=Object(X.a)(["manageSignatures"]).t,t=Object(o.useState)(25),a=Object(n.a)(t,1)[0],r=Object(o.useState)(!1),i=Object(n.a)(r,2),s=i[0],c=i[1],m=Ma().indexes,d=Object(o.useState)(null),p=Object(n.a)(d,2),g=p[0],f=p[1],h=Object(ue.h)(),b=Object(o.useState)(null),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Object(ue.g)(),x=Object(v.a)(),w=dr(),j=np(),k=el(),S=k.closeGlobalDrawer,C=k.setGlobalDrawer,T=Object(l.a)(x.breakpoints.up("md")),A=Object(l.a)(x.breakpoints.only("xl")),N=Object(o.useState)([].concat(Object(oe.a)(Object.keys(m.signature).filter((function(e){return m.signature[e].indexed}))),Object(oe.a)(pl))),R=Object(n.a)(N,1)[0],z=Object(o.useRef)("");Object(o.useEffect)((function(){O(new Ol(h.search,"query=*&rows=".concat(a,"&offset=0")))}),[h.pathname,h.search,a]),Object(o.useEffect)((function(){y&&D(0)}),[y]),Object(o.useEffect)((function(){function e(){D(g?g.offset:0)}return window.addEventListener("reloadSignatures",e),function(){window.removeEventListener("reloadSignatures",e)}}),[y,g]);var D=function e(t){y.set("rows",25),y.set("offset",t),w({method:"POST",url:"/api/v4/search/signature/",body:y.getParams(),onSuccess:function(t){0===t.api_response.items.length&&0!==t.api_response.offset&&t.api_response.offset>=t.api_response.total?e(Math.max(0,t.api_response.offset-t.api_response.rows)):f(t.api_response)},onEnter:function(){return c(!0)},onExit:function(){return c(!1)}})},B=Object(o.useCallback)((function(){_.push(h.pathname)}),[h.pathname]),q=Object(o.useCallback)((function(){""!==z.current?(y.set("query",z.current),_.push("".concat(h.pathname,"?").concat(y.toString()))):B()}),[y,h.pathname,B]),L=function(e){z.current=e},F=Object(o.useCallback)((function(e){C(u.a.createElement(ap,{signature_id:e,onUpdated:P,onDeleted:M}))}),[y]),P=function(){A||S(),setTimeout((function(){return window.dispatchEvent(new CustomEvent("reloadSignatures"))}),1e3)},M=function(){S(),setTimeout((function(){return window.dispatchEvent(new CustomEvent("reloadSignatures"))}),1e3)};return u.a.createElement(Yi,{margin:4},Object(o.useMemo)((function(){return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{paddingBottom:x.spacing(2)}},u.a.createElement(Br.a,{container:!0,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement(Kt.a,{variant:"h4"},e("title"))),u.a.createElement(Br.a,{item:!0,xs:!0,style:{textAlign:"right"}},u.a.createElement(I.a,{title:e("download_desc")},u.a.createElement(Z.a,{component:$t.a,style:{color:x.palette.action.active},href:"/api/v4/signature/download/?query=".concat(y?y.get("query","*"):"*")},u.a.createElement(Ju.a,null)))))),u.a.createElement(Ji,{isSticky:!0},u.a.createElement("div",{style:{paddingTop:x.spacing(1)}},u.a.createElement(vl,{initValue:y?y.get("query",""):"",placeholder:e("filter"),searching:s,suggestions:R,onValueChange:L,onClear:B,onSearch:q,buttons:[{icon:u.a.createElement(Kd.a,{fontSize:T?"default":"small"}),tooltip:e("noisy"),props:{onClick:function(){y.set("query","status:NOISY"),_.push("".concat(h.pathname,"?").concat(y.getDeltaString()))}}},{icon:u.a.createElement(zn.a,{fontSize:T?"default":"small"}),tooltip:e("disabled"),props:{onClick:function(){y.set("query","status:DISABLED"),_.push("".concat(h.pathname,"?").concat(y.getDeltaString()))}}}]},null!==g&&u.a.createElement("div",{className:j.searchresult},0!==g.total&&u.a.createElement(Kt.a,{variant:"subtitle1",color:"secondary",style:{flexGrow:1}},s?u.a.createElement("span",null,e("searching")):u.a.createElement("span",null,g.total,"\xa0",y.get("query")?e("filtered".concat(1===g.total?"":"s")):e("total".concat(1===g.total?"":"s")))),u.a.createElement(xl,{total:g.total,setResults:f,pageSize:a,index:"signature",query:y,setSearching:c}))))))}),[j.searchresult,_,h.pathname,B,q,a,y,s,g,R,e,x,T]),u.a.createElement("div",{style:{paddingTop:x.spacing(2),paddingLeft:x.spacing(.5),paddingRight:x.spacing(.5)}},u.a.createElement($d,{signatureResults:g,setSignatureID:F})))}var ip=a(436),lp=a.n(ip),sp=a(437),cp=a.n(sp),op=u.a.memo((function(e){var t=e.workflowResults,a=e.setWorkflowID,n=void 0===a?null:a,r=Object(X.a)(["search"]),i=r.t,l=r.i18n,s=Ma().c12nDef;return t?0!==t.total?u.a.createElement(qr.a,{component:ua.a},u.a.createElement(Rl,null,u.a.createElement(Nl,null,u.a.createElement(Al,null,u.a.createElement(Cl,{sortField:"creation_date"},i("header.created")),u.a.createElement(Cl,{sortField:"last_seen"},i("header.lasttimeseen")),u.a.createElement(Cl,{sortField:"name"},i("header.name")),u.a.createElement(Cl,{sortField:"priority"},i("header.priority")),u.a.createElement(Cl,{sortField:"status"},i("header.status")),u.a.createElement(Cl,{sortField:"hit_count"},i("header.hit_count")),s.enforce&&u.a.createElement(Cl,{sortField:"classification"},i("header.classification")))),u.a.createElement(Il,null,t.items.map((function(e){return u.a.createElement(Tl,{key:e.workflow_id,component:Y.b,to:"/manage/workflow/".concat(e.workflow_id),onClick:function(t){n&&(t.preventDefault(),n(e.workflow_id))},hover:!0},u.a.createElement(Sl,null,u.a.createElement(Dl.a,{fromNow:!0,locale:l.language},e.creation_date)),u.a.createElement(Sl,null,e.last_seen&&u.a.createElement(Dl.a,{fromNow:!0,locale:l.language},e.last_seen)),u.a.createElement(Sl,null,e.name),u.a.createElement(Sl,null,e.priority),u.a.createElement(Sl,null,e.status),u.a.createElement(Sl,null,e.hit_count),s.enforce&&u.a.createElement(Sl,null,u.a.createElement(ki,{type:"text",size:"tiny",c12n:e.classification,format:"short"})))}))))):u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(Ll,null,u.a.createElement(wl.a,null,i("no_workflows_title")),i("no_results_desc"))):u.a.createElement(pr.a,{variant:"rect",style:{height:"6rem",borderRadius:"4px"}})})),up=["PHISHING","CRIME","ATTRIBUTED","WHITELISTED","FALSE_POSITIVE","REPORTED","MITIGATED","PENDING"],mp=Object(Dr.a)((function(e){return Object(G.a)({root:{minHeight:e.spacing(4)}})}))(Kr.a),dp=Object(i.a)((function(e){return{buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})),pp=function(e){var t=e.workflow_id,a=e.close,r=Object(X.a)(["manageWorkflowDetail"]),i=r.t,l=r.i18n,s=Object(ue.i)().id,c=Object(v.a)(),m=Object(o.useState)(null),d=Object(n.a)(m,2),p=d[0],g=d[1],f=Object(o.useState)(!1),b=Object(n.a)(f,2),E=b[0],y=b[1],O=Object(o.useState)(!1),_=Object(n.a)(O,2),x=_[0],w=_[1],j=Object(o.useState)(!1),k=Object(n.a)(j,2),S=k[0],C=k[1],T=Ma().c12nDef,A=$n().showSuccessMessage,N=dr(),R=dp(),z=Object(ue.g)(),D={classification:T.UNRESTRICTED,hit_count:0,labels:[],name:"",priority:"",query:"",status:""};Object(o.useEffect)((function(){t||s?N({url:"/api/v4/workflow/".concat(t||s,"/"),onSuccess:function(e){g(Object(h.a)(Object(h.a)({},e.api_response),{},{status:e.api_response.status||"",priority:e.api_response.priority||""}))}}):g(Object(h.a)({},D))}),[t,s]);return u.a.createElement(ir,{margin:s?4:2,width:"100%"},u.a.createElement(Si,{open:S,handleClose:function(){return C(!1)},handleAccept:function(){N({url:"/api/v4/workflow/".concat(t||s,"/"),method:"DELETE",onSuccess:function(){C(!1),A(i("delete.success")),s&&setTimeout((function(){return z.push("/manage/workflows")}),1e3),setTimeout((function(){return window.dispatchEvent(new CustomEvent("reloadWorkflows"))}),1e3),a()}})},title:i("delete.title"),cancelText:i("delete.cancelText"),acceptText:i("delete.acceptText"),text:i("delete.text")}),T.enforce&&u.a.createElement("div",{style:{paddingBottom:c.spacing(4)}},u.a.createElement(ki,{type:"picker",c12n:p?p.classification:null,setClassification:function(e){y(!0),g(Object(h.a)(Object(h.a)({},p),{},{classification:e}))}})),u.a.createElement("div",{style:{textAlign:"left"}},u.a.createElement("div",{style:{paddingBottom:c.spacing(4)}},u.a.createElement(Br.a,{container:!0,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement(Kt.a,{variant:"h4"},i(t||s?"title":"add.title")),u.a.createElement(Kt.a,{variant:"caption"},p?p.workflow_id:u.a.createElement(pr.a,{style:{width:"10rem"}}))),(t||s)&&u.a.createElement(Br.a,{item:!0,xs:!0,style:{textAlign:"right",flexGrow:0}},p?u.a.createElement(I.a,{title:i("remove")},u.a.createElement(Z.a,{style:{color:"dark"===c.palette.type?c.palette.error.light:c.palette.error.dark},onClick:function(){return C(!0)}},u.a.createElement(Jl.a,null))):u.a.createElement(pr.a,{variant:"circle",height:"2.5rem",width:"2.5rem",style:{margin:c.spacing(.5)}})))),u.a.createElement(Br.a,{container:!0,spacing:2},u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},i("name")),p?u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){y(!0),g(Object(h.a)(Object(h.a)({},p),{},{name:e.target.value}))},value:p.name}):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},i("query")),p?u.a.createElement(hr.a,{fullWidth:!0,size:"small",margin:"dense",variant:"outlined",onChange:function(e){y(!0),g(Object(h.a)(Object(h.a)({},p),{},{query:e.target.value}))},value:p.query}):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement(Kt.a,{variant:"subtitle2"},i("labels")),p?u.a.createElement(Ro.a,{fullWidth:!0,multiple:!0,freeSolo:!0,options:up,value:p.labels,renderInput:function(e){return u.a.createElement(hr.a,Object.assign({},e,{variant:"outlined"}))},onChange:function(e,t){return a=t,y(!0),void g(Object(h.a)(Object(h.a)({},p),{},{labels:a.map((function(e){return e.toUpperCase()}))}));var a}}):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},i("priority")),p?u.a.createElement(Qr.a,{id:"priority",fullWidth:!0,value:p.priority,onChange:function(e){y(!0),g(Object(h.a)(Object(h.a)({},p),{},{priority:e.target.value}))},variant:"outlined",margin:"dense"},u.a.createElement(mp,{value:""},i("priority.null")),u.a.createElement(mp,{value:"LOW"},i("priority.LOW")),u.a.createElement(mp,{value:"MEDIUM"},i("priority.MEDIUM")),u.a.createElement(mp,{value:"HIGH"},i("priority.HIGH")),u.a.createElement(mp,{value:"CRITICAL"},i("priority.CRITICAL"))):u.a.createElement(pr.a,{style:{height:"2.5rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:6},u.a.createElement(Kt.a,{variant:"subtitle2"},i("status")),p?u.a.createElement(Qr.a,{id:"priority",fullWidth:!0,value:p.status,onChange:function(e){y(!0),g(Object(h.a)(Object(h.a)({},p),{},{status:e.target.value}))},variant:"outlined",margin:"dense"},u.a.createElement(mp,{value:""},i("status.null")),u.a.createElement(mp,{value:"MALICIOUS"},i("status.MALICIOUS")),u.a.createElement(mp,{value:"NON-MALICIOUS"},i("status.NON-MALICIOUS")),u.a.createElement(mp,{value:"ASSESS"},i("status.ASSESS"))):u.a.createElement(pr.a,{style:{height:"2.5rem"}}))),u.a.createElement("div",{style:{textAlign:"center",paddingTop:c.spacing(3)}},p?p.creator&&u.a.createElement(Kt.a,{variant:"subtitle2",color:"textSecondary"},"".concat(i("created_by")," ").concat(p.creator," "),u.a.createElement(Dl.a,{fromNow:!0,locale:l.language},p.creation_date)):u.a.createElement(pr.a,null),p?p.edited_by&&u.a.createElement(Kt.a,{variant:"subtitle2",color:"textSecondary"},"".concat(i("edited_by")," ").concat(p.edited_by," "),u.a.createElement(Dl.a,{fromNow:!0,locale:l.language},p.last_edit)):u.a.createElement(pr.a,null)," ")),p&&E&&p.name&&p.query?u.a.createElement("div",{style:{paddingTop:s?c.spacing(1):c.spacing(2),paddingBottom:s?c.spacing(1):c.spacing(2),position:s?"fixed":"inherit",bottom:s?0:"inherit",left:s?0:"inherit",width:s?"100%":"inherit",textAlign:s?"center":"right",zIndex:s?c.zIndex.drawer-1:"auto",backgroundColor:s?c.palette.background.default:"inherit",boxShadow:s?c.shadows[4]:"inherit"}},u.a.createElement(ma.a,{variant:"contained",color:"primary",disabled:x,onClick:function(){N({url:t||s?"/api/v4/workflow/".concat(t||s,"/"):"/api/v4/workflow/",method:t||s?"POST":"PUT",body:Object(h.a)(Object(h.a)({},p),{},{priority:""===p.priority?null:p.priority,status:""===p.status?null:p.status}),onSuccess:function(){A(i(t||s?"save.success":"add.success")),y(!1),setTimeout((function(){return window.dispatchEvent(new CustomEvent("reloadWorkflows"))}),1e3),t||s||a()},onEnter:function(){return w(!0)},onExit:function(){return w(!1)}})}},i(t||s?"save":"add.button"),x&&u.a.createElement(tr.a,{size:24,className:R.buttonProgress}))):null)};pp.defaultProps={workflow_id:null,close:function(){}};var gp=pp,fp=Object(i.a)((function(e){return{searchresult:{fontStyle:"italic",paddingTop:e.spacing(.5),display:"flex",flexWrap:"wrap"},drawerPaper:Object(r.a)({width:"80%",maxWidth:"800px"},e.breakpoints.down("sm"),{width:"100%"})}}));function hp(){var e=Object(X.a)(["manageWorkflows"]).t,t=Object(o.useState)(25),a=Object(n.a)(t,1)[0],r=Object(o.useState)(!1),i=Object(n.a)(r,2),s=i[0],c=i[1],m=Ma().indexes,d=Object(o.useState)(null),p=Object(n.a)(d,2),g=p[0],f=p[1],h=Object(ue.h)(),b=Object(o.useState)(null),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Object(ue.g)(),x=Object(v.a)(),w=Object(l.a)(x.breakpoints.up("md")),j=dr(),k=fp(),S=el(),C=S.closeGlobalDrawer,T=S.setGlobalDrawer,A=Object(o.useState)([].concat(Object(oe.a)(Object.keys(m.workflow).filter((function(e){return m.workflow[e].indexed}))),Object(oe.a)(pl))),N=Object(n.a)(A,1)[0],R=Object(o.useRef)("");Object(o.useEffect)((function(){O(new Ol(h.search,"query=*&rows=".concat(a,"&offset=0")))}),[h.pathname,h.search,a]),Object(o.useEffect)((function(){y&&z(0)}),[y]),Object(o.useEffect)((function(){function e(){z(g?g.offset:0)}return window.addEventListener("reloadWorkflows",e),function(){window.removeEventListener("reloadWorkflows",e)}}),[y,g]);var z=function e(t){y.set("rows",25),y.set("offset",t),j({method:"POST",url:"/api/v4/search/workflow/",body:y.getParams(),onSuccess:function(t){0===t.api_response.items.length&&0!==t.api_response.offset&&t.api_response.offset>=t.api_response.total?e(Math.max(0,t.api_response.offset-t.api_response.rows)):f(t.api_response)},onEnter:function(){return c(!0)},onExit:function(){return c(!1)}})},D=Object(o.useCallback)((function(){_.push(h.pathname)}),[h.pathname]),B=Object(o.useCallback)((function(){""!==R.current?(y.set("query",R.current),_.push("".concat(h.pathname,"?").concat(y.toString()))):D()}),[y,h.pathname,D]),q=Object(o.useCallback)((function(e){T(u.a.createElement(gp,{workflow_id:e,close:C}))}),[]);return u.a.createElement(Yi,{margin:4},u.a.createElement("div",{style:{paddingBottom:x.spacing(2)}},u.a.createElement(Br.a,{container:!0,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement(Kt.a,{variant:"h4"},e("title"))),u.a.createElement(Br.a,{item:!0,xs:!0,style:{textAlign:"right"}},u.a.createElement(I.a,{title:e("add_workflow")},u.a.createElement(Z.a,{style:{color:"dark"===x.palette.type?x.palette.success.light:x.palette.success.dark},onClick:function(){return T(u.a.createElement(gp,{workflow_id:null,close:C}))}},u.a.createElement(Cs.a,null)))))),u.a.createElement(Ji,{isSticky:!0},u.a.createElement("div",{style:{paddingTop:x.spacing(1)}},u.a.createElement(vl,{initValue:y?y.get("query",""):"",placeholder:e("filter"),searching:s,suggestions:N,onValueChange:function(e){R.current=e},onClear:D,onSearch:B,buttons:[{icon:u.a.createElement(lp.a,{fontSize:w?"default":"small"}),tooltip:e("never_used"),props:{onClick:function(){y.set("query","hit_count:0"),_.push("".concat(h.pathname,"?").concat(y.getDeltaString()))}}},{icon:u.a.createElement(cp.a,{fontSize:w?"default":"small"}),tooltip:e("old"),props:{onClick:function(){y.set("query","last_seen:[* TO now-3m]"),_.push("".concat(h.pathname,"?").concat(y.getDeltaString()))}}}]},null!==g&&u.a.createElement("div",{className:k.searchresult},0!==g.total&&u.a.createElement(Kt.a,{variant:"subtitle1",color:"secondary",style:{flexGrow:1}},s?u.a.createElement("span",null,e("searching")):u.a.createElement("span",null,g.total,"\xa0",y.get("query")?e("filtered".concat(1===g.total?"":"s")):e("total".concat(1===g.total?"":"s")))),u.a.createElement(xl,{total:g.total,setResults:f,pageSize:a,index:"workflow",query:y,setSearching:c}))))),u.a.createElement("div",{style:{paddingTop:x.spacing(2),paddingLeft:x.spacing(.5),paddingRight:x.spacing(.5)}},u.a.createElement(op,{workflowResults:g,setWorkflowID:q})))}var bp=function(){var e=Object(X.a)(["optout"]).t,t=Object(v.a)(),a=dr(),n=Pa(),r=n.getBanner,i=n.hideMenus;return Object(o.useEffect)((function(){i(),a({body:!1,method:"PUT",url:"/api/v4/user/ui4/",onSuccess:function(){setTimeout((function(){window.location.replace("/")}),500)}})}),[]),u.a.createElement(ur,null,u.a.createElement("div",{style:{textAlign:"center"}},r(t),u.a.createElement("div",{style:{marginBottom:t.spacing(3)}},u.a.createElement(Kt.a,null,e("title"))),u.a.createElement(tr.a,{size:24})))},vp=a(742),Ep=a(440),yp=a.n(Ep),Op=a(439),_p=a.n(Op),xp=u.a.memo((function(e){var t=e.alertResults,a=e.allowSort,n=void 0===a||a,r=Object(X.a)(["search"]),i=r.t,l=r.i18n,s=Ma().c12nDef;return t?0!==t.total?u.a.createElement(qr.a,{component:ua.a},u.a.createElement(Rl,null,u.a.createElement(Nl,null,u.a.createElement(Al,null,u.a.createElement(Cl,{sortField:"reporting_ts",allowSort:n},i("header.reporting_ts")),u.a.createElement(Cl,{sortField:"al.score",allowSort:n},i("header.verdict")),u.a.createElement(Cl,{sortField:"file.sha256",allowSort:n},i("header.sha256")),u.a.createElement(Cl,{sortField:"status",allowSort:n},i("header.status")),u.a.createElement(Cl,{sortField:"type",allowSort:n},i("header.type")),s.enforce&&u.a.createElement(Cl,{sortField:"classification",allowSort:n},i("header.classification")))),u.a.createElement(Il,null,t.items.map((function(e){return u.a.createElement(Tl,{key:e.id,component:Y.b,to:"/alerts/".concat(e.id),hover:!0,style:{textDecoration:"none"}},u.a.createElement(Sl,null,u.a.createElement(I.a,{title:e.reporting_ts},u.a.createElement(Dl.a,{fromNow:!0,locale:l.language},e.reporting_ts))),u.a.createElement(Sl,null,u.a.createElement(Cc,{score:e.al.score,fullWidth:!0})),u.a.createElement(Sl,{style:{wordBreak:"break-word"}},e.file.sha256),u.a.createElement(Sl,null,e.status),u.a.createElement(Sl,null,e.type),s.enforce&&u.a.createElement(Sl,null,u.a.createElement(ki,{type:"text",size:"tiny",c12n:e.classification,format:"short"})))}))))):u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(Ll,null,u.a.createElement(wl.a,null,i("no_alerts_title")),i("no_results_desc"))):u.a.createElement(pr.a,{variant:"rect",style:{height:"6rem",borderRadius:"4px"}})})),wp=u.a.memo((function(e){var t=e.fileResults,a=e.allowSort,n=void 0===a||a,r=Object(X.a)(["search"]),i=r.t,l=r.i18n,s=Ma().c12nDef;return t?0!==t.total?u.a.createElement(qr.a,{component:ua.a},u.a.createElement(Rl,null,u.a.createElement(Nl,null,u.a.createElement(Al,null,u.a.createElement(Cl,{sortField:"seen.last",allowSort:n},i("header.lasttimeseen")),u.a.createElement(Cl,{sortField:"seen.count",allowSort:n},i("header.count")),u.a.createElement(Cl,{sortField:"sha256",allowSort:n},i("header.sha256")),u.a.createElement(Cl,{sortField:"type",allowSort:n},i("header.filetype")),u.a.createElement(Cl,{sortField:"size",allowSort:n},i("header.size")),s.enforce&&u.a.createElement(Cl,{sortField:"classification",allowSort:n},i("header.classification")))),u.a.createElement(Il,null,t.items.map((function(e){return u.a.createElement(Tl,{key:e.id,component:Y.b,to:"/file/detail/".concat(e.sha256),hover:!0,style:{textDecoration:"none"}},u.a.createElement(Sl,null,u.a.createElement(I.a,{title:e.seen.last},u.a.createElement(Dl.a,{fromNow:!0,locale:l.language},e.seen.last))),u.a.createElement(Sl,null,e.seen.count),u.a.createElement(Sl,{style:{wordBreak:"break-word"}},e.sha256),u.a.createElement(Sl,null,e.type),u.a.createElement(Sl,null,e.size),s.enforce&&u.a.createElement(Sl,null,u.a.createElement(ki,{type:"text",size:"tiny",c12n:e.classification,format:"short"})))}))))):u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(Ll,null,u.a.createElement(wl.a,null,i("no_files_title")),i("no_results_desc"))):u.a.createElement(pr.a,{variant:"rect",style:{height:"6rem",borderRadius:"4px"}})})),jp=a(438),kp=a.n(jp),Sp={error:u.a.createElement(ec.a,{color:"error"}),completed:u.a.createElement(ac.a,{color:"primary"}),submitted:u.a.createElement(kp.a,{color:"action"})},Cp=u.a.memo((function(e){var t=e.state,a=e.error_count,n=void 0===a?0:a,r=Object(X.a)().t,i=0!==n?"error":t,l=Sp[i];return u.a.createElement(I.a,{title:r("submission.state.".concat(i))},l)})),Tp=u.a.memo((function(e){var t=e.submissionResults,a=e.allowSort,n=void 0===a||a,r=Object(X.a)(["search"]),i=r.t,l=r.i18n,s=Ma().c12nDef;return t?0!==t.total?u.a.createElement(qr.a,{component:ua.a},u.a.createElement(Rl,null,u.a.createElement(Nl,null,u.a.createElement(Al,null,u.a.createElement(Cl,{sortField:"times.submitted",allowSort:n},i("header.starttime")),u.a.createElement(Cl,{sortField:"max_score",allowSort:n},i("header.verdict")),u.a.createElement(Sl,null,i("header.description")),u.a.createElement(Cl,{sortField:"params.submitter",allowSort:n},i("header.user")),u.a.createElement(Cl,{sortField:"file_count",allowSort:n},i("header.numfiles")),s&&s.enforce&&u.a.createElement(Cl,{sortField:"classification",allowSort:n},i("header.classification")),u.a.createElement(Cl,{sortField:"error_count",allowSort:n},i("header.status")))),u.a.createElement(Il,null,t.items.map((function(e){return u.a.createElement(Tl,{key:e.id,component:Y.b,to:"completed"===e.state?"/submission/".concat(e.id):"/submission/detail/".concat(e.id),hover:!0,style:{textDecoration:"none"}},u.a.createElement(Sl,null,u.a.createElement(I.a,{title:e.times.submitted},u.a.createElement(Dl.a,{fromNow:!0,locale:l.language},e.times.submitted))),u.a.createElement(Sl,null,u.a.createElement(Cc,{score:e.max_score,fullWidth:!0})),u.a.createElement(Sl,{style:{wordBreak:"break-word"}},e.params.description.length>150?"".concat(e.params.description.substr(0,147),"..."):e.params.description),u.a.createElement(Sl,{style:{whiteSpace:"nowrap"}},e.params.submitter),u.a.createElement(Sl,null,e.file_count),s&&s.enforce&&u.a.createElement(Sl,null,u.a.createElement(ki,{type:"text",size:"tiny",c12n:e.classification,format:"short"})),u.a.createElement(Sl,{style:{textAlign:"center"}},u.a.createElement(Cp,{state:e.state,error_count:e.error_count})))}))))):u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(Ll,null,u.a.createElement(wl.a,null,i("no_submissions_title")),i("no_results_desc"))):u.a.createElement(pr.a,{variant:"rect",style:{height:"6rem",borderRadius:"4px"}})})),Ap=Object(i.a)((function(e){var t;return Object(G.a)({tweaked_tabs:(t={minHeight:"unset"},Object(r.a)(t,e.breakpoints.up("md"),{"& [role=tab]":{padding:"8px 20px",fontSize:"13px",minHeight:"unset",minWidth:"unset"}}),Object(r.a)(t,e.breakpoints.down("sm"),{minHeight:"unset","& [role=tab]":{fontSize:"12px",minHeight:"unset",minWidth:"unset"}}),t),searchresult:{paddingLeft:e.spacing(1),color:e.palette.primary.main,fontStyle:"italic"}})}));function Np(e){var t=e.index,a=Object(ue.i)().id,r=Object(X.a)(["search"]).t,i=Object(o.useState)(25),s=Object(n.a)(i,1)[0],c=Object(o.useState)(!1),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Ma().indexes,f=Object(ue.h)(),E=Object(ue.g)(),y=Object(v.a)(),O=Ap(),_=dr(),x=Object(o.useState)(null),w=Object(n.a)(x,2),j=w[0],k=w[1],S=Object(o.useState)(null),C=Object(n.a)(S,2),T=C[0],A=C[1],N=Object(o.useState)(null),R=Object(n.a)(N,2),z=R[0],D=R[1],B=$n().showErrorMessage,q=Object(l.a)(y.breakpoints.down("sm")),L=Object(o.useState)(null),F=Object(n.a)(L,2),P=F[0],M=F[1],W=Object(o.useState)(null),U=Object(n.a)(W,2),H=U[0],V=U[1],G=Object(o.useState)(null),J=Object(n.a)(G,2),Q=J[0],K=J[1],$=Object(o.useState)(null),ee=Object(n.a)($,2),te=ee[0],ae=ee[1],ne=Object(o.useState)(null),re=Object(n.a)(ne,2),ie=re[0],le=re[1],se={submission:M,file:V,result:K,signature:ae,alert:le},ce={submission:P,file:H,result:Q,signature:te,alert:ie},me=Object(o.useRef)(""),de=function(){j.delete("query"),E.push("".concat(f.pathname,"?").concat(j.toString()).concat(f.hash))};Object(o.useEffect)((function(){A([].concat(Object(oe.a)(Object.keys(g[t||a]||{}).filter((function(e){return g[t||a][e].indexed}))),Object(oe.a)(pl)))}),[t,a,g]),Object(o.useEffect)((function(){k(new Ol(f.search,"rows=".concat(s,"&offset=0"))),M(null),V(null),K(null),ae(null),le(null)}),[f.search,s]),Object(o.useEffect)((function(){var e=f.hash.substring(1,f.hash.length)||t||a||"submission";D(e)}),[a,t,f.hash]),Object(o.useEffect)((function(){if(j&&(me.current=j.get("query",""),j.get("query"))){var e=[];t||a?(e.push(z),d||p(!0)):e.push.apply(e,Object(oe.a)(Object.keys(se)));for(var n=function(){var e=i[r];_({method:"POST",url:"/api/v4/search/".concat(e,"/"),body:Object(h.a)(Object(h.a)({},j.getParams()),{},{rows:s,offset:0}),onSuccess:function(t){se[e](t.api_response)},onFailure:function(n){t||a||!n.api_error_message.includes("Rewrite first")?B(n.api_error_message):se[e]({total:0,offset:0,items:[],rows:s})},onFinalize:function(){(t||a)&&p(!1)}})},r=0,i=e;r<i.length;r++)n()}}),[j]);var pe=function(e){return u.a.createElement("div",{style:{flexGrow:1}})},ge=function(e){var t=e.children;Object(b.a)(e,["children"]);return t};return u.a.createElement(Yi,{margin:4},u.a.createElement("div",{style:{paddingBottom:y.spacing(2),textAlign:"left",width:"100%"}},u.a.createElement(Kt.a,{variant:"h4"},r("title_".concat(t||a||"all")))),u.a.createElement(Ji,{isSticky:!0},u.a.createElement("div",{style:{paddingTop:y.spacing(1)}},u.a.createElement(vl,{initValue:j?j.get("query",""):"",searching:d,placeholder:r("search_".concat(t||a||"all")),suggestions:T,onValueChange:function(e){me.current=e},onClear:de,onSearch:function(){""!==me.current?(j.set("query",me.current),E.push("".concat(f.pathname,"?").concat(j.toString()).concat(f.hash))):de()},buttons:[{icon:j&&"false"===j.get("use_archive")?u.a.createElement(_p.a,{fontSize:q?"small":"default"}):u.a.createElement(yp.a,{fontSize:q?"small":"default"}),tooltip:j&&"false"===j.get("use_archive")?r("use_archive.turn_on"):r("use_archive.turn_off"),props:{onClick:function(){j.set("use_archive","false"===j.get("use_archive")),E.push("".concat(f.pathname,"?").concat(j.getDeltaString()).concat(f.hash))}}}]}),!(t||a)&&j&&j.get("query")&&u.a.createElement(ua.a,{square:!0,style:{marginBottom:y.spacing(.5)}},u.a.createElement(vp.a,{className:O.tweaked_tabs,value:z,onChange:function(e,t){E.push("".concat(f.pathname,"?").concat(j.toString(),"#").concat(t))},indicatorColor:"primary",textColor:"primary",scrollButtons:"auto",variant:"scrollable"},u.a.createElement(Gl.a,{label:"".concat(r("submission")," (").concat(P?P.total:"...",")"),value:"submission"}),u.a.createElement(Gl.a,{label:"".concat(r("file")," (").concat(H?H.total:"...",")"),value:"file"}),u.a.createElement(Gl.a,{label:"".concat(r("result")," (").concat(Q?Q.total:"...",")"),value:"result"}),u.a.createElement(Gl.a,{label:"".concat(r("signature")," (").concat(te?te.total:"...",")"),value:"signature"}),u.a.createElement(Gl.a,{label:"".concat(r("alert")," (").concat(ie?ie.total:"...",")"),value:"alert"}),u.a.createElement(pe,null),u.a.createElement(ge,null,u.a.createElement(I.a,{title:r("focus_search")},u.a.createElement(Z.a,{size:q?"small":"medium",component:Y.b,to:"/search/".concat(z).concat(f.search)},u.a.createElement(_o.a,{fontSize:"small"})))))),u.a.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",marginBottom:y.spacing(.5)}},ce[z]&&0!==ce[z].total&&(t||a)&&u.a.createElement("div",{className:O.searchresult},"".concat(ce[z].total," ").concat(r(1===ce[z].total?"matching_result":"matching_results"))),u.a.createElement("div",{style:{flexGrow:1}}),ce[z]&&u.a.createElement(xl,{total:ce[z].total,setResults:se[z],page:ce[z].offset/ce[z].rows+1,pageSize:s,index:z,query:j,setSearching:p})))),u.a.createElement("div",{style:{paddingTop:y.spacing(2),paddingLeft:y.spacing(.5),paddingRight:y.spacing(.5)}},"submission"===z&&j&&j.get("query")&&u.a.createElement(Tp,{submissionResults:P,allowSort:!(!t&&!a)}),"file"===z&&j&&j.get("query")&&u.a.createElement(wp,{fileResults:H,allowSort:!(!t&&!a)}),"result"===z&&j&&j.get("query")&&u.a.createElement(Ud,{resultResults:Q,allowSort:!(!t&&!a)}),"signature"===z&&j&&j.get("query")&&u.a.createElement($d,{signatureResults:te,allowSort:!(!t&&!a)}),"alert"===z&&j&&j.get("query")&&u.a.createElement(xp,{alertResults:ie,allowSort:!(!t&&!a)})))}Np.defaultProps={index:null};var Ip=Np,Rp=a(441),zp=Object(i.a)((function(e){return Object(G.a)({item:{width:"100%","&:hover":{background:e.palette.action.hover}}})}));function Dp(e){var t=e.size,a=void 0===t?"medium":t;return u.a.createElement("div",{style:{display:"flex",flexDirection:"row",paddingBottom:"8px"}},u.a.createElement(pr.a,{style:{height:"medium"===a?"2.5rem":"2rem",width:"1.5rem"}}),u.a.createElement(pr.a,{style:{marginLeft:"1rem",height:"medium"===a?"2.5rem":"2rem",width:"100%"}}))}function Bp(e){var t=e.item,a=e.onChange,n=e.size,r=void 0===n?"medium":n,i=zp(),l=Object(v.a)(),s=l.spacing(1),c=l.spacing(4);return u.a.createElement("div",{style:{paddingLeft:s,height:"100%",width:"100%",display:"inline-block",pageBreakInside:"avoid"}},u.a.createElement(ts.a,{control:u.a.createElement(ks.a,{size:r,indeterminate:!!t.services&&(!t.services.every((function(e){return e.selected}))&&!t.services.every((function(e){return!e.selected}))),checked:t.services?t.services.some((function(e){return e.selected})):t.selected,name:"label",onChange:function(){return a(t.name,t.category)}}),label:u.a.createElement(Kt.a,{variant:"small"===r?"body2":"body1"},t.name,t.is_external&&u.a.createElement(Rp.a,{style:{fontSize:"large",verticalAlign:"middle",marginLeft:l.spacing(2)}})),className:i.item}),u.a.createElement("div",{style:{paddingLeft:c}},t.services?t.services.map((function(e,t){return u.a.createElement(Bp,{size:r,key:t,item:e,onChange:a})})):null))}function qp(e){var t=e.size,a=e.spacing;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{height:"100%",width:"100%",display:"inline-block",pageBreakInside:"avoid"}},u.a.createElement(Dp,{size:t}),u.a.createElement("div",{style:{paddingLeft:a}},u.a.createElement(Dp,{size:t}),u.a.createElement(Dp,{size:t}),u.a.createElement(Dp,{size:t}),u.a.createElement(Dp,{size:t}))),u.a.createElement("div",{style:{height:"100%",width:"100%",display:"inline-block",pageBreakInside:"avoid"}},u.a.createElement(Dp,{size:t}),u.a.createElement("div",{style:{paddingLeft:a}},u.a.createElement(Dp,{size:t}),u.a.createElement(Dp,{size:t}))),u.a.createElement("div",{style:{height:"100%",width:"100%",display:"inline-block",pageBreakInside:"avoid"}},u.a.createElement(Dp,{size:t}),u.a.createElement("div",{style:{paddingLeft:a}},u.a.createElement(Dp,{size:t}),u.a.createElement(Dp,{size:t}),u.a.createElement(Dp,{size:t}),u.a.createElement(Dp,{size:t}),u.a.createElement(Dp,{size:t}))))}var Lp=function(e){var t=e.settings,a=e.setSettings,n=e.setModified,r=void 0===n?null:n,i=e.compressed,l=void 0!==i&&i,s=e.size,c=void 0===s?"medium":s,o=Object(v.a)(),m=o.spacing(2),d=o.spacing(4);function p(e,n){if(t){var i=t.services;if(n){var l,s=Object(di.a)(i);try{for(s.s();!(l=s.n()).done;){var c=l.value;if(c.name===n){var o,u=Object(di.a)(c.services);try{for(u.s();!(o=u.n()).done;){var m=o.value;if(m.name===e){m.selected=!m.selected;break}}}catch(v){u.e(v)}finally{u.f()}c.selected=c.services.every((function(e){return e.selected}));break}}}catch(v){s.e(v)}finally{s.f()}}else{var d,p=Object(di.a)(i);try{for(p.s();!(d=p.n()).done;){var g=d.value;if(g.name===e){g.selected=!g.selected;var f,b=Object(di.a)(g.services);try{for(b.s();!(f=b.n()).done;){f.value.selected=g.selected}}catch(v){b.e(v)}finally{b.f()}break}}}catch(v){p.e(v)}finally{p.f()}}r&&r(!0),a(Object(h.a)(Object(h.a)({},t),{},{services:i}))}}function g(e,t){var a=e.name.toUpperCase(),n=t.name.toUpperCase();return a<n?-1:a>n?1:0}return l?u.a.createElement("div",{style:{paddingTop:m,paddingBottom:m,columnWidth:"18rem",columnGap:"1rem",columnRuleWidth:"1px",columnRuleStyle:"dotted",columnRuleColor:o.palette.divider}},t?t.services.sort(g).map((function(e,t){return u.a.createElement(Bp,{size:c,key:t,item:e,onChange:p})})):u.a.createElement(qp,{size:c,spacing:d})):t?t.services.sort(g).map((function(e,t){return u.a.createElement(Bp,{size:c,key:t,item:e,onChange:p})})):u.a.createElement(qp,{size:c,spacing:d})};var Fp=Object(z.a)()((function(e){var t=e.width,a=Object(X.a)(["settings"]).t,l=Object(v.a)(),s=Object(o.useState)(null),c=Object(n.a)(s,2),m=c[0],d=c[1],p=Object(o.useState)(!1),g=Object(n.a)(p,2),f=g[0],b=g[1],E=Object(o.useState)(null),y=Object(n.a)(E,2),O=y[0],_=y[1],x=Object(o.useState)(!1),w=Object(n.a)(x,2),j=w[0],k=w[1],S=Object(o.useState)(!1),C=Object(n.a)(S,2),T=C[0],A=C[1],I=Ma(),R=I.user,D=I.c12nDef,B=$n().showSuccessMessage,q=l.spacing(1),L=l.spacing(2),F=l.spacing(4),P=l.spacing(6),M=dr(),W=Object(i.a)((function(e){return{drawer:Object(r.a)({width:"500px"},l.breakpoints.down("xs"),{width:"100vw"}),row:{height:"62px"},group:{marginTop:"1rem"},skelItem:{display:"inline-block"},skelButton:{display:"inline-block",width:"9rem",height:"4rem"},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}))();function U(){O&&(k(!0),_(Object(h.a)(Object(h.a)({},O),{},{ignore_dynamic_recursion_prevention:!O.ignore_dynamic_recursion_prevention})))}function H(){O&&(k(!0),_(Object(h.a)(Object(h.a)({},O),{},{ignore_filtering:!O.ignore_filtering})))}function V(){O&&(k(!0),_(Object(h.a)(Object(h.a)({},O),{},{ignore_cache:!O.ignore_cache})))}function G(){O&&(k(!0),_(Object(h.a)(Object(h.a)({},O),{},{deep_scan:!O.deep_scan})))}function Y(){O&&(k(!0),_(Object(h.a)(Object(h.a)({},O),{},{profile:!O.profile})))}function J(e){O&&(d(e),b(!0))}return Object(o.useEffect)((function(){M({url:"/api/v4/user/settings/".concat(R.username,"/"),onSuccess:function(e){_(e.api_response)}})}),[]),u.a.createElement(ir,{margin:4,width:"100%"},u.a.createElement(u.a.Fragment,{key:"right"},u.a.createElement(N.a,{anchor:"right",open:f,onClose:function(){return b(!1)}},u.a.createElement("div",{style:{alignSelf:"flex-end"}},u.a.createElement(Z.a,{onClick:function(){return b(!1)}},u.a.createElement(Yr.a,null))),u.a.createElement("div",{className:W.drawer,style:{paddingTop:F,paddingBottom:P,paddingLeft:F,paddingRight:F,display:"flex",flexDirection:"column"}},m&&O&&{ttl:u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4"},a("submissions.ttl")),u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},a("submissions.ttl_desc")),u.a.createElement(hr.a,{autoFocus:!0,type:"number",margin:"normal",variant:"outlined",onChange:function(e){return t=e.target.value,void(O&&(k(!0),_(Object(h.a)(Object(h.a)({},O),{},{ttl:parseInt(t)}))));var t},value:O.ttl,inputProps:{min:0,max:365}})),view:u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4"},a("interface.view")),u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},a("interface.view_desc")),u.a.createElement("div",{style:{paddingTop:L,width:"100%"}},u.a.createElement(Qr.a,{id:"view",margin:"dense",value:O.submission_view,onChange:function(e){O&&(k(!0),_(Object(h.a)(Object(h.a)({},O),{},{submission_view:e.target.value})))},variant:"outlined",style:{width:"100%"}},u.a.createElement(Kr.a,{value:"report"},a("interface.view_report")),u.a.createElement(Kr.a,{value:"details"},a("interface.view_details"))))),encoding:u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4"},a("interface.encoding")),u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},a("interface.encoding_desc")),u.a.createElement("div",{style:{paddingTop:L,width:"100%"}},u.a.createElement(Qr.a,{id:"view",margin:"dense",value:O.download_encoding,onChange:function(e){O&&(k(!0),_(Object(h.a)(Object(h.a)({},O),{},{download_encoding:e.target.value})))},variant:"outlined",style:{width:"100%"}},u.a.createElement(Kr.a,{value:"raw"},a("interface.encoding_raw")),u.a.createElement(Kr.a,{value:"cart"},a("interface.encoding_cart"))))),score:u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"h4"},a("interface.score")),u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},a("interface.score_desc")),u.a.createElement("div",{style:{paddingTop:L,width:"100%"}},u.a.createElement(Qr.a,{id:"view",margin:"dense",value:O.expand_min_score,onChange:function(e){O&&(k(!0),_(Object(h.a)(Object(h.a)({},O),{},{expand_min_score:e.target.value})))},variant:"outlined",style:{width:"100%"}},u.a.createElement(Kr.a,{value:"-1000000"},a("interface.score_-1000000")),u.a.createElement(Kr.a,{value:"0"},a("interface.score_0")),u.a.createElement(Kr.a,{value:"100"},a("interface.score_100")),u.a.createElement(Kr.a,{value:"500"},a("interface.score_500")),u.a.createElement(Kr.a,{value:"2000"},a("interface.score_2000")),u.a.createElement(Kr.a,{value:"100000000"},a("interface.score_100000000")))))}[m]))),u.a.createElement(qr.a,{className:W.group,component:ua.a},u.a.createElement(Lr.a,{"aria-label":a("submissions")},u.a.createElement(Fr.a,null,u.a.createElement(Pr.a,null,u.a.createElement(Mr.a,{colSpan:Object(z.b)("xs",t)?2:3},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},a("submissions"))))),u.a.createElement(Wr.a,null,u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return U()}},u.a.createElement(Mr.a,{colSpan:2,width:"100%"},u.a.createElement(Kt.a,{variant:"body1"},a("submissions.dynamic_recursion")),u.a.createElement(Kt.a,{variant:"caption"},a("submissions.dynamic_recursion_desc"))),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(ja.a,{checked:!O||!O.ignore_dynamic_recursion_prevention,disabled:null===O,onChange:function(){return U()},color:"secondary",name:"dynamic_resursion"}))),u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return H()}},u.a.createElement(Mr.a,{colSpan:2,width:"100%"},u.a.createElement(Kt.a,{variant:"body1"},a("submissions.filtering")),u.a.createElement(Kt.a,{variant:"caption"},a("submissions.filtering_desc"))),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(ja.a,{checked:!O||!O.ignore_filtering,disabled:null===O,onChange:function(){return H()},color:"secondary",name:"filtering"}))),u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return V()}},u.a.createElement(Mr.a,{colSpan:2,width:"100%"},u.a.createElement(Kt.a,{variant:"body1"},a("submissions.result_caching")),u.a.createElement(Kt.a,{variant:"caption"},a("submissions.result_caching_desc"))),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(ja.a,{checked:!O||!O.ignore_cache,disabled:null===O,onChange:function(){return V()},color:"secondary",name:"result_caching"}))),u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return G()}},u.a.createElement(Mr.a,{colSpan:2,width:"100%"},u.a.createElement(Kt.a,{variant:"body1"},a("submissions.deep_scan")),u.a.createElement(Kt.a,{variant:"caption"},a("submissions.deep_scan_desc"))),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(ja.a,{checked:!O||O.deep_scan,disabled:null===O,onChange:function(){return G()},color:"secondary",name:"deep_scan"}))),u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(){return Y()}},u.a.createElement(Mr.a,{colSpan:2,width:"100%"},u.a.createElement(Kt.a,{variant:"body1"},a("submissions.profile")),u.a.createElement(Kt.a,{variant:"caption"},a("submissions.profile_desc"))),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(ja.a,{checked:!O||!O.profile,disabled:null===O,onChange:function(){return Y()},color:"secondary",name:"profile"}))),u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(e){return J("ttl")}},Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,null,u.a.createElement(Kt.a,{variant:"body1"},a("submissions.ttl")),u.a.createElement(Kt.a,{variant:"caption"},a("submissions.ttl_desc"))),u.a.createElement(Mr.a,{colSpan:Object(z.b)("xs",t)?2:1},Object(z.b)("xs",t)?u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"body1"},a("submissions.ttl")),u.a.createElement(Kt.a,{variant:"caption",gutterBottom:!0},a("submissions.ttl_desc"))):null,O?u.a.createElement(Kt.a,{variant:"subtitle2",color:"primary"},0===O.ttl?a("submissions.ttl_forever"):"".concat(O.ttl," ").concat(a("submissions.ttl_days"))):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(Vr.a,null))),D.enforce&&u.a.createElement(Pr.a,{style:{cursor:"pointer"}},Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,null,u.a.createElement(Kt.a,{variant:"body1"},a("submissions.classification")),u.a.createElement(Kt.a,{variant:"caption"},a("submissions.classification_desc"))),u.a.createElement(Mr.a,{colSpan:Object(z.b)("xs",t)?3:2},Object(z.b)("xs",t)?u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"body1"},a("submissions.classification")),u.a.createElement(Kt.a,{variant:"caption",gutterBottom:!0},a("submissions.classification_desc"))):null,u.a.createElement(ki,{type:"picker",size:"small",c12n:O?O.classification:null,setClassification:function(e){O&&(k(!0),_(Object(h.a)(Object(h.a)({},O),{},{classification:e})))}})))))),u.a.createElement(qr.a,{className:W.group,component:ua.a},u.a.createElement(Lr.a,{"aria-label":a("interface")},u.a.createElement(Fr.a,null,u.a.createElement(Pr.a,null,u.a.createElement(Mr.a,{colSpan:3},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},a("interface"))))),u.a.createElement(Wr.a,null,u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(e){return J("view")}},Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,null,u.a.createElement(Kt.a,{variant:"body1"},a("interface.view")),u.a.createElement(Kt.a,{variant:"caption"},a("interface.view_desc"))),u.a.createElement(Mr.a,{colSpan:Object(z.b)("xs",t)?2:1},Object(z.b)("xs",t)?u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"body1"},a("interface.view")),u.a.createElement(Kt.a,{variant:"caption",gutterBottom:!0},a("interface.view_desc"))):null,O?u.a.createElement(Kt.a,{variant:"subtitle2",color:"primary"},a("interface.view_".concat(O.submission_view))):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(Vr.a,null))),u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(e){return J("encoding")}},Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,null,u.a.createElement(Kt.a,{variant:"body1"},a("interface.encoding")),u.a.createElement(Kt.a,{variant:"caption"},a("interface.encoding_desc"))),u.a.createElement(Mr.a,{colSpan:Object(z.b)("xs",t)?2:1},Object(z.b)("xs",t)?u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"body1"},a("interface.encoding")),u.a.createElement(Kt.a,{variant:"caption",gutterBottom:!0},a("interface.encoding_desc"))):null,O?u.a.createElement(Kt.a,{variant:"subtitle2",color:"primary"},a("interface.encoding_".concat(O.download_encoding))):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(Vr.a,null))),u.a.createElement(Pr.a,{hover:!0,style:{cursor:"pointer"},onClick:function(e){return J("score")}},Object(z.b)("xs",t)?null:u.a.createElement(Mr.a,null,u.a.createElement(Kt.a,{variant:"body1"},a("interface.score")),u.a.createElement(Kt.a,{variant:"caption"},a("interface.score_desc"))),u.a.createElement(Mr.a,{colSpan:Object(z.b)("xs",t)?2:1},Object(z.b)("xs",t)?u.a.createElement(u.a.Fragment,null,u.a.createElement(Kt.a,{variant:"body1"},a("interface.score")),u.a.createElement(Kt.a,{variant:"caption",gutterBottom:!0},a("interface.score_desc"))):null,O?u.a.createElement(Kt.a,{variant:"subtitle2",color:"primary"},a("interface.score_".concat(O.expand_min_score))):u.a.createElement(pr.a,null)),u.a.createElement(Mr.a,{align:"right"},u.a.createElement(Vr.a,null)))))),u.a.createElement(ua.a,{className:W.group},u.a.createElement("div",{style:{padding:L,textAlign:"left"}},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},a("service")),u.a.createElement(Lp,{settings:O,setSettings:_,setModified:k,compressed:!0}))),O&&j&&u.a.createElement("div",{style:{paddingTop:q,paddingBottom:q,position:"fixed",bottom:0,left:0,width:"100%",zIndex:l.zIndex.drawer-1,backgroundColor:l.palette.background.default,boxShadow:l.shadows[4]}},u.a.createElement(ma.a,{variant:"contained",color:"primary",disabled:T||!j,onClick:function(){O&&M({url:"/api/v4/user/settings/".concat(R.username,"/"),method:"POST",body:O,onSuccess:function(){k(!1),B(a("success_save"))},onEnter:function(){return A(!0)},onExit:function(){return A(!1)}})}},a("save"),T&&u.a.createElement(tr.a,{size:24,className:W.buttonProgress}))))})),Pp=a(730),Mp=a(444),Wp=a.n(Mp),Up=a(443),Hp=a.n(Up),Vp=a(445),Gp=a.n(Vp),Yp=function(e){var t=e.substr(65,e.length);return-1!==t.indexOf(".")&&(t=t.substr(0,t.indexOf("."))),t},Jp=function(e){return e.substr(0,64)},Qp=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),Kp=u.a.memo((function(e){var t=e.attack_matrix,a=Object(X.a)(["submissionDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=Qp(),d=c.spacing(2),p=em().getKey;return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("attack_matrix")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},t?Object.keys(t).map((function(e,a){return u.a.createElement(Br.a,{container:!0,key:a},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500,textTransform:"capitalize"}},e.replace(/-/g," "))),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},t[e].map((function(e,t){var a=Object(n.a)(e,3),r=a[0],i=a[1],l=a[2];return u.a.createElement(mm,{key:"".concat(r,"_").concat(t),text:i,lvl:l,highlight_key:p("attack_pattern",r)})}))))})):Object(oe.a)(Array(3)).map((function(e,t){return u.a.createElement(Br.a,{container:!0,key:t,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement(pr.a,{style:{height:"2rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},u.a.createElement(pr.a,{style:{height:"2rem"}})))})))}),[t,p])))})),Xp=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}},meta_key:{overflowX:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}})),Zp=u.a.memo((function(e){var t=e.sid,a=e.parsed_errors,r=Object(X.a)(["submissionDetail"]).t,i=u.a.useState(!0),l=Object(n.a)(i,2),s=l[0],c=l[1],m=Object(v.a)(),d=Xp(),p=m.spacing(2);return u.a.createElement("div",{style:{paddingBottom:p,paddingTop:p}},u.a.createElement(Kt.a,{variant:"h6",style:{color:"dark"===m.palette.type?m.palette.error.light:m.palette.error.dark},onClick:function(){c(!s)},className:d.title},r("errors")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:s,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:p,paddingTop:p}},u.a.createElement("div",null,Object.keys(a.aggregated).map((function(e,t){return a.aggregated[e].length>0&&u.a.createElement("div",{key:t,style:{color:"dark"===m.palette.type?m.palette.error.light:m.palette.error.dark}},"".concat(r("errors.aggregated").replace("{errorType}",r("errors.type.".concat(e))),": ").concat(a.aggregated[e].join(" | ")))})),a.listed.map((function(e,a){return u.a.createElement("div",{key:a,style:{color:"dark"===m.palette.type?m.palette.error.light:m.palette.error.dark}},u.a.createElement("strong",null,Yp(e)),r("errors.listed"),u.a.createElement("strong",null,u.a.createElement($t.a,{component:Y.b,style:{color:"dark"===m.palette.type?m.palette.error.light:m.palette.error.dark},to:"/submission/detail/".concat(t,"/").concat(Jp(e))},Jp(e))),u.a.createElement("span",{style:{fontSize:"smaller"}},"\xa0::\xa0",r("errors.type.".concat(function(e){var t=e.substr(65,e.length);return-1!==t.indexOf(".e")&&(t=t.substr(t.indexOf(".e")+2,t.length)),"21"===t?"down":"12"===t?"retry":"10"===t?"depth":"30"===t?"preempted":"20"===t?"busy":"11"===t?"files":"1"===t?"exception":"unknown"}(e)))))}))))}),[a,t,m,r])))})),$p=Object(i.a)((function(e){return{file_item:{cursor:"pointer","&:hover, &:focus":{backgroundColor:e.palette.action.hover}},title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}},noMaxWidth:{maxWidth:"none"}}})),eg=u.a.memo((function(e){var t=e.tree,a=e.sid,n=Object(v.a)(),r=$p(),i=Object(ue.g)(),l=em().isHighlighted;return u.a.createElement(u.a.Fragment,null,Object.keys(t).map((function(e,s){var c=t[e];return u.a.createElement("div",{key:s},u.a.createElement(R.a,{className:r.file_item,onClick:c.sha256?function(){i.push("/submission/detail/".concat(a,"/").concat(c.sha256,"?name=").concat(encodeURI(c.name[0])))}:null,style:{wordBreak:"break-word",backgroundColor:l(e)?"dark"===n.palette.type?"#343a44":"#d8e3ea":null}},u.a.createElement("span",null,u.a.createElement(Cc,{score:c.score,mono:!0,short:!0}),":: ".concat(c.name.join(" | ")," "),u.a.createElement("span",{style:{fontSize:"80%",color:n.palette.text.secondary}},"[".concat(c.type,"]")))),u.a.createElement("div",{style:{marginLeft:n.spacing(3)}},u.a.createElement(eg,{tree:c.children,sid:a})))})))})),tg=u.a.memo((function(e){var t=e.tree,a=e.sid,r=Object(X.a)(["submissionDetail"]).t,i=u.a.useState(!0),l=Object(n.a)(i,2),s=l[0],c=l[1],o=Object(v.a)(),m=$p(),d=o.spacing(2);return u.a.createElement("div",{style:{paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){c(!s)},className:m.title},r("tree")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:s,timeout:"auto"},u.a.createElement("div",{style:{paddingTop:d}},null!==t?u.a.createElement(eg,{tree:t,sid:a}):Object(oe.a)(Array(3)).map((function(e,t){return u.a.createElement("div",{style:{display:"flex"},key:t},u.a.createElement(pr.a,{style:{height:"2rem",width:"1.5rem",marginRight:"0.5rem"}}),u.a.createElement(pr.a,{style:{flexGrow:1}}))})))))})),ag=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),ng=u.a.memo((function(e){var t=e.heuristics,a=Object(X.a)(["submissionDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=ag(),d=c.spacing(2),p=em().getKey;return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("heuristics")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},t?Object.keys(t).map((function(e,r){return u.a.createElement(Br.a,{container:!0,key:r},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500,wordBreak:"break-word"}},a("verdict.".concat(e)))),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},t[e].map((function(t,a){var r=Object(n.a)(t,2),i=r[0],l=r[1];return u.a.createElement(gm,{key:"".concat(i,"_").concat(a),text:l,lvl:e,highlight_key:p("heuristic",i)})}))))})):Object(oe.a)(Array(3)).map((function(e,t){return u.a.createElement(Br.a,{container:!0,key:t,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement(pr.a,{style:{height:"2rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},u.a.createElement(pr.a,{style:{height:"2rem"}})))})))}),[p,t])))})),rg=a(442),ig=a.n(rg),lg=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}}}})),sg=u.a.memo((function(e){var t=e.submission,a=Object(X.a)(["submissionDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=lg(),d=c.spacing(2);return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("information")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("params.description"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{wordBreak:"break-word"}},t?t.params.description:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("params.groups"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{wordBreak:"break-word"}},t?t.params.groups.join(" | "):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("params.services.selected"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{wordBreak:"break-word"}},t?t.params.services.selected.join(" | "):u.a.createElement(pr.a,null)),["deep_scan","ignore_cache","ignore_dynamic_recursion_prevention","ignore_filtering"].map((function(e,n){return u.a.createElement("div",{key:n,style:{display:"contents"}},u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("params.".concat(e)))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},t?t.params[e]?u.a.createElement(ig.a,{color:"primary"}):u.a.createElement(_d.a,{color:"error"}):u.a.createElement(pr.a,null)))})),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("params.submitter"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{wordBreak:"break-word"}},t?t.params.submitter:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("max_score"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},t?u.a.createElement(Cc,{score:t.max_score}):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("times.submitted"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},t?u.a.createElement(Dl.a,{format:"YYYY-MM-DD HH:mm:ss"},t.times.submitted):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},a("times.completed"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},t&&t.times.completed?u.a.createElement(Dl.a,{format:"YYYY-MM-DD HH:mm:ss"},t.times.completed):u.a.createElement(pr.a,null))))}),[t])))})),cg=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}},meta_key:{overflowX:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}})),og=u.a.memo((function(e){var t=e.metadata,a=Object(X.a)(["submissionDetail"]).t,r=u.a.useState(!0),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(v.a)(),m=cg(),d=c.spacing(2);return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){s(!l)},className:m.title},a("metadata")),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:l,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:d,paddingTop:d}},t?Object.keys(t).map((function(e,a){return u.a.createElement(Br.a,{container:!0,key:a},u.a.createElement(Br.a,{className:m.meta_key,item:!0,xs:12,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e)),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10,style:{wordBreak:"break-word"}},t[e]))})):Object(oe.a)(Array(3)).map((function(e,t){return u.a.createElement(Br.a,{container:!0,key:t,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,sm:3,lg:2},u.a.createElement(pr.a,{style:{height:"2rem"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},u.a.createElement(pr.a,{style:{height:"2rem"}})))})))}),[t])))})),ug=Object(i.a)((function(e){return{title:{cursor:"pointer","&:hover, &:focus":{color:e.palette.text.secondary}},meta_key:{overflowX:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}})),mg=u.a.memo((function(e){var t=e.tag_group,a=e.tags,r=Object(X.a)(["submissionDetail"]).t,i=u.a.useState(!0),l=Object(n.a)(i,2),s=l[0],c=l[1],m=Object(v.a)(),d=ug(),p=m.spacing(2),g=em().getKey;return u.a.createElement("div",{style:{paddingBottom:p,paddingTop:p}},u.a.createElement(Kt.a,{variant:"h6",onClick:function(){return c(!s)},className:d.title},r(t)),u.a.createElement(j.a,null),u.a.createElement(P.a,{in:s,timeout:"auto"},Object(o.useMemo)((function(){return u.a.createElement("div",{style:{paddingBottom:p,paddingTop:p}},Object.keys(a).map((function(e,t){return u.a.createElement(Br.a,{container:!0,key:t},u.a.createElement(Br.a,{className:d.meta_key,item:!0,xs:12,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e)),u.a.createElement(Br.a,{item:!0,xs:12,sm:9,lg:10},a[e].map((function(t,a){var r=Object(n.a)(t,2),i=r[0],l=r[1];return u.a.createElement(vm,{key:a,value:i,type:e,lvl:l,highlight_key:g(e,i)})}))))})))}),[g,a])))})),dg=function(e,t){return null===t?null:null===e?t:{result:Object(h.a)(Object(h.a)({},e.result),t.result),error:Object(h.a)(Object(h.a)({},e.error),t.error)}},pg=function(e,t){if(null===t)return[];var a=t.filter((function(t){return-1===e.indexOf(t)}));return 0!==a.length?[].concat(Object(oe.a)(e),Object(oe.a)(a)):e},gg=function(e,t){return null===t?0:e+t};function fg(){var e=Object(X.a)(["submissionDetail"]).t,t=Object(ue.i)(),a=t.id,r=t.fid,i=Object(v.a)(),l=Object(o.useState)(null),s=Object(n.a)(l,2),c=s[0],m=s[1],d=Object(o.useState)(null),p=Object(n.a)(d,2),g=p[0],f=p[1],b=Object(o.useState)(null),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Object(o.useState)(null),x=Object(n.a)(_,2),w=x[0],j=x[1],k=Object(o.useReducer)(pg,[]),S=Object(n.a)(k,2),C=S[0],T=S[1],A=Object(o.useReducer)(pg,[]),N=Object(n.a)(A,2),R=N[0],z=N[1],D=Object(o.useReducer)(pg,[]),B=Object(n.a)(D,2),q=B[0],L=B[1],F=Object(o.useReducer)(dg,null),P=Object(n.a)(F,2),M=P[0],W=P[1],U=Object(o.useState)(null),H=Object(n.a)(U,2),V=H[0],G=H[1],J=Object(o.useState)(null),Q=Object(n.a)(J,2),K=Q[0],$=Q[1],ee=Object(o.useState)(null),te=Object(n.a)(ee,2),ae=te[0],ne=te[1],re=Object(o.useState)(null),ie=Object(n.a)(re,2),le=ie[0],se=ie[1],ce=Object(o.useReducer)(gg,0),me=Object(n.a)(ce,2),de=me[0],pe=me[1],ge=Object(o.useState)(null),fe=Object(n.a)(ge,2),he=fe[0],be=fe[1],ve=Object(o.useState)(null),Ee=Object(n.a)(ve,2),ye=Ee[0],Oe=Ee[1],_e=Object(o.useState)(0),xe=Object(n.a)(_e,2),we=xe[0],je=xe[1],ke=Object(o.useState)(!1),Se=Object(n.a)(ke,2),Ce=Se[0],Te=Se[1],Ae=dr(),Ne=i.spacing(4),Ie=$n(),Re=Ie.showSuccessMessage,ze=Ie.showErrorMessage,De=Object(ue.g)(),Be=Ma(),qe=Be.user,Le=Be.c12nDef,Fe=em().setHighlightMap,Pe=el(),Me=Pe.setGlobalDrawer,We=Pe.globalDrawer,Ue=function(e){var t=null!==y?Object(h.a)({},y):{};Object.entries(e).forEach((function(e){var a=Object(n.a)(e,2),r=a[0],i=a[1],l=r.substr(0,64),s=function e(t,a){var r=[];return Object.entries(a).forEach((function(a){var i=Object(n.a)(a,2),l=i[0],s=i[1];0!==Object.keys(s.children).length&&(r=[].concat(Object(oe.a)(r),Object(oe.a)(e(t,s.children)))),l===t&&r.push(s)})),r}(l,t);if(0===s.length){var o=function(e){if(null!==c)for(var t in c.files)if(c.files[t].sha256===e)return c.files[t].name;return null}(l);null!=o?(t[l]={children:{},name:[o],score:0,sha256:l,type:"N/A"},s.push(t[l])):(Object.hasOwnProperty.call(t,"TBD")||(t.TBD={children:{},name:["Undetermined Parent"],score:0,type:"N/A"}),t.TBD.children[l]={children:{},name:[l],score:0,sha256:l,type:"N/A"},s.push(t.TBD.children[l]))}var u=[];for(var m in s)if(Object.hasOwnProperty.call(s,m)){var d=s[m];for(var p in void 0!==i.result.score&&(d.score+=i.result.score),i.response.extracted)if(Object.hasOwnProperty.call(i.response.extracted,p)){var g=i.response.extracted[p],f=g.sha256,h=g.name;Object.hasOwnProperty.call(d.children,f)?d.children[f].name.push(h):Object.hasOwnProperty.call(t,"TBD")&&Object.hasOwnProperty.call(t.TBD.children,f)?(d.children[f]=t.TBD.children[f],d.children[f].name=[h],-1===u.indexOf(f)&&u.push(f)):d.children[f]={children:{},name:[h],score:0,sha256:f,type:"N/A"}}}for(var b in u)Object.hasOwnProperty.call(u,b)&&delete t.TBD.children[u[b]]})),t.TBD&&0===Object.keys(t.TBD.children).length&&delete t.TBD,O(t)},He=function(e){var t;return{aggregated:function(e){var t={depth:[],files:[],retry:[],down:[],busy:[]};return e.forEach((function(e){var a=Yp(e),n=function(e){var t=e.substr(65,e.length);return-1!==t.indexOf(".e")&&(t=t.substr(t.indexOf(".e")+2,t.length)),t}(e);"20"===n&&-1===t.busy.indexOf(a)&&t.busy.push(a),"21"===n?-1===t.down.indexOf(a)&&t.down.push(a):"12"===n?-1===t.retry.indexOf(a)&&t.retry.push(a):"10"===n?-1===t.depth.indexOf(a)&&t.depth.push(a):"11"===n&&-1===t.files.indexOf(a)&&t.files.push(a)})),t.busy.sort(),t.down.sort(),t.depth.sort(),t.files.sort(),t.retry.sort(),t}(e),listed:(t=e,t.filter((function(e){var t=e.substr(65,e.length);return-1!==t.indexOf(".e")&&(t=t.substr(t.indexOf(".e")+2,t.length)),-1===["20","21","12","10","11"].indexOf(t)})))}},Ve=function(e){return Object(h.a)(Object(h.a)({},e),{},{parsed_errors:He(e.errors)})},Ge=Object(o.useCallback)((function(){he&&(he.disconnect(),T(null),z(null),L(null),W(null),$(null),ne(null),be(null),se(null),pe(null),je(0),j(null))}),[he]),Ye=Object(o.useCallback)((function(){null!=c&&Ae({url:"/api/v4/submit/resubmit/".concat(c.sid,"/"),onSuccess:function(t){Re(e("submit.success")),Ge(),m(null),f(null),O(null),setTimeout((function(){De.push("/submission/detail/".concat(t.api_response.sid))}),500)}})}),[Ae,De,Ge,Re,c,e]),Je=Object(o.useCallback)((function(e){null!=c&&-1===c.verdict[e].indexOf(qe.username)&&Ae({method:"PUT",url:"/api/v4/submission/verdict/".concat(c.sid,"/").concat(e,"/"),onSuccess:function(t){if(t.api_response.success){var a=Object(h.a)({},c);"malicious"===e?(-1===a.verdict.malicious.indexOf(qe.username)&&a.verdict.malicious.push(qe.username),-1!==a.verdict.non_malicious.indexOf(qe.username)&&a.verdict.non_malicious.splice(a.verdict.non_malicious.indexOf(qe.username),1)):(-1===a.verdict.non_malicious.indexOf(qe.username)&&a.verdict.non_malicious.push(qe.username),-1!==a.verdict.malicious.indexOf(qe.username)&&a.verdict.malicious.splice(c.verdict.malicious.indexOf(qe.username),1)),m(a)}}})}),[Ae,qe.username,c]);Object(o.useEffect)((function(){Ae({url:"/api/v4/help/configuration/",onSuccess:function(e){G(e.api_response)}}),Ae({url:"/api/v4/submission/".concat(a,"/"),onSuccess:function(e){m(Ve(e.api_response))}})}),[a]),Object(o.useEffect)((function(){if(c)if("completed"===c.state)Ge(),Ae({url:"/api/v4/submission/summary/".concat(a,"/"),onSuccess:function(e){Fe(e.api_response.map),f(e.api_response)}}),Ae({url:"/api/v4/submission/tree/".concat(a,"/"),onSuccess:function(e){O(e.api_response.tree)}});else{if(!he){console.debug("SocketIO :: Init => Create SocketIO client...");var e=Su()("/live_submission");e.on("connect",(function(){console.debug("SocketIO :: Conn => Connecting to socketIO server...")})),e.on("disconnect",(function(){console.debug("SocketIO :: Conn => Disconnected from socketIO server...")})),be(e)}Oe(setInterval((function(){return pe(1)}),5e3)),Ae({url:"/api/v4/live/setup_watch_queue/".concat(a,"/"),onSuccess:function(e){j(e.api_response.wq_id)}})}}),[c]);var Qe=Object(o.useCallback)((function(t){console.debug("SocketIO :: onError => ".concat(t.msg)),ze(e("dispatcher.not_responding"),15e3),Ae({url:"/api/v4/live/setup_watch_queue/".concat(a,"/"),onSuccess:function(e){j(e.api_response.wq_id)}})}),[a]),Ke=function(e){console.debug("SocketIO :: onStart => ".concat(e.msg)),setTimeout((function(){return pe(1)}),500)},Xe=Object(o.useCallback)((function(e){console.debug("SocketIO :: onStop => ".concat(e.msg)),setTimeout((function(){ye&&clearInterval(ye),Oe(null),se(null),Ae({url:"/api/v4/submission/".concat(a,"/"),onSuccess:function(e){m(Ve(e.api_response))}})}),2e3)}),[a]),Ze=function(e){console.debug("SocketIO :: onCacheKey => ".concat(e.msg)),T([e.msg])},$e=function(e){console.debug("SocketIO :: onCacheKeyError => ".concat(e.msg)),z([e.msg])},et=function(){je(de),se(null)};return Object(o.useEffect)((function(){return function(){ye&&clearInterval(ye)}}),[ye]),Object(o.useEffect)((function(){return he&&(console.debug("SocketIO :: Init => Registering SocketIO Callbacks..."),he.on("error",Qe),he.on("start",Ke),he.on("stop",Xe),he.on("cachekey",Ze),he.on("cachekeyerr",$e)),function(){he&&he.disconnect()}}),[he,Qe,Xe]),Object(o.useEffect)((function(){w&&he&&(console.debug("SocketIO :: emitListen => Listening for messages on watch queue: ".concat(w)),he.emit("listen",{wq_id:w,from_start:!0}))}),[w,he,Qe]),Object(o.useEffect)((function(){null!==c&&null===We&&void 0!==r&&De.push("/submission/detail/".concat(a))}),[We]),Object(o.useEffect)((function(){if(r)if(M){var e=[],t=[];Object.entries(M.result).forEach((function(t){var a=Object(n.a)(t,2),i=a[0],l=a[1];i.startsWith(r)&&e.push(l)})),Object.entries(M.error).forEach((function(e){var a=Object(n.a)(e,2),i=a[0],l=a[1];i.startsWith(r)&&t.push(l)})),Me(u.a.createElement(md,{sha256:r,sid:a,liveResultKeys:C,liveErrors:t}))}else Me(u.a.createElement(md,{sha256:r,sid:a}))}),[r]),Object(o.useEffect)((function(){if(0!==de){console.debug("LIVE :: Checking for new keys to load...");var e=C.filter((function(e){return-1===q.indexOf(e)})),t=R.filter((function(e){return-1===q.indexOf(e)}));0!==e.length||0!==t.length?(console.debug("LIVE :: New Results: ".concat(e.join(" | ")," - New Errors: ").concat(t.join(" | "))),$(He(R)),Ae({method:"POST",url:"/api/v4/result/multiple_keys/",body:{error:t,result:e},onSuccess:function(a){je(de),L([].concat(Object(oe.a)(e),Object(oe.a)(t))),W(a.api_response),Ue(a.api_response.result),function(e){var t=null!==g?Object(h.a)({},g):{tags:{},heuristics:{},attack_matrix:{}},a=null!==ae?Object(h.a)({},ae):{};Object.entries(e).forEach((function(e){var r=Object(n.a)(e,2),i=r[0],l=r[1],s=i.substr(0,64);for(var c in Object.hasOwnProperty.call(a,s)||(a[s]=[]),l.result.sections){var o=l.result.sections[c],u="info";if(null!==o.heuristic&&void 0!==o.heuristic){u=o.heuristic.score<100?"info":o.heuristic.score<1e3?"suspicious":"malicious",Object.hasOwnProperty.call(t.heuristics,u)||(t.heuristics[u]=[]);var m=!1,d=[o.heuristic.heur_id,o.heuristic.name];for(var p in t.heuristics[u])if(t.heuristics[u][p][0]===d[0]&&t.heuristics[u][p][1]===d[1]){m=!0;break}if(!m){t.heuristics[u].push(d);var g="heuristic__".concat(o.heuristic.heur_id);a[s].push(g),Object.hasOwnProperty.call(a,g)||(a[g]=[]),a[g].push(s)}if(o.heuristic.attack)for(var f in o.heuristic.attack){var h=o.heuristic.attack[f];for(var b in h.categories){var v=h.categories[b];Object.hasOwnProperty.call(t.attack_matrix,v)||(t.attack_matrix[v]=[]);var E=!1,y=[h.attack_id,h.pattern,u];for(var O in t.attack_matrix[v])if(t.attack_matrix[v][O][0]===y[0]&&t.attack_matrix[v][O][1]===y[1]&&t.attack_matrix[v][O][2]===y[2]){E=!0;break}if(!E){t.attack_matrix[v].push(y);var _="attack_pattern__".concat(h.attack_id);a[s].push(_),Object.hasOwnProperty.call(a,_)||(a[_]=[]),a[_].push(s)}}}}for(var x in o.tags){var w=o.tags[x],j=null;if(-1!==V["submission.tag_types.attribution"].indexOf(w.type)?j="attribution":-1!==V["submission.tag_types.behavior"].indexOf(w.type)?j="behavior":-1!==V["submission.tag_types.ioc"].indexOf(w.type)&&(j="ioc"),null!==j){Object.hasOwnProperty.call(t.tags,j)||(t.tags[j]={}),Object.hasOwnProperty.call(t.tags[j],w.type)||(t.tags[j][w.type]=[]);var k=!1,S=[w.value,u];for(var C in t.tags[j][w.type])if(t.tags[j][w.type][C][0]===S[0]&&t.tags[j][w.type][C][1]===S[1]){k=!0;break}if(!k){t.tags[j][w.type].push(S);var T="".concat(w.type,"__").concat(w.value);a[s].push(T),Object.hasOwnProperty.call(a,T)||(a[T]=[]),a[T].push(s)}}}}})),ne(a),Fe(a),f(t)}(a.api_response.result)}})):de>=we+4&&(!le||de%4===0)&&(console.debug("LIVE :: Finding out oustanding services..."),Ae({url:"/api/v4/live/outstanding_services/".concat(a,"/"),onSuccess:function(e){se(e.api_response)}}))}}),[de]),u.a.createElement(ir,{margin:4,width:"100%"},u.a.createElement(Si,{open:Ce,handleClose:function(){return Te(!1)},handleAccept:function(){null!=c&&Ae({method:"DELETE",url:"/api/v4/submission/".concat(c.sid,"/"),onSuccess:function(t){Re(e("delete.success")),Te(!1),setTimeout((function(){De.push("/submissions")}),500)}})},title:e("delete.title"),cancelText:e("delete.cancelText"),acceptText:e("delete.acceptText"),text:e("delete.text")}),u.a.createElement(Pp.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:null!==le,key:"outstanding",style:{top:i.spacing(8),zIndex:100}},le&&(Object.keys(le).length>0?u.a.createElement(Bl.a,{elevation:6,severity:"info",style:{textAlign:"left"},action:u.a.createElement(Z.a,{"aria-label":"close",color:"inherit",size:"small",onClick:et,style:{alignSelf:"start",margin:"6px 6px 0 0"}},u.a.createElement(Yr.a,{fontSize:"inherit"}))},u.a.createElement("span",{style:{fontWeight:500,textAlign:"left"}},e("outstanding.title")),u.a.createElement(Br.a,{container:!0,style:{marginTop:i.spacing(1)}},u.a.createElement(Br.a,{item:!0,xs:6},u.a.createElement("b",null,e("outstanding.services"))),u.a.createElement(Br.a,{item:!0,xs:6},u.a.createElement("b",null,e("outstanding.files")))),Object.keys(le).map((function(e){return u.a.createElement(Br.a,{key:e,container:!0},u.a.createElement(Br.a,{item:!0,xs:6},u.a.createElement("b",null,e)),u.a.createElement(Br.a,{item:!0,xs:6},le[e]))}))):u.a.createElement(Bl.a,{elevation:6,severity:"error",action:u.a.createElement(Z.a,{"aria-label":"close",color:"inherit",size:"small",onClick:et,style:{alignSelf:"start",margin:"6px 6px 0 0"}},u.a.createElement(Yr.a,{fontSize:"inherit"}))},u.a.createElement("div",{style:{textAlign:"left"}},e("outstanding.error"))))),u.a.createElement("div",{style:{textAlign:"left"}},Object(o.useMemo)((function(){return u.a.createElement(u.a.Fragment,null,Le.enforce&&u.a.createElement("div",{style:{paddingBottom:Ne}},u.a.createElement(ki,{size:"tiny",c12n:c?c.classification:null})),u.a.createElement("div",{style:{paddingBottom:Ne}},u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement("div",null,u.a.createElement(Kt.a,{variant:"h4"},e("title")),u.a.createElement(Kt.a,{variant:"caption"},c?c.sid:u.a.createElement(pr.a,{style:{width:"10rem"}}))),he&&u.a.createElement("div",{style:{paddingBottom:i.spacing(3),paddingTop:i.spacing(2),color:"dark"===i.palette.type?i.palette.primary.light:i.palette.primary.dark}},u.a.createElement(Hp.a,{style:{height:i.spacing(2),width:i.spacing(2),verticalAlign:"sub",marginRight:i.spacing(1)}}),e("live_mode"),u.a.createElement(tl.a,null))),u.a.createElement(Br.a,{item:!0,xs:12,sm:6,md:4},u.a.createElement("div",{style:{textAlign:"right"}},u.a.createElement(I.a,{title:e("delete")},u.a.createElement(Z.a,{onClick:function(){return Te(!0)},style:{color:"dark"===i.palette.type?i.palette.error.light:i.palette.error.dark}},u.a.createElement(Jl.a,null))),u.a.createElement(I.a,{title:e("download")},u.a.createElement(Z.a,{component:$t.a,href:"/api/v4/bundle/".concat(c?c.sid:a,"/?XSRF_TOKEN=").concat(mr())},u.a.createElement(Wp.a,{color:"action"}))),u.a.createElement(I.a,{title:e("resubmit")},u.a.createElement(Z.a,{onClick:Ye},u.a.createElement(Gp.a,null))),u.a.createElement(I.a,{title:e("report_view")},u.a.createElement(Z.a,{component:Y.b,to:"/submission/report/".concat(c?c.sid:a)},u.a.createElement(Ln.a,null)))),u.a.createElement("div",{style:{textAlign:"right",width:"164px",marginTop:"8px",marginLeft:"auto",marginRight:"12px"}},c?u.a.createElement(su,{verdicts:c.verdict}):u.a.createElement(pr.a,null),u.a.createElement(Br.a,{container:!0},u.a.createElement(Br.a,{item:!0,xs:5,style:{textAlign:"left"}},u.a.createElement(I.a,{title:e("verdict.".concat(c&&-1!==c.verdict.malicious.indexOf(qe.username)?"is":"set",".malicious"))},u.a.createElement(Z.a,{size:"small",onClick:function(){return Je("malicious")}},u.a.createElement(vc.a,{style:{color:c&&-1!==c.verdict.malicious.indexOf(qe.username)?i.palette.error.dark:null}})))),u.a.createElement(Br.a,{item:!0,xs:2}),u.a.createElement(Br.a,{item:!0,xs:5,style:{textAlign:"right"}},u.a.createElement(I.a,{title:e("verdict.".concat(c&&-1!==c.verdict.non_malicious.indexOf(qe.username)?"is":"set",".non_malicious"))},u.a.createElement(Z.a,{size:"small",onClick:function(){return Je("non_malicious")}},u.a.createElement(yc.a,{style:{color:c&&-1!==c.verdict.non_malicious.indexOf(qe.username)?i.palette.success.dark:null}}))))))))))}),[c,a,he,i,e]),u.a.createElement(sg,{submission:c}),(!c||0!==Object.keys(c.metadata).length)&&u.a.createElement(og,{metadata:c?c.metadata:null}),(!g||0!==Object.keys(g.attack_matrix).length)&&u.a.createElement(Kp,{attack_matrix:g?g.attack_matrix:null}),(!g||0!==Object.keys(g.heuristics).length)&&u.a.createElement(ng,{heuristics:g?g.heuristics:null}),g&&0!==Object.keys(g.tags).length&&Object.keys(g.tags).map((function(e,t){return 0!==Object.keys(g.tags[e]).length&&u.a.createElement(mg,{key:t,tag_group:e,tags:g.tags[e]})})),c&&"completed"===c.state&&0!==Object.keys(c.errors).length&&u.a.createElement(Zp,{sid:a,parsed_errors:c.parsed_errors}),c&&"completed"!==c.state&&0!==R.length&&null!==K&&u.a.createElement(Zp,{sid:a,parsed_errors:K}),u.a.createElement(tg,{tree:y,sid:a})))}var hg=a(446),bg=a.n(hg),vg=a(447),Eg=a.n(vg),yg={info:"default",safe:"success",suspicious:"warning",highly_suspicious:"warning",malicious:"error"},Og=u.a.memo((function(e){var t=e.verdict,a=e.variant,n=void 0===a?"default":a,r=e.size,i=void 0===r?"tiny":r,l=e.mono,s=void 0!==l&&l,c=e.fullWidth,o=void 0!==c&&c,m=Object(X.a)().t,d=yg[t];return u.a.createElement(I.a,{title:m("verdict.".concat(t))},u.a.createElement("span",null,u.a.createElement(mi,{type:"rounded",variant:n,size:i,label:m("verdict.".concat(t,".short")),color:d,mono:s,fullWidth:o})))})),_g=Object(i.a)((function(e){return{circle:{position:"relative",zIndex:1,top:"-90px",left:"15px",borderRadius:"50%",width:"70px",height:"70px",boxShadow:e.shadows[2],backgroundColor:e.palette.background.paper,textAlign:"center","@media print":{backgroundColor:"#FFFFFF"}},text:{fontSize:"30px",lineHeight:"30px",paddingTop:"15px",fontWeight:900,color:e.palette.text.secondary,"@media print":{color:"#00000066"}},under_text:{fontSize:"13px",lineHeight:"13px",fontWeight:300,color:e.palette.text.secondary,"@media print":{color:"#00000066"}}}})),xg=function(e){var t=e.verdicts,a=e.max,n=void 0===a?20:a,r=e.colorBack,i=void 0===r?"#68686815":r,l=Object(X.a)().t,s=_g(),c=Object(v.a)(),o="dark"===c.palette.type?c.palette.error.light:c.palette.error.dark,m="dark"===c.palette.type?c.palette.success.light:c.palette.success.dark,d=Object(xu.a)().innerRadius(.7).outerRadius(.95).startAngle(-Math.PI).endAngle(Math.PI).cornerRadius(0)(),p=Object(_u.a)().domain([0,n]).range([0,1]),g=Object(_u.a)().domain([0,1]).range([0,Math.PI]).clamp(!0),f=Object(xu.a)().innerRadius(.7).outerRadius(.95).startAngle(0).endAngle(g(p(t.malicious.length))).cornerRadius(0)(),h=Object(_u.a)().domain([0,1]).range([0,-Math.PI]).clamp(!0),b=Object(xu.a)().innerRadius(.7).outerRadius(.95).startAngle(h(p(t.non_malicious.length))).endAngle(0).cornerRadius(0)();return u.a.createElement("div",null,u.a.createElement(I.a,{title:"".concat(l("verdict.non_malicious"),": ").concat(t.non_malicious.length," / ").concat(l("verdict.malicious"),": ").concat(t.malicious.length)},u.a.createElement("div",{style:{width:"100px",height:"100px",display:"block"}},u.a.createElement("svg",{style:{position:"relative",width:"100px",height:"100px"},viewBox:[-1,-1,2,1].join(" ")},u.a.createElement("g",{style:{transform:"translateY(-50%)"}},u.a.createElement("path",{d:d,fill:i}),u.a.createElement("path",{d:b,fill:m}),u.a.createElement("path",{d:f,fill:o}))),u.a.createElement("div",{className:s.circle},u.a.createElement("div",{className:s.text,style:{color:t.non_malicious.length>t.malicious.length?m:t.malicious.length>t.non_malicious.length?o:null}},t.non_malicious.length>t.malicious.length?t.non_malicious.length:t.malicious.length),u.a.createElement("div",{className:s.under_text},"/ ".concat(t.non_malicious.length+t.malicious.length))))))},wg=Object(i.a)((function(e){var t;return{avatar:Object(r.a)({display:"inline-flex",width:e.spacing(16),height:e.spacing(16),marginRight:e.spacing(2)},e.breakpoints.down("xs"),{width:e.spacing(12),height:e.spacing(12),marginRight:0}),banner_title:Object(r.a)({fontWeight:500,fontSize:"200%"},e.breakpoints.down("xs"),{fontSize:"180%"}),divider:{"@media print":{backgroundColor:"#0000001f !important"}},file_details:{fontFamily:"monospace",color:e.palette.text.secondary,wordBreak:"break-word",paddingBottom:"4px","@media print":{color:"rgba(0, 0, 0, 0.54)"}},icon:(t={marginLeft:"24px",marginRight:"36px",fontSize:"400%"},Object(r.a)(t,e.breakpoints.down("xs"),{marginLeft:"16px",marginRight:"20px",fontSize:"350%"}),Object(r.a)(t,"@media print",{marginLeft:"24px",marginRight:"36px",fontSize:"400%"}),t),malicious_heur:{textTransform:"capitalize",fontWeight:700,padding:"5px",WebkitPrintColorAdjust:"exact",backgroundColor:"#f2000015 !important",borderBottom:"1px solid #d9534f !important"},suspicious_heur:{textTransform:"capitalize",fontWeight:700,padding:"5px",WebkitPrintColorAdjust:"exact",backgroundColor:"#ff970015 !important",borderBottom:"1px solid #f0ad4e !important"},info_heur:{textTransform:"capitalize",fontWeight:700,padding:"5px",WebkitPrintColorAdjust:"exact",backgroundColor:"#6e6e6e15 !important",borderBottom:"1px solid #aaa !important"}}}));function jg(e){var t=e.report,a=Object(X.a)(["submissionReport"]).t,n=Object(v.a)(),r=n.spacing(2),i=n.spacing(1),l=wg(),s=t?t.max_score:0,c={info:{icon:u.a.createElement(bg.a,{className:l.icon}),bgColor:"#6e6e6e15",textColor:"dark"===n.palette.type?"#AAA":"#888"},safe:{icon:u.a.createElement(yc.a,{className:l.icon}),bgColor:"#00f20015",textColor:"dark"!==n.palette.type?n.palette.success.dark:n.palette.success.light},suspicious:{icon:u.a.createElement(au.a,{className:l.icon}),bgColor:"#ff970015",textColor:"dark"!==n.palette.type?n.palette.warning.dark:n.palette.warning.light},highly_suspicious:{icon:u.a.createElement(au.a,{className:l.icon}),bgColor:"#ff970015",textColor:"dark"!==n.palette.type?n.palette.warning.dark:n.palette.warning.light},malicious:{icon:u.a.createElement(vc.a,{className:l.icon}),bgColor:"#f2000015",textColor:"dark"!==n.palette.type?n.palette.error.dark:n.palette.error.light}}[kc(s)],o=c.bgColor,m=c.icon,d=c.textColor,p=t&&t.tags&&t.tags.attributions&&t.tags.attributions["attribution.implant"]?Object.keys(t.tags.attributions["attribution.implant"]).join(" | "):null,g=t&&t.tags&&t.tags.attributions&&t.tags.attributions["attribution.family"]?Object.keys(t.tags.attributions["attribution.family"]).join(" | "):null,f=t&&t.tags&&t.tags.attributions&&t.tags.attributions["attribution.actor"]?Object.keys(t.tags.attributions["attribution.actor"]).join(" | "):null;return u.a.createElement("div",{style:{marginBottom:r,marginTop:r,padding:i,backgroundColor:o,border:"solid 1px ".concat(d),borderRadius:"4px"}},u.a.createElement(Br.a,{container:!0,alignItems:"center",justify:"center"},u.a.createElement(Zo.a,{smDown:!0},u.a.createElement(Br.a,{item:!0,xs:!0,style:{color:d}},m)),u.a.createElement(Br.a,{item:!0,xs:!0,style:{flexGrow:10}},u.a.createElement("div",{className:l.banner_title},t?u.a.createElement(Cc,{type:"text",size:"medium",score:t.max_score}):u.a.createElement(pr.a,null)),u.a.createElement("table",{width:t?null:"100%",style:{borderSpacing:0}},u.a.createElement("tbody",null,u.a.createElement("tr",null,t?p&&u.a.createElement(u.a.Fragment,null,u.a.createElement("td",{style:{whiteSpace:"nowrap",fontStyle:"italic",verticalAlign:"top"}},"".concat(a("implant"),": ")),u.a.createElement("td",{style:{fontWeight:500,paddingLeft:i}},Object.keys(t.tags.attributions["attribution.implant"]).join(" | "))):u.a.createElement("td",null,u.a.createElement(pr.a,null))),u.a.createElement("tr",null,t?g&&u.a.createElement(u.a.Fragment,null,u.a.createElement("td",{style:{whiteSpace:"nowrap",fontStyle:"italic",verticalAlign:"top"}},"".concat(a("family"),": ")),u.a.createElement("td",{style:{fontWeight:500,paddingLeft:i}},Object.keys(t.tags.attributions["attribution.family"]).join(" | "))):u.a.createElement("td",null,u.a.createElement(pr.a,null))),u.a.createElement("tr",null,t?f&&u.a.createElement(u.a.Fragment,null,u.a.createElement("td",{style:{whiteSpace:"nowrap",fontStyle:"italic",verticalAlign:"top"}},"".concat(a("actor"),": ")),u.a.createElement("td",{style:{fontWeight:500,paddingLeft:i}},Object.keys(t.tags.attributions["attribution.actor"]).join(" | "))):u.a.createElement("td",null,u.a.createElement(pr.a,null)))))),u.a.createElement(Br.a,{item:!0,xs:!0,style:{color:d,paddingLeft:i,paddingRight:i}},t?u.a.createElement(xg,{verdicts:t.verdict}):u.a.createElement(pr.a,{variant:"circle",height:"100px",width:"100px"}))))}function kg(e){var t=e.group,a=e.items,n=Object(X.a)(["submissionReport"]).t,r=Object(v.a)(),i={},l=r.spacing(2),s=r.spacing(1),c=wg();return Object.keys(a).map((function(e){return Object.keys(a[e]).map((function(t){var n="".concat(a[e][t].h_type,"_").concat(e);return Object.hasOwnProperty.call(i,n)||(i[n]={verdict:a[e][t].h_type,type:e,values:[]}),i[n].values.push(t),null}))})),u.a.createElement("div",{style:{paddingBottom:l,paddingTop:l,pageBreakInside:"avoid"}},u.a.createElement(Kt.a,{variant:"h6"},n("tag.".concat(t))),u.a.createElement(j.a,{className:c.divider}),u.a.createElement("div",{style:{paddingTop:l,paddingBottom:l,paddingLeft:s,paddingRight:s}},u.a.createElement(Br.a,{container:!0,spacing:1},Object.keys(i).map((function(e,t){return u.a.createElement(Br.a,{key:t,style:{marginBottom:l,paddingLeft:s,paddingRight:s,minWidth:"21rem"}},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0},u.a.createElement("div",{style:{display:"flex",minWidth:"5rem"}},u.a.createElement(Og,{verdict:i[e].verdict,mono:!0}),u.a.createElement(I.a,{title:i[e].type},u.a.createElement("span",{style:{fontSize:"110%",flexGrow:1,textTransform:"capitalize"}},i[e].type.split(".").pop().replace("_"," "))))),u.a.createElement(Br.a,{item:!0},i[e].values.map((function(e,t){return u.a.createElement("div",{key:t,style:{paddingBottom:"5px",wordBreak:"break-word"}},e)})))))})))))}function Sg(e){var t=e.attack,a=e.items,n=Object(v.a)().spacing(2);return u.a.createElement("div",{style:{height:"100%",width:"100%",display:"inline-block",pageBreakInside:"avoid",paddingBottom:n}},u.a.createElement("span",{style:{fontSize:"1rem",textTransform:"capitalize"}},t.replace(/-/g," ")),Object.keys(a).map((function(e,t){return u.a.createElement("div",{key:t},u.a.createElement(Og,{verdict:a[e].h_type,mono:!0}),u.a.createElement("span",{style:{verticalAlign:"middle"}},e))})))}function Cg(){return u.a.createElement("div",{style:{paddingBottom:"1rem",height:"100%",width:"100%",display:"inline-block",pageBreakInside:"avoid"}},u.a.createElement(pr.a,{style:{height:"2rem"}}),u.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},u.a.createElement(pr.a,{style:{height:"2rem",width:"1.5rem",marginRight:"8px"}}),u.a.createElement(pr.a,{style:{height:"2rem",flexGrow:1}})),u.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},u.a.createElement(pr.a,{style:{height:"2rem",width:"1.5rem",marginRight:"8px"}}),u.a.createElement(pr.a,{style:{height:"2rem",flexGrow:1}})))}function Tg(e){var t=e.verdict,a=e.items,n=Object(v.a)(),r=Object(X.a)().t,i=wg(),l=n.spacing(2),s=n.spacing(1),c={malicious:i.malicious_heur,suspicious:i.suspicious_heur,info:i.info_heur};return u.a.createElement("div",{style:{flexGrow:1,minWidth:"200px"}},u.a.createElement("div",{className:c[t],style:{marginBottom:l,marginTop:l,fontSize:"1.2rem"}},r("verdict.".concat(t))),u.a.createElement("div",{style:{paddingLeft:s,paddingRight:s}},Object.keys(a).map((function(e,t){return u.a.createElement("div",{key:t,style:{fontSize:"1rem",verticalAlign:"middle",paddingBottom:"2px"}},e)}))))}function Ag(){return u.a.createElement("div",{style:{flexGrow:1,margin:5}},u.a.createElement(pr.a,{style:{height:"3.5rem"}}),u.a.createElement(pr.a,{style:{height:"2rem"}}),u.a.createElement(pr.a,{style:{height:"2rem"}}),u.a.createElement(pr.a,{style:{height:"2rem"}}))}function Ng(e){var t=e.tree,a=e.important_files,n=wg();return u.a.createElement("div",null,Object.keys(t).map((function(e,r){return-1!==a.indexOf(e)?u.a.createElement("div",{key:r,style:{pageBreakInside:"avoid"}},u.a.createElement("table",{style:{borderSpacing:0}},u.a.createElement("tbody",null,u.a.createElement("tr",null,u.a.createElement("td",{style:{verticalAlign:"top"}},u.a.createElement(Cc,{score:t[e].score,short:!0,mono:!0})),u.a.createElement("td",null,u.a.createElement("b",{style:{fontSize:"110%",wordBreak:"break-word"}},t[e].name.join(" | ")))),u.a.createElement("tr",null,u.a.createElement("td",null),u.a.createElement("td",null,u.a.createElement("div",{className:n.file_details},"".concat(t[e].sha256," - ").concat(t[e].type," - "),u.a.createElement("b",null,t[e].size),u.a.createElement("span",{style:{fontWeight:300}}," (",jc(t[e].size),")")))),u.a.createElement("tr",null,u.a.createElement("td",null),u.a.createElement("td",null,u.a.createElement(Ng,{tree:t[e].children,important_files:a})))))):null})))}function Ig(){function e(){return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{display:"flex"}},u.a.createElement(pr.a,{style:{height:"2rem",width:"2rem"}}),u.a.createElement(pr.a,{style:{height:"2rem",marginLeft:"1rem",flexGrow:1}})),u.a.createElement(pr.a,null),u.a.createElement(pr.a,null),u.a.createElement(pr.a,null))}return u.a.createElement("div",null,u.a.createElement(e,null),u.a.createElement("div",{style:{marginLeft:"2rem"}},u.a.createElement(e,null)))}function Rg(){var e=Object(X.a)(["submissionReport"]).t,t=Object(ue.i)().id,a=Ma().c12nDef,r=Object(ue.g)(),i=Object(v.a)(),s=Object(o.useState)(null),c=Object(n.a)(s,2),m=c[0],d=c[1],p=dr(),g=i.spacing(1),f=i.spacing(2),h=i.spacing(4),b=wg(),E=$n(),y=E.showErrorMessage,O=E.showWarningMessage,_=Object(l.a)("print");return Object(o.useEffect)((function(){p({url:"/api/v4/submission/report/".concat(t,"/"),onSuccess:function(e){d(e.api_response)},onFailure:function(a){425===a.api_status_code?(O(e("error.too_early")),r.replace("/submission/detail/".concat(t))):404===a.api_status_code?(y(e("error.notfound")),r.replace("/notfound")):y(a.api_error_message)}})}),[]),u.a.createElement(ir,{mt:_?0:4,mb:_?0:4,ml:_?2:4,mr:_?2:4,width:"100%"},u.a.createElement("div",{style:{textAlign:"left"}},a.enforce&&u.a.createElement("div",{style:{paddingBottom:h}},u.a.createElement(ki,{size:"tiny",c12n:m?m.classification:null})),a.enforce&&u.a.createElement("div",{className:"print-footer print-only"},"".concat(e("title")," :: ").concat(t," :: "),u.a.createElement(ki,{type:"text",size:"tiny",c12n:m?m.classification:null})),u.a.createElement("div",{style:{paddingBottom:f}},u.a.createElement(Br.a,{container:!0,alignItems:"center"},u.a.createElement(Br.a,{item:!0,xs:!0},u.a.createElement("div",null,u.a.createElement(Kt.a,{variant:"h4"},e("title")),u.a.createElement(Kt.a,{variant:"caption"},m?m.sid:u.a.createElement(pr.a,{style:{width:"10rem"}})))),u.a.createElement(Br.a,{item:!0,className:"print-only"},u.a.createElement("img",{src:"".concat("","/images/banner.svg"),alt:"Assemblyline Banner",style:{height:"72px"}})),u.a.createElement(Br.a,{item:!0,xs:12,sm:3,className:"no-print"},u.a.createElement("div",{style:{textAlign:"right"}},u.a.createElement(I.a,{title:e("print")},u.a.createElement(Z.a,{onClick:function(){return window.print()}},u.a.createElement(Eg.a,null))),u.a.createElement(I.a,{title:e("detail_view")},u.a.createElement(Z.a,{component:Y.b,to:"/submission/detail/".concat(m?m.sid:t)},u.a.createElement(Hn.a,null))))))),u.a.createElement(jg,{report:m}),u.a.createElement("div",{style:{paddingBottom:f,paddingTop:f}},u.a.createElement(Kt.a,{variant:"h6"},e("general")),u.a.createElement(j.a,{className:b.divider}),u.a.createElement("div",{style:{paddingBottom:f,paddingTop:f}},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("file.name"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{wordBreak:"break-word"}},m?m.files[0].name:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("file.description"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10,style:{wordBreak:"break-word"}},m?m.params.description:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{style:{height:f}})),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("submission.date"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},m?u.a.createElement(Dl.a,{date:m.times.submitted}):u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("submission.user"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},m?m.params.submitter:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("submission.services"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},m?m.params.services.selected.join(" | "):u.a.createElement(pr.a,null)),m&&0!==m.params.services.errors.length&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("submission.services.errors"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},u.a.createElement("span",{style:{color:"dark"===i.palette.type?i.palette.error.light:i.palette.error.dark}},m.params.services.errors.join(" | ")))),u.a.createElement(Br.a,{item:!0,xs:12},u.a.createElement("div",{style:{height:f}})),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("file.type"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},m?m.file_info.type:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("file.mime"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},m?m.file_info.mime:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("file.magic"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},m?m.file_info.magic:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("file.size"))),u.a.createElement(Br.a,{item:!0,xs:8,sm:9,lg:10},m?m.file_info.size:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("file.md5"))),u.a.createElement(Br.a,{item:!0,xs:8,md:9,lg:10,style:{fontFamily:"monospace",fontSize:"larger",wordBreak:"break-word"}},m?m.file_info.md5:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("file.sha1"))),u.a.createElement(Br.a,{item:!0,xs:8,md:9,lg:10,style:{fontFamily:"monospace",fontSize:"larger",wordBreak:"break-word"}},m?m.file_info.sha1:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("file.sha256"))),u.a.createElement(Br.a,{item:!0,xs:8,md:9,lg:10,style:{fontFamily:"monospace",fontSize:"larger",wordBreak:"break-word"}},m?m.file_info.sha256:u.a.createElement(pr.a,null)),u.a.createElement(Br.a,{item:!0,xs:4,sm:3,lg:2},u.a.createElement("span",{style:{fontWeight:500}},e("file.ssdeep"))),u.a.createElement(Br.a,{item:!0,xs:8,md:9,lg:10,style:{fontFamily:"monospace",fontSize:"larger",wordBreak:"break-word"}},m?m.file_info.ssdeep:u.a.createElement(pr.a,null))))),(!m||0!==Object.keys(m.metadata).length)&&u.a.createElement("div",{style:{paddingBottom:f,paddingTop:f,pageBreakInside:"avoid"}},u.a.createElement(Kt.a,{variant:"h6"},e("metadata")),u.a.createElement(j.a,{className:b.divider}),u.a.createElement("table",{style:{paddingBottom:f,paddingTop:f,width:"100%"}},u.a.createElement("tbody",null,m?Object.keys(m.metadata).map((function(e,t){return u.a.createElement("tr",{key:t},u.a.createElement("td",{style:{width:"20%"}},u.a.createElement("span",{style:{fontWeight:500}},e)),u.a.createElement("td",{style:{paddingLeft:g,width:"80%",wordBreak:"break-word"}},m.metadata[e]))})):Object(oe.a)(Array(3)).map((function(e,t){return u.a.createElement("tr",{key:t,style:{width:"100%"}},u.a.createElement("td",{width:"33%"},u.a.createElement(pr.a,null)),u.a.createElement("td",{width:"67%"},u.a.createElement(pr.a,null)))}))))),(!m||0!==Object.keys(m.attack_matrix).length)&&u.a.createElement("div",{style:{paddingBottom:f,paddingTop:f,pageBreakInside:"avoid"}},u.a.createElement(Kt.a,{variant:"h6"},e("attack")),u.a.createElement(j.a,{className:b.divider}),u.a.createElement("div",{style:{paddingTop:f,paddingBottom:f,columnWidth:"21rem",columnGap:"1rem"}},m?Object.keys(m.attack_matrix).map((function(e,t){return u.a.createElement(Sg,{key:t,attack:e,items:m.attack_matrix[e]})})):Object(oe.a)(Array(5)).map((function(e,t){return u.a.createElement(Cg,{key:t})})))),(!m||0!==Object.keys(m.heuristics.malicious).length||0!==Object.keys(m.heuristics.suspicious).length||0!==Object.keys(m.heuristics.info).length)&&u.a.createElement("div",{style:{paddingBottom:f,paddingTop:f,pageBreakInside:"avoid"}},u.a.createElement(Kt.a,{variant:"h6"},e("heuristics")),u.a.createElement(j.a,{className:b.divider}),u.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},m?u.a.createElement(u.a.Fragment,null,0!==Object.keys(m.heuristics.malicious).length&&u.a.createElement(Tg,{verdict:"malicious",items:m.heuristics.malicious}),0!==Object.keys(m.heuristics.suspicious).length&&u.a.createElement(Tg,{verdict:"suspicious",items:m.heuristics.suspicious}),0!==Object.keys(m.heuristics.info).length&&u.a.createElement(Tg,{verdict:"info",items:m.heuristics.info})):Object(oe.a)(Array(3)).map((function(e,t){return u.a.createElement(Ag,{key:t})})))),m&&0!==Object.keys(m.tags).length&&Object.keys(m.tags).map((function(e,t){return u.a.createElement(kg,{key:t,group:e,items:m.tags[e]})})),(!m||0!==m.important_files.length)&&u.a.createElement("div",{style:{paddingTop:f,pageBreakInside:"avoid"}},u.a.createElement(Kt.a,{variant:"h6"},e("important_files")),u.a.createElement(j.a,{className:b.divider}),u.a.createElement("div",{style:{paddingTop:f}},m?u.a.createElement(Ng,{tree:m.file_tree[m.files[0].sha256].children,important_files:m.important_files}):u.a.createElement(Ig,null)))))}var zg=a(449),Dg=a.n(zg),Bg=a(450),qg=a.n(Bg),Lg=a(448),Fg=a.n(Lg),Pg=Object(i.a)((function(e){return{searchresult:{fontStyle:"italic",paddingTop:e.spacing(.5),display:"flex",flexWrap:"wrap"}}}));function Mg(){var e=Object(X.a)(["submissions"]).t,t=Object(o.useState)(25),a=Object(n.a)(t,1)[0],r=Object(o.useState)(null),i=Object(n.a)(r,2),s=i[0],c=i[1],m=Object(o.useState)(!1),d=Object(n.a)(m,2),p=d[0],g=d[1],f=Ma(),h=f.user,b=f.indexes,E=Object(ue.g)(),y=dr(),O=Object(v.a)(),_=Object(ue.h)(),x=Object(o.useState)(null),w=Object(n.a)(x,2),j=w[0],k=w[1],S=Object(l.a)(O.breakpoints.up("md")),C=Object(o.useRef)(""),T=Pg(),A=Object(o.useState)([].concat(Object(oe.a)(Object.keys(b.submission).filter((function(e){return b.submission[e].indexed}))),Object(oe.a)(pl))),N=Object(n.a)(A,1)[0],I=function(){E.push(_.pathname)};return Object(o.useEffect)((function(){g(!0),k(new Ol(_.search,"query=*&rows=".concat(a,"&offset=0")))}),[_.search,a]),Object(o.useEffect)((function(){j&&(j.set("rows",a),j.set("offset",0),y({method:"POST",url:"/api/v4/search/submission/",body:j.getParams(),onSuccess:function(e){c(e.api_response)},onFinalize:function(){g(!1)}}))}),[j]),u.a.createElement(Yi,{margin:4},u.a.createElement("div",{style:{paddingBottom:O.spacing(2)}},u.a.createElement(Kt.a,{variant:"h4"},e("title"))),u.a.createElement(Ji,{isSticky:!0},u.a.createElement("div",{style:{paddingTop:O.spacing(1)}},u.a.createElement(vl,{initValue:j?j.get("query",""):"",placeholder:e("filter"),searching:p,suggestions:N,onValueChange:function(e){C.current=e},onClear:I,onSearch:function(){""!==C.current?(j.set("query",C.current),E.push("".concat(_.pathname,"?").concat(j.toString()))):I()},buttons:[{icon:u.a.createElement(Fg.a,{fontSize:S?"default":"small"}),tooltip:e("my_submission"),props:{onClick:function(){j.set("query",'params.submitter:"'.concat(h.username,'"')),E.push("".concat(_.pathname,"?").concat(j.getDeltaString()))}}},{icon:u.a.createElement(Dg.a,{fontSize:S?"default":"small"}),tooltip:e("completed_submissions"),props:{onClick:function(){j.set("query","state:completed"),E.push("".concat(_.pathname,"?").concat(j.getDeltaString()))}}},{icon:u.a.createElement(qg.a,{fontSize:S?"default":"small"}),tooltip:e("malicious_submissions"),props:{onClick:function(){j.set("query","max_score:>1000"),E.push("".concat(_.pathname,"?").concat(j.getDeltaString()))}}}]},null!==s&&u.a.createElement("div",{className:T.searchresult},0!==s.total&&u.a.createElement(Kt.a,{variant:"subtitle1",color:"secondary",style:{flexGrow:1}},p?u.a.createElement("span",null,e("searching")):u.a.createElement("span",null,s.total,"\xa0",j.get("query")?e("filtered".concat(1===s.total?"":"s")):e("total".concat(1===s.total?"":"s")))),u.a.createElement(xl,{total:s.total,setResults:c,pageSize:a,index:"submission",query:j,setSearching:g}))))),u.a.createElement("div",{style:{paddingTop:O.spacing(2),paddingLeft:O.spacing(.5),paddingRight:O.spacing(.5)}},u.a.createElement(Tp,{submissionResults:s})))}var Wg=a(455),Ug=a(452);function Hg(e){var t,a=e.file,n=e.setFile,r=e.disabled,l=Object(X.a)(["submit"]).t,s=Object(Wg.a)({disabled:r}),c=s.acceptedFiles,m=s.getRootProps,d=s.getInputProps,p=s.isDragActive,g=(t=r,Object(i.a)((function(e){return{drop_zone:{flex:"1",display:"flex",flexDirection:"column",alignItems:"center",padding:e.spacing(3),backgroundColor:e.palette.action.hover,outline:"none",border:"2px ".concat(e.palette.action.disabled," dashed"),borderRadius:"6px",color:e.palette.action.disabled,"&:hover":{border:t?null:"2px ".concat(e.palette.text.disabled," dashed"),backgroundColor:t?null:e.palette.action.selected,color:t?null:e.palette.text.disabled,cursor:t?null:"pointer"}},drag_enter:{border:"2px ".concat(e.palette.text.disabled," dashed"),backgroundColor:e.palette.action.selected,color:e.palette.text.disabled}}}))());return Object(o.useEffect)((function(){0!==c.length&&n(c[0])}),[c]),u.a.createElement("div",Object.assign({},m(),{className:p&&!r?"".concat(g.drop_zone," ").concat(g.drag_enter):g.drop_zone}),u.a.createElement("input",d()),u.a.createElement(Ug.a,{style:{fontSize:"140px"}}),u.a.createElement("div",{style:{height:"44px",textAlign:"center"}},u.a.createElement(Kt.a,{variant:"body1"},u.a.createElement("b",null,p&&!r?l("file.drophere"):a?a.name:l("file.dragzone"))),a&&(!p||r)&&u.a.createElement(Kt.a,{variant:"body2",align:"center"},a.size," ",l("file.dragzone.byte"))))}var Vg=a(453),Gg=a.n(Vg);var Yg=function(){var e=Pa().getBanner,t=dr(),a=Object(X.a)(["submit"]),s=a.t,c=a.i18n,m=Object(v.a)(),d=Ma(),p=d.user,g=d.c12nDef,f=d.configuration,b=Object(o.useState)(null),E=Object(n.a)(b,2),y=E[0],O=E[1],_=Object(o.useState)(null),x=Object(n.a)(_,2),w=x[0],j=x[1],k=Object(o.useState)(null),S=Object(n.a)(k,2),C=S[0],T=S[1],A=Object(o.useState)(null),N=Object(n.a)(A,2),I=N[0],R=N[1],z=Object(o.useState)(""),D=Object(n.a)(z,2),B=D[0],q=D[1],L=Object(o.useState)(!1),F=Object(n.a)(L,2),P=F[0],M=F[1],W=Object(o.useState)(!1),U=Object(n.a)(W,2),H=U[0],V=U[1],G=Object(o.useState)(null),J=Object(n.a)(G,2),Q=J[0],K=J[1],Z=Object(o.useState)(!0),$=Object(n.a)(Z,2),ee=$[0],te=$[1],ae=Object(o.useState)(null),ne=Object(n.a)(ae,2),re=ne[0],ie=ne[1],le=Object(o.useState)("0"),se=Object(n.a)(le,2),ce=se[0],oe=se[1],me=Object(l.a)(m.breakpoints.down("sm")),de=Object(l.a)(m.breakpoints.only("md")),pe=$n(),ge=pe.showErrorMessage,fe=pe.showSuccessMessage,he=pe.closeSnackbar,be=Object(ue.g)(),ve=m.spacing(1),Ee=m.spacing(2),ye=m.spacing(4),Oe=m.spacing(8),_e=Object(i.a)((function(e){return{no_pad:{padding:0},item:{marginLeft:0,width:"100%","&:hover":{background:m.palette.action.hover}}}}))(),xe=function(e){var t=e.relativePath||e.webkitRelativePath||e.fileName||e.name;return"".concat(y,"_").concat(re.size,"_").concat(t.replace(/[^0-9a-zA-Z_-]/gim,""))},we=function(){ie(null),te(!0),R(null),w.cancel(),w.off("complete"),w.off("fileError"),w.off("progress")},je=function(e){var t=!1;C.services.forEach((function(e){e.services.forEach((function(e){e.selected&&e.is_external&&(t=!0)}))})),t?(K(e),V(!0)):"file"===e?Se():Ne()},ke=function(){V(!1),"file"===Q?Se():Ne()},Se=function(){w.opts.generateUniqueIdentifier=xe,te(!1),R(0),w.on("fileError",(function(e,t){try{var a=JSON.parse(t);Object.hasOwnProperty.call(a,"api_status_code")&&401===a.api_status_code&&window.location.reload(!1)}catch(n){we(),ge(s("submit.file.upload_fail"))}})),w.on("progress",(function(){R(Math.trunc(100*w.progress()))})),w.on("complete",(function(){if(0!==w.files.length){for(var e=0;e<w.files.length;e++)if(w.files[e].error)return;t({url:"/api/v4/ui/start/".concat(y,"/"),method:"POST",body:C,onSuccess:function(e){fe("".concat(s("submit.success")," ").concat(e.api_response.sid)),setTimeout((function(){be.push("/submission/detail/".concat(e.api_response.sid))}),500)},onFailure:function(e){503===e.api_status_code||403===e.api_status_code||404===e.api_status_code||400===e.api_status_code?ge(e.api_error_message):ge(s("submit.file.failure")),te(!0),we()}})}})),w.addFile(re),w.upload()},Ce=function(e,t,a){if(C){var n=Object(h.a)({},C);n.service_spec[e].params[t].value=a,T(n)}};function Te(e,t){C&&T(Object(h.a)(Object(h.a)({},C),{},Object(r.a)({},e,t)))}function Ae(e,t){C&&(C[e]=t)}function Ne(){var e=/^(((([^:/#?]+:)?(?:(\/\/)((?:(([^:@/#?]+)(?::([^:@/#?]+))?)@)?(([^:/#?\][]+|\[[^/\]@#?]+])(?::([0-9]+))?))?)?)?((\/?(?:[^/?#]+\/+)*)([^?#]*)))?(\?[^#]+)?)(#.*)?/.exec(B);void 0!==e[15]&&""!==e[15]||(e[15]="file");var a={name:e[15],url:B,ui_params:C};M(!1),t({url:"/api/v4/submit/",method:"POST",body:a,onSuccess:function(e){te(!1),fe("".concat(s("submit.success")," ").concat(e.api_response.sid)),setTimeout((function(){be.push("/submission/detail/".concat(e.api_response.sid))}),500)},onFailure:function(e){ge(s("submit.url.failure")),M(!0)}})}return Object(o.useEffect)((function(){j(new Gg.a({target:"/api/v4/ui/flowjs/",permanentErrors:[412,404,500],maxChunkRetries:1,chunkRetryInterval:500,simultaneousUploads:4})),t({url:"/api/v4/user/settings/".concat(p.username,"/"),onSuccess:function(e){T(e.api_response)}}),O(function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?a:7&a|8).toString(16)}))}())}),[]),u.a.createElement(ir,{maxWidth:de?"800px":me?"100%":"1024px",margin:4,width:"100%"},u.a.createElement(Si,{open:H,handleClose:function(){for(var e in C.services){var t=C.services[e];for(var a in C.services[e].services){var n=C.services[e].services[a];n.selected&&n.is_external&&(n.selected=!1)}t.selected=t.services.every((function(e){return e.selected}))}ke()},handleAccept:ke,title:s("validate.title"),cancelText:s("validate.cancelText"),acceptText:s("validate.acceptText"),text:s("validate.text")}),u.a.createElement("div",{style:{marginBottom:me||f.ui.banner?null:"2rem"}},e(m)),f.ui.banner&&u.a.createElement(Bl.a,{severity:f.ui.banner_level,style:{marginBottom:"2rem"}},f.ui.banner[c.language]?f.ui.banner[c.language]:f.ui.banner.en),g.enforce?u.a.createElement("div",{style:{paddingBottom:Oe}},u.a.createElement("div",{style:{padding:ve,fontSize:16}},s("classification")),u.a.createElement(ki,{format:"long",type:"picker",c12n:C?C.classification:null,setClassification:function(e){C&&T(Object(h.a)(Object(h.a)({},C),{},{classification:e}))}})):null,u.a.createElement(Ql.a,{value:ce},u.a.createElement(ua.a,{square:!0},u.a.createElement(Kl.a,{centered:!0,onChange:function(e,t){oe(t)},indicatorColor:"primary",textColor:"primary"},u.a.createElement(Gl.a,{label:s("file"),value:"0"}),f.ui.allow_url_submissions?u.a.createElement(Gl.a,{label:s("url"),value:"1",disabled:!f.ui.allow_url_submissions}):u.a.createElement(Zl,null),u.a.createElement(Gl.a,{label:s("options"),value:"2"}))),u.a.createElement(Xl.a,{value:"0",className:_e.no_pad},C?u.a.createElement("div",{style:{marginTop:"30px"}},u.a.createElement(Hg,{file:re,setFile:function(e){ie(e)},disabled:!ee}),u.a.createElement("div",{style:{marginTop:"2rem"}},re?u.a.createElement(u.a.Fragment,null,u.a.createElement(ma.a,{disabled:!ee,color:"primary",variant:"contained",onClick:function(){return je("file")}},null===I?s("file.button"):"".concat(I).concat(s("submit.progress"))),u.a.createElement(ma.a,{style:{marginLeft:"16px"},color:"secondary",variant:"contained",onClick:we},s("file.cancel"))):null)):u.a.createElement(pr.a,{style:{height:"280px"}}),f.ui.tos?u.a.createElement("div",{style:{marginTop:"50px",textAlign:"center"}},u.a.createElement(Kt.a,{variant:"body2"},s("terms1"),u.a.createElement("i",null,s("file.button")),s("terms2"),u.a.createElement(Y.b,{style:{textDecoration:"none",color:m.palette.primary.main},to:"/tos"},s("terms3")),".")):null),f.ui.allow_url_submissions&&u.a.createElement(Xl.a,{value:"1",className:_e.no_pad},u.a.createElement("div",{style:{display:"flex",flexDirection:"row",marginTop:"30px",alignItems:"flex-start"}},C?u.a.createElement(u.a.Fragment,null,u.a.createElement(hr.a,{label:s("url.input"),error:P,size:"small",type:"url",variant:"outlined",value:B,onChange:function(e){he(),M(!1),q(e.target.value)},style:{flexGrow:1,marginRight:"1rem"}}),u.a.createElement(ma.a,{disabled:!B||!ee,color:"primary",variant:"contained",onClick:function(){return je("url")}},s("url.button"))):u.a.createElement(u.a.Fragment,null,u.a.createElement(pr.a,{style:{flexGrow:1,height:"3rem"}}),u.a.createElement(pr.a,{style:{marginLeft:"16px",height:"3rem",width:"5rem"}}))),f.ui.tos?u.a.createElement("div",{style:{marginTop:"50px",textAlign:"center"}},u.a.createElement(Kt.a,{variant:"body2"},s("terms1"),u.a.createElement("i",null,s("url.button")),s("terms2"),u.a.createElement(Y.b,{style:{textDecoration:"none",color:m.palette.primary.main},to:"/tos"},s("terms3")),".")):null),u.a.createElement(Xl.a,{value:"2",className:_e.no_pad},u.a.createElement(Br.a,{container:!0,spacing:1},u.a.createElement(Br.a,{item:!0,xs:12,md:!0},u.a.createElement("div",{style:{paddingLeft:Ee,textAlign:"left",marginTop:ye}},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},s("options.service")),u.a.createElement(Lp,{size:"small",settings:C,setSettings:T}))),u.a.createElement(Br.a,{item:!0,xs:12,md:!0},u.a.createElement("div",{style:{textAlign:"left",marginTop:ye}},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},s("options.submission")),u.a.createElement("div",{style:{paddingTop:ve,paddingBottom:ve}},u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},s("options.submission.desc")),C?u.a.createElement(hr.a,{id:"desc",size:"small",type:"text",defaultValue:C.description,onChange:function(e){return Ae("description",e.target.value)},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0}):u.a.createElement(pr.a,{style:{height:"3rem"}})),u.a.createElement("div",{style:{paddingTop:ve,paddingBottom:ve}},u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},s("options.submission.priority")),C?u.a.createElement(Qr.a,{id:"priority",margin:"dense",value:C.priority,variant:"outlined",onChange:function(e){return Te("priority",e.target.value)},fullWidth:!0},u.a.createElement(Kr.a,{value:"500"},s("options.submission.priority.low")),u.a.createElement(Kr.a,{value:"1000"},s("options.submission.priority.medium")),u.a.createElement(Kr.a,{value:"1500"},s("options.submission.priority.high"))):u.a.createElement(pr.a,{style:{height:"3rem"}})),u.a.createElement("div",{style:{paddingTop:ve,paddingBottom:ve}},u.a.createElement(ts.a,{control:C?u.a.createElement(ks.a,{size:"small",checked:C.ignore_filtering,name:"label",onChange:function(e){return Te("ignore_filtering",e.target.checked)}}):u.a.createElement(pr.a,{style:{height:"2rem",width:"1.5rem",marginLeft:"16px",marginRight:"16px"}}),label:u.a.createElement(Kt.a,{variant:"body2"},s("options.submission.ignore_filtering")),className:C?_e.item:null}),u.a.createElement(ts.a,{control:C?u.a.createElement(ks.a,{size:"small",checked:C.ignore_cache,name:"label",onChange:function(e){return Te("ignore_cache",e.target.checked)}}):u.a.createElement(pr.a,{style:{height:"2rem",width:"1.5rem",marginLeft:"16px",marginRight:"16px"}}),label:u.a.createElement(Kt.a,{variant:"body2"},s("options.submission.ignore_cache")),className:C?_e.item:null}),u.a.createElement(ts.a,{control:C?u.a.createElement(ks.a,{size:"small",checked:C.ignore_dynamic_recursion_prevention,name:"label",onChange:function(e){return Te("ignore_dynamic_recursion_prevention",e.target.checked)}}):u.a.createElement(pr.a,{style:{height:"2rem",width:"1.5rem",marginLeft:"16px",marginRight:"16px"}}),label:u.a.createElement(Kt.a,{variant:"body2"},s("options.submission.ignore_dynamic_recursion_prevention")),className:C?_e.item:null}),u.a.createElement(ts.a,{control:C?u.a.createElement(ks.a,{size:"small",checked:C.profile,name:"label",onChange:function(e){return Te("profile",e.target.checked)}}):u.a.createElement(pr.a,{style:{height:"2rem",width:"1.5rem",marginLeft:"16px",marginRight:"16px"}}),label:u.a.createElement(Kt.a,{variant:"body2"},s("options.submission.profile")),className:C?_e.item:null}),u.a.createElement(ts.a,{control:C?u.a.createElement(ks.a,{size:"small",checked:C.deep_scan,name:"label",onChange:function(e){return Te("deep_scan",e.target.checked)}}):u.a.createElement(pr.a,{style:{height:"2rem",width:"1.5rem",marginLeft:"16px",marginRight:"16px"}}),label:u.a.createElement(Kt.a,{variant:"body2"},s("options.submission.deep_scan")),className:C?_e.item:null})),u.a.createElement("div",{style:{paddingTop:ve,paddingBottom:ve}},u.a.createElement(Kt.a,{variant:"caption",color:"textSecondary",gutterBottom:!0},s("options.submission.ttl")),C?u.a.createElement(hr.a,{id:"ttl",size:"small",type:"number",inputProps:{min:0,max:365},defaultValue:C.ttl,onChange:function(e){return Ae("ttl",e.target.value)},variant:"outlined",fullWidth:!0}):u.a.createElement(pr.a,{style:{height:"3rem"}}))),C&&0!==C.service_spec.length?u.a.createElement("div",{style:{textAlign:"left",marginTop:ye}},u.a.createElement(Kt.a,{variant:"h6",gutterBottom:!0},s("options.service_spec")),C.service_spec.map((function(e,t){return u.a.createElement("div",{key:t,style:{paddingTop:ve,paddingBottom:ve}},u.a.createElement(Kt.a,{variant:"subtitle1",gutterBottom:!0},e.name),e.params.map((function(e,a){return u.a.createElement("div",{key:a,style:{paddingBottom:ve}},"bool"===e.type?u.a.createElement("div",{style:{paddingLeft:ve}},u.a.createElement(ts.a,{control:u.a.createElement(ks.a,{size:"small",checked:"true"===e.value||!0===e.value,name:"label",onChange:function(){return Ce(t,a,!e.value)}}),label:u.a.createElement(Kt.a,{variant:"body2",style:{textTransform:"capitalize"}},e.name.replace(/_/g," ")),className:_e.item})):u.a.createElement(u.a.Fragment,null,u.a.createElement("div",null,u.a.createElement(Kt.a,{variant:"caption",gutterBottom:!0,style:{textTransform:"capitalize"}},e.name.replace(/_/g," "))),"list"===e.type?u.a.createElement(Qr.a,{margin:"dense",value:e.value,variant:"outlined",onChange:function(e){return Ce(t,a,e.target.value)},fullWidth:!0},e.list.map((function(e,t){return u.a.createElement(Kr.a,{key:t,value:e},e)}))):u.a.createElement(hr.a,{variant:"outlined",type:"int"===e.type?"number":"text",size:"small",fullWidth:!0,defaultValue:e.value,onChange:function(e){return n=t,r=a,i=e.target.value,void(C&&(C.service_spec[n].params[r].value=i));var n,r,i}})))})))}))):null)))))},Jg=a(644);function Qg(){var e=Object(X.a)(["tos"]).t,t=Object(v.a)(),a=Object(o.useState)(""),l=Object(n.a)(a,2),s=l[0],c=l[1],m=Object(o.useState)(!1),d=Object(n.a)(m,2),p=d[0],g=d[1],f=Pa().getBanner,h=Ma(),b=h.user,E=h.configuration,y=dr(),O=Object(i.a)((function(e){var t;return{no_pad:{padding:0},page:(t={maxWidth:"960px",width:"100%"},Object(r.a)(t,e.breakpoints.down("sm"),{maxWidth:"100%"}),Object(r.a)(t,e.breakpoints.only("md"),{maxWidth:"630px"}),t),buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}))(),_=t.spacing(6);return Object(o.useEffect)((function(){E.ui.tos&&y({url:"/api/v4/help/tos/",onSuccess:function(e){return c(e.api_response)}})}),[]),E.ui.tos?u.a.createElement(ir,{margin:4,width:"100%"},u.a.createElement("div",{className:O.page,style:{display:"inline-block",textAlign:"center"}},u.a.createElement("div",null,f(t)),u.a.createElement("div",{style:{marginBottom:_,textAlign:"left"}},u.a.createElement(Kt.a,{variant:"h3",gutterBottom:!0},e("title"))),s?u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{textAlign:"left"}},u.a.createElement(Jg,{source:s,renderers:{link:$t.a}})),b.agrees_with_tos?u.a.createElement("div",{style:{marginTop:_}},u.a.createElement(Kt.a,{variant:"subtitle1",color:"secondary"},e("agreed"))):u.a.createElement("div",null,u.a.createElement(ma.a,{style:{marginTop:"3rem",marginBottom:"3rem"},variant:"contained",color:"primary",disabled:p,onClick:function(){y({url:"/api/v4/user/tos/".concat(b.username,"/"),onSuccess:function(){return window.location.reload(!1)},onEnter:function(){return g(!0)},onExit:function(){return g(!1)}})}},e("button"),p&&u.a.createElement(tr.a,{size:24,className:O.buttonProgress})),u.a.createElement(ma.a,{style:{marginLeft:"1rem",marginTop:"3rem",marginBottom:"3rem"},variant:"contained",color:"secondary",disabled:p,onClick:function(){y({url:"/api/v4/auth/logout/",onSuccess:function(){return window.location.reload(!1)},onEnter:function(){return g(!0)},onExit:function(){return g(!1)}})}},e("logout"),p&&u.a.createElement(tr.a,{size:24,className:O.buttonProgress})))):u.a.createElement(u.a.Fragment,null,u.a.createElement(pr.a,{style:{marginBottom:12}}),u.a.createElement(pr.a,{style:{marginBottom:12}}),u.a.createElement(pr.a,{style:{marginBottom:12}}),u.a.createElement(pr.a,{style:{marginBottom:12}}),u.a.createElement(pr.a,{style:{marginBottom:12}}),u.a.createElement(pr.a,null)))):u.a.createElement(zr,null)}function Kg(){var e=Object(ue.h)().pathname,t=Object(o.useState)(null),a=Object(n.a)(t,2),r=a[0],i=a[1];return Object(o.useEffect)((function(){var t=Object(h.a)({params:{id:null}},Object(ue.f)(e,{path:"/submission/detail/:id"})).params.id;null!==t&&void 0!==t&&t!==r||(window.scrollTo(0,0),i(t));var a=e.split("/").join(" ").trim();document.title="".concat("AL4"," | ").concat(a?a.charAt(0).toUpperCase()+a.slice(1):"Submit")}),[e]),null}var Xg=u.a.memo((function(){var e=Ma(),t=e.configuration,a=e.settings;return u.a.createElement(u.a.Fragment,null,u.a.createElement(Kg,null),u.a.createElement(ue.d,null,u.a.createElement(ue.b,{exact:!0,path:"/",component:Yg}),u.a.createElement(ue.b,{exact:!0,path:"/account",component:zi}),u.a.createElement(ue.b,{exact:!0,path:"/alerts",component:Xo}),u.a.createElement(ue.b,{exact:!0,path:"/alerts/legacy",component:ou}),u.a.createElement(ue.b,{exact:!0,path:"/alerts/:id",component:Wc}),u.a.createElement(ue.b,{exact:!0,path:"/admin",component:Li}),u.a.createElement(ue.b,{exact:!0,path:"/admin/errors",component:Ul}),u.a.createElement(ue.b,{exact:!0,path:"/admin/services",component:rc}),u.a.createElement(ue.b,{exact:!0,path:"/admin/services/:svc",component:Zs}),u.a.createElement(ue.b,{exact:!0,path:"/admin/sitemap",component:cc}),u.a.createElement(ue.b,{exact:!0,path:"/admin/users",component:hc}),u.a.createElement(ue.b,{exact:!0,path:"/admin/users/:id",component:Ri}),u.a.createElement(ue.b,{exact:!0,path:"/authorize",component:du}),u.a.createElement(ue.b,{exact:!0,path:"/dashboard",component:Gu}),u.a.createElement(ue.b,{exact:!0,path:"/file/detail/:id",component:dd}),u.a.createElement(ue.b,{exact:!0,path:"/file/viewer/:id",component:bd}),u.a.createElement(ue.b,{exact:!0,path:"/help",component:vd}),u.a.createElement(ue.b,{exact:!0,path:"/help/api",component:wd}),u.a.createElement(ue.b,{exact:!0,path:"/help/classification",component:kd}),u.a.createElement(ue.b,{exact:!0,path:"/help/configuration",component:Sd}),u.a.createElement(ue.b,{exact:!0,path:"/help/search",component:Nd}),u.a.createElement(ue.b,{exact:!0,path:"/help/services",component:zd}),u.a.createElement(ue.b,{exact:!0,path:"/logout",component:Dd}),u.a.createElement(ue.b,{exact:!0,path:"/manage/heuristics",component:Jd}),u.a.createElement(ue.b,{exact:!0,path:"/manage/heuristic/:id",component:Gd}),u.a.createElement(ue.b,{exact:!0,path:"/manage/signatures",component:rp}),u.a.createElement(ue.b,{exact:!0,path:"/manage/signature/:id",component:ap}),u.a.createElement(ue.b,{exact:!0,path:"/manage/sources",component:Us}),u.a.createElement(ue.b,{exact:!0,path:"/manage/workflow/:id",component:gp}),u.a.createElement(ue.b,{exact:!0,path:"/manage/workflows",component:hp}),u.a.createElement(ue.b,{exact:!0,path:"/manage",component:Bd}),u.a.createElement(ue.b,{exact:!0,path:"/optout",component:bp}),u.a.createElement(ue.b,{exact:!0,path:"/search",component:Ip}),u.a.createElement(ue.b,{exact:!0,path:"/search/:id",component:Ip}),u.a.createElement(ue.b,{exact:!0,path:"/settings",component:Fp}),u.a.createElement(ue.b,{exact:!0,path:"/submit",component:Yg}),u.a.createElement(ue.b,{exact:!0,path:"/submission/detail/:id/:fid",component:fg}),u.a.createElement(ue.b,{exact:!0,path:"/submission/detail/:id",component:fg}),u.a.createElement(ue.b,{exact:!0,path:"/submission/report/:id",component:Rg}),"details"===a.submission_view?u.a.createElement(ue.a,{from:"/submission/:id",to:"/submission/detail/:id"}):u.a.createElement(ue.a,{from:"/submission/:id",to:"/submission/report/:id"}),u.a.createElement(ue.b,{exact:!0,path:"/submissions",component:Mg}),u.a.createElement(ue.b,{exact:!0,path:"/tos",component:Qg}),u.a.createElement(ue.b,{exact:!0,path:"/forbidden",component:lr}),u.a.createElement(ue.b,{exact:!0,path:"/notfound",component:zr}),u.a.createElement(ue.a,{to:"/notfound"})),t.system&&"production"!==t.system.type&&u.a.createElement("div",{style:{position:"sticky",bottom:"16px",right:"16px",opacity:"0.4",textAlign:"right",zIndex:1e4,marginTop:"auto",marginLeft:"auto"}},"Assemblyline ".concat(t.system.version," :: "),u.a.createElement("span",{style:{textTransform:"capitalize"}},t.system.type)))})),Zg=function(){var e=localStorage.getItem("loginParams"),t=e?JSON.parse(e):null,a=new URLSearchParams(window.location.search),r=Object(o.useState)(a.get("provider")?"login":"load"),i=Object(n.a)(r,2),l=i[0],s=i[1],c=Object(o.useState)(t),m=Object(n.a)(c,2),d=m[0],p=m[1],g=Object(X.a)().t,f=Ma(),h=f.setUser,b=f.setConfiguration,v=Pa().setReady,E=$n().showErrorMessage,y=function(e){l!==e&&s(e)};return Object(o.useEffect)((function(){if(!a.get("provider")){var e={method:"GET",headers:{"X-XSRF-TOKEN":mr()},credentials:"same-origin"};fetch("/api/v4/user/whoami/",e).then((function(e){return e.json()})).catch((function(){return{api_error_message:g("api.unreachable"),api_response:"",api_server_version:"4.0.0",api_status_code:400}})).then((function(e){void 0!==e&&e.hasOwnProperty("api_response")?403===e.api_status_code?(b(e.api_response),y("locked")):401===e.api_status_code?(localStorage.setItem("loginParams",JSON.stringify(e.api_response)),p(e.api_response),y("login")):200===e.api_status_code?(h(e.api_response),v(!0),!e.api_response.agrees_with_tos&&e.api_response.configuration.ui.tos?y("tos"):y("routes")):(E(g("api.unreachable"),3e4),y("load")):(E(g("api.unreachable"),3e4),y("load"))}))}}),[]),{load:u.a.createElement(ar,null),locked:u.a.createElement(sr,null),login:d?u.a.createElement(Rr,{oAuthProviders:d.oauth_providers,allowUserPass:d.allow_userpass_login,allowSignup:d.allow_signup,allowPWReset:d.allow_pw_rest}):u.a.createElement(ar,null),routes:u.a.createElement(Xg,null),tos:u.a.createElement(Qg,null)}[l]},$g=function(){var e=An(),t=function(){var e=Object(X.a)().t;return{routes:[{path:"/forbidden",title:e("forbidden"),isRoot:!0,icon:u.a.createElement(zn.a,null)},{path:"/notfound",title:e("notfound"),isRoot:!0,icon:u.a.createElement(Wn.a,null)},{path:"/",title:e("drawer.submit"),isRoot:!0,icon:u.a.createElement(yn.a,null)},{path:"/submit",title:e("drawer.submit"),isRoot:!0,icon:u.a.createElement(yn.a,null)},{path:"/submissions",title:e("drawer.submissions"),isRoot:!0,icon:u.a.createElement(Ya.a,null)},{path:"/submission/detail/:id",title:e("breadcrumb.submission.detail"),icon:u.a.createElement(Hn.a,null),breadcrumbs:["/submissions"]},{path:"/file/detail/:id",title:e("breadcrumb.file.detail"),icon:u.a.createElement(Pn.a,null),isRoot:!0},{path:"/file/viewer/:id",title:e("breadcrumb.file.viewer"),icon:u.a.createElement(Jn.a,null),isRoot:!0},{path:"/submission/detail/:id/:fid",title:e("breadcrumb.submission.detail"),icon:u.a.createElement(Hn.a,null),breadcrumbs:["/submissions"]},{path:"/submission/report/:id",title:e("breadcrumb.submission.report"),icon:u.a.createElement(Ln.a,null),breadcrumbs:["/submissions"]},{path:"/alerts",title:e("drawer.alerts"),isRoot:!0,icon:u.a.createElement(vn.a,null)},{path:"/alerts/:id",title:e("breadcrumb.alert.detail"),icon:u.a.createElement(In.a,null),breadcrumbs:["/alerts"]},{path:"/dashboard",title:e("drawer.dashboard"),isRoot:!0,icon:u.a.createElement(nn.a,null)},{path:"/manage",title:e("drawer.manage"),isRoot:!0,icon:u.a.createElement(Xa.a,null)},{path:"/manage/heuristics",title:e("drawer.manage.heuristics"),icon:u.a.createElement(kn.a,null),breadcrumbs:["/manage"]},{path:"/manage/heuristic/:id",title:e("breadcrumb.heuristic.detail"),icon:u.a.createElement(Gn.a,null),breadcrumbs:["/manage","/manage/heuristics"]},{path:"/manage/signatures",title:e("drawer.manage.signatures"),icon:u.a.createElement(un.a,null),breadcrumbs:["/manage"]},{path:"/manage/signature/:id",title:e("breadcrumb.signature.detail"),icon:u.a.createElement(Gn.a,null),breadcrumbs:["/manage","/manage/signatures"]},{path:"/manage/sources",title:e("drawer.manage.source"),icon:u.a.createElement(tn.a,null),breadcrumbs:["/manage"]},{path:"/manage/workflow/:id",title:e("breadcrumb.workflow.detail"),icon:u.a.createElement(Gn.a,null),breadcrumbs:["/manage","/manage/workflows"]},{path:"/manage/workflows",title:e("drawer.manage.workflow"),icon:u.a.createElement(Tn.a,null),breadcrumbs:["/manage"]},{path:"/search",title:e("drawer.search"),isRoot:!0,icon:u.a.createElement(ya.a,null)},{path:"/search/alert",title:e("drawer.search.alert"),breadcrumbs:["/search"]},{path:"/search/file",title:e("drawer.search.file"),breadcrumbs:["/search"]},{path:"/search/result",title:e("drawer.search.result"),breadcrumbs:["/search"]},{path:"/search/signature",title:e("drawer.search.signature"),breadcrumbs:["/search"]},{path:"/search/submission",title:e("drawer.search.submission"),breadcrumbs:["/search"]},{path:"/help",title:e("drawer.help"),isRoot:!0,icon:u.a.createElement(dn.a,null)},{path:"/help/api",title:e("drawer.help.api"),icon:u.a.createElement(Qa.a,null),breadcrumbs:["/help"]},{path:"/help/classification",title:e("drawer.help.classification"),icon:u.a.createElement(gn.a,null),breadcrumbs:["/help"]},{path:"/help/configuration",title:e("drawer.help.configuration"),icon:u.a.createElement(_n.a,null),breadcrumbs:["/help"]},{path:"/help/search",title:e("drawer.help.search"),icon:u.a.createElement(ya.a,null),breadcrumbs:["/help"]},{path:"/help/services",title:e("drawer.help.services"),icon:u.a.createElement(Va.a,null),breadcrumbs:["/help"]},{path:"/tos",title:e("breadcrumb.tos"),isRoot:!0,icon:u.a.createElement(Kn.a,null)},{path:"/account",title:e("usermenu.account"),isRoot:!0,icon:u.a.createElement(Ua.a,null)},{path:"/settings",title:e("usermenu.settings"),isRoot:!0,icon:u.a.createElement(wn.a,null)},{path:"/admin",title:e("adminmenu"),isRoot:!0,icon:u.a.createElement(Bn.a,null)},{path:"/admin/errors",title:e("adminmenu.errors"),icon:u.a.createElement(ln.a,null),breadcrumbs:["/admin"]},{path:"/admin/services",title:e("adminmenu.services"),icon:u.a.createElement(Va.a,null),breadcrumbs:["/admin"]},{path:"/admin/services/:svc",title:"{:svc}",icon:u.a.createElement(Zn.a,null),breadcrumbs:["/admin","/admin/services"]},{path:"/admin/sitemap",title:e("adminmenu.sitemap"),icon:u.a.createElement(hn.a,null),breadcrumbs:["/admin"]},{path:"/admin/users",title:e("adminmenu.users"),icon:u.a.createElement(Cn.a,null),breadcrumbs:["/admin"]},{path:"/admin/users/:id",title:"{:id}",isRoot:!0,icon:u.a.createElement(Ua.a,null),breadcrumbs:["/admin","/admin/users"]}]}}(),a=er();return u.a.createElement(Y.a,{basename:""},u.a.createElement(_,a,u.a.createElement(de,t,u.a.createElement($u,null,u.a.createElement($i,null,u.a.createElement(Fa,e,u.a.createElement(Zg,null)))))))},ef=function(){return u.a.createElement(f,{defaultTheme:"light",colors:{darkPrimary:"#7c93b9",darkSecondary:"#929cad",lightPrimary:"#0b65a1",lightSecondary:"#939dac"}},u.a.createElement($g,null))},tf=(a(723),a(26)),af=a.n(tf);a(724);af.a.render(u.a.createElement(ef,null),document.getElementById("root"))}},[[476,1,2]]]);
//# sourceMappingURL=main.a225b845.chunk.js.map